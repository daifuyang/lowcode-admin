var oN=Object.prototype.hasOwnProperty;var xO=Object.getOwnPropertySymbols,nN=Object.prototype.propertyIsEnumerable;var k=Object.assign;var Ia=(Rn,Ra)=>{var Pr={};for(var So in Rn)oN.call(Rn,So)&&Ra.indexOf(So)<0&&(Pr[So]=Rn[So]);if(Rn!=null&&xO)for(var So of xO(Rn))Ra.indexOf(So)<0&&nN.call(Rn,So)&&(Pr[So]=Rn[So]);return Pr};(function(){"use strict";const Rn=Object.getPrototypeOf,Ra=(e,t,o)=>{var n;return!!o(e,t.prototype)||((n=e.constructor)===null||n===void 0?void 0:n.name)===t.name},Pr=e=>t=>(o=>{const n=typeof o;return o===null?"null":n==="object"&&Array.isArray(o)?"array":n==="object"&&Ra(o,String,(r,s)=>s.isPrototypeOf(r))?"string":n})(t)===e,So=e=>t=>typeof t===e,eh=e=>t=>e===t,_e=Pr("string"),gr=Pr("object"),th=e=>((t,o)=>gr(t)&&Ra(t,o,(n,r)=>Rn(n)===r))(e,Object),pr=Pr("array"),il=eh(null),Nn=So("boolean"),Vn=eh(void 0),ll=e=>e==null,No=e=>!ll(e),ko=So("function"),hr=So("number"),Na=(e,t)=>{if(pr(e)){for(let o=0,n=e.length;o<n;++o)if(!t(e[o]))return!1;return!0}return!1},H=()=>{},Sd=(e,t)=>(...o)=>e(t.apply(null,o)),E=e=>()=>e,xe=e=>e,oh=(e,t)=>e===t;function Co(e,...t){return(...o)=>{const n=t.concat(o);return e.apply(null,n)}}const Va=e=>t=>!e(t),kd=e=>()=>{throw new Error(e)},nh=e=>e(),Ve=E(!1),pt=E(!0);var wO=tinymce.util.Tools.resolve("tinymce.ThemeManager");class g{constructor(t,o){this.tag=t,this.value=o}static some(t){return new g(!0,t)}static none(){return g.singletonNone}fold(t,o){return this.tag?o(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?g.some(t(this.value)):g.none()}bind(t){return this.tag?t(this.value):g.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:g.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t!=null?t:"Called getOrDie on None")}static from(t){return No(t)?g.some(t):g.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}g.singletonNone=new g(!1);const cl=Array.prototype.slice,SO=Array.prototype.indexOf,kO=Array.prototype.push,rh=(e,t)=>SO.call(e,t),sh=(e,t)=>{const o=rh(e,t);return o===-1?g.none():g.some(o)},ht=(e,t)=>rh(e,t)>-1,Yo=(e,t)=>{for(let o=0,n=e.length;o<n;o++)if(t(e[o],o))return!0;return!1},Cd=(e,t)=>{const o=[];for(let n=0;n<e;n++)o.push(t(n));return o},ah=(e,t)=>{const o=[];for(let n=0;n<e.length;n+=t){const r=cl.call(e,n,n+t);o.push(r)}return o},N=(e,t)=>{const o=e.length,n=new Array(o);for(let r=0;r<o;r++){const s=e[r];n[r]=t(s,r)}return n},q=(e,t)=>{for(let o=0,n=e.length;o<n;o++)t(e[o],o)},ih=(e,t)=>{const o=[],n=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];(t(a,r)?o:n).push(a)}return{pass:o,fail:n}},He=(e,t)=>{const o=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t(s,n)&&o.push(s)}return o},Bs=(e,t,o)=>(((n,r)=>{for(let s=n.length-1;s>=0;s--)r(n[s],s)})(e,(n,r)=>{o=t(o,n,r)}),o),Ft=(e,t,o)=>(q(e,(n,r)=>{o=t(o,n,r)}),o),Ke=(e,t)=>((o,n,r)=>{for(let s=0,a=o.length;s<a;s++){const i=o[s];if(n(i,s))return g.some(i);if(r(i,s))break}return g.none()})(e,t,Ve),Fs=(e,t)=>{for(let o=0,n=e.length;o<n;o++)if(t(e[o],o))return g.some(o);return g.none()},xt=e=>{const t=[];for(let o=0,n=e.length;o<n;++o){if(!pr(e[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+e);kO.apply(t,e[o])}return t},nt=(e,t)=>xt(N(e,t)),Is=(e,t)=>{for(let o=0,n=e.length;o<n;++o)if(t(e[o],o)!==!0)return!1;return!0},Ha=e=>{const t=cl.call(e,0);return t.reverse(),t},Ur=(e,t)=>He(e,o=>!ht(t,o)),lh=(e,t)=>{const o={};for(let n=0,r=e.length;n<r;n++){const s=e[n];o[String(s)]=t(s,n)}return o},CO=e=>[e],ch=(e,t)=>{const o=cl.call(e,0);return o.sort(t),o},dl=(e,t)=>t>=0&&t<e.length?g.some(e[t]):g.none(),Hn=e=>dl(e,0),Od=e=>dl(e,e.length-1),OO=ko(Array.from)?Array.from:e=>cl.call(e),yn=(e,t)=>{for(let o=0;o<e.length;o++){const n=t(e[o],o);if(n.isSome())return n}return g.none()},rt=Object.keys,_O=Object.hasOwnProperty,It=(e,t)=>{const o=rt(e);for(let n=0,r=o.length;n<r;n++){const s=o[n];t(e[s],s)}},ft=(e,t)=>dh(e,(o,n)=>({k:n,v:t(o,n)})),dh=(e,t)=>{const o={};return It(e,(n,r)=>{const s=t(n,r);o[s.k]=s.v}),o},_d=e=>(t,o)=>{e[o]=t},uh=(e,t,o,n)=>{It(e,(r,s)=>{(t(r,s)?o:n)(r,s)})},mh=(e,t)=>{const o={};return uh(e,t,_d(o),H),o},ul=(e,t)=>{const o=[];return It(e,(n,r)=>{o.push(t(n,r))}),o},Td=(e,t)=>{const o=rt(e);for(let n=0,r=o.length;n<r;n++){const s=o[n],a=e[s];if(t(a,s,e))return g.some(a)}return g.none()},Ed=e=>ul(e,xe),K=(e,t)=>Te(e,t)?g.from(e[t]):g.none(),Te=(e,t)=>_O.call(e,t),Vo=(e,t)=>Te(e,t)&&e[t]!==void 0&&e[t]!==null,Jo=(e,t,o=oh)=>e.exists(n=>o(n,t)),Wr=e=>{const t=[],o=n=>{t.push(n)};for(let n=0;n<e.length;n++)e[n].each(o);return t},ml=(e,t,o)=>e.isSome()&&t.isSome()?g.some(o(e.getOrDie(),t.getOrDie())):g.none(),za=(e,t)=>e?g.some(t):g.none(),gh=(e,t,o)=>t===""||e.length>=t.length&&e.substr(o,o+t.length)===t,qt=(e,t,o=0,n)=>{const r=e.indexOf(t,o);return r!==-1&&(!!Vn(n)||r+t.length<=n)},gl=(e,t)=>gh(e,t,e.length-t.length),TO=(Kh=/^\s+|\s+$/g,e=>e.replace(Kh,"")),Ad=e=>e.length>0,La=e=>e.style!==void 0&&ko(e.style.getPropertyValue),pl=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},EO=(e,t)=>{const o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){const n="HTML does not have a single root node";throw console.error(n,e),new Error(n)}return pl(o.childNodes[0])},Rs=(e,t)=>{const o=(t||document).createElement(e);return pl(o)},ph=(e,t)=>{const o=(t||document).createTextNode(e);return pl(o)},U=pl,AO=typeof window!="undefined"?window:Function("return this;")(),hh=(e,t)=>((o,n)=>{let r=n!=null?n:AO;for(let s=0;s<o.length&&r!=null;++s)r=r[o[s]];return r})(e.split("."),t),MO=Object.getPrototypeOf,DO=e=>{const t=hh("ownerDocument.defaultView",e);return gr(e)&&((o=>((n,r)=>{const s=((a,i)=>hh(a,i))(n,r);if(s==null)throw new Error(n+" not available on this browser");return s})("HTMLElement",o))(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(MO(e).constructor.name))},zn=e=>e.dom.nodeName.toLowerCase(),hl=e=>t=>(o=>o.dom.nodeType)(t)===e,Oo=hl(1),jr=hl(3),BO=hl(9),FO=hl(11),fh=e=>t=>Oo(t)&&zn(t)===e,Md=(e,t)=>{const o=e.dom;if(o.nodeType!==1)return!1;{const n=o;if(n.matches!==void 0)return n.matches(t);if(n.msMatchesSelector!==void 0)return n.msMatchesSelector(t);if(n.webkitMatchesSelector!==void 0)return n.webkitMatchesSelector(t);if(n.mozMatchesSelector!==void 0)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},bh=e=>e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11||e.childElementCount===0,Le=(e,t)=>e.dom===t.dom,fl=(e,t)=>{const o=e.dom,n=t.dom;return o!==n&&o.contains(n)},Zo=e=>U(e.dom.ownerDocument),bl=e=>BO(e)?e:Zo(e),Dd=e=>U(bl(e).dom.documentElement),Pa=e=>U(bl(e).dom.defaultView),xn=e=>g.from(e.dom.parentNode).map(U),Ua=e=>g.from(e.dom.parentElement).map(U),vh=e=>g.from(e.dom.offsetParent).map(U),wn=e=>N(e.dom.childNodes,U),Gr=(e,t)=>{const o=e.dom.childNodes;return g.from(o[t]).map(U)},yh=(e,t)=>({element:e,offset:t}),xh=(e,t)=>{const o=wn(e);return o.length>0&&t<o.length?yh(o[t],0):yh(e,t)},Bd=e=>FO(e)&&No(e.dom.host),wh=ko(Element.prototype.attachShadow)&&ko(Node.prototype.getRootNode),IO=E(wh),_o=wh?e=>U(e.dom.getRootNode()):bl,vl=e=>Bd(e)?e:U(bl(e).dom.body),Sh=e=>{const t=_o(e);return Bd(t)?g.some(t):g.none()},RO=e=>U(e.dom.host),Ho=e=>{const t=jr(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const o=t.ownerDocument;return Sh(U(t)).fold(()=>o.body.contains(t),(n=Ho,r=RO,s=>n(r(s))));var n,r},Ln=()=>NO(U(document)),NO=e=>{const t=e.dom.body;if(t==null)throw new Error("Body is not available yet");return U(t)},kh=(e,t,o)=>{if(!(_e(o)||Nn(o)||hr(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},ie=(e,t,o)=>{kh(e.dom,t,o)},Ch=(e,t)=>{const o=e.dom;It(t,(n,r)=>{kh(o,r,n)})},Tt=(e,t)=>{const o=e.dom.getAttribute(t);return o===null?void 0:o},lo=(e,t)=>g.from(Tt(e,t)),Oh=(e,t)=>{const o=e.dom;return!(!o||!o.hasAttribute)&&o.hasAttribute(t)},at=(e,t)=>{e.dom.removeAttribute(t)},Fd=(e,t,o)=>{if(!_e(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);La(e)&&e.style.setProperty(t,o)},_h=(e,t)=>{La(e)&&e.style.removeProperty(t)},se=(e,t,o)=>{const n=e.dom;Fd(n,t,o)},Ns=(e,t)=>{const o=e.dom;It(t,(n,r)=>{Fd(o,r,n)})},yl=(e,t)=>{const o=e.dom;It(t,(n,r)=>{n.fold(()=>{_h(o,r)},s=>{Fd(o,r,s)})})},co=(e,t)=>{const o=e.dom,n=window.getComputedStyle(o).getPropertyValue(t);return n!==""||Ho(e)?n:Th(o,t)},Th=(e,t)=>La(e)?e.style.getPropertyValue(t):"",Et=(e,t)=>{const o=e.dom,n=Th(o,t);return g.from(n).filter(r=>r.length>0)},Eh=e=>{const t={},o=e.dom;if(La(o))for(let n=0;n<o.style.length;n++){const r=o.style.item(n);t[r]=o.style[r]}return t},Ah=(e,t,o)=>{const n=Rs(e);return se(n,t,o),Et(n,t).isSome()},Me=(e,t)=>{const o=e.dom;_h(o,t),Jo(lo(e,"style").map(TO),"")&&at(e,"style")},Wa=e=>e.dom.offsetWidth,Mh=(e,t)=>{const o=r=>{const s=t(r);if(s<=0||s===null){const a=co(r,e);return parseFloat(a)||0}return s},n=(r,s)=>Ft(s,(a,i)=>{const l=co(r,i),c=l===void 0?0:parseInt(l,10);return isNaN(c)?a:a+c},0);return{set:(r,s)=>{if(!hr(s)&&!s.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+s);const a=r.dom;La(a)&&(a.style[e]=s+"px")},get:o,getOuter:o,aggregate:n,max:(r,s,a)=>{const i=n(r,a);return s>i?s-i:0}}},Id=Mh("height",e=>{const t=e.dom;return Ho(e)?t.getBoundingClientRect().height:t.offsetHeight}),Rt=e=>Id.get(e),$r=e=>Id.getOuter(e),Dh=(e,t)=>({left:e,top:t,translate:(o,n)=>Dh(e+o,t+n)}),We=Dh,xl=(e,t)=>e!==void 0?e:t!==void 0?t:0,fr=e=>{const t=e.dom.ownerDocument,o=t.body,n=t.defaultView,r=t.documentElement;if(o===e.dom)return We(o.offsetLeft,o.offsetTop);const s=xl(n==null?void 0:n.pageYOffset,r.scrollTop),a=xl(n==null?void 0:n.pageXOffset,r.scrollLeft),i=xl(r.clientTop,o.clientTop),l=xl(r.clientLeft,o.clientLeft);return Rd(e).translate(a-l,s-i)},Rd=e=>{const t=e.dom,o=t.ownerDocument.body;return o===t?We(o.offsetLeft,o.offsetTop):Ho(e)?(n=>{const r=n.getBoundingClientRect();return We(r.left,r.top)})(t):We(0,0)},wl=Mh("width",e=>e.dom.offsetWidth),Xt=e=>wl.get(e),ja=e=>wl.getOuter(e),br=e=>{let t,o=!1;return(...n)=>(o||(o=!0,t=e.apply(null,n)),t)},Bh=()=>Nd(0,0),Nd=(e,t)=>({major:e,minor:t}),Ga={nu:Nd,detect:(e,t)=>{const o=String(t).toLowerCase();return e.length===0?Bh():((n,r)=>{const s=((i,l)=>{for(let c=0;c<i.length;c++){const u=i[c];if(u.test(l))return u}})(n,r);if(!s)return{major:0,minor:0};const a=i=>Number(r.replace(s,"$"+i));return Nd(a(1),a(2))})(e,o)},unknown:Bh},Fh=(e,t)=>{const o=String(t).toLowerCase();return Ke(e,n=>n.search(o))},Vd=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Pn=e=>t=>qt(t,e),VO=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>qt(e,"edge/")&&qt(e,"chrome")&&qt(e,"safari")&&qt(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Vd],search:e=>qt(e,"chrome")&&!qt(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>qt(e,"msie")||qt(e,"trident")},{name:"Opera",versionRegexes:[Vd,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Pn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Pn("firefox")},{name:"Safari",versionRegexes:[Vd,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(qt(e,"safari")||qt(e,"mobile/"))&&qt(e,"applewebkit")}],HO=[{name:"Windows",search:Pn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>qt(e,"iphone")||qt(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Pn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Pn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Pn("linux"),versionRegexes:[]},{name:"Solaris",search:Pn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Pn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Pn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Ih={browsers:E(VO),oses:E(HO)},Rh="Edge",Nh="Chromium",Vh="Opera",Hh="Firefox",zh="Safari",Lh=e=>{const t=e.current,o=e.version,n=r=>()=>t===r;return{current:t,version:o,isEdge:n(Rh),isChromium:n(Nh),isIE:n("IE"),isOpera:n(Vh),isFirefox:n(Hh),isSafari:n(zh)}},zO=()=>Lh({current:void 0,version:Ga.unknown()}),LO=Lh,Ph=(E(Rh),E(Nh),E("IE"),E(Vh),E(Hh),E(zh),"Windows"),Uh="Android",Wh="Linux",jh="macOS",Gh="Solaris",$h="FreeBSD",qh="ChromeOS",Xh=e=>{const t=e.current,o=e.version,n=r=>()=>t===r;return{current:t,version:o,isWindows:n(Ph),isiOS:n("iOS"),isAndroid:n(Uh),isMacOS:n(jh),isLinux:n(Wh),isSolaris:n(Gh),isFreeBSD:n($h),isChromeOS:n(qh)}},PO=()=>Xh({current:void 0,version:Ga.unknown()}),UO=Xh,WO=(E(Ph),E("iOS"),E(Uh),E(Wh),E(jh),E(Gh),E($h),E(qh),e=>window.matchMedia(e).matches);var Kh;let jO=br(()=>((e,t,o)=>{const n=Ih.browsers(),r=Ih.oses(),s=t.bind(l=>((c,u)=>yn(u.brands,d=>{const m=d.brand.toLowerCase();return Ke(c,p=>{var h;return m===((h=p.brand)===null||h===void 0?void 0:h.toLowerCase())}).map(p=>({current:p.name,version:Ga.nu(parseInt(d.version,10),0)}))}))(n,l)).orThunk(()=>((l,c)=>Fh(l,c).map(u=>{const d=Ga.detect(u.versionRegexes,c);return{current:u.name,version:d}}))(n,e)).fold(zO,LO),a=((l,c)=>Fh(l,c).map(u=>{const d=Ga.detect(u.versionRegexes,c);return{current:u.name,version:d}}))(r,e).fold(PO,UO),i=((l,c,u,d)=>{const m=l.isiOS()&&/ipad/i.test(u)===!0,p=l.isiOS()&&!m,h=l.isiOS()||l.isAndroid(),f=h||d("(pointer:coarse)"),v=m||!p&&h&&d("(min-device-width:768px)"),y=p||h&&!v,x=c.isSafari()&&l.isiOS()&&/safari/i.test(u)===!1,b=!y&&!v&&!x;return{isiPad:E(m),isiPhone:E(p),isTablet:E(v),isPhone:E(y),isTouch:E(f),isAndroid:l.isAndroid,isiOS:l.isiOS,isWebView:E(x),isDesktop:E(b)}})(a,s,e,o);return{browser:s,os:a,deviceType:i}})(navigator.userAgent,g.from(navigator.userAgentData),WO));const qr=()=>jO(),Yh=e=>{const t=U((s=>{if(IO()&&No(s.target)){const a=U(s.target);if(Oo(a)&&(i=>No(i.dom.shadowRoot))(a)&&s.composed&&s.composedPath){const i=s.composedPath();if(i)return Hn(i)}}return g.from(s.target)})(e).getOr(e.target)),o=()=>e.stopPropagation(),n=()=>e.preventDefault(),r=Sd(n,o);return((s,a,i,l,c,u,d)=>({target:s,x:a,y:i,stop:l,prevent:c,kill:u,raw:d}))(t,e.clientX,e.clientY,o,n,r,e)},Jh=(e,t,o,n,r)=>{const s=((a,i)=>l=>{a(l)&&i(Yh(l))})(o,n);return e.dom.addEventListener(t,s,r),{unbind:Co(GO,e,t,s,r)}},GO=(e,t,o,n)=>{e.dom.removeEventListener(t,o,n)},$a=(e,t)=>{xn(e).each(o=>{o.dom.insertBefore(t.dom,e.dom)})},$O=(e,t)=>{(n=>g.from(n.dom.nextSibling).map(U))(e).fold(()=>{xn(e).each(n=>{zo(n,t)})},n=>{$a(n,t)})},qO=(e,t)=>{(n=>Gr(n,0))(e).fold(()=>{zo(e,t)},n=>{e.dom.insertBefore(t.dom,n.dom)})},zo=(e,t)=>{e.dom.appendChild(t.dom)},Zh=(e,t)=>{q(t,o=>{zo(e,o)})},Hd=e=>{e.dom.textContent="",q(wn(e),t=>{Un(t)})},Un=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},Sn=e=>{const t=e!==void 0?e.dom:document,o=t.body.scrollLeft||t.documentElement.scrollLeft,n=t.body.scrollTop||t.documentElement.scrollTop;return We(o,n)},Qh=(e,t,o)=>{const n=(o!==void 0?o.dom:document).defaultView;n&&n.scrollTo(e,t)},ef=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),tf=e=>{const t=e===void 0?window:e,o=t.document,n=Sn(U(o));return(r=>{const s=r===void 0?window:r;return qr().browser.isFirefox()?g.none():g.from(s.visualViewport)})(t).fold(()=>{const r=t.document.documentElement,s=r.clientWidth,a=r.clientHeight;return ef(n.left,n.top,s,a)},r=>ef(Math.max(r.pageLeft,n.left),Math.max(r.pageTop,n.top),r.width,r.height))},zd=()=>U(document),of=(e,t)=>e.view(t).fold(E([]),o=>{const n=e.owner(o),r=of(e,n);return[o].concat(r)});var XO=Object.freeze({__proto__:null,view:e=>{var t;return(e.dom===document?g.none():g.from((t=e.dom.defaultView)===null||t===void 0?void 0:t.frameElement)).map(U)},owner:e=>Zo(e)});const Ld=e=>{const t=zd(),o=Sn(t);return((r,s)=>{const a=s.owner(r),i=of(s,a);return g.some(i)})(e,XO).fold(Co(fr,e),r=>{const s=Rd(e),a=Bs(r,(i,l)=>{const c=Rd(l);return{left:i.left+c.left,top:i.top+c.top}},{left:0,top:0});return We(a.left+s.left+o.left,a.top+s.top+o.top)})},Nt=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),Qt=e=>{const t=fr(e),o=ja(e),n=$r(e);return Nt(t.left,t.top,o,n)},Xr=e=>{const t=Ld(e),o=ja(e),n=$r(e);return Nt(t.left,t.top,o,n)},kn=()=>tf(window),nf=e=>{const t=s=>s(e),o=E(e),n=()=>r,r={tag:!0,inner:e,fold:(s,a)=>a(e),isValue:pt,isError:Ve,map:s=>ue.value(s(e)),mapError:n,bind:t,exists:t,forall:t,getOr:o,or:n,getOrThunk:o,orThunk:n,getOrDie:o,each:s=>{s(e)},toOptional:()=>g.some(e)};return r},rf=e=>{const t=()=>o,o={tag:!1,inner:e,fold:(n,r)=>n(e),isValue:Ve,isError:pt,map:t,mapError:n=>ue.error(n(e)),bind:t,exists:Ve,forall:pt,getOr:xe,or:xe,getOrThunk:nh,orThunk:nh,getOrDie:kd(String(e)),each:H,toOptional:g.none};return o},ue={value:nf,error:rf,fromOption:(e,t)=>e.fold(()=>rf(t),nf)};var To;(function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"})(To||(To={}));const Pd=(e,t,o)=>e.stype===To.Error?t(e.serror):o(e.svalue),sf=e=>({stype:To.Value,svalue:e}),af=e=>({stype:To.Error,serror:e}),Kr=sf,Yr=af,KO=Pd,lf=(e,t,o,n)=>({tag:"field",key:e,newKey:t,presence:o,prop:n}),Ud=(e,t,o)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return o(e.newKey,e.instantiator)}},cf=e=>(...t)=>{if(t.length===0)throw new Error("Can't merge zero objects");const o={};for(let n=0;n<t.length;n++){const r=t[n];for(const s in r)Te(r,s)&&(o[s]=e(o[s],r[s]))}return o},je=cf((e,t)=>th(e)&&th(t)?je(e,t):t),YO=cf((e,t)=>t),Sl=e=>({tag:"defaultedThunk",process:e}),kl=e=>Sl(E(e)),Wd=e=>({tag:"mergeWithThunk",process:e}),df=e=>{const t=(n=>{const r=[],s=[];return q(n,a=>{Pd(a,i=>s.push(i),i=>r.push(i))}),{values:r,errors:s}})(e);return t.errors.length>0?(o=t.errors,Sd(Yr,xt)(o)):Kr(t.values);var o},jd=e=>gr(e)&&rt(e).length>100?" removed due to size":JSON.stringify(e,null,2),qa=(e,t)=>Yr([{path:e,getErrorInfo:t}]),Vs=e=>({extract:(t,o)=>{return n=e(o),r=s=>((a,i)=>qa(a,E(i)))(t,s),n.stype===To.Error?r(n.serror):n;var n,r},toString:E("val")}),uf=Vs(Kr),mf=(e,t,o,n)=>n(K(e,t).getOrThunk(()=>o(e))),JO=(e,t,o,n,r)=>{const s=i=>r.extract(t.concat([n]),i),a=i=>i.fold(()=>Kr(g.none()),l=>{return u=r.extract(t.concat([n]),l),d=g.some,u.stype===To.Value?{stype:To.Value,svalue:d(u.svalue)}:u;var u,d});switch(e.tag){case"required":return((i,l,c,u)=>K(l,c).fold(()=>((d,m,p)=>qa(d,()=>'Could not find valid *required* value for "'+m+'" in '+jd(p)))(i,c,l),u))(t,o,n,s);case"defaultedThunk":return mf(o,n,e.process,s);case"option":return((i,l,c)=>c(K(i,l)))(o,n,a);case"defaultedOptionThunk":return((i,l,c,u)=>u(K(i,l).map(d=>d===!0?c(i):d)))(o,n,e.process,a);case"mergeWithThunk":return mf(o,n,E({}),i=>{const l=je(e.process(o),i);return s(l)})}},gf=e=>({extract:(t,o)=>e().extract(t,o),toString:()=>e().toString()}),ZO=e=>rt(mh(e,No)),uo=e=>{const t=X(e),o=Bs(e,(n,r)=>Ud(r,s=>je(n,{[s]:!0}),E(n)),{});return{extract:(n,r)=>{const s=Nn(r)?[]:ZO(r),a=He(s,i=>!Vo(o,i));return a.length===0?t.extract(n,r):((i,l)=>qa(i,()=>"There are unsupported fields: ["+l.join(", ")+"] specified"))(n,a)},toString:t.toString}},X=e=>({extract:(t,o)=>((n,r,s)=>{const a={},i=[];for(const l of s)Ud(l,(c,u,d,m)=>{const p=JO(d,n,r,c,m);KO(p,h=>{i.push(...h)},h=>{a[u]=h})},(c,u)=>{a[c]=u(r)});return i.length>0?Yr(i):Kr(a)})(t,o,e),toString:()=>{const t=N(e,o=>Ud(o,(n,r,s,a)=>n+" -> "+a.toString(),(n,r)=>"state("+n+")"));return`obj{
`+t.join(`
`)+"}"}}),vr=e=>({extract:(t,o)=>{const n=N(o,(r,s)=>e.extract(t.concat(["["+s+"]"]),r));return df(n)},toString:()=>"array("+e.toString()+")"}),Gd=(e,t)=>{const o=t!==void 0?t:xe;return{extract:(n,r)=>{const s=[];for(const a of e){const i=a.extract(n,r);if(i.stype===To.Value)return{stype:To.Value,svalue:o(i.svalue)};s.push(i)}return df(s)},toString:()=>"oneOf("+N(e,n=>n.toString()).join(", ")+")"}},QO=(e,t)=>({extract:(o,n)=>{const r=rt(n),s=((l,c)=>vr(Vs(e)).extract(l,c))(o,r);return i=l=>{const c=N(l,u=>lf(u,u,{tag:"required",process:{}},t));return X(c).extract(o,n)},(a=s).stype===To.Value?i(a.svalue):a;var a,i},toString:()=>"setOf("+t.toString()+")"}),$d=Sd(vr,X),Qo=E(uf),Cl=(e,t)=>Vs(o=>{const n=typeof o;return e(o)?Kr(o):Yr(`Expected type: ${t} but got: ${n}`)}),Ol=Cl(hr,"number"),wt=Cl(_e,"string"),Xa=Cl(Nn,"boolean"),qd=Cl(ko,"function"),pf=e=>{if(Object(e)!==e)return!0;switch({}.toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every(t=>pf(e[t]));default:return!1}},e_=Vs(e=>pf(e)?Kr(e):Yr("Expected value to be acceptable for sending via postMessage")),_l=(e,t)=>({extract:(o,n)=>K(n,e).fold(()=>((r,s)=>qa(r,()=>'Choice schema did not contain choice key: "'+s+'"'))(o,e),r=>((s,a,i,l)=>K(i,l).fold(()=>((c,u,d)=>qa(c,()=>'The chosen schema: "'+d+'" did not exist in branches: '+jd(u)))(s,i,l),c=>c.extract(s.concat(["branch: "+l]),a)))(o,n,t,r)),toString:()=>"chooseOn("+e+"). Possible values: "+rt(t)}),Ka=e=>Vs(t=>e(t).fold(Yr,Kr)),hf=(e,t)=>QO(o=>e(o).fold(af,sf),t),Ue=(e,t,o)=>{return n=((r,s,a)=>((i,l)=>i.stype===To.Error?{stype:To.Error,serror:l(i.serror)}:i)(s.extract([r],a),i=>({input:a,errors:i})))(e,t,o),Pd(n,ue.error,ue.value);var n},en=e=>e.fold(t=>{throw new Error(Hs(t))},xe),Kt=(e,t,o)=>en(Ue(e,t,o)),Hs=e=>`Errors: 
`+(t=>{const o=t.length>10?t.slice(0,10).concat([{path:[],getErrorInfo:E("... (only showing first ten failures)")}]):t;return N(o,n=>"Failed path: ("+n.path.join(" > ")+`)
`+n.getErrorInfo())})(e.errors).join(`
`)+`

Input object: `+jd(e.input),mo=(e,t)=>_l(e,ft(t,X)),St=lf,zt=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),Xd=e=>Ka(t=>ht(e,t)?ue.value(t):ue.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),M=e=>St(e,e,{tag:"required",process:{}},Qo()),go=(e,t)=>St(e,e,{tag:"required",process:{}},t),t_=e=>go(e,Ol),it=e=>go(e,wt),Ya=(e,t)=>St(e,e,{tag:"required",process:{}},Xd(t)),Lo=e=>go(e,qd),yr=(e,t)=>St(e,e,{tag:"required",process:{}},X(t)),ff=(e,t)=>St(e,e,{tag:"required",process:{}},$d(t)),Eo=(e,t)=>St(e,e,{tag:"required",process:{}},vr(t)),Se=e=>St(e,e,{tag:"option",process:{}},Qo()),Wn=(e,t)=>St(e,e,{tag:"option",process:{}},t),Ja=e=>Wn(e,Ol),eo=e=>Wn(e,wt),bf=(e,t)=>Wn(e,Xd(t)),Tl=e=>Wn(e,qd),vf=(e,t)=>Wn(e,vr(t)),po=(e,t)=>Wn(e,X(t)),T=(e,t)=>St(e,e,kl(t),Qo()),Ao=(e,t,o)=>St(e,e,kl(t),o),Kd=(e,t)=>Ao(e,t,Ol),jn=(e,t)=>Ao(e,t,wt),Gn=(e,t,o)=>Ao(e,t,Xd(o)),ho=(e,t)=>Ao(e,t,Xa),lt=(e,t)=>Ao(e,t,qd),El=(e,t,o)=>Ao(e,t,vr(o)),Yd=(e,t,o)=>Ao(e,t,X(o)),Z=e=>{let t=e;return{get:()=>t,set:o=>{t=o}}},Mo=e=>{if(!pr(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],o={};return q(e,(n,r)=>{const s=rt(n);if(s.length!==1)throw new Error("one and only one name per case");const a=s[0],i=n[a];if(o[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!pr(i))throw new Error("case arguments must be an array");t.push(a),o[a]=(...l)=>{const c=l.length;if(c!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+c);return{fold:(...u)=>{if(u.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+u.length);return u[r].apply(null,l)},match:u=>{const d=rt(u);if(t.length!==d.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+d.join(","));if(!Is(t,m=>ht(d,m)))throw new Error("Not all branches were specified when using match. Specified: "+d.join(", ")+`
Required: `+t.join(", "));return u[a].apply(null,l)},log:u=>{console.log(u,{constructors:t,constructor:a,params:l})}}}}),o};Mo([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const Jr=(e,t)=>((o,n)=>({[o]:n}))(e,t),zs=e=>(t=>{const o={};return q(t,n=>{o[n.key]=n.value}),o})(e),yf=e=>ko(e)?e:Ve,xf=(e,t,o)=>{let n=e.dom;const r=yf(o);for(;n.parentNode;){n=n.parentNode;const s=U(n),a=t(s);if(a.isSome())return a;if(r(s))break}return g.none()},Jd=(e,t,o)=>{const n=t(e),r=yf(o);return n.orThunk(()=>r(e)?g.none():xf(e,t,r))},wf=(e,t)=>Le(e.element,t.event.target),o_={can:pt,abort:Ve,run:H},Ls=e=>{if(!Vo(e,"can")&&!Vo(e,"abort")&&!Vo(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return k(k({},o_),e)},kt=E,$n=kt("touchstart"),Za=kt("touchmove"),Qa=kt("touchend"),Sf=kt("touchcancel"),Po=kt("mousedown"),Al=kt("mousemove"),Zd=kt("mouseout"),Qd=kt("mouseup"),xr=kt("mouseover"),wr=kt("focusin"),n_=kt("focusout"),ei=kt("keydown"),r_=kt("keyup"),Zr=kt("input"),ti=kt("change"),oi=kt("click"),s_=kt("transitioncancel"),ni=kt("transitionend"),a_=kt("transitionstart"),i_=kt("selectstart"),Je=e=>E("alloy."+e),l_={tap:Je("tap")},Sr=Je("focus"),eu=Je("blur.post"),tu=Je("paste.post"),Qr=Je("receive"),fo=Je("execute"),ri=Je("focus.item"),si=l_.tap,c_=Je("longpress"),Ml=Je("sandbox.close"),ou=Je("typeahead.cancel"),Dl=Je("system.init"),d_=Je("system.touchmove"),u_=Je("system.touchend"),nu=Je("system.scroll"),Bl=Je("system.resize"),es=Je("system.attached"),Ps=Je("system.detached"),Us=Je("system.dismissRequested"),kf=Je("system.repositionRequested"),Cf=Je("focusmanager.shifted"),ru=Je("slotcontainer.visibility"),Of=Je("change.tab"),_f=Je("dismiss.tab"),Tf=Je("highlight"),su=Je("dehighlight"),we=(e,t)=>{iu(e,e.element,t,{})},Y=(e,t,o)=>{iu(e,e.element,t,o)},ts=e=>{we(e,fo())},au=(e,t,o)=>{iu(e,t,o,{})},iu=(e,t,o,n)=>{const r=k({target:t},n);e.getSystem().triggerEvent(o,t,r)},Ef=(e,t,o,n)=>{e.getSystem().triggerEvent(o,t,n.event)},Re=e=>zs(e),Af=(e,t)=>({key:e,value:Ls({abort:t})}),Mf=e=>({key:e,value:Ls({run:(t,o)=>{o.event.prevent()}})}),B=(e,t)=>({key:e,value:Ls({run:t})}),lu=(e,t,o)=>({key:e,value:Ls({run:(n,r)=>{t.apply(void 0,[n,r].concat(o))}})}),Fl=e=>t=>({key:e,value:Ls({run:(o,n)=>{wf(o,n)&&t(o,n)}})}),Ws=(e,t,o)=>((n,r)=>B(n,(s,a)=>{s.getSystem().getByUid(r).each(i=>{Ef(i,i.element,n,a)})}))(e,t.partUids[o]),cu=(e,t)=>B(e,(o,n)=>{const r=n.event,s=o.getSystem().getByDom(r.target).getOrThunk(()=>Jd(r.target,a=>o.getSystem().getByDom(a).toOptional(),Ve).getOr(o));t(o,s,n)}),os=e=>B(e,(t,o)=>{o.cut()}),m_=e=>B(e,(t,o)=>{o.stop()}),js=(e,t)=>Fl(e)(t),Ge=Fl(es()),Cn=Fl(Ps()),g_=Fl(Dl()),qn=(Df=fo(),e=>B(Df,e)),du=e=>e.dom.innerHTML,Gs=(e,t)=>{const o=Zo(e).dom,n=U(o.createDocumentFragment()),r=((s,a)=>{const i=(a||document).createElement("div");return i.innerHTML=s,wn(U(i))})(t,o);Zh(n,r),Hd(e),zo(e,n)},p_=e=>Bd(e)?"#shadow-root":(t=>{const o=Rs("div"),n=U(t.dom.cloneNode(!0));return zo(o,n),du(o)})((t=>((o,n)=>U(o.dom.cloneNode(!1)))(t))(e)),kr=e=>p_(e),h_=Re([((e,t)=>({key:e,value:Ls({can:(o,n)=>{const r=n.event,s=r.originator,a=r.target;return!((i,l,c)=>Le(l,i.element)&&!Le(l,c))(o,s,a)||(console.warn(Sr()+` did not get interpreted by the desired target. 
Originator: `+kr(s)+`
Target: `+kr(a)+`
Check the `+Sr()+" event handlers"),!1)}})}))(Sr())]);var Df,f_=Object.freeze({__proto__:null,events:h_});let Bf=0;const j=e=>{const t=new Date().getTime(),o=Math.floor(1e9*Math.random());return Bf++,e+"_"+o+Bf+String(t)},b_=E("alloy-id-"),v_=E("data-alloy-id"),y_=b_(),Ff=v_(),uu=(e,t)=>{Object.defineProperty(e.dom,Ff,{value:t,writable:!0})},ai=e=>{const t=Oo(e)?e.dom[Ff]:null;return g.from(t)},$s=e=>j(e),x_=xe,Il=e=>{const t=r=>`The component must be in a context to execute: ${r}`+(e?`
`+kr(e().element)+" is not in context.":""),o=r=>()=>{throw new Error(t(r))},n=r=>()=>{console.warn(t(r))};return{debugInfo:E("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),build:o("build"),buildOrPatch:o("buildOrPatch"),addToWorld:o("addToWorld"),removeFromWorld:o("removeFromWorld"),addToGui:o("addToGui"),removeFromGui:o("removeFromGui"),getByUid:o("getByUid"),getByDom:o("getByDom"),isConnected:Ve}},w_=Il(),mu=e=>N(e,t=>gl(t,"/*")?t.substring(0,t.length-"/*".length):t),gu=(e,t)=>{const o=e.toString(),n=o.indexOf(")")+1,r=o.indexOf("("),s=o.substring(r+1,n-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:mu(s)}),e},Rl=j("alloy-premade"),If=e=>(Object.defineProperty(e.element.dom,Rl,{value:e.uid,writable:!0}),Jr(Rl,e)),Rf=e=>K(e,Rl),Nl=e=>((t,o)=>{const n=o.toString(),r=n.indexOf(")")+1,s=n.indexOf("("),a=n.substring(s+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:mu(a.slice(1))}),t})((t,...o)=>e(t.getApis(),t,...o),e),tn={init:()=>bo({readState:E("No State required")})},bo=e=>e,Nf=(e,t)=>{const o={};return It(e,(n,r)=>{It(n,(s,a)=>{const i=K(o,a).getOr([]);o[a]=i.concat([t(r,s)])})}),o},on=e=>({classes:Vn(e.classes)?[]:e.classes,attributes:Vn(e.attributes)?{}:e.attributes,styles:Vn(e.styles)?{}:e.styles}),pu=e=>e.cHandler,S_=(e,t)=>({name:e,handler:t}),k_=(e,t)=>{const o={};return q(e,n=>{o[n.name()]=n.handlers(t)}),o},C_=(e,t,o)=>{const n=t[o];return n?((r,s,a,i)=>{try{const l=ch(a,(c,u)=>{const d=c.name,m=u.name,p=i.indexOf(d),h=i.indexOf(m);if(p===-1)throw new Error("The ordering for "+r+" does not have an entry for "+d+`.
Order specified: `+JSON.stringify(i,null,2));if(h===-1)throw new Error("The ordering for "+r+" does not have an entry for "+m+`.
Order specified: `+JSON.stringify(i,null,2));return p<h?-1:h<p?1:0});return ue.value(l)}catch(l){return ue.error([l])}})("Event: "+o,0,e,n).map(r=>(s=>{const a=((l,c)=>(...u)=>Ft(l,(d,m)=>d&&(p=>p.can)(m).apply(void 0,u),!0))(s),i=((l,c)=>(...u)=>Ft(l,(d,m)=>d||(p=>p.abort)(m).apply(void 0,u),!1))(s);return{can:a,abort:i,run:(...l)=>{q(s,c=>{c.run.apply(void 0,l)})}}})(N(r,s=>s.handler))):((r,s)=>ue.error(["The event ("+r+`) has more than one behaviour that listens to it.
When this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).
The behaviours that can trigger it are: `+JSON.stringify(N(s,a=>a.name),null,2)]))(o,e)},O_=(e,t)=>((o,n)=>{const r=(a=>{const i=[],l=[];return q(a,c=>{c.fold(u=>{i.push(u)},u=>{l.push(u)})}),{errors:i,values:l}})(o);return r.errors.length>0?(s=r.errors,ue.error(xt(s))):((a,i)=>a.length===0?ue.value(i):ue.value(je(i,YO.apply(void 0,a))))(r.values,n);var s})(ul(e,(o,n)=>(o.length===1?ue.value(o[0].handler):C_(o,t,n)).map(r=>{const s=(i=>{const l=(c=>ko(c)?{can:pt,abort:Ve,run:c}:c)(i);return(c,u,...d)=>{const m=[c,u].concat(d);l.abort.apply(void 0,m)?u.stop():l.can.apply(void 0,m)&&l.run.apply(void 0,m)}})(r),a=o.length>1?He(t[n],i=>Yo(o,l=>l.name===i)).join(" > "):o[0].name;return Jr(n,((i,l)=>({handler:i,purpose:l}))(s,a))})),{}),ns="alloy.base.behaviour",__=X([St("dom","dom",{tag:"required",process:{}},X([M("tag"),T("styles",{}),T("classes",[]),T("attributes",{}),Se("value"),Se("innerHtml")])),M("components"),M("uid"),T("events",{}),T("apis",{}),St("eventOrder","eventOrder",(Wf={[fo()]:["disabling",ns,"toggling","typeaheadevents"],[Sr()]:[ns,"focusing","keying"],[Dl()]:[ns,"disabling","toggling","representing"],[Zr()]:[ns,"representing","streaming","invalidating"],[Ps()]:[ns,"representing","item-events","tooltipping"],[Po()]:["focusing",ns,"item-type-events"],[$n()]:["focusing",ns,"item-type-events"],[xr()]:["item-type-events","tooltipping"],[Qr()]:["receiving","reflecting","tooltipping"]},Wd(E(Wf))),Qo()),Se("domModification")]),T_=e=>e.events,hu=(e,t)=>{const o=Tt(e,t);return o===void 0||o===""?[]:o.split(" ")},ii=e=>e.dom.classList!==void 0,Vf=e=>hu(e,"class"),ct=(e,t)=>{ii(e)?e.dom.classList.add(t):((o,n)=>{((r,s,a)=>{const i=hu(r,s).concat([a]);ie(r,s,i.join(" "))})(o,"class",n)})(e,t)},Ze=(e,t)=>{ii(e)?e.dom.classList.remove(t):((o,n)=>{((r,s,a)=>{const i=He(hu(r,s),l=>l!==a);i.length>0?ie(r,s,i.join(" ")):at(r,s)})(o,"class",n)})(e,t),(o=>{(ii(o)?o.dom.classList:Vf(o)).length===0&&at(o,"class")})(e)},vo=(e,t)=>ii(e)&&e.dom.classList.contains(t),rs=(e,t)=>{q(t,o=>{ct(e,o)})},nn=(e,t)=>{q(t,o=>{Ze(e,o)})},Xn=e=>e.dom.value,qs=(e,t)=>{if(t===void 0)throw new Error("Value.set was undefined");e.dom.value=t},Hf=(e,t,o)=>{o.fold(()=>zo(e,t),n=>{Le(n,t)||($a(n,t),Un(n))})},zf=(e,t,o)=>{const n=N(t,o),r=wn(e);return q(r.slice(n.length),Un),n},Lf=(e,t,o,n)=>{const r=Gr(e,t),s=n(o,r),a=((i,l,c)=>Gr(i,l).map(u=>{if(c.exists(d=>!Le(d,u))){const d=c.map(zn).getOr("span"),m=Rs(d);return $a(u,m),m}return u}))(e,t,r);return Hf(e,s.element,a),s},Pf=(e,t)=>{const o=rt(e),n=rt(t);return{toRemove:Ur(n,o),toSet:((r,s)=>{const a={},i={};return uh(r,(l,c)=>!Te(t,c)||l!==t[c],_d(a),_d(i)),{t:a,f:i}})(e).t}},E_=(e,t)=>{const p=(h=>Ft(h.dom.attributes,(f,v)=>(f[v.name]=v.value,f),{}))(t),{class:o,style:n}=p,r=Ia(p,["class","style"]),{toSet:s,toRemove:a}=Pf(e.attributes,r),i=Eh(t),{toSet:l,toRemove:c}=Pf(e.styles,i),u=(h=>ii(h)?(f=>{const v=f.dom.classList,y=new Array(v.length);for(let x=0;x<v.length;x++){const b=v.item(x);b!==null&&(y[x]=b)}return y})(h):Vf(h))(t),d=Ur(u,e.classes),m=Ur(e.classes,u);return q(a,h=>at(t,h)),Ch(t,s),rs(t,m),nn(t,d),q(c,h=>Me(t,h)),Ns(t,l),e.innerHtml.fold(()=>{const h=e.domChildren;((f,v)=>{zf(f,v,(y,x)=>{const b=Gr(f,x);return Hf(f,y,b),y})})(t,h)},h=>{Gs(t,h)}),(()=>{const h=t,f=e.value.getOrUndefined();f!==Xn(h)&&qs(h,f!=null?f:"")})(),t},A_=e=>{const t=(o=>{const n=K(o,"behaviours").getOr({});return nt(rt(n),r=>{const s=n[r];return No(s)?[s.me]:[]})})(e);return((o,n)=>((r,s)=>{const a=N(s,l=>po(l.name(),[M("config"),T("state",tn)])),i=Ue("component.behaviours",X(a),r.behaviours).fold(l=>{throw new Error(Hs(l)+`
Complete spec:
`+JSON.stringify(r,null,2))},xe);return{list:s,data:ft(i,l=>{const c=l.map(u=>({config:u.config,state:u.state.init(u.config)}));return E(c)})}})(o,n))(e,t)},M_=(e,t)=>{const o=()=>m,n=Z(w_),r=en((p=>Ue("custom.definition",__,p))(e)),s=A_(e),a=(p=>p.list)(s),i=(p=>p.data)(s),l=((p,h,f)=>{const v=k(k({},(y=p).dom),{uid:y.uid,domChildren:N(y.components,O=>O.element)});var y;const x=(O=>O.domModification.fold(()=>on({}),on))(p),b={"alloy.base.modification":x},w=h.length>0?((O,A,F,D)=>{const R=k({},A);q(F,ne=>{R[ne.name()]=ne.exhibit(O,D)});const L=Nf(R,(ne,ce)=>({name:ne,modification:ce})),P=ne=>Bs(ne,(ce,ee)=>k(k({},ee.modification),ce),{}),z=Bs(L.classes,(ne,ce)=>ce.modification.concat(ne),[]),oe=P(L.attributes),W=P(L.styles);return on({classes:z,attributes:oe,styles:W})})(f,b,h,v):x;return S=v,C=w,k(k({},S),{attributes:k(k({},S.attributes),C.attributes),styles:k(k({},S.styles),C.styles),classes:S.classes.concat(C.classes)});var S,C})(r,a,i),c=((p,h)=>{const f=h.filter(v=>zn(v)===p.tag&&!(y=>y.innerHtml.isSome()&&y.domChildren.length>0)(p)&&!(y=>Te(y.dom,Rl))(v)).bind(v=>((y,x)=>{try{const b=E_(y,x);return g.some(b)}catch(b){return g.none()}})(p,v)).getOrThunk(()=>(v=>{const y=Rs(v.tag);Ch(y,v.attributes),rs(y,v.classes),Ns(y,v.styles),v.innerHtml.each(b=>Gs(y,b));const x=v.domChildren;return Zh(y,x),v.value.each(b=>{qs(y,b)}),y})(p));return uu(f,p.uid),f})(l,t),u=((p,h,f)=>{const v={"alloy.base.behaviour":T_(p)};return((y,x,b,w)=>{const S=((C,O,A)=>{const F=k(k({},A),k_(O,C));return Nf(F,S_)})(y,b,w);return O_(S,x)})(f,p.eventOrder,h,v).getOrDie()})(r,a,i),d=Z(r.components),m={uid:e.uid,getSystem:n.get,config:p=>{const h=i;return(ko(h[p.name()])?h[p.name()]:()=>{throw new Error("Could not find "+p.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:p=>ko(i[p.name()]),spec:e,readState:p=>i[p]().map(h=>h.state.readState()).getOr("not enabled"),getApis:()=>r.apis,connect:p=>{n.set(p)},disconnect:()=>{n.set(Il(o))},element:c,syncComponents:()=>{const p=wn(c),h=nt(p,f=>n.get().getByDom(f).fold(()=>[],CO));d.set(h)},components:d.get,events:u};return m},dt=e=>{const t=ph(e);return Uf({element:t})},Uf=e=>{const t=Kt("external.component",uo([M("element"),Se("uid")]),e),o=Z(Il()),n=t.uid.getOrThunk(()=>$s("external"));uu(t.element,n);const r={uid:n,getSystem:o.get,config:g.none,hasConfigured:Ve,connect:s=>{o.set(s)},disconnect:()=>{o.set(Il(()=>r))},getApis:()=>({}),element:t.element,spec:e,readState:E("No state"),syncComponents:H,components:E([]),events:{}};return If(r)},D_=$s,fu=(e,t)=>Rf(e).getOrThunk(()=>((o,n)=>{const l=x_(o),{events:r}=l,s=Ia(l,["events"]),a=((c,u)=>{const d=K(c,"components").getOr([]);return u.fold(()=>N(d,Lt),m=>N(d,(p,h)=>fu(p,Gr(m,h))))})(s,n),i=k(k({},s),{events:k(k({},f_),r),components:a});return ue.value(M_(i,n))})((o=>Te(o,"uid"))(e)?e:k({uid:D_("")},e),t).getOrDie()),Lt=e=>fu(e,g.none()),Uo=If;var Wf,jf=(e,t,o,n,r)=>e(o,n)?g.some(o):ko(r)&&r(o)?g.none():t(o,n,r);const Gf=(e,t,o)=>{let n=e.dom;const r=ko(o)?o:Ve;for(;n.parentNode;){n=n.parentNode;const s=U(n);if(t(s))return g.some(s);if(r(s))break}return g.none()},$f=(e,t,o)=>jf((n,r)=>r(n),Gf,e,t,o),qf=(e,t,o)=>$f(e,t,o).isSome(),Vl=(e,t,o)=>Gf(e,n=>Md(n,t),o),B_=(e,t)=>((o,n)=>Ke(o.dom.childNodes,r=>{return s=U(r),Md(s,t);var s}).map(U))(e),ut=(e,t)=>((o,n)=>{const r=n===void 0?document:n.dom;return bh(r)?g.none():g.from(r.querySelector(o)).map(U)})(t,e),rn=(e,t,o)=>jf((n,r)=>Md(n,r),Vl,e,t,o),li="aria-controls",Xf=()=>{const e=j(li);return{id:e,link:t=>{ie(t,li,e)},unlink:t=>{at(t,li)}}},ss=(e,t)=>qf(t,o=>Le(o,e.element),Ve)||((o,n)=>(r=>$f(r,s=>{if(!Oo(s))return!1;const a=Tt(s,"id");return a!==void 0&&a.indexOf(li)>-1}).bind(s=>{const a=Tt(s,"id"),i=_o(s);return ut(i,`[${li}="${a}"]`)}))(n).exists(r=>ss(o,r)))(e,t);var Xs;(function(e){e[e.STOP=0]="STOP",e[e.NORMAL=1]="NORMAL",e[e.LOGGING=2]="LOGGING"})(Xs||(Xs={}));const bu=Z({}),F_=["alloy/data/Fields","alloy/debugging/Debugging"],vu=(e,t,o)=>((n,r,s)=>{switch(K(bu.get(),n).orThunk(()=>{const a=rt(bu.get());return yn(a,i=>n.indexOf(i)>-1?g.some(bu.get()[i]):g.none())}).getOr(Xs.NORMAL)){case Xs.NORMAL:return s(I_());case Xs.LOGGING:{const a=((l,c)=>{const u=[],d=new Date().getTime();return{logEventCut:(m,p,h)=>{u.push({outcome:"cut",target:p,purpose:h})},logEventStopped:(m,p,h)=>{u.push({outcome:"stopped",target:p,purpose:h})},logNoParent:(m,p,h)=>{u.push({outcome:"no-parent",target:p,purpose:h})},logEventNoHandlers:(m,p)=>{u.push({outcome:"no-handlers-left",target:p})},logEventResponse:(m,p,h)=>{u.push({outcome:"response",purpose:h,target:p})},write:()=>{const m=new Date().getTime();ht(["mousemove","mouseover","mouseout",Dl()],l)||console.log(l,{event:l,time:m-d,target:c.dom,sequence:N(u,p=>ht(["cut","stopped","response"],p.outcome)?"{"+p.purpose+"} "+p.outcome+" at ("+kr(p.target)+")":p.outcome)})}}})(n,r),i=s(a);return a.write(),i}case Xs.STOP:return!0}})(e,t,o),I_=E({logEventCut:H,logEventStopped:H,logNoParent:H,logEventNoHandlers:H,logEventResponse:H,write:H}),Kf=E([M("menu"),M("selectedMenu")]),yu=E([M("item"),M("selectedItem")]);E(X(yu().concat(Kf())));const R_=E(X(yu())),N_=yr("initSize",[M("numColumns"),M("numRows")]),Hl=()=>yr("markers",[M("backgroundMenu")].concat(Kf()).concat(yu())),as=e=>yr("markers",N(e,M)),zl=(e,t,o)=>((()=>{const n=new Error;if(n.stack!==void 0){const r=n.stack.split(`
`);Ke(r,s=>s.indexOf("alloy")>0&&!Yo(F_,a=>s.indexOf(a)>-1)).getOr("unknown")}})(),St(t,t,o,Ka(n=>ue.value((...r)=>n.apply(void 0,r))))),me=e=>zl(0,e,kl(H)),to=e=>zl(0,e,kl(g.none)),is=e=>zl(0,e,{tag:"required",process:{}}),xu=e=>zl(0,e,{tag:"required",process:{}}),Ne=(e,t)=>zt(e,E(t)),Yf=e=>zt(e,xe),Jf=E(N_),Ct=(e,t,o,n,r,s,a,i=!1)=>({x:e,y:t,bubble:o,direction:n,placement:r,restriction:s,label:`${a}-${r}`,alwaysFit:i}),Cr=Mo([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Ll=Cr.southeast,wu=Cr.southwest,Su=Cr.northeast,ku=Cr.northwest,Zf=Cr.south,Qf=Cr.north,eb=Cr.east,tb=Cr.west,Ks=(e,t,o,n)=>{const r=e+t;return r>n?o:r<o?n:r},Do=(e,t,o)=>Math.min(Math.max(e,t),o),Ot=(e,t)=>lh(["left","right","top","bottom"],o=>K(t,o).map(n=>((r,s)=>{switch(s){case 1:return r.x;case 0:return r.x+r.width;case 2:return r.y;case 3:return r.y+r.height}})(e,n))),Or="layout",ob=e=>e.x,nb=(e,t)=>e.x+e.width/2-t.width/2,rb=(e,t)=>e.x+e.width-t.width,Cu=(e,t)=>e.y-t.height,Ou=e=>e.y+e.height,sb=(e,t)=>e.y+e.height/2-t.height/2,At=(e,t,o)=>Ct(ob(e),Ou(e),o.southeast(),Ll(),"southeast",Ot(e,{left:1,top:3}),Or),Mt=(e,t,o)=>Ct(rb(e,t),Ou(e),o.southwest(),wu(),"southwest",Ot(e,{right:0,top:3}),Or),Yt=(e,t,o)=>Ct(ob(e),Cu(e,t),o.northeast(),Su(),"northeast",Ot(e,{left:1,bottom:2}),Or),Jt=(e,t,o)=>Ct(rb(e,t),Cu(e,t),o.northwest(),ku(),"northwest",Ot(e,{right:0,bottom:2}),Or),yo=(e,t,o)=>Ct(nb(e,t),Cu(e,t),o.north(),Qf(),"north",Ot(e,{bottom:2}),Or),_t=(e,t,o)=>Ct(nb(e,t),Ou(e),o.south(),Zf(),"south",Ot(e,{top:3}),Or),_u=(e,t,o)=>Ct((n=>n.x+n.width)(e),sb(e,t),o.east(),eb(),"east",Ot(e,{left:0}),Or),Tu=(e,t,o)=>Ct(((n,r)=>n.x-r.width)(e,t),sb(e,t),o.west(),tb(),"west",Ot(e,{right:1}),Or),ab=()=>[At,Mt,Yt,Jt,_t,yo,_u,Tu],ib=()=>[Mt,At,Jt,Yt,_t,yo,_u,Tu],lb=()=>[Yt,Jt,At,Mt,yo,_t],cb=()=>[Jt,Yt,Mt,At,yo,_t],Eu=()=>[At,Mt,Yt,Jt,_t,yo],Au=()=>[Mt,At,Jt,Yt,_t,yo];var V_=Object.freeze({__proto__:null,events:e=>Re([B(Qr(),(t,o)=>{const n=e.channels,r=rt(n),s=o,a=((i,l)=>l.universal?i:He(i,c=>ht(l.channels,c)))(r,s);q(a,i=>{const l=n[i],c=l.schema,u=Kt("channel["+i+`] data
Receiver: `+kr(t.element),c,s.data);l.onReceive(t,u)})})])}),H_=[go("channels",hf(ue.value,uo([is("onReceive"),T("schema",Qo())])))];const Mu=(e,t,o)=>g_((n,r)=>{o(n,e,t)}),z_=e=>({key:e,value:void 0}),db=(e,t,o,n,r,s,a)=>{const i=u=>Vo(u,o)?u[o]():g.none(),l=ft(r,(u,d)=>((m,p,h)=>((f,v,y)=>{const x=y.toString(),b=x.indexOf(")")+1,w=x.indexOf("("),S=x.substring(w+1,b-1).split(/,\s*/);return f.toFunctionAnnotation=()=>({name:v,parameters:mu(S.slice(0,1).concat(S.slice(3)))}),f})((f,...v)=>{const y=[f].concat(v);return f.config({name:E(m)}).fold(()=>{throw new Error("We could not find any behaviour configuration for: "+m+". Using API: "+h)},x=>{const b=Array.prototype.slice.call(y,1);return p.apply(void 0,[f,x.config,x.state].concat(b))})},h,p))(o,u,d)),c=k(k(k({},ft(s,(u,d)=>gu(u,d))),l),{revoke:Co(z_,o),config:u=>{const d=Kt(o+"-config",e,u);return{key:o,value:{config:d,me:c,configAsRaw:br(()=>Kt(o+"-config",e,u)),initialConfig:u,state:a}}},schema:E(t),exhibit:(u,d)=>ml(i(u),K(n,"exhibit"),(m,p)=>p(d,m.config,m.state)).getOrThunk(()=>on({})),name:E(o),handlers:u=>i(u).map(d=>K(n,"events").getOr(()=>({}))(d.config,d.state)).getOr({})});return c},I=e=>zs(e),L_=uo([M("fields"),M("name"),T("active",{}),T("apis",{}),T("state",tn),T("extra",{})]),bt=e=>{const t=Kt("Creating behaviour: "+e.name,L_,e);return((o,n,r,s,a,i)=>{const l=uo(o),c=po(n,[(u=o,Wn("config",uo(u)))]);var u;return db(l,c,n,r,s,a,i)})(t.fields,t.name,t.active,t.apis,t.extra,t.state)},P_=uo([M("branchKey"),M("branches"),M("name"),T("active",{}),T("apis",{}),T("state",tn),T("extra",{})]),ub=e=>{const t=Kt("Creating behaviour: "+e.name,P_,e);return((o,n,r,s,a,i)=>{const l=o,c=po(n,[Wn("config",o)]);return db(l,c,n,r,s,a,i)})(mo(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},U_=E(void 0),Wo=bt({fields:H_,name:"receiving",active:V_});var W_=Object.freeze({__proto__:null,exhibit:(e,t)=>on({classes:[],styles:t.useFixed()?{}:{position:"relative"}})});const Kn=e=>e.dom.focus(),mb=e=>{const t=_o(e).dom;return e.dom===t.activeElement},Yn=(e=zd())=>g.from(e.dom.activeElement).map(U),sn=e=>Yn(_o(e)).filter(t=>e.dom.contains(t.dom)),Du=(e,t)=>{const o=_o(t),n=Yn(o).bind(s=>{const a=i=>Le(s,i);return a(t)?g.some(t):((i,l)=>{const c=u=>{for(let d=0;d<u.childNodes.length;d++){const m=U(u.childNodes[d]);if(l(m))return g.some(m);const p=c(u.childNodes[d]);if(p.isSome())return p}return g.none()};return c(i.dom)})(t,a)}),r=e(t);return n.each(s=>{Yn(o).filter(a=>Le(a,s)).fold(()=>{Kn(s)},H)}),r},an=(e,t,o,n,r)=>{const s=a=>a+"px";return{position:e,left:t.map(s),top:o.map(s),right:n.map(s),bottom:r.map(s)}},gb=(e,t)=>{yl(e,(o=>k(k({},o),{position:g.some(o.position)}))(t))},Bu=Mo([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),pb=(e,t,o,n,r,s)=>{const a=t.rect,i=a.x-o,l=a.y-n,c=r-(i+a.width),u=s-(l+a.height),d=g.some(i),m=g.some(l),p=g.some(c),h=g.some(u),f=g.none();return t.direction.fold(()=>an(e,d,m,f,f),()=>an(e,f,m,p,f),()=>an(e,d,f,f,h),()=>an(e,f,f,p,h),()=>an(e,d,m,f,f),()=>an(e,d,f,f,h),()=>an(e,d,m,f,f),()=>an(e,f,m,p,f))},hb=(e,t)=>e.fold(()=>{const o=t.rect;return an("absolute",g.some(o.x),g.some(o.y),g.none(),g.none())},(o,n,r,s)=>pb("absolute",t,o,n,r,s),(o,n,r,s)=>pb("fixed",t,o,n,r,s)),Fu=(e,t)=>{const o=Co(Ld,t),n=e.fold(o,o,()=>{const a=Sn();return Ld(t).translate(-a.left,-a.top)}),r=ja(t),s=$r(t);return Nt(n.left,n.top,r,s)},j_=(e,t)=>t.fold(()=>e.fold(kn,kn,Nt),o=>e.fold(o,o,()=>{const n=o(),r=fb(e,n.x,n.y);return Nt(r.left,r.top,n.width,n.height)})),fb=(e,t,o)=>{const n=We(t,o);return e.fold(E(n),E(n),()=>{const r=Sn();return n.translate(-r.left,-r.top)})};Bu.none;const G_=Bu.relative,$_=Bu.fixed,Iu="data-alloy-placement",bb=e=>lo(e,Iu),Pl=Mo([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),q_=(e,t,o,n)=>{const r=e.bubble,s=r.offset,a=((w,S,C)=>{const O=(L,P)=>S[L].map(z=>{const oe=L==="top"||L==="bottom",W=oe?C.top:C.left,ne=(L==="left"||L==="top"?Math.max:Math.min)(z,P)+W;return oe?Do(ne,w.y,w.bottom):Do(ne,w.x,w.right)}).getOr(P),A=O("left",w.x),F=O("top",w.y),D=O("right",w.right),R=O("bottom",w.bottom);return Nt(A,F,D-A,R-F)})(n,e.restriction,s),i=e.x+s.left,l=e.y+s.top,c=Nt(i,l,t,o),{originInBounds:u,sizeInBounds:d,visibleW:m,visibleH:p}=((w,S)=>{const{x:C,y:O,right:A,bottom:F}=S,{x:D,y:R,right:L,bottom:P,width:z,height:oe}=w;return{originInBounds:D>=C&&D<=A&&R>=O&&R<=F,sizeInBounds:L<=A&&L>=C&&P<=F&&P>=O,visibleW:Math.min(z,D>=C?A-D:L-C),visibleH:Math.min(oe,R>=O?F-R:P-O)}})(c,a),h=u&&d,f=h?c:((w,S)=>{const{x:C,y:O,right:A,bottom:F}=S,{x:D,y:R,width:L,height:P}=w,z=Math.max(C,A-L),oe=Math.max(O,F-P),W=Do(D,C,z),ne=Do(R,O,oe),ce=Math.min(W+L,A)-W,ee=Math.min(ne+P,F)-ne;return Nt(W,ne,ce,ee)})(c,a),v=f.width>0&&f.height>0,{maxWidth:y,maxHeight:x}=((w,S,C)=>{const O=E(S.bottom-C.y),A=E(C.bottom-S.y),F=((P,z,oe,W)=>P.fold(z,z,W,W,z,W,oe,oe))(w,A,A,O),D=E(S.right-C.x),R=E(C.right-S.x);return{maxWidth:((P,z,oe,W)=>P.fold(z,W,z,W,oe,oe,z,W))(w,R,R,D),maxHeight:F}})(e.direction,f,n),b={rect:f,maxHeight:x,maxWidth:y,direction:e.direction,placement:e.placement,classes:{on:r.classesOn,off:r.classesOff},layout:e.label,testY:l};return h||e.alwaysFit?Pl.fit(b):Pl.nofit(b,m,p,v)},Ru=e=>{const t=Z(g.none()),o=()=>t.get().each(e);return{clear:()=>{o(),t.set(g.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:n=>{o(),t.set(g.some(n))}}},Ys=()=>Ru(e=>e.unbind()),ze=()=>{const e=Ru(H);return k(k({},e),{on:t=>e.get().each(t)})},vb=pt,Pt=(e,t,o)=>((n,r,s,a)=>Jh(n,r,s,a,!1))(e,t,vb,o),yb=(e,t,o)=>((n,r,s,a)=>Jh(n,r,s,a,!0))(e,t,vb,o),xb=Yh,wb=["top","bottom","right","left"],Ul="data-alloy-transition-timer",X_=(e,t,o,n,r,s)=>{const a=((i,l,c)=>c.exists(u=>{const d=i.mode;return d==="all"||u[d]!==l[d]}))(n,r,s);if(a||((i,l)=>((c,u)=>Is(u,d=>vo(c,d)))(i,l.classes))(e,n)){se(e,"position",o.position);const i=Fu(t,e),l=hb(t,k(k({},r),{rect:i})),c=lh(wb,u=>l[u]);((u,d)=>{const m=p=>parseFloat(p).toFixed(3);return Td(d,(p,h)=>!((f,v,y=oh)=>ml(f,v,y).getOr(f.isNone()&&v.isNone()))(u[h].map(m),p.map(m))).isSome()})(o,c)&&(yl(e,c),a&&((u,d)=>{rs(u,d.classes),lo(u,Ul).each(m=>{clearTimeout(parseInt(m,10)),at(u,Ul)}),((m,p)=>{const h=Ys(),f=Ys();let v;const y=S=>{var C;const O=(C=S.raw.pseudoElement)!==null&&C!==void 0?C:"";return Le(S.target,m)&&!Ad(O)&&ht(wb,S.raw.propertyName)},x=S=>{if(ll(S)||y(S)){h.clear(),f.clear();const C=S==null?void 0:S.raw.type;(ll(C)||C===ni())&&(clearTimeout(v),at(m,Ul),nn(m,p.classes))}},b=Pt(m,a_(),S=>{y(S)&&(b.unbind(),h.set(Pt(m,ni(),x)),f.set(Pt(m,s_(),x)))}),w=(S=>{const C=D=>{const R=co(S,D).split(/\s*,\s*/);return He(R,Ad)},O=D=>{if(_e(D)&&/^[\d.]+/.test(D)){const R=parseFloat(D);return gl(D,"ms")?R:1e3*R}return 0},A=C("transition-delay"),F=C("transition-duration");return Ft(F,(D,R,L)=>{const P=O(A[L])+O(R);return Math.max(D,P)},0)})(m);requestAnimationFrame(()=>{v=setTimeout(x,w+17),ie(m,Ul,v)})})(u,d)})(e,n),Wa(e))}else nn(e,n.classes)},Sb=(e,t)=>{((o,n)=>{const r=Id.max(o,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);se(o,"max-height",r+"px")})(e,Math.floor(t))},K_=E((e,t)=>{Sb(e,t),Ns(e,{"overflow-x":"hidden","overflow-y":"auto"})}),ci=E((e,t)=>{Sb(e,t)}),kb=(e,t,o)=>e[t]===void 0?o:e[t],Y_=(e,t,o,n)=>{const r=((s,a,i,l)=>{Me(a,"max-height"),Me(a,"max-width");const c={width:ja(u=a),height:$r(u)};var u;return((d,m,p,h,f,v)=>{const y=h.width,x=h.height,b=(w,S,C,O,A)=>{const F=w(p,h,f,d,v),D=q_(F,y,x,v);return D.fold(E(D),(R,L,P,z)=>(A===z?P>O||L>C:!A&&z)?D:Pl.nofit(S,C,O,A))};return Ft(m,(w,S)=>{const C=Co(b,S);return w.fold(E(w),C)},Pl.nofit({rect:p,maxHeight:h.height,maxWidth:h.width,direction:Ll(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:p.y},-1,-1,!1)).fold(xe,xe)})(a,l.preference,s,c,i,l.bounds)})(e,t,o,n);return((s,a,i)=>{const l=hb(i.origin,a);i.transition.each(c=>{X_(s,i.origin,l,c,a,i.lastPlacement)}),gb(s,l)})(t,r,n),((s,a)=>{((i,l)=>{ie(i,Iu,l)})(s,a.placement)})(t,r),((s,a)=>{const i=a.classes;nn(s,i.off),rs(s,i.on)})(t,r),((s,a,i)=>{(0,i.maxHeightFunction)(s,a.maxHeight)})(t,r,n),((s,a,i)=>{(0,i.maxWidthFunction)(s,a.maxWidth)})(t,r,n),{layout:r.layout,placement:r.placement}},J_=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],Js=(e,t,o,n=1)=>{const r=e*n,s=t*n,a=l=>K(o,l).getOr([]),i=(l,c,u)=>{const d=Ur(J_,u);return{offset:We(l,c),classesOn:nt(u,a),classesOff:nt(d,a)}};return{southeast:()=>i(-e,t,["top","alignLeft"]),southwest:()=>i(e,t,["top","alignRight"]),south:()=>i(-e/2,t,["top","alignCentre"]),northeast:()=>i(-e,-t,["bottom","alignLeft"]),northwest:()=>i(e,-t,["bottom","alignRight"]),north:()=>i(-e/2,-t,["bottom","alignCentre"]),east:()=>i(e,-t/2,["valignCentre","left"]),west:()=>i(-e,-t/2,["valignCentre","right"]),insetNortheast:()=>i(r,s,["top","alignLeft","inset"]),insetNorthwest:()=>i(-r,s,["top","alignRight","inset"]),insetNorth:()=>i(-r/2,s,["top","alignCentre","inset"]),insetSoutheast:()=>i(r,-s,["bottom","alignLeft","inset"]),insetSouthwest:()=>i(-r,-s,["bottom","alignRight","inset"]),insetSouth:()=>i(-r/2,-s,["bottom","alignCentre","inset"]),insetEast:()=>i(-r,-s/2,["valignCentre","right","inset"]),insetWest:()=>i(r,-s/2,["valignCentre","left","inset"])}},Wl=()=>Js(0,0,{}),jl=xe,Nu=(e,t)=>o=>Z_(o)==="rtl"?t:e,Z_=e=>co(e,"direction")==="rtl"?"rtl":"ltr";var Jn;(function(e){e.TopToBottom="toptobottom",e.BottomToTop="bottomtotop"})(Jn||(Jn={}));const Vu="data-alloy-vertical-dir",Q_=e=>qf(e,t=>Oo(t)&&Tt(t,"data-alloy-vertical-dir")===Jn.BottomToTop),_r=()=>po("layouts",[M("onLtr"),M("onRtl"),Se("onBottomLtr"),Se("onBottomRtl")]),Gl=(e,t,o,n,r,s,a)=>{const i=a.map(Q_).getOr(!1),l=t.layouts.map(m=>m.onLtr(e)),c=t.layouts.map(m=>m.onRtl(e)),u=i?t.layouts.bind(m=>m.onBottomLtr.map(p=>p(e))).or(l).getOr(r):l.getOr(o),d=i?t.layouts.bind(m=>m.onBottomRtl.map(p=>p(e))).or(c).getOr(s):c.getOr(n);return Nu(u,d)(e)};var eT=[M("hotspot"),Se("bubble"),T("overrides",{}),_r(),Ne("placement",(e,t,o)=>{const n=t.hotspot,r=Fu(o,n.element),s=Gl(e.element,t,Eu(),Au(),lb(),cb(),g.some(t.hotspot.element));return g.some(jl({anchorBox:r,bubble:t.bubble.getOr(Wl()),overrides:t.overrides,layouts:s,placer:g.none()}))})],tT=[M("x"),M("y"),T("height",0),T("width",0),T("bubble",Wl()),T("overrides",{}),_r(),Ne("placement",(e,t,o)=>{const n=fb(o,t.x,t.y),r=Nt(n.left,n.top,t.width,t.height),s=Gl(e.element,t,ab(),ib(),ab(),ib(),g.none());return g.some(jl({anchorBox:r,bubble:t.bubble,overrides:t.overrides,layouts:s,placer:g.none()}))})];const Cb=Mo([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),oT=e=>e.fold(xe,(t,o,n)=>t.translate(-o,-n)),nT=e=>e.fold(xe,xe),Ob=e=>Ft(e,(t,o)=>t.translate(o.left,o.top),We(0,0)),_b=e=>{const t=N(e,nT);return Ob(t)},rT=Cb.screen,sT=Cb.absolute,Tb=(e,t,o)=>{const n=Zo(e.element),r=Sn(n),s=((a,i,l)=>{const c=Pa(l.root).dom;return g.from(c.frameElement).map(U).filter(u=>{const d=Zo(u),m=Zo(a.element);return Le(d,m)}).map(fr)})(e,0,o).getOr(r);return sT(s,r.left,r.top)},Eb=(e,t,o,n)=>{const r=rT(We(e,t));return g.some(((s,a,i)=>({point:s,width:a,height:i}))(r,o,n))},Ab=(e,t,o,n,r)=>e.map(s=>{const a=[t,s.point],i=(l=()=>_b(a),c=()=>_b(a),u=()=>(b=>{const w=N(b,oT);return Ob(w)})(a),n.fold(l,c,u));var l,c,u;const d=(f=i.left,v=i.top,y=s.width,x=s.height,{x:f,y:v,width:y,height:x}),m=o.showAbove?lb():Eu(),p=o.showAbove?cb():Au(),h=Gl(r,o,m,p,m,p,g.none());var f,v,y,x;return jl({anchorBox:d,bubble:o.bubble.getOr(Wl()),overrides:o.overrides,layouts:h,placer:g.none()})});var aT=[M("node"),M("root"),Se("bubble"),_r(),T("overrides",{}),T("showAbove",!1),Ne("placement",(e,t,o)=>{const n=Tb(e,0,t);return t.node.filter(Ho).bind(r=>{const s=r.dom.getBoundingClientRect(),a=Eb(s.left,s.top,s.width,s.height),i=t.node.getOr(e.element);return Ab(a,n,t,o,i)})})];const Hu=(e,t,o,n)=>({start:e,soffset:t,finish:o,foffset:n}),zu=Mo([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),iT=(zu.before,zu.on,zu.after,e=>e.fold(xe,xe,xe)),$l=Mo([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),di={domRange:$l.domRange,relative:$l.relative,exact:$l.exact,exactFromRange:e=>$l.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{const t=(o=>o.match({domRange:n=>U(n.startContainer),relative:(n,r)=>iT(n),exact:(n,r,s,a)=>n}))(e);return Pa(t)},range:Hu},Mb=(e,t,o)=>{const n=e.document.createRange();var r;return r=n,t.fold(s=>{r.setStartBefore(s.dom)},(s,a)=>{r.setStart(s.dom,a)},s=>{r.setStartAfter(s.dom)}),((s,a)=>{a.fold(i=>{s.setEndBefore(i.dom)},(i,l)=>{s.setEnd(i.dom,l)},i=>{s.setEndAfter(i.dom)})})(n,o),n},Db=(e,t,o,n,r)=>{const s=e.document.createRange();return s.setStart(t.dom,o),s.setEnd(n.dom,r),s},Bb=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),ui=Mo([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Fb=(e,t,o)=>t(U(o.startContainer),o.startOffset,U(o.endContainer),o.endOffset),Ib=(e,t)=>((o,n)=>{const r=((s,a)=>a.match({domRange:i=>({ltr:E(i),rtl:g.none}),relative:(i,l)=>({ltr:br(()=>Mb(s,i,l)),rtl:br(()=>g.some(Mb(s,l,i)))}),exact:(i,l,c,u)=>({ltr:br(()=>Db(s,i,l,c,u)),rtl:br(()=>g.some(Db(s,c,u,i,l)))})}))(o,n);return((s,a)=>{const i=a.ltr();return i.collapsed?a.rtl().filter(l=>l.collapsed===!1).map(l=>ui.rtl(U(l.endContainer),l.endOffset,U(l.startContainer),l.startOffset)).getOrThunk(()=>Fb(0,ui.ltr,i)):Fb(0,ui.ltr,i)})(0,r)})(e,t).match({ltr:(o,n,r,s)=>{const a=e.document.createRange();return a.setStart(o.dom,n),a.setEnd(r.dom,s),a},rtl:(o,n,r,s)=>{const a=e.document.createRange();return a.setStart(r.dom,s),a.setEnd(o.dom,n),a}});ui.ltr,ui.rtl;const Ut=(e,t)=>((o,n)=>{const r=n===void 0?document:n.dom;return bh(r)?[]:N(r.querySelectorAll(o),U)})(t,e),Rb=e=>{if(e.rangeCount>0){const t=e.getRangeAt(0),o=e.getRangeAt(e.rangeCount-1);return g.some(Hu(U(t.startContainer),t.startOffset,U(o.endContainer),o.endOffset))}return g.none()},lT=e=>{if(e.anchorNode===null||e.focusNode===null)return Rb(e);{const t=U(e.anchorNode),o=U(e.focusNode);return((n,r,s,a)=>{const i=((c,u,d,m)=>{const p=Zo(c).dom.createRange();return p.setStart(c.dom,u),p.setEnd(d.dom,m),p})(n,r,s,a),l=Le(n,s)&&r===a;return i.collapsed&&!l})(t,e.anchorOffset,o,e.focusOffset)?g.some(Hu(t,e.anchorOffset,o,e.focusOffset)):Rb(e)}},Nb=(e,t)=>(o=>{const n=o.getClientRects(),r=n.length>0?n[0]:o.getBoundingClientRect();return r.width>0||r.height>0?g.some(r).map(Bb):g.none()})(Ib(e,t)),cT=((e,t)=>{const o=n=>e(n)?g.from(n.dom.nodeValue):g.none();return{get:n=>{if(!e(n))throw new Error("Can only get text value of a text node");return o(n).getOr("")},getOption:o,set:(n,r)=>{if(!e(n))throw new Error("Can only set raw text value of a text node");n.dom.nodeValue=r}}})(jr),ql=(e,t)=>({element:e,offset:t}),Vb=(e,t)=>jr(e)?ql(e,t):((o,n)=>{const r=wn(o);if(r.length===0)return ql(o,n);if(n<r.length)return ql(r[n],0);{const s=r[r.length-1],a=jr(s)?(i=>cT.get(i))(s).length:wn(s).length;return ql(s,a)}})(e,t),Hb=(e,t)=>t.getSelection.getOrThunk(()=>()=>(o=>(n=>g.from(n.getSelection()))(o).filter(n=>n.rangeCount>0).bind(lT))(e))().map(o=>{const n=Vb(o.start,o.soffset),r=Vb(o.finish,o.foffset);return di.range(n.element,n.offset,r.element,r.offset)});var dT=[Se("getSelection"),M("root"),Se("bubble"),_r(),T("overrides",{}),T("showAbove",!1),Ne("placement",(e,t,o)=>{const n=Pa(t.root).dom,r=Tb(e,0,t),s=Hb(n,t).bind(i=>((c,u)=>(d=>{const m=d.getBoundingClientRect();return m.width>0||m.height>0?g.some(m).map(Bb):g.none()})(Ib(c,u)))(n,di.exactFromRange(i)).orThunk(()=>{const c=ph("\uFEFF");$a(i.start,c);const u=Nb(n,di.exact(c,0,c,1));return Un(c),u}).bind(c=>Eb(c.left,c.top,c.width,c.height))),a=Hb(n,t).bind(i=>Oo(i.start)?g.some(i.start):Ua(i.start)).getOr(e.element);return Ab(s,r,t,o,a)})];const Xl="link-layout",zb=e=>e.x+e.width,Lb=(e,t)=>e.x-t.width,Pb=(e,t)=>e.y-t.height+e.height,Ub=e=>e.y,Wb=(e,t,o)=>Ct(zb(e),Ub(e),o.southeast(),Ll(),"southeast",Ot(e,{left:0,top:2}),Xl),jb=(e,t,o)=>Ct(Lb(e,t),Ub(e),o.southwest(),wu(),"southwest",Ot(e,{right:1,top:2}),Xl),Gb=(e,t,o)=>Ct(zb(e),Pb(e,t),o.northeast(),Su(),"northeast",Ot(e,{left:0,bottom:3}),Xl),$b=(e,t,o)=>Ct(Lb(e,t),Pb(e,t),o.northwest(),ku(),"northwest",Ot(e,{right:1,bottom:3}),Xl),qb=()=>[Wb,jb,Gb,$b],Xb=()=>[jb,Wb,$b,Gb];var uT=[M("item"),_r(),T("overrides",{}),Ne("placement",(e,t,o)=>{const n=Fu(o,t.item.element),r=Gl(e.element,t,qb(),Xb(),qb(),Xb(),g.none());return g.some(jl({anchorBox:n,bubble:Wl(),overrides:t.overrides,layouts:r,placer:g.none()}))})],mT=mo("type",{selection:dT,node:aT,hotspot:eT,submenu:uT,makeshift:tT});const gT=[Eo("classes",wt),Gn("mode","all",["all","layout","placement"])],pT=[T("useFixed",Ve),Se("getBounds")],hT=[go("anchor",mT),po("transition",gT)],fT=(e,t,o,n,r,s,a)=>((i,l,c,u,d,m,p,h)=>{const f=kb(p,"maxHeightFunction",K_()),v=kb(p,"maxWidthFunction",H),y=i.anchorBox,x=i.origin,b={bounds:j_(x,m),origin:x,preference:u,maxHeightFunction:f,maxWidthFunction:v,lastPlacement:d,transition:h};return Y_(y,l,c,b)})(((i,l)=>((c,u)=>({anchorBox:c,origin:u}))(i,l))(o.anchorBox,t),r.element,o.bubble,o.layouts,s,n,o.overrides,a),Kb=(e,t,o,n,r,s)=>{const a=s.map(Qt);return Yb(e,t,o,n,r,a)},Yb=(e,t,o,n,r,s)=>{const a=Kt("placement.info",X(hT),r),i=a.anchor,l=n.element,c=o.get(n.uid);Du(()=>{se(l,"position","fixed");const u=Et(l,"visibility");se(l,"visibility","hidden");const d=t.useFixed()?(()=>{const h=document.documentElement;return $_(0,0,h.clientWidth,h.clientHeight)})():(h=>{const f=fr(h.element),v=h.element.dom.getBoundingClientRect();return G_(f.left,f.top,v.width,v.height)})(e),m=i.placement,p=s.map(E).or(t.getBounds);m(e,i,d).each(h=>{const f=h.placer.getOr(fT)(e,d,h,p,n,c,a.transition);o.set(n.uid,f)}),u.fold(()=>{Me(l,"visibility")},h=>{se(l,"visibility",h)}),Et(l,"left").isNone()&&Et(l,"top").isNone()&&Et(l,"right").isNone()&&Et(l,"bottom").isNone()&&Jo(Et(l,"position"),"fixed")&&Me(l,"position")},l)};var bT=Object.freeze({__proto__:null,position:(e,t,o,n,r)=>{Kb(e,t,o,n,r,g.none())},positionWithin:Kb,positionWithinBounds:Yb,getMode:(e,t,o)=>t.useFixed()?"fixed":"absolute",reset:(e,t,o,n)=>{const r=n.element;q(["position","left","right","top","bottom"],s=>Me(r,s)),(s=>{at(s,Iu)})(r),o.clear(n.uid)}});const Wt=bt({fields:pT,name:"positioning",active:W_,apis:bT,state:Object.freeze({__proto__:null,init:()=>{let e={};return bo({readState:()=>e,clear:t=>{No(t)?delete e[t]:e={}},set:(t,o)=>{e[t]=o},get:t=>K(e,t)})}})}),Lu=e=>e.getSystem().isConnected(),mi=e=>{we(e,Ps());const t=e.components();q(t,mi)},gi=e=>{const t=e.components();q(t,gi),we(e,es())},Jb=(e,t)=>{e.getSystem().addToWorld(t),Ho(e.element)&&gi(t)},Pu=e=>{mi(e),e.getSystem().removeFromWorld(e)},Zb=(e,t)=>{zo(e.element,t.element)},ls=(e,t)=>{Qb(e,t,zo)},Qb=(e,t,o)=>{e.getSystem().addToWorld(t),o(e.element,t.element),Ho(e.element)&&gi(t),e.syncComponents()},ev=e=>{mi(e),Un(e.element),e.getSystem().removeFromWorld(e)},Zn=e=>{const t=xn(e.element).bind(o=>e.getSystem().getByDom(o).toOptional());ev(e),t.each(o=>{o.syncComponents()})},tv=e=>{const t=e.components();q(t,ev),Hd(e.element),e.syncComponents()},Uu=(e,t)=>{ov(e,t,zo)},ov=(e,t,o)=>{o(e,t.element);const n=wn(t.element);q(n,r=>{t.getByDom(r).each(gi)})},vT=e=>{const t=wn(e.element);q(t,o=>{e.getByDom(o).each(mi)}),Un(e.element)},nv=(e,t,o,n)=>{o.get().each(a=>{tv(e)});const r=t.getAttachPoint(e);ls(r,e);const s=e.getSystem().build(n);return ls(e,s),o.set(s),s},rv=(e,t,o,n)=>{const r=nv(e,t,o,n);return t.onOpen(e,r),r},sv=(e,t,o)=>{o.get().each(n=>{tv(e),Zn(e),t.onClose(e,n),o.clear()})},av=(e,t,o)=>o.isOpen(),iv=(e,t,o)=>{const n=t.getAttachPoint(e);se(e.element,"position",Wt.getMode(n)),((r,s,a,i)=>{Et(r.element,s).fold(()=>{at(r.element,a)},l=>{ie(r.element,a,l)}),se(r.element,s,"hidden")})(e,"visibility",t.cloakVisibilityAttr)},lv=(e,t,o)=>{(n=>Yo(["top","left","right","bottom"],r=>Et(n,r).isSome()))(e.element)||Me(e.element,"position"),((n,r,s)=>{lo(n.element,s).fold(()=>Me(n.element,r),a=>se(n.element,r,a))})(e,"visibility",t.cloakVisibilityAttr)};var yT=Object.freeze({__proto__:null,cloak:iv,decloak:lv,open:rv,openWhileCloaked:(e,t,o,n,r)=>{iv(e,t),rv(e,t,o,n),r(),lv(e,t)},close:sv,isOpen:av,isPartOf:(e,t,o,n)=>av(0,0,o)&&o.get().exists(r=>t.isPartOf(e,r,n)),getState:(e,t,o)=>o.get(),setContent:(e,t,o,n)=>o.get().map(()=>nv(e,t,o,n))}),xT=Object.freeze({__proto__:null,events:(e,t)=>Re([B(Ml(),(o,n)=>{sv(o,e,t)})])}),wT=[me("onOpen"),me("onClose"),M("isPartOf"),M("getAttachPoint"),T("cloakVisibilityAttr","data-precloak-visibility")],ST=Object.freeze({__proto__:null,init:()=>{const e=ze(),t=E("not-implemented");return bo({readState:t,isOpen:e.isSet,clear:e.clear,set:e.set,get:e.get})}});const ge=bt({fields:wT,name:"sandboxing",active:xT,apis:yT,state:ST}),Tr=E("dismiss.popups"),Zs=E("reposition.popups"),Wu=E("mouse.released"),kT=uo([T("isExtraPart",Ve),po("fireEventInstead",[T("event",Us())])]),ju=e=>{const t=Kt("Dismissal",kT,e);return{[Tr()]:{schema:uo([M("target")]),onReceive:(o,n)=>{ge.isOpen(o)&&(ge.isPartOf(o,n.target)||t.isExtraPart(o,n.target)||t.fireEventInstead.fold(()=>ge.close(o),r=>we(o,r.event)))}}}},CT=uo([po("fireEventInstead",[T("event",kf())]),Lo("doReposition")]),Gu=e=>{const t=Kt("Reposition",CT,e);return{[Zs()]:{onReceive:o=>{ge.isOpen(o)&&t.fireEventInstead.fold(()=>t.doReposition(o),n=>we(o,n.event))}}}},$u=(e,t,o)=>{t.store.manager.onLoad(e,t,o)},cv=(e,t,o)=>{t.store.manager.onUnload(e,t,o)};var OT=Object.freeze({__proto__:null,onLoad:$u,onUnload:cv,setValue:(e,t,o,n)=>{t.store.manager.setValue(e,t,o,n)},getValue:(e,t,o)=>t.store.manager.getValue(e,t,o),getState:(e,t,o)=>o}),_T=Object.freeze({__proto__:null,events:(e,t)=>{const o=e.resetOnDom?[Ge((n,r)=>{$u(n,e,t)}),Cn((n,r)=>{cv(n,e,t)})]:[Mu(e,t,$u)];return Re(o)}});const dv=()=>{const e=Z(null);return bo({set:e.set,get:e.get,isNotSet:()=>e.get()===null,clear:()=>{e.set(null)},readState:()=>({mode:"memory",value:e.get()})})},uv=()=>{const e=Z({}),t=Z({});return bo({readState:()=>({mode:"dataset",dataByValue:e.get(),dataByText:t.get()}),lookup:o=>K(e.get(),o).orThunk(()=>K(t.get(),o)),update:o=>{const n=e.get(),r=t.get(),s={},a={};q(o,i=>{s[i.value]=i,K(i,"meta").each(l=>{K(l,"text").each(c=>{a[c]=i})})}),e.set(k(k({},n),s)),t.set(k(k({},r),a))},clear:()=>{e.set({}),t.set({})}})};var TT=Object.freeze({__proto__:null,memory:dv,dataset:uv,manual:()=>bo({readState:H}),init:e=>e.store.manager.state(e)});const mv=(e,t,o,n)=>{const r=t.store;o.update([n]),r.setValue(e,n),t.onSetValue(e,n)};var ET=[Se("initialValue"),M("getFallbackEntry"),M("getDataKey"),M("setValue"),Ne("manager",{setValue:mv,getValue:(e,t,o)=>{const n=t.store,r=n.getDataKey(e);return o.lookup(r).getOrThunk(()=>n.getFallbackEntry(r))},onLoad:(e,t,o)=>{t.store.initialValue.each(n=>{mv(e,t,o,n)})},onUnload:(e,t,o)=>{o.clear()},state:uv})],AT=[M("getValue"),T("setValue",H),Se("initialValue"),Ne("manager",{setValue:(e,t,o,n)=>{t.store.setValue(e,n),t.onSetValue(e,n)},getValue:(e,t,o)=>t.store.getValue(e),onLoad:(e,t,o)=>{t.store.initialValue.each(n=>{t.store.setValue(e,n)})},onUnload:H,state:tn.init})],MT=[Se("initialValue"),Ne("manager",{setValue:(e,t,o,n)=>{o.set(n),t.onSetValue(e,n)},getValue:(e,t,o)=>o.get(),onLoad:(e,t,o)=>{t.store.initialValue.each(n=>{o.isNotSet()&&o.set(n)})},onUnload:(e,t,o)=>{o.clear()},state:dv})],DT=[Ao("store",{mode:"memory"},mo("mode",{memory:MT,manual:AT,dataset:ET})),me("onSetValue"),T("resetOnDom",!1)];const V=bt({fields:DT,name:"representing",active:_T,apis:OT,extra:{setValueFrom:(e,t)=>{const o=V.getValue(t);V.setValue(e,o)}},state:TT}),mt=(e,t)=>Yd(e,{},N(t,o=>{return n=o.name(),r="Cannot configure "+o.name()+" for "+e,St(n,n,{tag:"option",process:{}},Vs(s=>Yr("The field: "+n+" is forbidden. "+r)));var n,r}).concat([zt("dump",xe)])),qu=e=>e.dump,vt=(e,t)=>k(k({},I(t)),e.dump),Qs=mt,ea=vt,gv="placeholder",Kl=Mo([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Xu=e=>Te(e,"uiType"),pv=(e,t,o,n)=>((r,s,a,i)=>Xu(a)&&a.uiType===gv?((l,c,u,d)=>l.exists(m=>m!==u.owner)?Kl.single(!0,E(u)):K(d,u.name).fold(()=>{throw new Error("Unknown placeholder component: "+u.name+`
Known: [`+rt(d)+`]
Namespace: `+l.getOr("none")+`
Spec: `+JSON.stringify(u,null,2))},m=>m.replace()))(r,0,a,i):Kl.single(!1,E(a)))(e,0,o,n).fold((r,s)=>{const a=Xu(o)?s(t,o.config,o.validated):s(t),i=K(a,"components").getOr([]),l=nt(i,c=>pv(e,t,c,n));return[k(k({},a),{components:l})]},(r,s)=>{if(Xu(o)){const a=s(t,o.config,o.validated);return o.validated.preprocess.getOr(xe)(a)}return s(t)}),hv=Kl.single,BT=Kl.multiple,fv=E(gv),Yl=Mo([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Jl=T("factory",{sketch:xe}),Ku=T("schema",[]),Zl=M("name"),Yu=St("pname","pname",Sl(e=>"<alloy."+j(e.name)+">"),Qo()),FT=zt("schema",()=>[Se("preprocess")]),Ql=T("defaults",E({})),ec=T("overrides",E({})),IT=X([Jl,Ku,Zl,Yu,Ql,ec]),RT=X([Jl,Ku,Zl,Ql,ec]),NT=X([Jl,Ku,Zl,Yu,Ql,ec]),VT=X([Jl,FT,Zl,M("unit"),Yu,Ql,ec]),bv=e=>e.fold(g.some,g.none,g.some,g.some),vv=e=>{const t=o=>o.name;return e.fold(t,t,t,t)},tc=(e,t)=>o=>{const n=Kt("Converting part type",t,o);return e(n)},Dt=tc(Yl.required,IT),jo=tc(Yl.external,RT),Bo=tc(Yl.optional,NT),oc=tc(Yl.group,VT),Ju=E("entirety");var HT=Object.freeze({__proto__:null,required:Dt,external:jo,optional:Bo,group:oc,asNamedPart:bv,name:vv,asCommon:e=>e.fold(xe,xe,xe,xe),original:Ju});const Zu=(e,t,o,n)=>je(t.defaults(e,o,n),o,{uid:e.partUids[t.name]},t.overrides(e,o,n)),Qu=(e,t)=>{const o={};return q(t,n=>{bv(n).each(r=>{const s=zT(e,r.pname);o[r.name]=a=>{const i=Kt("Part: "+r.name+" in "+e,X(r.schema),a);return k(k({},s),{config:a,validated:i})}})}),o},zT=(e,t)=>({uiType:fv(),owner:e,name:t}),em=(e,t,o)=>({uiType:fv(),owner:e,name:t,config:o,validated:{}}),yv=e=>nt(e,t=>t.fold(g.none,g.some,g.none,g.none).map(o=>yr(o.name,o.schema.concat([Yf(Ju())]))).toArray()),xv=e=>N(e,vv),tm=(e,t,o)=>((n,r,s)=>{const a={},i={};return q(s,l=>{l.fold(c=>{a[c.pname]=hv(!0,(u,d,m)=>c.factory.sketch(Zu(u,c,d,m)))},c=>{const u=r.parts[c.name];i[c.name]=E(c.factory.sketch(Zu(r,c,u[Ju()]),u))},c=>{a[c.pname]=hv(!1,(u,d,m)=>c.factory.sketch(Zu(u,c,d,m)))},c=>{a[c.pname]=BT(!0,(u,d,m)=>{const p=u[c.name];return N(p,h=>c.factory.sketch(je(c.defaults(u,h,m),h,c.overrides(u,h))))})})}),{internals:E(a),externals:E(i)}})(0,t,o),om=(e,t,o)=>((n,r,s,a)=>{const i=ft(a,(c,u)=>((d,m)=>{let p=!1;return{name:E(d),required:()=>m.fold((h,f)=>h,(h,f)=>h),used:()=>p,replace:()=>{if(p)throw new Error("Trying to use the same placeholder more than once: "+d);return p=!0,m}}})(u,c)),l=((c,u,d,m)=>nt(d,p=>pv(c,u,p,m)))(n,r,s,i);return It(i,c=>{if(c.used()===!1&&c.required())throw new Error("Placeholder: "+c.name()+` was not found in components list
Namespace: `+n.getOr("none")+`
Components: `+JSON.stringify(r.components,null,2))}),l})(g.some(e),t,t.components,o),Ee=(e,t,o)=>{const n=t.partUids[o];return e.getSystem().getByUid(n).toOptional()},On=(e,t,o)=>Ee(e,t,o).getOrDie("Could not find part: "+o),wv=(e,t,o)=>{const n={},r=t.partUids,s=e.getSystem();return q(o,a=>{n[a]=E(s.getByUid(r[a]))}),n},Sv=(e,t)=>{const o=e.getSystem();return ft(t.partUids,(n,r)=>E(o.getByUid(n)))},kv=e=>rt(e.partUids),nm=(e,t,o)=>{const n={},r=t.partUids,s=e.getSystem();return q(o,a=>{n[a]=E(s.getByUid(r[a]).getOrDie())}),n},Cv=(e,t)=>{const o=xv(t);return zs(N(o,n=>({key:n,value:e+"-"+n})))},rm=e=>St("partUids","partUids",Wd(t=>Cv(t.uid,e)),Qo());var LT=Object.freeze({__proto__:null,generate:Qu,generateOne:em,schemas:yv,names:xv,substitutes:tm,components:om,defaultUids:Cv,defaultUidsSchema:rm,getAllParts:Sv,getAllPartNames:kv,getPart:Ee,getPartOrDie:On,getParts:wv,getPartsOrDie:nm});const Ov=(e,t,o,n,r)=>{const s=((a,i)=>(a.length>0?[yr("parts",a)]:[]).concat([M("uid"),T("dom",{}),T("components",[]),Yf("originalSpec"),T("debug.sketcher",{})]).concat(i))(n,r);return Kt(e+" [SpecSchema]",uo(s.concat(t)),o)},sm=(e,t,o,n,r)=>{const s=_v(r),a=yv(o),i=rm(o),l=Ov(e,t,s,a,[i]),c=tm(0,l,o);return n(l,om(e,l,c.internals()),s,c.externals())},_v=e=>(t=>Te(t,"uid"))(e)?e:k(k({},e),{uid:$s("uid")}),PT=uo([M("name"),M("factory"),M("configFields"),T("apis",{}),T("extraApis",{})]),UT=uo([M("name"),M("factory"),M("configFields"),M("partFields"),T("apis",{}),T("extraApis",{})]),xo=e=>{const t=Kt("Sketcher for "+e.name,PT,e),o=ft(t.apis,Nl),n=ft(t.extraApis,(r,s)=>gu(r,s));return k(k({name:t.name,configFields:t.configFields,sketch:r=>((s,a,i,l)=>{const c=_v(l);return i(Ov(s,a,c,[],[]),c)})(t.name,t.configFields,t.factory,r)},o),n)},Vt=e=>{const t=Kt("Sketcher for "+e.name,UT,e),o=Qu(t.name,t.partFields),n=ft(t.apis,Nl),r=ft(t.extraApis,(s,a)=>gu(s,a));return k(k({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:s=>sm(t.name,t.configFields,t.partFields,t.factory,s),parts:o},n),r)},ta=e=>fh("input")(e)&&Tt(e,"type")!=="radio"||fh("textarea")(e);var WT=Object.freeze({__proto__:null,getCurrent:(e,t,o)=>t.find(e)});const jT=[M("find")],de=bt({fields:jT,name:"composing",apis:WT}),GT=["input","button","textarea","select"],Tv=(e,t,o)=>{(t.disabled()?im:lm)(e,t)},am=(e,t)=>t.useNative===!0&&ht(GT,zn(e.element)),$T=e=>{ie(e.element,"disabled","disabled")},qT=e=>{at(e.element,"disabled")},XT=e=>{ie(e.element,"aria-disabled","true")},KT=e=>{ie(e.element,"aria-disabled","false")},im=(e,t,o)=>{t.disableClass.each(n=>{ct(e.element,n)}),(am(e,t)?$T:XT)(e),t.onDisabled(e)},lm=(e,t,o)=>{t.disableClass.each(n=>{Ze(e.element,n)}),(am(e,t)?qT:KT)(e),t.onEnabled(e)},Ev=(e,t)=>am(e,t)?(o=>Oh(o.element,"disabled"))(e):(o=>Tt(o.element,"aria-disabled")==="true")(e);var YT=Object.freeze({__proto__:null,enable:lm,disable:im,isDisabled:Ev,onLoad:Tv,set:(e,t,o,n)=>{(n?im:lm)(e,t)}}),JT=Object.freeze({__proto__:null,exhibit:(e,t)=>on({classes:t.disabled()?t.disableClass.toArray():[]}),events:(e,t)=>Re([Af(fo(),(o,n)=>Ev(o,e)),Mu(e,t,Tv)])}),ZT=[lt("disabled",Ve),T("useNative",!0),Se("disableClass"),me("onDisabled"),me("onEnabled")];const Q=bt({fields:ZT,name:"disabling",active:JT,apis:YT}),Av=(e,t,o,n)=>{const r=Ut(e.element,"."+t.highlightClass);q(r,s=>{Yo(n,a=>Le(a.element,s))||(Ze(s,t.highlightClass),e.getSystem().getByDom(s).each(a=>{t.onDehighlight(e,a),we(a,su())}))})},pi=(e,t,o,n)=>{Av(e,t,0,[n]),cm(e,t,o,n)||(ct(n.element,t.highlightClass),t.onHighlight(e,n),we(n,Tf()))},cm=(e,t,o,n)=>vo(n.element,t.highlightClass),Mv=(e,t,o)=>ut(e.element,"."+t.itemClass).bind(n=>e.getSystem().getByDom(n).toOptional()),Dv=(e,t,o)=>{const n=Ut(e.element,"."+t.itemClass);return(n.length>0?g.some(n[n.length-1]):g.none()).bind(r=>e.getSystem().getByDom(r).toOptional())},Bv=(e,t,o,n)=>{const r=Ut(e.element,"."+t.itemClass);return Fs(r,s=>vo(s,t.highlightClass)).bind(s=>{const a=Ks(s,n,0,r.length-1);return e.getSystem().getByDom(r[a]).toOptional()})},Fv=(e,t,o)=>{const n=Ut(e.element,"."+t.itemClass);return Wr(N(n,r=>e.getSystem().getByDom(r).toOptional()))};var QT=Object.freeze({__proto__:null,dehighlightAll:(e,t,o)=>Av(e,t,0,[]),dehighlight:(e,t,o,n)=>{cm(e,t,o,n)&&(Ze(n.element,t.highlightClass),t.onDehighlight(e,n),we(n,su()))},highlight:pi,highlightFirst:(e,t,o)=>{Mv(e,t).each(n=>{pi(e,t,o,n)})},highlightLast:(e,t,o)=>{Dv(e,t).each(n=>{pi(e,t,o,n)})},highlightAt:(e,t,o,n)=>{((r,s,a,i)=>{const l=Ut(r.element,"."+s.itemClass);return g.from(l[i]).fold(()=>ue.error(new Error("No element found with index "+i)),r.getSystem().getByDom)})(e,t,0,n).fold(r=>{throw r},r=>{pi(e,t,o,r)})},highlightBy:(e,t,o,n)=>{const r=Fv(e,t);Ke(r,n).each(s=>{pi(e,t,o,s)})},isHighlighted:cm,getHighlighted:(e,t,o)=>ut(e.element,"."+t.highlightClass).bind(n=>e.getSystem().getByDom(n).toOptional()),getFirst:Mv,getLast:Dv,getPrevious:(e,t,o)=>Bv(e,t,0,-1),getNext:(e,t,o)=>Bv(e,t,0,1),getCandidates:Fv}),e1=[M("highlightClass"),M("itemClass"),me("onHighlight"),me("onDehighlight")];const be=bt({fields:e1,name:"highlighting",apis:QT}),t1=[8],Er=[9],_n=[13],nc=[27],oo=[32],rc=[37],hi=[38],sc=[39],oa=[40],o1=(e,t,o)=>{const n=Ha(e.slice(0,t)),r=Ha(e.slice(t+1));return Ke(n.concat(r),o)},n1=(e,t,o)=>{const n=Ha(e.slice(0,t));return Ke(n,o)},r1=(e,t,o)=>{const n=e.slice(0,t),r=e.slice(t+1);return Ke(r.concat(n),o)},s1=(e,t,o)=>{const n=e.slice(t+1);return Ke(n,o)},pe=e=>t=>{const o=t.raw;return ht(e,o.which)},ln=e=>t=>Is(e,o=>o(t)),na=e=>e.raw.shiftKey===!0,a1=e=>e.raw.ctrlKey===!0,fi=Va(na),fe=(e,t)=>({matches:e,classification:t}),Iv=(e,t,o)=>{t.exists(n=>o.exists(r=>Le(r,n)))||Y(e,Cf(),{prevFocus:t,newFocus:o})},dm=()=>{const e=t=>sn(t.element);return{get:e,set:(t,o)=>{const n=e(t);t.getSystem().triggerFocus(o,t.element);const r=e(t);Iv(t,n,r)}}},i1=()=>{const e=t=>be.getHighlighted(t).map(o=>o.element);return{get:e,set:(t,o)=>{const n=e(t);t.getSystem().getByDom(o).fold(H,s=>{be.highlight(t,s)});const r=e(t);Iv(t,n,r)}}};var ac;(function(e){e.OnFocusMode="onFocus",e.OnEnterOrSpaceMode="onEnterOrSpace",e.OnApiMode="onApi"})(ac||(ac={}));const cs=(e,t,o,n,r)=>{const s=(i,l,c,u,d)=>{return(m=c(i,l,u,d),p=l.event,Ke(m,h=>h.matches(p)).map(h=>h.classification)).bind(h=>h(i,l,u,d));var m,p},a={schema:()=>e.concat([T("focusManager",dm()),Ao("focusInside","onFocus",Ka(i=>ht(["onFocus","onEnterOrSpace","onApi"],i)?ue.value(i):ue.error("Invalid value for focusInside"))),Ne("handler",a),Ne("state",t),Ne("sendFocusIn",r)]),processKey:s,toEvents:(i,l)=>{const c=i.focusInside!==ac.OnFocusMode?g.none():r(i).map(d=>B(Sr(),(m,p)=>{d(m,i,l),p.stop()})),u=[B(ei(),(d,m)=>{s(d,m,o,i,l).fold(()=>{((p,h)=>{const f=pe(oo.concat(_n))(h.event);i.focusInside===ac.OnEnterOrSpaceMode&&f&&wf(p,h)&&r(i).each(v=>{v(p,i,l),h.stop()})})(d,m)},p=>{m.stop()})}),B(r_(),(d,m)=>{s(d,m,n,i,l).each(p=>{m.stop()})})];return Re(c.toArray().concat(u))}};return a},Rv=e=>{const t=[Se("onEscape"),Se("onEnter"),T("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),T("firstTabstop",0),T("useTabstopAt",pt),Se("visibilitySelector")].concat([e]),o=(i,l)=>{const c=i.visibilitySelector.bind(u=>rn(l,u)).getOr(l);return Rt(c)>0},n=(i,l,c)=>{((u,d)=>{const m=Ut(u.element,d.selector),p=He(m,h=>o(d,h));return g.from(p[d.firstTabstop])})(i,l).each(u=>{l.focusManager.set(i,u)})},r=(i,l,c,u)=>{const d=Ut(i.element,c.selector);return((m,p)=>p.focusManager.get(m).bind(h=>rn(h,p.selector)))(i,c).bind(m=>Fs(d,Co(Le,m)).bind(p=>((h,f,v,y,x)=>x(f,v,b=>((w,S)=>o(w,S)&&w.useTabstopAt(S))(y,b)).fold(()=>y.cyclic?g.some(!0):g.none(),b=>(y.focusManager.set(h,b),g.some(!0))))(i,d,p,c,u)))},s=E([fe(ln([na,pe(Er)]),(i,l,c)=>{const u=c.cyclic?o1:n1;return r(i,0,c,u)}),fe(pe(Er),(i,l,c)=>{const u=c.cyclic?r1:s1;return r(i,0,c,u)}),fe(ln([fi,pe(_n)]),(i,l,c)=>c.onEnter.bind(u=>u(i,l)))]),a=E([fe(pe(nc),(i,l,c)=>c.onEscape.bind(u=>u(i,l)))]);return cs(t,tn.init,s,a,()=>g.some(n))};var l1=Rv(zt("cyclic",Ve)),c1=Rv(zt("cyclic",pt));const bi=(e,t,o)=>ta(o)&&pe(oo)(t.event)?g.none():((n,r,s)=>(au(n,s,fo()),g.some(!0)))(e,0,o),ra=(e,t)=>g.some(!0),d1=[T("execute",bi),T("useSpace",!1),T("useEnter",!0),T("useControlEnter",!1),T("useDown",!1)],Nv=(e,t,o)=>o.execute(e,t,e.element);var u1=cs(d1,tn.init,(e,t,o,n)=>{const r=o.useSpace&&!ta(e.element)?oo:[],s=o.useEnter?_n:[],a=o.useDown?oa:[],i=r.concat(s).concat(a);return[fe(pe(i),Nv)].concat(o.useControlEnter?[fe(ln([a1,pe(_n)]),Nv)]:[])},(e,t,o,n)=>o.useSpace&&!ta(e.element)?[fe(pe(oo),ra)]:[],()=>g.none());const Vv=()=>{const e=ze();return bo({readState:()=>e.get().map(t=>({numRows:String(t.numRows),numColumns:String(t.numColumns)})).getOr({numRows:"?",numColumns:"?"}),setGridSize:(t,o)=>{e.set({numRows:t,numColumns:o})},getNumRows:()=>e.get().map(t=>t.numRows),getNumColumns:()=>e.get().map(t=>t.numColumns)})};var m1=Object.freeze({__proto__:null,flatgrid:Vv,init:e=>e.state(e)});const Hv=e=>(t,o,n,r)=>{const s=e(t.element);return zv(s,t,o,n,r)},um=(e,t)=>{const o=Nu(e,t);return Hv(o)},mm=(e,t)=>{const o=Nu(t,e);return Hv(o)},gm=e=>(t,o,n,r)=>zv(e,t,o,n,r),zv=(e,t,o,n,r)=>n.focusManager.get(t).bind(s=>e(t.element,s,n,r)).map(s=>(n.focusManager.set(t,s),!0)),Lv=gm,Pv=gm,ic=gm,Uv=e=>!(t=>t.offsetWidth<=0&&t.offsetHeight<=0)(e.dom),Wv=(e,t,o)=>{const n=Ut(e,o);return((r,s)=>Fs(r,a=>Le(a,t)).map(a=>({index:a,candidates:r})))(He(n,Uv))},jv=(e,t)=>Fs(e,o=>Le(t,o)),Gv=(e,t,o,n)=>n(Math.floor(t/o),t%o).bind(r=>{const s=r.row*o+r.column;return s>=0&&s<e.length?g.some(e[s]):g.none()}),$v=(e,t,o,n,r)=>Gv(e,t,n,(s,a)=>{const i=s===o-1?e.length-s*n:n,l=Ks(a,r,0,i-1);return g.some({row:s,column:l})}),qv=(e,t,o,n,r)=>Gv(e,t,n,(s,a)=>{const i=Ks(s,r,0,o-1),l=i===o-1?e.length-i*n:n,c=Do(a,0,l-1);return g.some({row:i,column:c})}),g1=[M("selector"),T("execute",bi),to("onEscape"),T("captureTab",!1),Jf()],p1=(e,t,o)=>{ut(e.element,t.selector).each(n=>{t.focusManager.set(e,n)})},lc=e=>(t,o,n,r)=>Wv(t,o,n.selector).bind(s=>e(s.candidates,s.index,r.getNumRows().getOr(n.initSize.numRows),r.getNumColumns().getOr(n.initSize.numColumns))),Xv=(e,t,o)=>o.captureTab?g.some(!0):g.none(),Kv=lc((e,t,o,n)=>$v(e,t,o,n,-1)),Yv=lc((e,t,o,n)=>$v(e,t,o,n,1)),h1=lc((e,t,o,n)=>qv(e,t,o,n,-1)),f1=lc((e,t,o,n)=>qv(e,t,o,n,1)),b1=E([fe(pe(rc),um(Kv,Yv)),fe(pe(sc),mm(Kv,Yv)),fe(pe(hi),Lv(h1)),fe(pe(oa),Pv(f1)),fe(ln([na,pe(Er)]),Xv),fe(ln([fi,pe(Er)]),Xv),fe(pe(oo.concat(_n)),(e,t,o,n)=>((r,s)=>s.focusManager.get(r).bind(a=>rn(a,s.selector)))(e,o).bind(r=>o.execute(e,t,r)))]),v1=E([fe(pe(nc),(e,t,o)=>o.onEscape(e,t)),fe(pe(oo),ra)]);var y1=cs(g1,Vv,b1,v1,()=>g.some(p1));const cc=(e,t,o,n)=>{const r=(s,a,i)=>{const l=Ks(a,n,0,i.length-1);return l===s?g.none():(c=i[l],zn(c)==="button"&&Tt(c,"disabled")==="disabled"?r(s,l,i):g.from(i[l]));var c};return Wv(e,o,t).bind(s=>{const a=s.index,i=s.candidates;return r(a,a,i)})},x1=[M("selector"),T("getInitial",g.none),T("execute",bi),to("onEscape"),T("executeOnMove",!1),T("allowVertical",!0)],pm=(e,t,o)=>((n,r)=>r.focusManager.get(n).bind(s=>rn(s,r.selector)))(e,o).bind(n=>o.execute(e,t,n)),w1=(e,t,o)=>{t.getInitial(e).orThunk(()=>ut(e.element,t.selector)).each(n=>{t.focusManager.set(e,n)})},Jv=(e,t,o)=>cc(e,o.selector,t,-1),Zv=(e,t,o)=>cc(e,o.selector,t,1),Qv=e=>(t,o,n,r)=>e(t,o,n,r).bind(()=>n.executeOnMove?pm(t,o,n):g.some(!0)),S1=E([fe(pe(oo),ra),fe(pe(nc),(e,t,o)=>o.onEscape(e,t))]);var k1=cs(x1,tn.init,(e,t,o,n)=>{const r=rc.concat(o.allowVertical?hi:[]),s=sc.concat(o.allowVertical?oa:[]);return[fe(pe(r),Qv(um(Jv,Zv))),fe(pe(s),Qv(mm(Jv,Zv))),fe(pe(_n),pm),fe(pe(oo),pm)]},S1,()=>g.some(w1));const dc=(e,t,o)=>g.from(e[t]).bind(n=>g.from(n[o]).map(r=>({rowIndex:t,columnIndex:o,cell:r}))),ey=(e,t,o,n)=>{const r=e[t].length,s=Ks(o,n,0,r-1);return dc(e,t,s)},ty=(e,t,o,n)=>{const r=Ks(o,n,0,e.length-1),s=e[r].length,a=Do(t,0,s-1);return dc(e,r,a)},oy=(e,t,o,n)=>{const r=e[t].length,s=Do(o+n,0,r-1);return dc(e,t,s)},ny=(e,t,o,n)=>{const r=Do(o+n,0,e.length-1),s=e[r].length,a=Do(t,0,s-1);return dc(e,r,a)},C1=[yr("selectors",[M("row"),M("cell")]),T("cycles",!0),T("previousSelector",g.none),T("execute",bi)],O1=(e,t,o)=>{t.previousSelector(e).orThunk(()=>{const n=t.selectors;return ut(e.element,n.cell)}).each(n=>{t.focusManager.set(e,n)})},uc=(e,t)=>(o,n,r)=>{const s=r.cycles?e:t;return rn(n,r.selectors.row).bind(a=>{const i=Ut(a,r.selectors.cell);return jv(i,n).bind(l=>{const c=Ut(o,r.selectors.row);return jv(c,a).bind(u=>{const d=((m,p)=>N(m,h=>Ut(h,p.selectors.cell)))(c,r);return s(d,u,l).map(m=>m.cell)})})})},ry=uc((e,t,o)=>ey(e,t,o,-1),(e,t,o)=>oy(e,t,o,-1)),sy=uc((e,t,o)=>ey(e,t,o,1),(e,t,o)=>oy(e,t,o,1)),_1=uc((e,t,o)=>ty(e,o,t,-1),(e,t,o)=>ny(e,o,t,-1)),T1=uc((e,t,o)=>ty(e,o,t,1),(e,t,o)=>ny(e,o,t,1)),E1=E([fe(pe(rc),um(ry,sy)),fe(pe(sc),mm(ry,sy)),fe(pe(hi),Lv(_1)),fe(pe(oa),Pv(T1)),fe(pe(oo.concat(_n)),(e,t,o)=>sn(e.element).bind(n=>o.execute(e,t,n)))]),A1=E([fe(pe(oo),ra)]);var M1=cs(C1,tn.init,E1,A1,()=>g.some(O1));const D1=[M("selector"),T("execute",bi),T("moveOnTab",!1)],ay=(e,t,o)=>o.focusManager.get(e).bind(n=>o.execute(e,t,n)),B1=(e,t,o)=>{ut(e.element,t.selector).each(n=>{t.focusManager.set(e,n)})},iy=(e,t,o)=>cc(e,o.selector,t,-1),ly=(e,t,o)=>cc(e,o.selector,t,1),F1=E([fe(pe(hi),ic(iy)),fe(pe(oa),ic(ly)),fe(ln([na,pe(Er)]),(e,t,o,n)=>o.moveOnTab?ic(iy)(e,t,o,n):g.none()),fe(ln([fi,pe(Er)]),(e,t,o,n)=>o.moveOnTab?ic(ly)(e,t,o,n):g.none()),fe(pe(_n),ay),fe(pe(oo),ay)]),I1=E([fe(pe(oo),ra)]);var R1=cs(D1,tn.init,F1,I1,()=>g.some(B1));const N1=[to("onSpace"),to("onEnter"),to("onShiftEnter"),to("onLeft"),to("onRight"),to("onTab"),to("onShiftTab"),to("onUp"),to("onDown"),to("onEscape"),T("stopSpaceKeyup",!1),Se("focusIn")];var V1=cs(N1,tn.init,(e,t,o)=>[fe(pe(oo),o.onSpace),fe(ln([fi,pe(_n)]),o.onEnter),fe(ln([na,pe(_n)]),o.onShiftEnter),fe(ln([na,pe(Er)]),o.onShiftTab),fe(ln([fi,pe(Er)]),o.onTab),fe(pe(hi),o.onUp),fe(pe(oa),o.onDown),fe(pe(rc),o.onLeft),fe(pe(sc),o.onRight),fe(pe(oo),o.onSpace)],(e,t,o)=>[...o.stopSpaceKeyup?[fe(pe(oo),ra)]:[],fe(pe(nc),o.onEscape)],e=>e.focusIn);const H1=l1.schema(),z1=c1.schema(),L1=k1.schema(),P1=y1.schema(),U1=M1.schema(),W1=u1.schema(),j1=R1.schema(),G1=V1.schema(),$=ub({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:H1,cyclic:z1,flow:L1,flatgrid:P1,matrix:U1,execution:W1,menu:j1,special:G1}),name:"keying",active:{events:(e,t)=>e.handler.toEvents(e,t)},apis:{focusIn:(e,t,o)=>{t.sendFocusIn(t).fold(()=>{e.getSystem().triggerFocus(e.element,e.element)},n=>{n(e,t,o)})},setGridSize:(e,t,o,n,r)=>{(s=>Vo(s,"setGridSize"))(o)?o.setGridSize(n,r):console.error("Layout does not support setGridSize")}},state:m1}),cy=(e,t)=>{Du(()=>{((o,n,r)=>{const s=o.components();(l=>{q(l.components(),c=>Un(c.element)),Hd(l.element),l.syncComponents()})(o);const a=r(n),i=Ur(s,a);q(i,l=>{mi(l),o.getSystem().removeFromWorld(l)}),q(a,l=>{Lu(l)?Zb(o,l):(o.getSystem().addToWorld(l),Zb(o,l),Ho(o.element)&&gi(l))}),o.syncComponents()})(e,t,()=>N(t,e.getSystem().build))},e.element)},dy=(e,t)=>{Du(()=>{((o,n,r)=>{const s=o.components(),a=nt(n,c=>Rf(c).toArray());q(s,c=>{ht(a,c)||Pu(c)});const i=((c,u,d)=>zf(c,u,(m,p)=>Lf(c,p,m,d)))(e.element,t,e.getSystem().buildOrPatch),l=Ur(s,i);q(l,c=>{Lu(c)&&Pu(c)}),q(i,c=>{Lu(c)||Jb(o,c)}),o.syncComponents()})(e,t)},e.element)},$1=(e,t,o,n)=>{Pu(t);const r=Lf(e.element,o,n,e.getSystem().buildOrPatch);Jb(e,r),e.syncComponents()},hm=(e,t,o)=>{const n=e.getSystem().build(o);Qb(e,n,t)},q1=(e,t,o,n)=>{Zn(t),hm(e,(r,s)=>((a,i,l)=>{Gr(a,l).fold(()=>{zo(a,i)},c=>{$a(c,i)})})(r,s,o),n)},mc=(e,t)=>e.components(),uy=(e,t,o,n,r)=>{const s=mc(e);return g.from(s[n]).map(a=>(r.fold(()=>Zn(a),i=>{(t.reuseDom?$1:q1)(e,a,n,i)}),a))};var X1=Object.freeze({__proto__:null,append:(e,t,o,n)=>{hm(e,zo,n)},prepend:(e,t,o,n)=>{hm(e,qO,n)},remove:(e,t,o,n)=>{const r=mc(e);Ke(r,a=>Le(n.element,a.element)).each(Zn)},replaceAt:uy,replaceBy:(e,t,o,n,r)=>{const s=mc(e);return Fs(s,n).bind(a=>uy(e,t,0,a,r))},set:(e,t,o,n)=>(t.reuseDom?dy:cy)(e,n),contents:mc});const re=bt({fields:[ho("reuseDom",!0)],name:"replacing",apis:X1}),le=(e,t)=>{const o=((n,r)=>{const s=Re(r);return bt({fields:[M("enabled")],name:n,active:{events:E(s)}})})(e,t);return{key:e,value:{config:{},me:o,configAsRaw:E({}),initialConfig:{},state:tn}}},my=(e,t)=>{t.ignore||(Kn(e.element),t.onFocus(e))};var K1=Object.freeze({__proto__:null,focus:my,blur:(e,t)=>{t.ignore||(o=>{o.dom.blur()})(e.element)},isFocused:e=>mb(e.element)}),Y1=Object.freeze({__proto__:null,exhibit:(e,t)=>{const o=t.ignore?{}:{attributes:{tabindex:"-1"}};return on(o)},events:e=>Re([B(Sr(),(t,o)=>{my(t,e),o.stop()})].concat(e.stopMousedown?[B(Po(),(t,o)=>{o.event.prevent()})]:[]))}),J1=[me("onFocus"),T("stopMousedown",!1),T("ignore",!1)];const te=bt({fields:J1,name:"focusing",active:Y1,apis:K1}),vi=(e,t,o,n)=>{const r=o.get();o.set(n),((s,a,i)=>{a.toggleClass.each(l=>{i.get()?ct(s.element,l):Ze(s.element,l)})})(e,t,o),((s,a,i)=>{const l=a.aria;l.update(s,l,i.get())})(e,t,o),r!==n&&t.onToggled(e,n)},gy=(e,t,o)=>{vi(e,t,o,!o.get())},py=(e,t,o)=>{vi(e,t,o,t.selected)};var Z1=Object.freeze({__proto__:null,onLoad:py,toggle:gy,isOn:(e,t,o)=>o.get(),on:(e,t,o)=>{vi(e,t,o,!0)},off:(e,t,o)=>{vi(e,t,o,!1)},set:vi}),Q1=Object.freeze({__proto__:null,exhibit:()=>on({}),events:(e,t)=>{const o=(n=e,r=t,s=gy,qn(i=>{s(i,n,r)}));var n,r,s;const a=Mu(e,t,py);return Re(xt([e.toggleOnExecute?[o]:[],[a]]))}});const hy=(e,t,o)=>{ie(e.element,"aria-expanded",o)};var eE=[T("selected",!1),Se("toggleClass"),T("toggleOnExecute",!0),me("onToggled"),Ao("aria",{mode:"none"},mo("mode",{pressed:[T("syncWithExpanded",!1),Ne("update",(e,t,o)=>{ie(e.element,"aria-pressed",o),t.syncWithExpanded&&hy(e,0,o)})],checked:[Ne("update",(e,t,o)=>{ie(e.element,"aria-checked",o)})],expanded:[Ne("update",hy)],selected:[Ne("update",(e,t,o)=>{ie(e.element,"aria-selected",o)})],none:[Ne("update",H)]}))];const he=bt({fields:eE,name:"toggling",active:Q1,apis:Z1,state:{init:()=>{const e=Z(!1);return{get:()=>e.get(),set:t=>e.set(t),clear:()=>e.set(!1),readState:()=>e.get()}}}}),fy=()=>{const e=(t,o)=>{o.stop(),ts(t)};return[B(oi(),e),B(si(),e),os($n()),os(Po())]},gc=e=>Re(xt([e.map(t=>qn((o,n)=>{t(o),n.stop()})).toArray(),fy()])),by="alloy.item-hover",vy="alloy.item-focus",yy="alloy.item-toggled",xy=e=>{(sn(e.element).isNone()||te.isFocused(e))&&(te.isFocused(e)||te.focus(e),Y(e,by,{item:e}))},wy=e=>{Y(e,vy,{item:e})},Sy=E(by),tE=E(vy),oE=E(yy),nE=e=>e.toggling.map(t=>t.exclusive?"menuitemradio":"menuitemcheckbox").getOr("menuitem"),rE=[M("data"),M("components"),M("dom"),T("hasSubmenu",!1),Se("toggling"),Qs("itemBehaviours",[he,te,$,V]),T("ignoreFocus",!1),T("domModification",{}),Ne("builder",e=>({dom:e.dom,domModification:k(k({},e.domModification),{attributes:k(k(k({role:nE(e)},e.domModification.attributes),{"aria-haspopup":e.hasSubmenu}),e.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:ea(e.itemBehaviours,[e.toggling.fold(he.revoke,t=>he.config((o=>k(k({aria:{mode:"checked"}},mh(o,(n,r)=>r!=="exclusive")),{onToggled:(n,r)=>{ko(o.onToggled)&&o.onToggled(n,r),((s,a)=>{Y(s,yy,{item:s,state:a})})(n,r)}}))(t))),te.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:t=>{wy(t)}}),$.config({mode:"execution"}),V.config({store:{mode:"memory",initialValue:e.data}}),le("item-type-events",[...fy(),B(xr(),xy),B(ri(),te.focus)])]),components:e.components,eventOrder:e.eventOrder})),T("eventOrder",{})],sE=[M("dom"),M("components"),Ne("builder",e=>({dom:e.dom,components:e.components,events:Re([m_(ri())])}))],fm=E("item-widget"),bm=E([Dt({name:"widget",overrides:e=>({behaviours:I([V.config({store:{mode:"manual",getValue:t=>e.data,setValue:H}})])})})]),aE=[M("uid"),M("data"),M("components"),M("dom"),T("autofocus",!1),T("ignoreFocus",!1),Qs("widgetBehaviours",[V,te,$]),T("domModification",{}),rm(bm()),Ne("builder",e=>{const t=tm(fm(),e,bm()),o=om(fm(),e,t.internals()),n=s=>Ee(s,e,"widget").map(a=>($.focusIn(a),a)),r=(s,a)=>(ta(a.event.target)||e.autofocus&&a.setSource(s.element),g.none());return{dom:e.dom,components:o,domModification:e.domModification,events:Re([qn((s,a)=>{n(s).each(i=>{a.stop()})}),B(xr(),xy),B(ri(),(s,a)=>{e.autofocus?n(s):te.focus(s)})]),behaviours:ea(e.widgetBehaviours,[V.config({store:{mode:"memory",initialValue:e.data}}),te.config({ignore:e.ignoreFocus,onFocus:s=>{wy(s)}}),$.config({mode:"special",focusIn:e.autofocus?s=>{n(s)}:U_(),onLeft:r,onRight:r,onEscape:(s,a)=>te.isFocused(s)||e.autofocus?(e.autofocus&&a.setSource(s.element),g.none()):(te.focus(s),g.some(!0))})])}})],iE=mo("type",{widget:aE,item:rE,separator:sE}),lE=E([oc({factory:{sketch:e=>{const t=Kt("menu.spec item",iE,e);return t.builder(t)}},name:"items",unit:"item",defaults:(e,t)=>Te(t,"uid")?t:k(k({},t),{uid:$s("item")}),overrides:(e,t)=>({type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}})})]),cE=E([M("value"),M("items"),M("dom"),M("components"),T("eventOrder",{}),mt("menuBehaviours",[be,V,de,$]),Ao("movement",{mode:"menu",moveOnTab:!0},mo("mode",{grid:[Jf(),Ne("config",(e,t)=>({mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}))],matrix:[Ne("config",(e,t)=>({mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},previousSelector:t.previousSelector,focusManager:e.focusManager})),M("rowSelector"),T("previousSelector",g.none)],menu:[T("moveOnTab",!0),Ne("config",(e,t)=>({mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}))]})),go("markers",R_()),T("fakeFocus",!1),T("focusManager",dm()),me("onHighlight"),me("onDehighlight")]),ky=E("alloy.menu-focus"),ds=Vt({name:"Menu",configFields:cE(),partFields:lE(),factory:(e,t,o,n)=>({uid:e.uid,dom:e.dom,markers:e.markers,behaviours:vt(e.menuBehaviours,[be.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight,onDehighlight:e.onDehighlight}),V.config({store:{mode:"memory",initialValue:e.value}}),de.config({find:g.some}),$.config(e.movement.config(e,e.movement))]),events:Re([B(tE(),(r,s)=>{const a=s.event;r.getSystem().getByDom(a.target).each(i=>{be.highlight(r,i),s.stop(),Y(r,ky(),{menu:r,item:i})})}),B(Sy(),(r,s)=>{const a=s.event.item;be.highlight(r,a)}),B(oE(),(r,s)=>{const{item:a,state:i}=s.event;i&&Tt(a.element,"role")==="menuitemradio"&&((l,c)=>{const u=Ut(l.element,'[role="menuitemradio"][aria-checked="true"]');q(u,d=>{Le(d,c.element)||l.getSystem().getByDom(d).each(m=>{he.off(m)})})})(r,a)})]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}})}),Cy=(e,t,o,n)=>K(o,n).bind(r=>K(e,r).bind(s=>{const a=Cy(e,t,o,s);return g.some([s].concat(a))})).getOr([]),Oy=e=>e.type==="prepared"?g.some(e.menu):g.none(),dE=()=>{const e=Z({}),t=Z({}),o=Z({}),n=ze(),r=Z({}),s=l=>a(l).bind(Oy),a=l=>K(t.get(),l),i=l=>K(e.get(),l);return{setMenuBuilt:(l,c)=>{t.set(k(k({},t.get()),{[l]:{type:"prepared",menu:c}}))},setContents:(l,c,u,d)=>{n.set(l),e.set(u),t.set(c),r.set(d);const m=((p,h)=>{const f={};It(p,(b,w)=>{q(b,S=>{f[S]=w})});const v=h,y=dh(h,(b,w)=>({k:b,v:w})),x=ft(y,(b,w)=>[w].concat(Cy(f,v,y,w)));return ft(f,b=>K(x,b).getOr([b]))})(d,u);o.set(m)},expand:l=>K(e.get(),l).map(c=>{const u=K(o.get(),l).getOr([]);return[c].concat(u)}),refresh:l=>K(o.get(),l),collapse:l=>K(o.get(),l).bind(c=>c.length>1?g.some(c.slice(1)):g.none()),lookupMenu:a,lookupItem:i,otherMenus:l=>{const c=r.get();return Ur(rt(c),l)},getPrimary:()=>n.get().bind(s),getMenus:()=>t.get(),clear:()=>{e.set({}),t.set({}),o.set({}),n.clear()},isClear:()=>n.get().isNone(),getTriggeringPath:(l,c)=>{const u=He(i(l).toArray(),d=>s(d).isSome());return K(o.get(),l).bind(d=>{const m=Ha(u.concat(d));return(p=>{const h=[];for(let f=0;f<p.length;f++){const v=p[f];if(!v.isSome())return g.none();h.push(v.getOrDie())}return g.some(h)})(nt(m,(p,h)=>((f,v,y)=>s(f).bind(x=>(b=>Td(e.get(),(w,S)=>w===b))(f).bind(b=>v(b).map(w=>({triggeredMenu:x,triggeringItem:w,triggeringPath:y})))))(p,c,m.slice(0,h+1)).fold(()=>Jo(n.get(),p)?[]:[g.none()],f=>[g.some(f)])))})}}},uE=Oy,_y=j("tiered-menu-item-highlight"),Ty=j("tiered-menu-item-dehighlight");var jt;(function(e){e[e.HighlightMenuAndItem=0]="HighlightMenuAndItem",e[e.HighlightJustMenu=1]="HighlightJustMenu",e[e.HighlightNone=2]="HighlightNone"})(jt||(jt={}));const mE=E("collapse-item"),us=xo({name:"TieredMenu",configFields:[xu("onExecute"),xu("onEscape"),is("onOpenMenu"),is("onOpenSubmenu"),me("onRepositionMenu"),me("onCollapseMenu"),T("highlightOnOpen",jt.HighlightMenuAndItem),yr("data",[M("primary"),M("menus"),M("expansions")]),T("fakeFocus",!1),me("onHighlightItem"),me("onDehighlightItem"),me("onHover"),Hl(),M("dom"),T("navigateOnHover",!0),T("stayInDom",!1),mt("tmenuBehaviours",[$,be,de,re]),T("eventOrder",{})],apis:{collapseMenu:(e,t)=>{e.collapseMenu(t)},highlightPrimary:(e,t)=>{e.highlightPrimary(t)},repositionMenus:(e,t)=>{e.repositionMenus(t)}},factory:(e,t)=>{const o=ze(),n=dE(),r=b=>V.getValue(b).value,s=b=>ft(e.data.menus,(w,S)=>nt(w.items,C=>C.type==="separator"?[]:[C.data.value])),a=be.highlight,i=(b,w)=>{a(b,w),be.getHighlighted(w).orThunk(()=>be.getFirst(w)).each(S=>{e.fakeFocus?be.highlight(w,S):au(b,S.element,ri())})},l=(b,w)=>Wr(N(w,S=>b.lookupMenu(S).bind(C=>C.type==="prepared"?g.some(C.menu):g.none()))),c=(b,w,S)=>{const C=l(w,w.otherMenus(S));q(C,O=>{nn(O.element,[e.markers.backgroundMenu]),e.stayInDom||re.remove(b,O)})},u=(b,w)=>{const S=(C=>o.get().getOrThunk(()=>{const O={},A=Ut(C.element,`.${e.markers.item}`),F=He(A,D=>Tt(D,"aria-haspopup")==="true");return q(F,D=>{C.getSystem().getByDom(D).each(R=>{const L=r(R);O[L]=R})}),o.set(O),O}))(b);It(S,(C,O)=>{const A=ht(w,O);ie(C.element,"aria-expanded",A)})},d=(b,w,S)=>g.from(S[0]).bind(C=>w.lookupMenu(C).bind(O=>{if(O.type==="notbuilt")return g.none();{const A=O.menu,F=l(w,S.slice(1));return q(F,D=>{ct(D.element,e.markers.backgroundMenu)}),Ho(A.element)||re.append(b,Uo(A)),nn(A.element,[e.markers.backgroundMenu]),i(b,A),c(b,w,S),g.some(A)}}));let m;(function(b){b[b.HighlightSubmenu=0]="HighlightSubmenu",b[b.HighlightParent=1]="HighlightParent"})(m||(m={}));const p=(b,w,S=m.HighlightSubmenu)=>{if(w.hasConfigured(Q)&&Q.isDisabled(w))return g.some(w);{const C=r(w);return n.expand(C).bind(O=>(u(b,O),g.from(O[0]).bind(A=>n.lookupMenu(A).bind(F=>{const D=((R,L,P)=>{if(P.type==="notbuilt"){const z=R.getSystem().build(P.nbMenu());return n.setMenuBuilt(L,z),z}return P.menu})(b,A,F);return Ho(D.element)||re.append(b,Uo(D)),e.onOpenSubmenu(b,w,D,Ha(O)),S===m.HighlightSubmenu?(be.highlightFirst(D),d(b,n,O)):(be.dehighlightAll(D),g.some(w))}))))}},h=(b,w)=>{const S=r(w);return n.collapse(S).bind(C=>(u(b,C),d(b,n,C).map(O=>(e.onCollapseMenu(b,w,O),O))))},f=b=>(w,S)=>rn(S.getSource(),`.${e.markers.item}`).bind(C=>w.getSystem().getByDom(C).toOptional().bind(O=>b(w,O).map(pt))),v=Re([B(ky(),(b,w)=>{const S=w.event.item;n.lookupItem(r(S)).each(()=>{const C=w.event.menu;be.highlight(b,C);const O=r(w.event.item);n.refresh(O).each(A=>c(b,n,A))})}),qn((b,w)=>{const S=w.event.target;b.getSystem().getByDom(S).each(C=>{r(C).indexOf("collapse-item")===0&&h(b,C),p(b,C,m.HighlightSubmenu).fold(()=>{e.onExecute(b,C)},H)})}),Ge((b,w)=>{(S=>{const C=((A,F,D)=>ft(D,(R,L)=>{const P=()=>ds.sketch(k(k({},R),{value:L,markers:e.markers,fakeFocus:e.fakeFocus,onHighlight:(z,oe)=>{Y(z,_y,{menuComp:z,itemComp:oe})},onDehighlight:(z,oe)=>{Y(z,Ty,{menuComp:z,itemComp:oe})},focusManager:e.fakeFocus?i1():dm()}));return L===F?{type:"prepared",menu:A.getSystem().build(P())}:{type:"notbuilt",nbMenu:P}}))(S,e.data.primary,e.data.menus),O=s();return n.setContents(e.data.primary,C,e.data.expansions,O),n.getPrimary()})(b).each(S=>{re.append(b,Uo(S)),e.onOpenMenu(b,S),e.highlightOnOpen===jt.HighlightMenuAndItem?i(b,S):e.highlightOnOpen===jt.HighlightJustMenu&&a(b,S)})}),B(_y,(b,w)=>{e.onHighlightItem(b,w.event.menuComp,w.event.itemComp)}),B(Ty,(b,w)=>{e.onDehighlightItem(b,w.event.menuComp,w.event.itemComp)}),...e.navigateOnHover?[B(Sy(),(b,w)=>{const S=w.event.item;((C,O)=>{const A=r(O);n.refresh(A).bind(F=>(u(C,F),d(C,n,F)))})(b,S),p(b,S,m.HighlightParent),e.onHover(b,S)})]:[]]),y=b=>be.getHighlighted(b).bind(be.getHighlighted),x={collapseMenu:b=>{y(b).each(w=>{h(b,w)})},highlightPrimary:b=>{n.getPrimary().each(w=>{i(b,w)})},repositionMenus:b=>{n.getPrimary().bind(S=>y(b).bind(C=>{const O=r(C),A=Ed(n.getMenus()),F=Wr(N(A,uE));return n.getTriggeringPath(O,D=>((R,L,P)=>yn(L,z=>{if(!z.getSystem().isConnected())return g.none();const oe=be.getCandidates(z);return Ke(oe,W=>r(W)===P)}))(0,F,D))}).map(C=>({primary:S,triggeringPath:C}))).fold(()=>{(S=>g.from(S.components()[0]).filter(C=>Tt(C.element,"role")==="menu"))(b).each(S=>{e.onRepositionMenu(b,S,[])})},({primary:S,triggeringPath:C})=>{e.onRepositionMenu(b,S,C)})}};return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:vt(e.tmenuBehaviours,[$.config({mode:"special",onRight:f((b,w)=>ta(w.element)?g.none():p(b,w,m.HighlightSubmenu)),onLeft:f((b,w)=>ta(w.element)?g.none():h(b,w)),onEscape:f((b,w)=>h(b,w).orThunk(()=>e.onEscape(b,w).map(()=>b))),focusIn:(b,w)=>{n.getPrimary().each(S=>{au(b,S.element,ri())})}}),be.config({highlightClass:e.markers.selectedMenu,itemClass:e.markers.menu}),de.config({find:b=>be.getHighlighted(b)}),re.config({})]),eventOrder:e.eventOrder,apis:x,events:v}},extraApis:{tieredData:(e,t,o)=>({primary:e,menus:t,expansions:o}),singleData:(e,t)=>({primary:e,menus:Jr(e,t),expansions:{}}),collapseItem:e=>({value:j(mE()),meta:{text:e}})}}),$e=xo({name:"InlineView",configFields:[M("lazySink"),me("onShow"),me("onHide"),Tl("onEscape"),mt("inlineBehaviours",[ge,V,Wo]),po("fireDismissalEventInstead",[T("event",Us())]),po("fireRepositionEventInstead",[T("event",kf())]),T("getRelated",g.none),T("isExtraPart",Ve),T("eventOrder",g.none)],factory:(e,t)=>{const o=(i,l,c,u)=>{n(i,l,c,()=>u.map(d=>Qt(d)))},n=(i,l,c,u)=>{const d=e.lazySink(i).getOrDie();ge.openWhileCloaked(i,l,()=>Wt.positionWithinBounds(d,i,c,u())),V.setValue(i,g.some({mode:"position",config:c,getBounds:u}))},r=(i,l,c,u)=>{const d=((m,p,h,f,v)=>{const y=()=>m.lazySink(p),x=f.type==="horizontal"?{layouts:{onLtr:()=>Eu(),onRtl:()=>Au()}}:{},b=w=>(S=>S.length===2)(w)?x:{};return us.sketch({dom:{tag:"div"},data:f.data,markers:f.menu.markers,highlightOnOpen:f.menu.highlightOnOpen,fakeFocus:f.menu.fakeFocus,onEscape:()=>(ge.close(p),m.onEscape.map(w=>w(p)),g.some(!0)),onExecute:()=>g.some(!0),onOpenMenu:(w,S)=>{Wt.positionWithinBounds(y().getOrDie(),S,h,v())},onOpenSubmenu:(w,S,C,O)=>{const A=y().getOrDie();Wt.position(A,C,{anchor:k({type:"submenu",item:S},b(O))})},onRepositionMenu:(w,S,C)=>{const O=y().getOrDie();Wt.positionWithinBounds(O,S,h,v()),q(C,A=>{const F=b(A.triggeringPath);Wt.position(O,A.triggeredMenu,{anchor:k({type:"submenu",item:A.triggeringItem},F)})})}})})(e,i,l,c,u);ge.open(i,d),V.setValue(i,g.some({mode:"menu",menu:d}))},s=i=>{ge.isOpen(i)&&V.getValue(i).each(l=>{switch(l.mode){case"menu":ge.getState(i).each(us.repositionMenus);break;case"position":const c=e.lazySink(i).getOrDie();Wt.positionWithinBounds(c,i,l.config,l.getBounds())}})},a={setContent:(i,l)=>{ge.setContent(i,l)},showAt:(i,l,c)=>{o(i,l,c,g.none())},showWithin:o,showWithinBounds:n,showMenuAt:(i,l,c)=>{r(i,l,c,g.none)},showMenuWithinBounds:r,hide:i=>{ge.isOpen(i)&&(V.setValue(i,g.none()),ge.close(i))},getContent:i=>ge.getState(i),reposition:s,isOpen:ge.isOpen};return{uid:e.uid,dom:e.dom,behaviours:vt(e.inlineBehaviours,[ge.config({isPartOf:(i,l,c)=>ss(l,c)||((u,d)=>e.getRelated(u).exists(m=>ss(m,d)))(i,c),getAttachPoint:i=>e.lazySink(i).getOrDie(),onOpen:i=>{e.onShow(i)},onClose:i=>{e.onHide(i)}}),V.config({store:{mode:"memory",initialValue:g.none()}}),Wo.config({channels:k(k({},ju(k({isExtraPart:t.isExtraPart},e.fireDismissalEventInstead.map(i=>({fireEventInstead:{event:i.event}})).getOr({})))),Gu(k(k({},e.fireRepositionEventInstead.map(i=>({fireEventInstead:{event:i.event}})).getOr({})),{doReposition:s})))})]),eventOrder:e.eventOrder,apis:a}},apis:{showAt:(e,t,o,n)=>{e.showAt(t,o,n)},showWithin:(e,t,o,n,r)=>{e.showWithin(t,o,n,r)},showWithinBounds:(e,t,o,n,r)=>{e.showWithinBounds(t,o,n,r)},showMenuAt:(e,t,o,n)=>{e.showMenuAt(t,o,n)},showMenuWithinBounds:(e,t,o,n,r)=>{e.showMenuWithinBounds(t,o,n,r)},hide:(e,t)=>{e.hide(t)},isOpen:(e,t)=>e.isOpen(t),getContent:(e,t)=>e.getContent(t),setContent:(e,t,o)=>{e.setContent(t,o)},reposition:(e,t)=>{e.reposition(t)}}});var pc=tinymce.util.Tools.resolve("tinymce.util.Delay");const Zt=xo({name:"Button",factory:e=>{const t=gc(e.action),o=e.dom.tag,n=r=>K(e.dom,"attributes").bind(s=>K(s,r));return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:ea(e.buttonBehaviours,[te.config({}),$.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:o==="button"?k({type:n("type").getOr("button")},n("role").map(r=>({role:r})).getOr({})):{role:n("role").getOr("button")}},eventOrder:e.eventOrder}},configFields:[T("uid",void 0),M("dom"),T("components",[]),Qs("buttonBehaviours",[te,$]),Se("action"),Se("role"),T("eventOrder",{})]}),De=e=>{const t=(o=>o.uid!==void 0)(e)&&Vo(e,"uid")?e.uid:$s("memento");return{get:o=>o.getSystem().getByUid(t).getOrDie(),getOpt:o=>o.getSystem().getByUid(t).toOptional(),asSpec:()=>k(k({},e),{uid:t})}};var cn=tinymce.util.Tools.resolve("tinymce.util.I18n");const gE={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},Ey="temporary-placeholder",vm=e=>()=>K(e,Ey).getOr("!not found!"),ym=(e,t)=>{const o=e.toLowerCase();if(cn.isRtl()){const n=((r,s)=>gl(r,s)?r:((a,i)=>a+"-rtl")(r))(o,"-rtl");return Te(t,n)?n:o}return o},Ay=(e,t)=>K(t,ym(e,t)),My=(e,t)=>{const o=t();return Ay(e,o).getOrThunk(vm(o))},xm=()=>le("add-focusable",[Ge(e=>{B_(e.element,"svg").each(t=>ie(t,"focusable","false"))})]),Dy=(e,t,o,n)=>{var r,s;const a=(l=>!!cn.isRtl()&&Te(gE,l))(t)?["tox-icon--flip"]:[],i=K(o,ym(t,o)).or(n).getOrThunk(vm(o));return{dom:{tag:e.tag,attributes:(r=e.attributes)!==null&&r!==void 0?r:{},classes:e.classes.concat(a),innerHtml:i},behaviours:I([...(s=e.behaviours)!==null&&s!==void 0?s:[],xm()])}},dn=(e,t,o,n=g.none())=>Dy(t,e,o(),n),pE={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},wm=xo({name:"Notification",factory:e=>{const t=De({dom:{tag:"p",innerHtml:e.translationProvider(e.text)},behaviours:I([re.config({})])}),o=u=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:`${u}%`}}}),n=u=>({dom:{tag:"div",classes:["tox-text"],innerHtml:`${u}%`}}),r=De({dom:{tag:"div",classes:e.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(0)]},n(0)],behaviours:I([re.config({})])}),s={updateProgress:(u,d)=>{u.getSystem().isConnected()&&r.getOpt(u).each(m=>{re.set(m,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(d)]},n(d)])})},updateText:(u,d)=>{if(u.getSystem().isConnected()){const m=t.get(u);re.set(m,[dt(d)])}}},a=xt([e.icon.toArray(),e.level.toArray(),e.level.bind(u=>g.from(pE[u])).toArray()]),i=De(Zt.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[dn("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":e.translationProvider("Close")}},e.iconProvider)],action:u=>{e.onAction(u)}})),l=((u,d,m)=>{const p=m(),h=Ke(u,f=>Te(p,ym(f,p)));return Dy({tag:"div",classes:["tox-notification__icon"]},h.getOr(Ey),p,g.none())})(a,0,e.iconProvider),c=[l,{dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:I([re.config({})])}];return{uid:e.uid,dom:{tag:"div",attributes:{role:"alert"},classes:e.level.map(u=>["tox-notification","tox-notification--in",`tox-notification--${u}`]).getOr(["tox-notification","tox-notification--in"])},behaviours:I([te.config({}),le("notification-events",[B(wr(),u=>{i.getOpt(u).each(te.focus)})])]),components:c.concat(e.progress?[r.asSpec()]:[]).concat(e.closeButton?[i.asSpec()]:[]),apis:s}},configFields:[Se("level"),M("progress"),Se("icon"),M("onAction"),M("text"),M("iconProvider"),M("translationProvider"),ho("closeButton",!0)],apis:{updateProgress:(e,t,o)=>{e.updateProgress(t,o)},updateText:(e,t,o)=>{e.updateText(t,o)}}});var Fo,yi,xi=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),hE=tinymce.util.Tools.resolve("tinymce.EditorManager"),sa=tinymce.util.Tools.resolve("tinymce.Env");(function(e){e.default="wrap",e.floating="floating",e.sliding="sliding",e.scrolling="scrolling"})(Fo||(Fo={})),function(e){e.auto="auto",e.top="top",e.bottom="bottom"}(yi||(yi={}));const Be=e=>t=>t.options.get(e),wi=e=>t=>g.from(e(t)),By=e=>{const t=sa.deviceType.isPhone(),o=sa.deviceType.isTablet()||t,n=e.options.register,r=a=>_e(a)||a===!1,s=a=>_e(a)||hr(a);n("skin",{processor:a=>_e(a)||a===!1,default:"oxide"}),n("skin_url",{processor:"string"}),n("height",{processor:s,default:Math.max(e.getElement().offsetHeight,400)}),n("width",{processor:s,default:xi.DOM.getStyle(e.getElement(),"width")}),n("min_height",{processor:"number",default:100}),n("min_width",{processor:"number"}),n("max_height",{processor:"number"}),n("max_width",{processor:"number"}),n("style_formats",{processor:"object[]"}),n("style_formats_merge",{processor:"boolean",default:!1}),n("style_formats_autohide",{processor:"boolean",default:!1}),n("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),n("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),n("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),n("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),n("content_langs",{processor:"object[]"}),n("removed_menuitems",{processor:"string",default:""}),n("menubar",{processor:a=>_e(a)||Nn(a),default:!t}),n("menu",{processor:"object",default:{}}),n("toolbar",{processor:a=>Nn(a)||_e(a)||pr(a)?{value:a,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),Cd(9,a=>{n("toolbar"+(a+1),{processor:"string"})}),n("toolbar_mode",{processor:"string",default:o?"scrolling":"floating"}),n("toolbar_groups",{processor:"object",default:{}}),n("toolbar_location",{processor:"string",default:yi.auto}),n("toolbar_persist",{processor:"boolean",default:!1}),n("toolbar_sticky",{processor:"boolean",default:e.inline}),n("toolbar_sticky_offset",{processor:"number",default:0}),n("fixed_toolbar_container",{processor:"string",default:""}),n("fixed_toolbar_container_target",{processor:"object"}),n("file_picker_callback",{processor:"function"}),n("file_picker_validator_handler",{processor:"function"}),n("file_picker_types",{processor:"string"}),n("typeahead_urls",{processor:"boolean",default:!0}),n("anchor_top",{processor:r,default:"#top"}),n("anchor_bottom",{processor:r,default:"#bottom"}),n("draggable_modal",{processor:"boolean",default:!1}),n("statusbar",{processor:"boolean",default:!0}),n("elementpath",{processor:"boolean",default:!0}),n("branding",{processor:"boolean",default:!0}),n("promotion",{processor:"boolean",default:!0}),n("resize",{processor:a=>a==="both"||Nn(a),default:!sa.deviceType.isTouch()}),n("sidebar_show",{processor:"string"})},Fy=Be("readonly"),Sm=Be("height"),km=Be("width"),Cm=wi(Be("min_width")),Om=wi(Be("min_height")),hc=wi(Be("max_width")),_m=wi(Be("max_height")),Iy=wi(Be("style_formats")),Ry=Be("style_formats_merge"),Ny=Be("style_formats_autohide"),Vy=Be("content_langs"),Hy=Be("removed_menuitems"),aa=Be("toolbar_mode"),zy=Be("toolbar_groups"),Tm=Be("toolbar_location"),fE=Be("fixed_toolbar_container"),bE=Be("fixed_toolbar_container_target"),Ly=Be("toolbar_persist"),Py=Be("toolbar_sticky_offset"),Uy=Be("menubar"),fc=Be("toolbar"),Wy=Be("file_picker_callback"),jy=Be("file_picker_validator_handler"),Gy=Be("file_picker_types"),$y=Be("typeahead_urls"),qy=Be("anchor_top"),Xy=Be("anchor_bottom"),Ky=Be("draggable_modal"),Yy=Be("statusbar"),Jy=Be("elementpath"),vE=Be("branding"),Zy=Be("resize"),Qy=Be("paste_as_text"),ex=Be("sidebar_show"),tx=Be("promotion"),Em=e=>e.options.get("skin")===!1,bc=e=>e.options.get("menubar")!==!1,ox=e=>{const t=e.options.get("skin_url");if(Em(e))return t;if(t)return e.documentBaseURI.toAbsolute(t);{const o=e.options.get("skin");return hE.baseURL+"/skins/ui/"+o}},nx=e=>e.options.get("line_height_formats").split(" "),vc=e=>{const t=fc(e),o=_e(t),n=pr(t)&&t.length>0;return!Si(e)&&(n||o||t===!0)},Am=e=>{const t=Cd(9,n=>e.options.get("toolbar"+(n+1))),o=He(t,_e);return za(o.length>0,o)},Si=e=>Am(e).fold(()=>{const t=fc(e);return Na(t,_e)&&t.length>0},pt),Mm=e=>Tm(e)===yi.bottom,rx=e=>{var t;if(!e.inline)return g.none();const o=(t=fE(e))!==null&&t!==void 0?t:"";if(o.length>0)return ut(Ln(),o);const n=bE(e);return No(n)?g.some(U(n)):g.none()},ki=e=>e.inline&&rx(e).isSome(),Dm=e=>rx(e).getOrThunk(()=>vl(_o(U(e.getElement())))),Bm=e=>e.inline&&!bc(e)&&!vc(e)&&!Si(e),Ci=e=>(e.options.get("toolbar_sticky")||e.inline)&&!ki(e)&&!Bm(e),sx=e=>{const t=e.options.get("menu");return ft(t,o=>k(k({},o),{items:o.items}))};var yE=Object.freeze({__proto__:null,get ToolbarMode(){return Fo},get ToolbarLocation(){return yi},register:By,getSkinUrl:ox,isReadOnly:Fy,isSkinDisabled:Em,getHeightOption:Sm,getWidthOption:km,getMinWidthOption:Cm,getMinHeightOption:Om,getMaxWidthOption:hc,getMaxHeightOption:_m,getUserStyleFormats:Iy,shouldMergeStyleFormats:Ry,shouldAutoHideStyleFormats:Ny,getLineHeightFormats:nx,getContentLanguages:Vy,getRemovedMenuItems:Hy,isMenubarEnabled:bc,isMultipleToolbars:Si,isToolbarEnabled:vc,isToolbarPersist:Ly,getMultipleToolbarsOption:Am,getUiContainer:Dm,useFixedContainer:ki,getToolbarMode:aa,isDraggableModal:Ky,isDistractionFree:Bm,isStickyToolbar:Ci,getStickyToolbarOffset:Py,getToolbarLocation:Tm,isToolbarLocationBottom:Mm,getToolbarGroups:zy,getMenus:sx,getMenubar:Uy,getToolbar:fc,getFilePickerCallback:Wy,getFilePickerTypes:Gy,useTypeaheadUrls:$y,getAnchorTop:qy,getAnchorBottom:Xy,getFilePickerValidatorHandler:jy,useStatusBar:Yy,useElementPath:Jy,promotionEnabled:tx,useBranding:vE,getResize:Zy,getPasteAsText:Qy,getSidebarShow:ex});const ax="[data-mce-autocompleter]",ix=e=>rn(e,ax);var Fm;(function(e){e[e.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",e[e.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"})(Fm||(Fm={}));var un=Fm;const Im="tox-menu-nav__js",yc="tox-collection__item",xE={normal:Im,color:"tox-swatch"},lx="tox-collection__item--enabled",cx="tox-collection__item-icon",Rm="tox-collection__item-label",dx="tox-collection__item-caret",Oi="tox-collection__item--active",ux="tox-collection__item-container",mx="tox-collection__item-container--row",gx=e=>K(xE,e).getOr(Im),wE=e=>e==="color"?"tox-swatches":"tox-menu",Nm=e=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:wE(e),tieredMenu:"tox-tiered-menu"}),ms=e=>{const t=Nm(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:gx(e)}},SE=(e,t,o)=>{const n=Nm(o);return{tag:"div",classes:xt([[n.menu,`tox-menu-${t}-column`],e?[n.hasIcons]:[]])}},kE=[ds.parts.items({})],xc=(e,t,o)=>{const n=Nm(o);return{dom:{tag:"div",classes:xt([[n.tieredMenu]])},markers:ms(o)}},px=E([Se("data"),T("inputAttributes",{}),T("inputStyles",{}),T("tag","input"),T("inputClasses",[]),me("onSetValue"),T("styles",{}),T("eventOrder",{}),mt("inputBehaviours",[V,te]),T("selectOnFocus",!0)]),hx=e=>I([te.config({onFocus:e.selectOnFocus?t=>{const o=t.element,n=Xn(o);o.dom.setSelectionRange(0,n.length)}:H})]),CE=e=>k(k({},hx(e)),vt(e.inputBehaviours,[V.config({store:k(k({mode:"manual"},e.data.map(t=>({initialValue:t})).getOr({})),{getValue:t=>Xn(t.element),setValue:(t,o)=>{Xn(t.element)!==o&&qs(t.element,o)}}),onSetValue:e.onSetValue})])),fx=e=>({tag:e.tag,attributes:k({type:"text"},e.inputAttributes),styles:e.inputStyles,classes:e.inputClasses}),ia=xo({name:"Input",configFields:px(),factory:(e,t)=>({uid:e.uid,dom:fx(e),components:[],behaviours:CE(e),eventOrder:e.eventOrder})}),bx=j("refetch-trigger-event"),vx=j("redirect-menu-item-interaction"),wc=e=>ut(e.element,".tox-menu__searcher").bind(t=>e.getSystem().getByDom(t).toOptional()),yx=wc,xx=e=>({fetchPattern:V.getValue(e),selectionStart:e.element.dom.selectionStart,selectionEnd:e.element.dom.selectionEnd}),OE=e=>{const t=(r,s)=>(s.cut(),g.none()),o=(r,s)=>{const a={interactionEvent:s.event,eventType:s.event.raw.type};return Y(r,vx,a),g.some(!0)},n="searcher-events";return{dom:{tag:"div",classes:[yc]},components:[ia.sketch({inputClasses:["tox-menu__searcher","tox-textfield"],inputAttributes:k(k({},e.placeholder.map(r=>({placeholder:e.i18n(r)})).getOr({})),{type:"search","aria-autocomplete":"list"}),inputBehaviours:I([le(n,[B(Zr(),r=>{we(r,bx)}),B(ei(),(r,s)=>{s.event.raw.key==="Escape"&&s.stop()})]),$.config({mode:"special",onLeft:t,onRight:t,onSpace:t,onEnter:o,onEscape:o,onUp:o,onDown:o})]),eventOrder:{keydown:[n,$.name()]}})]}},Sc="tox-collection--results__js",wx=e=>{var t;return e.dom?k(k({},e),{dom:k(k({},e.dom),{attributes:k(k({},(t=e.dom.attributes)!==null&&t!==void 0?t:{}),{id:j("aria-item-search-result-id"),"aria-selected":"false"})})}):e},Vm=(e,t)=>o=>{const n=ah(o,t);return N(n,r=>({dom:e,components:r}))},Sx=(e,t)=>{const o=[];let n=[];return q(e,(r,s)=>{t(r,s)?(n.length>0&&o.push(n),n=[],(Te(r.dom,"innerHtml")||r.components&&r.components.length>0)&&n.push(r)):n.push(r)}),n.length>0&&o.push(n),N(o,r=>({dom:{tag:"div",classes:["tox-collection__group"]},components:r}))},Hm=(e,t,o)=>ds.parts.items({preprocess:n=>{const r=N(n,o);return e!=="auto"&&e>1?Vm({tag:"div",classes:["tox-collection__group"]},e)(r):Sx(r,(s,a)=>t[a].type==="separator")}}),kx=(e,t,o=!0)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(e===1?["tox-collection--list"]:["tox-collection--grid"])},components:[Hm(e,t,xe)]}),kc=e=>Yo(e,t=>"icon"in t&&t.icon!==void 0),Qn=e=>(console.error(Hs(e)),console.log(e),g.none()),_E=(e,t,o,n,r)=>{const s=(a=o,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[ds.parts.items({preprocess:i=>Sx(i,(l,c)=>a[c].type==="separator")})]});var a;return{value:e,dom:s.dom,components:s.components,items:o}},zm=(e,t,o,n,r)=>{if(r.menuType==="color"){const s=(a=>({dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[ds.parts.items({preprocess:a!=="auto"?Vm({tag:"div",classes:["tox-swatches__row"]},a):xe})]}]}))(n);return{value:e,dom:s.dom,components:s.components,items:o}}if(r.menuType==="normal"&&n==="auto"){const s=kx(n,o);return{value:e,dom:s.dom,components:s.components,items:o}}if(r.menuType==="normal"||r.menuType==="searchable"){const s=r.menuType!=="searchable"?kx(n,o):r.searchMode.searchMode==="search-with-field"?((a,i,l)=>{const c=j("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(a===1?["tox-collection--list"]:["tox-collection--grid"])},components:[OE({i18n:cn.translate,placeholder:l.placeholder}),{dom:{tag:"div",classes:[...a===1?["tox-collection--list"]:["tox-collection--grid"],Sc],attributes:{id:c}},components:[Hm(a,i,wx)]}]}})(n,o,r.searchMode):((a,i,l=!0)=>{const c=j("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection",Sc].concat(a===1?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:c}},components:[Hm(a,i,wx)]}})(n,o);return{value:e,dom:s.dom,components:s.components,items:o}}if(r.menuType==="listpreview"&&n!=="auto"){const s=(a=>({dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[ds.parts.items({preprocess:Vm({tag:"div",classes:["tox-collection__group"]},a)})]}))(n);return{value:e,dom:s.dom,components:s.components,items:o}}return{value:e,dom:SE(t,n,r.menuType),components:kE,items:o}},Ye=it("type"),Lm=it("name"),Pm=it("label"),er=it("text"),TE=it("title"),Cx=it("icon"),_i=it("value"),EE=Lo("fetch"),AE=Lo("getSubmenuItems"),la=Lo("onAction"),ME=Lo("onItemAction"),gs=lt("onSetup",()=>H),DE=eo("name"),ca=eo("text"),mn=eo("icon"),Cc=eo("tooltip"),Um=eo("label"),BE=eo("shortcut"),FE=Tl("select"),Oc=ho("active",!1),IE=ho("borderless",!1),Go=ho("enabled",!0),_c=ho("primary",!1),Ox=e=>T("columns",e),Wm=T("meta",{}),jm=lt("onAction",H),ps=e=>jn("type",e),Gm=e=>St("name","name",Sl(()=>j(`${e}-name`)),wt),_x=X([Ye,ca]),RE=X([ps("autocompleteitem"),Oc,Go,Wm,_i,ca,mn]),Ti=[Go,Cc,mn,ca,gs],NE=X([Ye,la].concat(Ti)),Tx=e=>Ue("toolbarbutton",NE,e),$m=[Oc].concat(Ti),VE=X($m.concat([Ye,la])),Ex=e=>Ue("ToggleButton",VE,e),Ax=[lt("predicate",Ve),Gn("scope","node",["node","editor"]),Gn("position","selection",["node","selection","line"])],HE=Ti.concat([ps("contextformbutton"),_c,la,zt("original",xe)]),zE=$m.concat([ps("contextformbutton"),_c,la,zt("original",xe)]),LE=Ti.concat([ps("contextformbutton")]),PE=$m.concat([ps("contextformtogglebutton")]),UE=mo("type",{contextformbutton:HE,contextformtogglebutton:zE}),WE=X([ps("contextform"),lt("initValue",E("")),Um,Eo("commands",UE),Wn("launch",mo("type",{contextformbutton:LE,contextformtogglebutton:PE}))].concat(Ax)),jE=X([ps("contexttoolbar"),it("items")].concat(Ax)),GE=[Ye,it("src"),eo("alt"),El("classes",[],wt)],$E=X(GE),qE=[Ye,er,DE,El("classes",["tox-collection__item-label"],wt)],XE=X(qE),Mx=gf(()=>_l("type",{cardimage:$E,cardtext:XE,cardcontainer:KE})),KE=X([Ye,jn("direction","horizontal"),jn("align","left"),jn("valign","middle"),Eo("items",Mx)]),da=[Go,ca,BE,St("value","value",Sl(()=>j("menuitem-value")),Qo()),Wm],YE=X([Ye,Um,Eo("items",Mx),gs,jm].concat(da)),JE=X([Ye,Oc,mn].concat(da)),Dx=[Ye,it("fancytype"),jm],ZE=[T("initData",{})].concat(Dx),QE=[Yd("initData",{},[ho("allowCustomColors",!0),jn("storageKey","default"),vf("colors",Qo())])].concat(Dx),eA=mo("fancytype",{inserttable:ZE,colorswatch:QE}),tA=X([Ye,gs,jm,mn].concat(da)),oA=X([Ye,AE,gs,mn].concat(da)),nA=X([Ye,mn,Oc,gs,la].concat(da)),qm=(e,t,o)=>{const n=Ut(e.element,"."+o);if(n.length>0){const r=Fs(n,s=>{const a=s.dom.getBoundingClientRect().top,i=n[0].dom.getBoundingClientRect().top;return Math.abs(a-i)>t}).getOr(n.length);return g.some({numColumns:r,numRows:Math.ceil(n.length/r)})}return g.none()},Ei=e=>((t,o)=>I([le(t,o)]))(j("unnamed-events"),e),Bx=j("tooltip.exclusive"),Ai=j("tooltip.show"),Mi=j("tooltip.hide"),Fx=(e,t,o)=>{e.getSystem().broadcastOn([Bx],{})};var rA=Object.freeze({__proto__:null,hideAllExclusive:Fx,setComponents:(e,t,o,n)=>{o.getTooltip().each(r=>{r.getSystem().isConnected()&&re.set(r,n)})}}),sA=Object.freeze({__proto__:null,events:(e,t)=>{const o=n=>{t.getTooltip().each(r=>{Zn(r),e.onHide(n,r),t.clearTooltip()}),t.clearTimer()};return Re(xt([[B(Ai,n=>{t.resetTimer(()=>{(r=>{if(!t.isShowing()){Fx(r);const s=e.lazySink(r).getOrDie(),a=r.getSystem().build({dom:e.tooltipDom,components:e.tooltipComponents,events:Re(e.mode==="normal"?[B(xr(),i=>{we(r,Ai)}),B(Zd(),i=>{we(r,Mi)})]:[]),behaviours:I([re.config({})])});t.setTooltip(a),ls(s,a),e.onShow(r,a),Wt.position(s,a,{anchor:e.anchor(r)})}})(n)},e.delay)}),B(Mi,n=>{t.resetTimer(()=>{o(n)},e.delay)}),B(Qr(),(n,r)=>{const s=r;s.universal||ht(s.channels,Bx)&&o(n)}),Cn(n=>{o(n)})],e.mode==="normal"?[B(wr(),n=>{we(n,Ai)}),B(eu(),n=>{we(n,Mi)}),B(xr(),n=>{we(n,Ai)}),B(Zd(),n=>{we(n,Mi)})]:[B(Tf(),(n,r)=>{we(n,Ai)}),B(su(),n=>{we(n,Mi)})]]))}}),aA=[M("lazySink"),M("tooltipDom"),T("exclusive",!0),T("tooltipComponents",[]),T("delay",300),Gn("mode","normal",["normal","follow-highlight"]),T("anchor",e=>({type:"hotspot",hotspot:e,layouts:{onLtr:E([_t,yo,At,Yt,Mt,Jt]),onRtl:E([_t,yo,At,Yt,Mt,Jt])}})),me("onHide"),me("onShow")];const Ix=bt({fields:aA,name:"tooltipping",active:sA,state:Object.freeze({__proto__:null,init:()=>{const e=ze(),t=ze(),o=()=>{e.on(clearTimeout)},n=E("not-implemented");return bo({getTooltip:t.get,isShowing:t.isSet,setTooltip:t.set,clearTooltip:t.clear,clearTimer:o,resetTimer:(r,s)=>{o(),e.set(setTimeout(r,s))},readState:n})}}),apis:rA}),Rx="silver.readonly",iA=X([go("readonly",Xa)]),Tc=(e,t)=>{const o=e.mainUi.outerContainer.element,n=[e.mainUi.mothership,...e.uiMotherships];t&&q(n,r=>{r.broadcastOn([Tr()],{target:o})}),q(n,r=>{r.broadcastOn([Rx],{readonly:t})})},Nx=(e,t)=>{e.on("init",()=>{e.mode.isReadOnly()&&Tc(t,!0)}),e.on("SwitchMode",()=>Tc(t,e.mode.isReadOnly())),Fy(e)&&e.mode.set("readonly")},et=()=>Wo.config({channels:{[Rx]:{schema:iA,onReceive:(e,t)=>{Q.set(e,t.readonly)}}}}),ua=e=>Q.config({disabled:e}),Vx=e=>Q.config({disabled:e,disableClass:"tox-tbtn--disabled"}),Xm=e=>Q.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1}),Ec=(e,t)=>{const o=e.getApi(t);return n=>{n(o)}},Di=(e,t)=>Ge(o=>{Ec(e,o)(n=>{const r=e.onSetup(n);ko(r)&&t.set(r)})}),Bi=(e,t)=>Cn(o=>Ec(e,o)(t.get())),lA=(e,t)=>qn((o,n)=>{Ec(e,o)(e.onAction),e.triggersSubmenu||t!==un.CLOSE_ON_EXECUTE||(o.getSystem().isConnected()&&we(o,Ml()),n.stop())}),cA={[fo()]:["disabling","alloy.base.behaviour","toggling","item-events"]},Fi=Wr,ma=(e,t,o,n)=>{const r=Z(H);return{type:"item",dom:t.dom,components:Fi(t.optComponents),data:e.data,eventOrder:cA,hasSubmenu:e.triggersSubmenu,itemBehaviours:I([le("item-events",[lA(e,o),Di(e,r),Bi(e,r)]),(s=()=>!e.enabled||n.isDisabled(),Q.config({disabled:s,disableClass:"tox-collection__item--state-disabled"})),et(),re.config({})].concat(e.itemBehaviours))};var s},ga=e=>({value:e.value,meta:k({text:e.text.getOr("")},e.meta)}),dA=e=>{const t=sa.os.isMacOS()||sa.os.isiOS(),o=t?{alt:"\u2325",ctrl:"\u2303",shift:"\u21E7",meta:"\u2318",access:"\u2303\u2325"}:{meta:"Ctrl",access:"Shift+Alt"},n=e.split("+"),r=N(n,s=>{const a=s.toLowerCase().trim();return Te(o,a)?o[a]:s});return t?r.join(""):r.join("+")},Km=(e,t,o=[cx])=>dn(e,{tag:"div",classes:o},t),Hx=e=>({dom:{tag:"div",classes:[Rm]},components:[dt(cn.translate(e))]}),zx=(e,t)=>({dom:{tag:"div",classes:t,innerHtml:e}}),uA=(e,t)=>({dom:{tag:"div",classes:[Rm]},components:[{dom:{tag:e.tag,styles:e.styles},components:[dt(cn.translate(t))]}]}),mA=e=>({dom:{tag:"div",classes:["tox-collection__item-accessory"]},components:[dt(dA(e))]}),Lx=e=>Km("checkmark",e,["tox-collection__item-checkmark"]),Px=e=>{const t=e.map(o=>({attributes:{title:cn.translate(o)}})).getOr({});return k({tag:"div",classes:[Im,yc]},t)},Ii=(e,t,o,n=g.none())=>e.presets==="color"?((r,s,a)=>{const i=r.ariaLabel,l=r.value,c=r.iconContent.map(u=>((d,m,p)=>{const h=m();return Ay(d,h).or(p).getOrThunk(vm(h))})(u,s.icons,a));return{dom:(()=>{const u=c.getOr(""),d=i.map(p=>({title:s.translate(p)})).getOr({}),m={tag:"div",attributes:d,classes:["tox-swatch"]};return l==="custom"?k(k({},m),{tag:"button",classes:[...m.classes,"tox-swatches__picker-btn"],innerHtml:u}):l==="remove"?k(k({},m),{classes:[...m.classes,"tox-swatch--remove"],innerHtml:u}):No(l)?k(k({},m),{attributes:k(k({},m.attributes),{"data-mce-color":l}),styles:{"background-color":l},innerHtml:u}):m})(),optComponents:[]}})(e,t,n):((r,s,a,i)=>{const l={tag:"div",classes:[cx]},c=a?r.iconContent.map(p=>dn(p,l,s.icons,i)).orThunk(()=>g.some({dom:l})):g.none(),u=r.checkMark,d=g.from(r.meta).fold(()=>Hx,p=>Te(p,"style")?Co(uA,p.style):Hx),m=r.htmlContent.fold(()=>r.textContent.map(d),p=>g.some(zx(p,[Rm])));return{dom:Px(r.ariaLabel),optComponents:[c,m,r.shortcutContent.map(mA),u,r.caret]}})(e,t,o,n),Ux=(e,t)=>K(e,"tooltipWorker").map(o=>[Ix.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:n=>({type:"submenu",item:n,overrides:{maxHeightFunction:ci}}),mode:"follow-highlight",onShow:(n,r)=>{o(s=>{Ix.setComponents(n,[Uf({element:U(s)})])})}})]).getOr([]),Wx=(e,t)=>{const o=(n=>xi.DOM.encode(n))(cn.translate(e));if(t.length>0){const n=new RegExp((r=>r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))(t),"gi");return o.replace(n,r=>`<span class="tox-autocompleter-highlight">${r}</span>`)}return o},jx=(e,t)=>N(e,o=>{switch(o.type){case"cardcontainer":return((s,a)=>{const i=s.direction==="vertical"?"tox-collection__item-container--column":mx,l=s.align==="left"?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right";return{dom:{tag:"div",classes:[ux,i,l,(()=>{switch(s.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}})()]},components:a}})(o,jx(o.items,t));case"cardimage":return((s,a,i)=>({dom:{tag:"img",classes:a,attributes:{src:s,alt:i.getOr("")}}}))(o.src,o.classes,o.alt);case"cardtext":const n=o.name.exists(s=>ht(t.cardText.highlightOn,s)),r=n?g.from(t.cardText.matchText).getOr(""):"";return zx(Wx(o.text,r),o.classes)}}),Gx=Qu(fm(),bm()),$x=e=>({value:e}),qx=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Xx=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Kx=e=>qx.test(e)||Xx.test(e),gA=e=>{return(t=e,((o,n)=>gh(o,n,0))(t,"#")?((o,n)=>o.substring(n))(t,"#".length):t).toUpperCase();var t},Ym=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},Ri=e=>{const t=Ym(e.red)+Ym(e.green)+Ym(e.blue);return $x(t)},Yx=Math.min,Jx=Math.max,Ac=Math.round,pA=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,hA=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,Ar=(e,t,o,n)=>({red:e,green:t,blue:o,alpha:n}),Jm=e=>{const t=parseInt(e,10);return t.toString()===e&&t>=0&&t<=255},Zx=e=>{let t,o,n;const r=(e.hue||0)%360;let s=e.saturation/100,a=e.value/100;if(s=Jx(0,Yx(s,1)),a=Jx(0,Yx(a,1)),s===0)return t=o=n=Ac(255*a),Ar(t,o,n,1);const i=r/60,l=a*s,c=l*(1-Math.abs(i%2-1)),u=a-l;switch(Math.floor(i)){case 0:t=l,o=c,n=0;break;case 1:t=c,o=l,n=0;break;case 2:t=0,o=l,n=c;break;case 3:t=0,o=c,n=l;break;case 4:t=c,o=0,n=l;break;case 5:t=l,o=0,n=c;break;default:t=o=n=0}return t=Ac(255*(t+u)),o=Ac(255*(o+u)),n=Ac(255*(n+u)),Ar(t,o,n,1)},Ni=e=>{const t=(s=>{const a=(l=>({value:l.value.replace(qx,(u,d,m,p)=>d+d+m+m+p+p)}))(s),i=Xx.exec(a.value);return i===null?["FFFFFF","FF","FF","FF"]:i})(e),o=parseInt(t[1],16),n=parseInt(t[2],16),r=parseInt(t[3],16);return Ar(o,n,r,1)},Qx=(e,t,o,n)=>{const r=parseInt(e,10),s=parseInt(t,10),a=parseInt(o,10),i=parseFloat(n);return Ar(r,s,a,i)},ew=e=>{if(e==="transparent")return g.some(Ar(0,0,0,0));const t=pA.exec(e);if(t!==null)return g.some(Qx(t[1],t[2],t[3],"1"));const o=hA.exec(e);return o!==null?g.some(Qx(o[1],o[2],o[3],o[4])):g.none()},tw=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,ow=Ar(255,0,0,1),Zm=(e,t)=>{e.dispatch("ResizeContent",t)},fA=(e,t)=>e.dispatch("ResolveName",{name:t.nodeName.toLowerCase(),target:t});var hs=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");const nw={},rw=e=>K(nw,e).getOrThunk(()=>{const t=`tinymce-custom-colors-${e}`,o=hs.getItem(t);if(ll(o)){const r=hs.getItem("tinymce-custom-colors");hs.setItem(t,No(r)?r:"[]")}const n=((r,s=10)=>{const a=hs.getItem(r),i=_e(a)?JSON.parse(a):[],l=s-(c=i).length<0?c.slice(0,s):c;var c;const u=d=>{l.splice(d,1)};return{add:d=>{sh(l,d).each(u),l.unshift(d),l.length>s&&l.pop(),hs.setItem(r,JSON.stringify(l))},state:()=>l.slice(0)}})(t,10);return nw[e]=n,n}),sw=(e,t)=>{rw(e).add(t)},Vi=(e,t,o)=>({hue:e,saturation:t,value:o}),Qm=e=>{let t=0,o=0,n=0;const r=e.red/255,s=e.green/255,a=e.blue/255,i=Math.min(r,Math.min(s,a)),l=Math.max(r,Math.max(s,a));return i===l?(n=i,Vi(0,0,100*n)):(t=r===i?3:a===i?1:5,t=60*(t-(r===i?s-a:a===i?r-s:a-r)/(l-i)),o=(l-i)/l,n=l,Vi(Math.round(t),Math.round(100*o),Math.round(100*n)))},aw=e=>Ri(Zx(e)),bA=e=>{return(t=e,Kx(t)?g.some({value:gA(t)}):g.none()).orThunk(()=>ew(e).map(Ri)).getOrThunk(()=>{const o=document.createElement("canvas");o.height=1,o.width=1;const n=o.getContext("2d");n.clearRect(0,0,o.width,o.height),n.fillStyle="#FFFFFF",n.fillStyle=e,n.fillRect(0,0,1,1);const r=n.getImageData(0,0,1,1).data,s=r[0],a=r[1],i=r[2],l=r[3];return Ri(Ar(s,a,i,l))});var t},eg="forecolor",tg="hilitecolor",og=e=>Math.max(5,Math.ceil(Math.sqrt(e))),vA=e=>{const t=[];for(let o=0;o<e.length;o+=2)t.push({text:e[o+1],value:"#"+bA(e[o]).value,icon:"checkmark",type:"choiceitem"});return t},tr=e=>t=>t.options.get(e),ng="#000000",iw=(e,t)=>t===eg?tr("color_cols_foreground")(e):t===tg?tr("color_cols_background")(e):tr("color_cols")(e),lw=tr("custom_colors"),Hi=(e,t)=>t===eg&&e.options.isSet("color_map_foreground")?tr("color_map_foreground")(e):t===tg&&e.options.isSet("color_map_background")?tr("color_map_background")(e):tr("color_map")(e),yA=tr("color_default_foreground"),xA=tr("color_default_background"),cw=(e,t)=>{const o=co(U(e.selection.getStart()),t==="hilitecolor"?"background-color":"color");return ew(o).map(n=>"#"+Ri(n).value)},dw=e=>{const t="choiceitem",o={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return e?[o,{type:t,text:"Custom color",icon:"color-picker",value:"custom"}]:[o]},rg=(e,t,o,n)=>{o==="custom"?fw(e)(r=>{r.each(s=>{sw(t,s),e.execCommand("mceApplyTextcolor",t,s),n(s)})},cw(e,t).getOr(ng)):o==="remove"?(n(""),e.execCommand("mceRemoveTextcolor",t)):(n(o),e.execCommand("mceApplyTextcolor",t,o))},uw=(e,t,o)=>e.concat((n=>N(rw(n).state(),r=>({type:"choiceitem",text:r,icon:"checkmark",value:r})))(t).concat(dw(o))),mw=(e,t,o)=>n=>{n(uw(e,t,o))},gw=(e,t,o)=>{const n=t==="forecolor"?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";e.setIconFill(n,o)},pw=(e,t,o,n,r)=>{e.ui.registry.addSplitButton(t,{tooltip:n,presets:"color",icon:t==="forecolor"?"text-color":"highlight-bg-color",select:s=>{const a=cw(e,o);return Jo(a,s.toUpperCase())},columns:iw(e,o),fetch:mw(Hi(e,o),o,lw(e)),onAction:s=>{rg(e,o,r.get(),H)},onItemAction:(s,a)=>{rg(e,o,a,i=>{r.set(i),((l,c)=>{l.dispatch("TextColorChange",c)})(e,{name:t,color:i})})},onSetup:s=>{gw(s,t,r.get());const a=i=>{i.name===t&&gw(s,i.name,i.color)};return e.on("TextColorChange",a),()=>{e.off("TextColorChange",a)}}})},hw=(e,t,o,n)=>{e.ui.registry.addNestedMenuItem(t,{text:n,icon:t==="forecolor"?"text-color":"highlight-bg-color",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",initData:{storageKey:o},onAction:r=>{rg(e,o,r.value,H)}}]})},fw=e=>(t,o)=>{let n=!1;const r={colorpicker:o};e.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:(s,a)=>{a.name==="hex-valid"&&(n=a.value)},onSubmit:s=>{const a=s.getData().colorpicker;n?(t(g.from(a)),s.close()):e.windowManager.alert(e.translate(["Invalid hex color code: {0}",a]))},onClose:H,onCancel:()=>{t(g.none())}})},sg=(e,t,o,n,r,s,a,i)=>{const l=kc(t),c=wA(t,o,n,r!=="color"?"normal":"color",s,a,i);return zm(e,l,c,n,{menuType:r})},wA=(e,t,o,n,r,s,a)=>Wr(N(e,i=>{return i.type==="choiceitem"?(l=i,Ue("choicemenuitem",JE,l)).fold(Qn,c=>g.some(((u,d,m,p,h,f,v,y=!0)=>{const x=Ii({presets:m,textContent:d?u.text:g.none(),htmlContent:g.none(),ariaLabel:u.text,iconContent:u.icon,shortcutContent:d?u.shortcut:g.none(),checkMark:d?g.some(Lx(v.icons)):g.none(),caret:g.none(),value:u.value},v,y);return je(ma({data:ga(u),enabled:u.enabled,getApi:b=>({setActive:w=>{he.set(b,w)},isActive:()=>he.isOn(b),isEnabled:()=>!Q.isDisabled(b),setEnabled:w=>Q.set(b,!w)}),onAction:b=>p(u.value),onSetup:b=>(b.setActive(h),H),triggersSubmenu:!1,itemBehaviours:[]},x,f,v),{toggling:{toggleClass:lx,toggleOnExecute:!1,selected:u.active,exclusive:!0}})})(c,o===1,n,t,s(c.value),r,a,kc(e)))):g.none();var l})),Mc=(e,t)=>{const o=ms(t);return e===1?{mode:"menu",moveOnTab:!0}:e==="auto"?{mode:"grid",selector:"."+o.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+(t==="color"?"tox-swatches__row":"tox-collection__group"),previousSelector:n=>t==="color"?ut(n.element,"[aria-checked=true]"):g.none()}},bw=j("cell-over"),vw=j("cell-execute"),SA=(e,t,o)=>{const n=s=>Y(s,vw,{row:e,col:t}),r=(s,a)=>{a.stop(),n(s)};return Lt({dom:{tag:"div",attributes:{role:"button","aria-labelledby":o}},behaviours:I([le("insert-table-picker-cell",[B(xr(),te.focus),B(fo(),n),B(oi(),r),B(si(),r)]),he.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),te.config({onFocus:s=>Y(s,bw,{row:e,col:t})})])})},kA=e=>nt(e,t=>N(t,Uo)),yw=(e,t)=>dt(`${t}x${e}`),CA={inserttable:e=>{const t=j("size-label"),o=((s,a,i)=>{const l=[];for(let c=0;c<10;c++){const u=[];for(let d=0;d<10;d++)u.push(SA(c,d,s));l.push(u)}return l})(t),n=yw(0,0),r=De({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[n],behaviours:I([re.config({})])});return{type:"widget",data:{value:j("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Gx.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:kA(o).concat(r.asSpec()),behaviours:I([le("insert-table-picker",[Ge(s=>{re.set(r.get(s),[n])}),cu(bw,(s,a,i)=>{const{row:l,col:c}=i.event;((u,d,m,p,h)=>{for(let f=0;f<10;f++)for(let v=0;v<10;v++)he.set(u[f][v],f<=d&&v<=m)})(o,l,c),re.set(r.get(s),[yw(l+1,c+1)])}),cu(vw,(s,a,i)=>{const{row:l,col:c}=i.event;e.onAction({numRows:l+1,numColumns:c+1}),we(s,Ml())})]),$.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:(e,t)=>{const o=((a,i)=>{const l=a.initData.allowCustomColors&&i.colorinput.hasCustomColors();return a.initData.colors.fold(()=>uw(i.colorinput.getColors(a.initData.storageKey),a.initData.storageKey,l),c=>c.concat(dw(l)))})(e,t),n=t.colorinput.getColorCols(e.initData.storageKey),r="color",s=k(k({},sg(j("menu-value"),o,a=>{e.onAction({value:a})},n,r,un.CLOSE_ON_EXECUTE,Ve,t.shared.providers)),{markers:ms(r),movement:Mc(n,r)});return{type:"widget",data:{value:j("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Gx.widget(ds.sketch(s))]}}},xw=e=>({type:"separator",dom:{tag:"div",classes:[yc,"tox-collection__group-heading"]},components:e.text.map(dt).toArray()});var OA=Object.freeze({__proto__:null,getCoupled:(e,t,o,n)=>o.getOrCreate(e,t,n),getExistingCoupled:(e,t,o,n)=>o.getExisting(e,t,n)}),_A=[go("others",hf(ue.value,Qo()))],TA=Object.freeze({__proto__:null,init:()=>{const e={},t=(n,r)=>{if(rt(n.others).length===0)throw new Error("Cannot find any known coupled components");return K(e,r)},o=E({});return bo({readState:o,getExisting:(n,r,s)=>t(r,s).orThunk(()=>(K(r.others,s).getOrDie("No information found for coupled component: "+s),g.none())),getOrCreate:(n,r,s)=>t(r,s).getOrThunk(()=>{const a=K(r.others,s).getOrDie("No information found for coupled component: "+s)(n),i=n.getSystem().build(a);return e[s]=i,i})})}});const Pe=bt({fields:_A,name:"coupling",apis:OA,state:TA}),ag=e=>{let t=g.none(),o=[];const n=a=>{r()?s(a):o.push(a)},r=()=>t.isSome(),s=a=>{t.each(i=>{setTimeout(()=>{a(i)},0)})};return e(a=>{r()||(t=g.some(a),q(o,s),o=[])}),{get:n,map:a=>ag(i=>{n(l=>{i(a(l))})}),isReady:r}},EA={nu:ag,pure:e=>ag(t=>{t(e)})},AA=e=>{setTimeout(()=>{throw e},0)},pa=e=>{const t=o=>{e().then(o,AA)};return{map:o=>pa(()=>e().then(o)),bind:o=>pa(()=>e().then(n=>o(n).toPromise())),anonBind:o=>pa(()=>e().then(()=>o.toPromise())),toLazy:()=>EA.nu(t),toCached:()=>{let o=null;return pa(()=>(o===null&&(o=e()),o))},toPromise:e,get:t}},Mr=e=>pa(()=>new Promise(e)),or=e=>pa(()=>Promise.resolve(e)),ww=E("sink"),Sw=E(Bo({name:ww(),overrides:E({dom:{tag:"div"},behaviours:I([Wt.config({useFixed:pt})]),events:Re([os(ei()),os(Po()),os(oi())])})})),kw=(e,t)=>{const o=e.getHotspot(t).getOr(t),n="hotspot",r=e.getAnchorOverrides();return e.layouts.fold(()=>({type:n,hotspot:o,overrides:r}),s=>({type:n,hotspot:o,overrides:r,layouts:s}))},Dc=(e,t,o,n,r,s,a)=>((l,c,u,d,m,p,h)=>{const f=((y,x,b)=>(0,y.fetch)(b).map(x))(l,c,d),v=Cw(d,l);return f.map(y=>y.bind(x=>g.from(us.sketch(k(k({},p.menu()),{uid:$s(""),data:x,highlightOnOpen:h,onOpenMenu:(b,w)=>{const S=v().getOrDie();Wt.position(S,w,{anchor:u}),ge.decloak(m)},onOpenSubmenu:(b,w,S)=>{const C=v().getOrDie();Wt.position(C,S,{anchor:{type:"submenu",item:w}}),ge.decloak(m)},onRepositionMenu:(b,w,S)=>{const C=v().getOrDie();Wt.position(C,w,{anchor:u}),q(S,O=>{Wt.position(C,O.triggeredMenu,{anchor:{type:"submenu",item:O.triggeringItem}})})},onEscape:()=>(te.focus(d),ge.close(m),g.some(!0))})))))})(e,t,kw(e,o),o,n,r,a).map(l=>(l.fold(()=>{ge.isOpen(n)&&ge.close(n)},c=>{ge.cloak(n),ge.open(n,c),s(n)}),n)),MA=(e,t,o,n,r,s,a)=>(ge.close(n),or(n)),ig=(e,t,o,n,r,s)=>{const a=Pe.getCoupled(o,"sandbox");return(ge.isOpen(a)?MA:Dc)(e,t,o,a,n,r,s)},Cw=(e,t)=>e.getSystem().getByUid(t.uid+"-"+ww()).map(o=>()=>ue.value(o)).getOrThunk(()=>t.lazySink.fold(()=>()=>ue.error(new Error("No internal sink is specified, nor could an external sink be found")),o=>()=>o(e))),Ow=e=>{ge.getState(e).each(t=>{us.repositionMenus(t)})},lg=(e,t,o)=>{const n=Xf(),r=Cw(t,e);return{dom:{tag:"div",classes:e.sandboxClasses,attributes:{id:n.id,role:"listbox"}},behaviours:ea(e.sandboxBehaviours,[V.config({store:{mode:"memory",initialValue:t}}),ge.config({onOpen:(s,a)=>{const i=kw(e,t);n.link(t.element),e.matchWidth&&((l,c,u)=>{const d=de.getCurrent(c).getOr(c),m=Xt(l.element);u?se(d.element,"min-width",m+"px"):((p,h)=>{wl.set(p,h)})(d.element,m)})(i.hotspot,a,e.useMinWidth),e.onOpen(i,s,a),o!==void 0&&o.onOpen!==void 0&&o.onOpen(s,a)},onClose:(s,a)=>{n.unlink(t.element),o!==void 0&&o.onClose!==void 0&&o.onClose(s,a)},isPartOf:(s,a,i)=>ss(a,i)||ss(t,i),getAttachPoint:()=>r().getOrDie()}),de.config({find:s=>ge.getState(s).bind(a=>de.getCurrent(a))}),Wo.config({channels:k(k({},ju({isExtraPart:Ve})),Gu({doReposition:Ow}))})])}},_w=e=>{const t=Pe.getCoupled(e,"sandbox");Ow(t)},cg=()=>[T("sandboxClasses",[]),Qs("sandboxBehaviours",[de,Wo,ge,V])],DA=E([M("dom"),M("fetch"),me("onOpen"),to("onExecute"),T("getHotspot",g.some),T("getAnchorOverrides",E({})),_r(),mt("dropdownBehaviours",[he,Pe,$,te]),M("toggleClass"),T("eventOrder",{}),Se("lazySink"),T("matchWidth",!1),T("useMinWidth",!1),Se("role")].concat(cg())),BA=E([jo({schema:[Hl(),T("fakeFocus",!1)],name:"menu",defaults:e=>({onExecute:e.onExecute})}),Sw()]),Io=Vt({name:"Dropdown",configFields:DA(),partFields:BA(),factory:(e,t,o,n)=>{const r=l=>{ge.getState(l).each(c=>{us.highlightPrimary(c)})},s=(l,c,u)=>ig(e,xe,l,n,c,u),a={expand:l=>{he.isOn(l)||s(l,H,jt.HighlightNone).get(H)},open:l=>{he.isOn(l)||s(l,H,jt.HighlightMenuAndItem).get(H)},refetch:l=>Pe.getExistingCoupled(l,"sandbox").fold(()=>s(l,H,jt.HighlightMenuAndItem).map(H),c=>Dc(e,xe,l,c,n,H,jt.HighlightMenuAndItem).map(H)),isOpen:he.isOn,close:l=>{he.isOn(l)&&s(l,H,jt.HighlightMenuAndItem).get(H)},repositionMenus:l=>{he.isOn(l)&&_w(l)}},i=(l,c)=>(ts(l),g.some(!0));return{uid:e.uid,dom:e.dom,components:t,behaviours:vt(e.dropdownBehaviours,[he.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),Pe.config({others:{sandbox:l=>lg(e,l,{onOpen:()=>he.on(l),onClose:()=>he.off(l)})}}),$.config({mode:"special",onSpace:i,onEnter:i,onDown:(l,c)=>{if(Io.isOpen(l)){const u=Pe.getCoupled(l,"sandbox");r(u)}else Io.open(l);return g.some(!0)},onEscape:(l,c)=>Io.isOpen(l)?(Io.close(l),g.some(!0)):g.none()}),te.config({})]),events:gc(g.some(l=>{s(l,r,jt.HighlightMenuAndItem).get(H)})),eventOrder:k(k({},e.eventOrder),{[fo()]:["disabling","toggling","alloy.base.behaviour"]}),apis:a,domModification:{attributes:k(k({"aria-haspopup":"true"},e.role.fold(()=>({}),l=>({role:l}))),e.dom.tag==="button"?{type:K(e.dom,"attributes").bind(l=>K(l,"type")).getOr("button")}:{})}}},apis:{open:(e,t)=>e.open(t),refetch:(e,t)=>e.refetch(t),expand:(e,t)=>e.expand(t),close:(e,t)=>e.close(t),isOpen:(e,t)=>e.isOpen(t),repositionMenus:(e,t)=>e.repositionMenus(t)}}),Tw=(e,t,o)=>{yx(e).each(n=>{var r;((s,a)=>{lo(a.element,"id").each(i=>ie(s.element,"aria-activedescendant",i))})(n,o),(vo((r=t).element,Sc)?g.some(r.element):ut(r.element,"."+Sc)).each(s=>{lo(s,"id").each(a=>ie(n.element,"aria-controls",a))})}),ie(o.element,"aria-selected","true")},FA=(e,t,o)=>{ie(o.element,"aria-selected","false")},IA=e=>Pe.getExistingCoupled(e,"sandbox").bind(wc).map(xx).map(t=>t.fetchPattern).getOr("");var Bc;(function(e){e[e.ContentFocus=0]="ContentFocus",e[e.UiFocus=1]="UiFocus"})(Bc||(Bc={}));const RA=(e,t,o,n,r)=>{const s=o.shared.providers,a=l=>r?k(k({},l),{shortcut:g.none(),icon:l.text.isSome()?g.none():l.icon}):l;switch(e.type){case"menuitem":return(i=e,Ue("menuitem",tA,i)).fold(Qn,l=>g.some(((c,u,d,m=!0)=>{const p=Ii({presets:"normal",iconContent:c.icon,textContent:c.text,htmlContent:g.none(),ariaLabel:c.text,caret:g.none(),checkMark:g.none(),shortcutContent:c.shortcut},d,m);return ma({data:ga(c),getApi:h=>({isEnabled:()=>!Q.isDisabled(h),setEnabled:f=>Q.set(h,!f)}),enabled:c.enabled,onAction:c.onAction,onSetup:c.onSetup,triggersSubmenu:!1,itemBehaviours:[]},p,u,d)})(a(l),t,s,n)));case"nestedmenuitem":return(l=>Ue("nestedmenuitem",oA,l))(e).fold(Qn,l=>g.some(((c,u,d,m=!0,p=!1)=>{const h=p?(f=d.icons,Km("chevron-down",f,[dx])):(y=>Km("chevron-right",y,[dx]))(d.icons);var f;const v=Ii({presets:"normal",iconContent:c.icon,textContent:c.text,htmlContent:g.none(),ariaLabel:c.text,caret:g.some(h),checkMark:g.none(),shortcutContent:c.shortcut},d,m);return ma({data:ga(c),getApi:y=>({isEnabled:()=>!Q.isDisabled(y),setEnabled:x=>Q.set(y,!x)}),enabled:c.enabled,onAction:H,onSetup:c.onSetup,triggersSubmenu:!0,itemBehaviours:[]},v,u,d)})(a(l),t,s,n,r)));case"togglemenuitem":return(l=>Ue("togglemenuitem",nA,l))(e).fold(Qn,l=>g.some(((c,u,d,m=!0)=>{const p=Ii({iconContent:c.icon,textContent:c.text,htmlContent:g.none(),ariaLabel:c.text,checkMark:g.some(Lx(d.icons)),caret:g.none(),shortcutContent:c.shortcut,presets:"normal",meta:c.meta},d,m);return je(ma({data:ga(c),enabled:c.enabled,getApi:h=>({setActive:f=>{he.set(h,f)},isActive:()=>he.isOn(h),isEnabled:()=>!Q.isDisabled(h),setEnabled:f=>Q.set(h,!f)}),onAction:c.onAction,onSetup:c.onSetup,triggersSubmenu:!1,itemBehaviours:[]},p,u,d),{toggling:{toggleClass:lx,toggleOnExecute:!1,selected:c.active}})})(a(l),t,s,n)));case"separator":return(l=>Ue("separatormenuitem",_x,l))(e).fold(Qn,l=>g.some(xw(l)));case"fancymenuitem":return(l=>Ue("fancymenuitem",eA,l))(e).fold(Qn,l=>((c,u)=>K(CA,c.fancytype).map(d=>d(c,u)))(l,o));default:return console.error("Unknown item in general menu",e),g.none()}var i},NA=(e,t,o,n,r,s,a)=>{const i=n===1,l=!i||kc(e);return Wr(N(e,c=>{switch(c.type){case"separator":return(u=c,Ue("Autocompleter.Separator",_x,u)).fold(Qn,d=>g.some(xw(d)));case"cardmenuitem":return(d=>Ue("cardmenuitem",YE,d))(c).fold(Qn,d=>g.some(((m,p,h,f)=>{const v={dom:Px(m.label),optComponents:[g.some({dom:{tag:"div",classes:[ux,mx]},components:jx(m.items,f)})]};return ma({data:ga(k({text:g.none()},m)),enabled:m.enabled,getApi:y=>({isEnabled:()=>!Q.isDisabled(y),setEnabled:x=>{Q.set(y,!x),q(Ut(y.element,"*"),b=>{y.getSystem().getByDom(b).each(w=>{w.hasConfigured(Q)&&Q.set(w,!x)})})}}),onAction:m.onAction,onSetup:m.onSetup,triggersSubmenu:!1,itemBehaviours:g.from(f.itemBehaviours).getOr([])},v,p,h.providers)})(k(k({},d),{onAction:m=>{d.onAction(m),o(d.value,d.meta)}}),r,s,{itemBehaviours:Ux(d.meta,s),cardText:{matchText:t,highlightOn:a}})));default:return(d=>Ue("Autocompleter.Item",RE,d))(c).fold(Qn,d=>g.some(((m,p,h,f,v,y,x,b=!0)=>{const w=Ii({presets:f,textContent:g.none(),htmlContent:h?m.text.map(S=>Wx(S,p)):g.none(),ariaLabel:m.text,iconContent:m.icon,shortcutContent:g.none(),checkMark:g.none(),caret:g.none(),value:m.value},x.providers,b,m.icon);return ma({data:ga(m),enabled:m.enabled,getApi:E({}),onAction:S=>v(m.value,m.meta),onSetup:E(H),triggersSubmenu:!1,itemBehaviours:Ux(m.meta,x)},w,y,x.providers)})(d,t,i,"normal",o,r,s,l)))}var u}))},Ew=(e,t,o,n,r,s)=>{const a=kc(t),i=Wr(N(t,c=>{const u=d=>RA(d,o,n,(m=>r?!Te(m,"text"):a)(d),r);return c.type==="nestedmenuitem"&&c.getSubmenuItems().length<=0?u(k(k({},c),{enabled:!1})):u(c)})),l=(c=>c.searchMode==="no-search"?{menuType:"normal"}:{menuType:"searchable",searchMode:c})(s);return(r?_E:zm)(e,a,i,1,l)},dg=e=>us.singleData(e.value,e),VA=(e,t)=>{const o=Z(!1),n=Z(!1),r=Lt($e.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:I([le("dismissAutocompleter",[B(Us(),()=>c())])]),lazySink:t.getSink})),s=()=>$e.isOpen(r),a=n.get,i=()=>{s()&&$e.hide(r)},l=()=>$e.getContent(r).bind(d=>dl(d.components(),0)),c=()=>e.execCommand("mceAutocompleterClose"),u=d=>{const m=(p=>{const h=yn(p,f=>g.from(f.columns)).getOr(1);return nt(p,f=>{const v=f.items;return NA(v,f.matchText,(y,x)=>{const b=e.selection.getRng();((w,S)=>ix(U(S.startContainer)).map(C=>{const O=w.createRng();return O.selectNode(C.dom),O}))(e.dom,b).each(w=>{const S={hide:()=>c(),reload:C=>{i(),e.execCommand("mceAutocompleterReload",!1,{fetchOptions:C})}};o.set(!0),f.onAction(S,w,y,x),o.set(!1)})},h,un.BUBBLE_TO_SANDBOX,t,f.highlightOn)})})(d);m.length>0?((p,h)=>{var f;(f=U(e.getBody()),ut(f,ax)).each(v=>{const y=yn(p,x=>g.from(x.columns)).getOr(1);$e.showMenuAt(r,{anchor:{type:"node",root:U(e.getBody()),node:g.from(v)}},((x,b,w,S)=>{const C=Mc(b,S),O=ms(S);return{data:dg(k(k({},x),{movement:C,menuBehaviours:Ei(b!=="auto"?[]:[Ge((A,F)=>{qm(A,4,O.item).each(({numColumns:D,numRows:R})=>{$.setGridSize(A,R,D)})})])})),menu:{markers:ms(S),fakeFocus:w===Bc.ContentFocus}}})(zm("autocompleter-value",!0,h,y,{menuType:"normal"}),y,Bc.ContentFocus,"normal"))}),l().each(be.highlightFirst)})(d,m):i()};e.on("AutocompleterStart",({lookupData:d})=>{n.set(!0),o.set(!1),u(d)}),e.on("AutocompleterUpdate",({lookupData:d})=>u(d)),e.on("AutocompleterEnd",()=>{i(),n.set(!1),o.set(!1)}),((d,m)=>{const p=(f,v)=>{Y(f,ei(),{raw:v})},h=()=>d.getMenu().bind(be.getHighlighted);m.on("keydown",f=>{const v=f.which;d.isActive()&&(d.isMenuOpen()?v===13?(h().each(ts),f.preventDefault()):v===40?(h().fold(()=>{d.getMenu().each(be.highlightFirst)},y=>{p(y,f)}),f.preventDefault(),f.stopImmediatePropagation()):v!==37&&v!==38&&v!==39||h().each(y=>{p(y,f),f.preventDefault(),f.stopImmediatePropagation()}):v!==13&&v!==38&&v!==40||d.cancelIfNecessary())}),m.on("NodeChange",f=>{d.isActive()&&!d.isProcessingAction()&&ix(U(f.element)).isNone()&&d.cancelIfNecessary()})})({cancelIfNecessary:c,isMenuOpen:s,isActive:a,isProcessingAction:o.get,getMenu:l},e)},zi=(e,t,o)=>rn(e,t,o).isSome(),Aw=(e,t)=>{let o=null;return{cancel:()=>{o!==null&&(clearTimeout(o),o=null)},schedule:(...n)=>{o=setTimeout(()=>{e.apply(null,n),o=null},t)}}},Mw=e=>{const t=e.raw;return t.touches===void 0||t.touches.length!==1?g.none():g.some(t.touches[0])},HA=(e,t)=>{const o=k({stopBackspace:!0},t),n=(d=>{const m=ze(),p=Z(!1),h=Aw(v=>{d.triggerEvent(c_(),v),p.set(!0)},400),f=zs([{key:$n(),value:v=>(Mw(v).each(y=>{h.cancel();const x={x:y.clientX,y:y.clientY,target:v.target};h.schedule(v),p.set(!1),m.set(x)}),g.none())},{key:Za(),value:v=>(h.cancel(),Mw(v).each(y=>{m.on(x=>{((b,w)=>{const S=Math.abs(b.clientX-w.x),C=Math.abs(b.clientY-w.y);return S>5||C>5})(y,x)&&m.clear()})}),g.none())},{key:Qa(),value:v=>(h.cancel(),m.get().filter(y=>Le(y.target,v.target)).map(y=>p.get()?(v.prevent(),!1):d.triggerEvent(si(),v)))}]);return{fireIfReady:(v,y)=>K(f,y).bind(x=>x(v))}})(o),r=N(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),d=>Pt(e,d,m=>{n.fireIfReady(m,d).each(p=>{p&&m.kill()}),o.triggerEvent(d,m)&&m.kill()})),s=ze(),a=Pt(e,"paste",d=>{n.fireIfReady(d,"paste").each(m=>{m&&d.kill()}),o.triggerEvent("paste",d)&&d.kill(),s.set(setTimeout(()=>{o.triggerEvent(tu(),d)},0))}),i=Pt(e,"keydown",d=>{o.triggerEvent("keydown",d)?d.kill():o.stopBackspace&&(m=>m.raw.which===t1[0]&&!ht(["input","textarea"],zn(m.target))&&!zi(m.target,'[contenteditable="true"]'))(d)&&d.prevent()}),l=Pt(e,"focusin",d=>{o.triggerEvent("focusin",d)&&d.kill()}),c=ze(),u=Pt(e,"focusout",d=>{o.triggerEvent("focusout",d)&&d.kill(),c.set(setTimeout(()=>{o.triggerEvent(eu(),d)},0))});return{unbind:()=>{q(r,d=>{d.unbind()}),i.unbind(),l.unbind(),u.unbind(),a.unbind(),s.on(clearTimeout),c.on(clearTimeout)}}},Dw=(e,t)=>{const o=K(e,"target").getOr(t);return Z(o)},Li=Mo([{stopped:[]},{resume:["element"]},{complete:[]}]),Bw=(e,t,o,n,r,s)=>{const a=e(t,n),i=((l,c)=>{const u=Z(!1),d=Z(!1);return{stop:()=>{u.set(!0)},cut:()=>{d.set(!0)},isStopped:u.get,isCut:d.get,event:l,setSource:c.set,getSource:c.get}})(o,r);return a.fold(()=>(s.logEventNoHandlers(t,n),Li.complete()),l=>{const c=l.descHandler;return pu(c)(i),i.isStopped()?(s.logEventStopped(t,l.element,c.purpose),Li.stopped()):i.isCut()?(s.logEventCut(t,l.element,c.purpose),Li.complete()):xn(l.element).fold(()=>(s.logNoParent(t,l.element,c.purpose),Li.complete()),u=>(s.logEventResponse(t,l.element,c.purpose),Li.resume(u)))})},Fw=(e,t,o,n,r,s)=>Bw(e,t,o,n,r,s).fold(pt,a=>Fw(e,t,o,a,r,s),Ve),Iw=(e,t,o,n,r)=>{const s=Dw(o,n);return Fw(e,t,o,n,s,r)},zA=()=>{const e=(()=>{const n={};return{registerId:(r,s,a)=>{It(a,(i,l)=>{const c=n[l]!==void 0?n[l]:{};c[s]=((u,d)=>({cHandler:Co.apply(void 0,[u.handler].concat(d)),purpose:u.purpose}))(i,r),n[l]=c})},unregisterId:r=>{It(n,(s,a)=>{Te(s,r)&&delete s[r]})},filterByType:r=>K(n,r).map(s=>ul(s,(a,i)=>((l,c)=>({id:l,descHandler:c}))(i,a))).getOr([]),find:(r,s,a)=>K(n,s).bind(i=>Jd(a,l=>((c,u)=>ai(u).bind(d=>K(c,d)).map(d=>((m,p)=>({element:m,descHandler:p}))(u,d)))(i,l),r))}})(),t={},o=n=>{ai(n.element).each(r=>{delete t[r],e.unregisterId(r)})};return{find:(n,r,s)=>e.find(n,r,s),filter:n=>e.filterByType(n),register:n=>{const r=(a=>{const i=a.element;return ai(i).getOrThunk(()=>((l,c)=>{const u=j(y_+"uid-");return uu(c,u),u})(0,a.element))})(n);Vo(t,r)&&((a,i)=>{const l=t[i];if(l!==a)throw new Error('The tagId "'+i+'" is already used by: '+kr(l.element)+`
Cannot use it for: `+kr(a.element)+`
The conflicting element is`+(Ho(l.element)?" ":" not ")+"already in the DOM");o(a)})(n,r);const s=[n];e.registerId(s,r,n.events),t[r]=n},unregister:o,getById:n=>K(t,n)}},gn=xo({name:"Container",factory:e=>{const n=e.dom,{attributes:t}=n,o=Ia(n,["attributes"]);return{uid:e.uid,dom:k({tag:"div",attributes:k({role:"presentation"},t)},o),components:e.components,behaviours:qu(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[T("components",[]),mt("containerBehaviours",[]),T("events",{}),T("domModification",{}),T("eventOrder",{})]}),Rw=e=>{const t=v=>xn(e.element).fold(pt,y=>Le(v,y)),o=zA(),n=(v,y)=>o.find(t,v,y),r=HA(e.element,{triggerEvent:(v,y)=>vu(v,y.target,x=>((b,w,S,C)=>Iw(b,w,S,S.target,C))(n,v,y,x))}),s={debugInfo:E("real"),triggerEvent:(v,y,x)=>{vu(v,y,b=>Iw(n,v,x,y,b))},triggerFocus:(v,y)=>{ai(v).fold(()=>{Kn(v)},x=>{vu(Sr(),v,b=>(((w,S,C,O,A)=>{const F=Dw(C,O);Bw(w,S,C,O,F,A)})(n,Sr(),{originator:y,kill:H,prevent:H,target:v},v,b),!1))})},triggerEscape:(v,y)=>{s.triggerEvent("keydown",v.element,y.event)},getByUid:v=>h(v),getByDom:v=>f(v),build:Lt,buildOrPatch:fu,addToGui:v=>{l(v)},removeFromGui:v=>{c(v)},addToWorld:v=>{a(v)},removeFromWorld:v=>{i(v)},broadcast:v=>{d(v)},broadcastOn:(v,y)=>{m(v,y)},broadcastEvent:(v,y)=>{p(v,y)},isConnected:pt},a=v=>{v.connect(s),jr(v.element)||(o.register(v),q(v.components(),a),s.triggerEvent(Dl(),v.element,{target:v.element}))},i=v=>{jr(v.element)||(q(v.components(),i),o.unregister(v)),v.disconnect()},l=v=>{ls(e,v)},c=v=>{Zn(v)},u=v=>{const y=o.filter(Qr());q(y,x=>{const b=x.descHandler;pu(b)(v)})},d=v=>{u({universal:!0,data:v})},m=(v,y)=>{u({universal:!1,channels:v,data:y})},p=(v,y)=>((x,b,w)=>{const S=(C=>{const O=Z(!1);return{stop:()=>{O.set(!0)},cut:H,isStopped:O.get,isCut:Ve,event:C,setSource:kd("Cannot set source of a broadcasted event"),getSource:kd("Cannot get source of a broadcasted event")}})(b);return q(x,C=>{const O=C.descHandler;pu(O)(S)}),S.isStopped()})(o.filter(v),y),h=v=>o.getById(v).fold(()=>ue.error(new Error('Could not find component with uid: "'+v+'" in system.')),ue.value),f=v=>{const y=ai(v).getOr("not found");return h(y)};return a(e),{root:e,element:e.element,destroy:()=>{r.unbind(),Un(e.element)},add:l,remove:c,getByUid:h,getByDom:f,addToWorld:a,removeFromWorld:i,broadcast:d,broadcastOn:m,broadcastEvent:p}},LA=E([T("prefix","form-field"),mt("fieldBehaviours",[de,V])]),PA=E([Bo({schema:[M("dom")],name:"label"}),Bo({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[M("text")],name:"aria-descriptor"}),Dt({factory:{sketch:e=>{const t=((o,n)=>{const r={};return It(o,(s,a)=>{ht(n,a)||(r[a]=s)}),r})(e,["factory"]);return e.factory.sketch(t)}},schema:[M("factory")],name:"field"})]),ve=Vt({name:"FormField",configFields:LA(),partFields:PA(),factory:(e,t,o,n)=>{const r=vt(e.fieldBehaviours,[de.config({find:i=>Ee(i,e,"field")}),V.config({store:{mode:"manual",getValue:i=>de.getCurrent(i).bind(V.getValue),setValue:(i,l)=>{de.getCurrent(i).each(c=>{V.setValue(c,l)})}}})]),s=Re([Ge((i,l)=>{const c=wv(i,e,["label","field","aria-descriptor"]);c.field().each(u=>{const d=j(e.prefix);c.label().each(m=>{ie(m.element,"for",d),ie(u.element,"id",d)}),c["aria-descriptor"]().each(m=>{const p=j(e.prefix);ie(m.element,"id",p),ie(u.element,"aria-describedby",p)})})})]),a={getField:i=>Ee(i,e,"field"),getLabel:i=>Ee(i,e,"label")};return{uid:e.uid,dom:e.dom,components:t,behaviours:r,events:s,apis:a}},apis:{getField:(e,t)=>e.getField(t),getLabel:(e,t)=>e.getLabel(t)}});var UA=Object.freeze({__proto__:null,exhibit:(e,t)=>on({attributes:zs([{key:t.tabAttr,value:"true"}])})}),WA=[T("tabAttr","data-alloy-tabstop")];const qe=bt({fields:WA,name:"tabstopping",active:UA});var jA=tinymce.util.Tools.resolve("tinymce.html.Entities");const Pi=(e,t,o,n)=>{const r=GA(e,t,o,n);return ve.sketch(r)},GA=(e,t,o,n)=>({dom:Nw(o),components:e.toArray().concat([t]),fieldBehaviours:I(n)}),Nw=e=>({tag:"div",classes:["tox-form__group"].concat(e)}),Dr=(e,t)=>ve.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[dt(t.translate(e))]}),no=j("form-component-change"),Ui=j("form-close"),fs=j("form-cancel"),nr=j("form-action"),Wi=j("form-submit"),ug=j("form-block"),mg=j("form-unblock"),Vw=j("form-tabchange"),Hw=j("form-resize"),$A=["input","textarea"],zw=e=>{const t=zn(e);return ht($A,t)},Lw=(e,t)=>{const o=t.getRoot(e).getOr(e.element);Ze(o,t.invalidClass),t.notify.each(n=>{zw(e.element)&&ie(e.element,"aria-invalid",!1),n.getContainer(e).each(r=>{Gs(r,n.validHtml)}),n.onValid(e)})},Pw=(e,t,o,n)=>{const r=t.getRoot(e).getOr(e.element);ct(r,t.invalidClass),t.notify.each(s=>{zw(e.element)&&ie(e.element,"aria-invalid",!0),s.getContainer(e).each(a=>{Gs(a,n)}),s.onInvalid(e,n)})},Uw=(e,t,o)=>t.validator.fold(()=>or(ue.value(!0)),n=>n.validate(e)),gg=(e,t,o)=>(t.notify.each(n=>{n.onValidate(e)}),Uw(e,t).map(n=>e.getSystem().isConnected()?n.fold(r=>(Pw(e,t,0,r),ue.error(r)),r=>(Lw(e,t),ue.value(r))):ue.error("No longer in system")));var qA=Object.freeze({__proto__:null,markValid:Lw,markInvalid:Pw,query:Uw,run:gg,isInvalid:(e,t)=>{const o=t.getRoot(e).getOr(e.element);return vo(o,t.invalidClass)}}),XA=Object.freeze({__proto__:null,events:(e,t)=>e.validator.map(o=>Re([B(o.onEvent,n=>{gg(n,e).get(xe)})].concat(o.validateOnLoad?[Ge(n=>{gg(n,e).get(H)})]:[]))).getOr({})}),KA=[M("invalidClass"),T("getRoot",g.none),po("notify",[T("aria","alert"),T("getContainer",g.none),T("validHtml",""),me("onValid"),me("onInvalid"),me("onValidate")]),po("validator",[M("validate"),T("onEvent","input"),T("validateOnLoad",!0)])];const Tn=bt({fields:KA,name:"invalidating",active:XA,apis:qA,extra:{validation:e=>t=>{const o=V.getValue(t);return or(e(o))}}}),ji=bt({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:()=>Re([Af(i_(),pt)]),exhibit:()=>on({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})})}),Ww=j("color-input-change"),jw=j("color-swatch-change"),Gw=j("color-picker-cancel"),YA=Bo({schema:[M("dom")],name:"label"}),Br=e=>Bo({name:e+"-edge",overrides:t=>t.model.manager.edgeActions[e].fold(()=>({}),o=>({events:Re([lu($n(),(n,r,s)=>o(n,s),[t]),lu(Po(),(n,r,s)=>o(n,s),[t]),lu(Al(),(n,r,s)=>{s.mouseIsDown.get()&&o(n,s)},[t])])}))}),JA=Br("top-left"),ZA=Br("top"),QA=Br("top-right"),eM=Br("right"),tM=Br("bottom-right"),oM=Br("bottom"),nM=Br("bottom-left");var rM=[YA,Br("left"),eM,ZA,oM,JA,QA,nM,tM,Dt({name:"thumb",defaults:E({dom:{styles:{position:"absolute"}}}),overrides:e=>({events:Re([Ws($n(),e,"spectrum"),Ws(Za(),e,"spectrum"),Ws(Qa(),e,"spectrum"),Ws(Po(),e,"spectrum"),Ws(Al(),e,"spectrum"),Ws(Qd(),e,"spectrum")])})}),Dt({schema:[zt("mouseIsDown",()=>Z(!1))],name:"spectrum",overrides:e=>{const t=e.model.manager,o=(n,r)=>t.getValueFromEvent(r).map(s=>t.setValueFrom(n,e,s));return{behaviours:I([$.config({mode:"special",onLeft:n=>t.onLeft(n,e),onRight:n=>t.onRight(n,e),onUp:n=>t.onUp(n,e),onDown:n=>t.onDown(n,e)}),te.config({})]),events:Re([B($n(),o),B(Za(),o),B(Po(),o),B(Al(),(n,r)=>{e.mouseIsDown.get()&&o(n,r)})])}}})];const Gi=E("slider.change.value"),pg=e=>{const t=e.event.raw;if((o=>o.type.indexOf("touch")!==-1)(t)){const o=t;return o.touches!==void 0&&o.touches.length===1?g.some(o.touches[0]).map(n=>We(n.clientX,n.clientY)):g.none()}{const o=t;return o.clientX!==void 0?g.some(o).map(n=>We(n.clientX,n.clientY)):g.none()}},bs=e=>e.model.minX,vs=e=>e.model.minY,Fc=e=>e.model.minX-1,Ic=e=>e.model.minY-1,ys=e=>e.model.maxX,xs=e=>e.model.maxY,Rc=e=>e.model.maxX+1,Nc=e=>e.model.maxY+1,$w=(e,t,o)=>t(e)-o(e),hg=e=>$w(e,ys,bs),fg=e=>$w(e,xs,vs),qw=e=>hg(e)/2,Xw=e=>fg(e)/2,ha=e=>e.stepSize,Kw=e=>e.snapToGrid,Yw=e=>e.snapStart,Jw=e=>e.rounded,Vc=(e,t)=>e[t+"-edge"]!==void 0,Zw=e=>Vc(e,"left"),Qw=e=>Vc(e,"right"),e0=e=>Vc(e,"top"),t0=e=>Vc(e,"bottom"),rr=e=>e.model.value.get(),Fr=(e,t)=>({x:e,y:t}),$o=(e,t)=>{Y(e,Gi(),{value:t})},bg=(e,t,o,n)=>e<t?e:e>o?o:e===t?t-1:Math.max(t,e-n),vg=(e,t,o,n)=>e>o?e:e<t?t:e===o?o+1:Math.min(o,e+n),o0=(e,t,o)=>Math.max(t,Math.min(o,e)),n0=e=>{const{min:t,max:o,range:n,value:r,step:s,snap:a,snapStart:i,rounded:l,hasMinEdge:c,hasMaxEdge:u,minBound:d,maxBound:m,screenRange:p}=e,h=c?t-1:t,f=u?o+1:o;if(r<d)return h;if(r>m)return f;{const v=((x,b,w)=>Math.min(w,Math.max(x,b))-b)(r,d,m),y=o0(v/p*n+t,h,f);return a&&y>=t&&y<=o?((x,b,w,S,C)=>C.fold(()=>{const O=x-b,A=Math.round(O/S)*S;return o0(b+A,b-1,w+1)},O=>{const A=(x-O)%S,F=Math.round(A/S),D=Math.floor((x-O)/S),R=Math.floor((w-O)/S),L=O+Math.min(R,D+F)*S;return Math.max(O,L)}))(y,t,o,s,i):l?Math.round(y):y}},r0=e=>{const{min:t,max:o,range:n,value:r,hasMinEdge:s,hasMaxEdge:a,maxBound:i,maxOffset:l,centerMinEdge:c,centerMaxEdge:u}=e;return r<t?s?0:c:r>o?a?i:u:(r-t)/n*l},yg="top",s0="right",a0="bottom",xg="left",En=e=>e.element.dom.getBoundingClientRect(),qo=(e,t)=>e[t],Hc=e=>{const t=En(e);return qo(t,xg)},i0=e=>{const t=En(e);return qo(t,s0)},zc=e=>{const t=En(e);return qo(t,yg)},l0=e=>{const t=En(e);return qo(t,a0)},c0=e=>{const t=En(e);return qo(t,"width")},d0=e=>{const t=En(e);return qo(t,"height")},u0=(e,t,o)=>(e+t)/2-o,m0=(e,t)=>{const o=En(e),n=En(t),r=qo(o,xg),s=qo(o,s0),a=qo(n,xg);return u0(r,s,a)},g0=(e,t)=>{const o=En(e),n=En(t),r=qo(o,yg),s=qo(o,a0),a=qo(n,yg);return u0(r,s,a)},Lc=(e,t)=>{Y(e,Gi(),{value:t})},wg=(e,t,o)=>{const n={min:bs(t),max:ys(t),range:hg(t),value:o,step:ha(t),snap:Kw(t),snapStart:Yw(t),rounded:Jw(t),hasMinEdge:Zw(t),hasMaxEdge:Qw(t),minBound:Hc(e),maxBound:i0(e),screenRange:c0(e)};return n0(n)},p0=e=>(t,o)=>((n,r,s)=>{const a=(n>0?vg:bg)(rr(s),bs(s),ys(s),ha(s));return Lc(r,a),g.some(a)})(e,t,o).map(pt),Sg=(e,t,o,n,r,s)=>{const a=((i,l,c,u,d)=>{const m=c0(i),p=u.bind(v=>g.some(m0(v,i))).getOr(0),h=d.bind(v=>g.some(m0(v,i))).getOr(m),f={min:bs(l),max:ys(l),range:hg(l),value:c,hasMinEdge:Zw(l),hasMaxEdge:Qw(l),minBound:Hc(i),minOffset:0,maxBound:i0(i),maxOffset:m,centerMinEdge:p,centerMaxEdge:h};return r0(f)})(t,s,o,n,r);return Hc(t)-Hc(e)+a},sM=p0(-1),aM=p0(1),iM=g.none,lM=g.none,cM={"top-left":g.none(),top:g.none(),"top-right":g.none(),right:g.some((e,t)=>{$o(e,Rc(t))}),"bottom-right":g.none(),bottom:g.none(),"bottom-left":g.none(),left:g.some((e,t)=>{$o(e,Fc(t))})};var dM=Object.freeze({__proto__:null,setValueFrom:(e,t,o)=>{const n=wg(e,t,o);return Lc(e,n),n},setToMin:(e,t)=>{const o=bs(t);Lc(e,o)},setToMax:(e,t)=>{const o=ys(t);Lc(e,o)},findValueOfOffset:wg,getValueFromEvent:e=>pg(e).map(t=>t.left),findPositionOfValue:Sg,setPositionFromValue:(e,t,o,n)=>{const r=rr(o),s=Sg(e,n.getSpectrum(e),r,n.getLeftEdge(e),n.getRightEdge(e),o),a=Xt(t.element)/2;se(t.element,"left",s-a+"px")},onLeft:sM,onRight:aM,onUp:iM,onDown:lM,edgeActions:cM});const Pc=(e,t)=>{Y(e,Gi(),{value:t})},kg=(e,t,o)=>{const n={min:vs(t),max:xs(t),range:fg(t),value:o,step:ha(t),snap:Kw(t),snapStart:Yw(t),rounded:Jw(t),hasMinEdge:e0(t),hasMaxEdge:t0(t),minBound:zc(e),maxBound:l0(e),screenRange:d0(e)};return n0(n)},h0=e=>(t,o)=>((n,r,s)=>{const a=(n>0?vg:bg)(rr(s),vs(s),xs(s),ha(s));return Pc(r,a),g.some(a)})(e,t,o).map(pt),Cg=(e,t,o,n,r,s)=>{const a=((i,l,c,u,d)=>{const m=d0(i),p=u.bind(v=>g.some(g0(v,i))).getOr(0),h=d.bind(v=>g.some(g0(v,i))).getOr(m),f={min:vs(l),max:xs(l),range:fg(l),value:c,hasMinEdge:e0(l),hasMaxEdge:t0(l),minBound:zc(i),minOffset:0,maxBound:l0(i),maxOffset:m,centerMinEdge:p,centerMaxEdge:h};return r0(f)})(t,s,o,n,r);return zc(t)-zc(e)+a},uM=g.none,mM=g.none,gM=h0(-1),pM=h0(1),hM={"top-left":g.none(),top:g.some((e,t)=>{$o(e,Ic(t))}),"top-right":g.none(),right:g.none(),"bottom-right":g.none(),bottom:g.some((e,t)=>{$o(e,Nc(t))}),"bottom-left":g.none(),left:g.none()};var fM=Object.freeze({__proto__:null,setValueFrom:(e,t,o)=>{const n=kg(e,t,o);return Pc(e,n),n},setToMin:(e,t)=>{const o=vs(t);Pc(e,o)},setToMax:(e,t)=>{const o=xs(t);Pc(e,o)},findValueOfOffset:kg,getValueFromEvent:e=>pg(e).map(t=>t.top),findPositionOfValue:Cg,setPositionFromValue:(e,t,o,n)=>{const r=rr(o),s=Cg(e,n.getSpectrum(e),r,n.getTopEdge(e),n.getBottomEdge(e),o),a=Rt(t.element)/2;se(t.element,"top",s-a+"px")},onLeft:uM,onRight:mM,onUp:gM,onDown:pM,edgeActions:hM});const Uc=(e,t)=>{Y(e,Gi(),{value:t})},Wc=(e,t)=>({x:e,y:t}),jc=(e,t)=>(o,n)=>((r,s,a,i)=>{const l=r>0?vg:bg,c=s?rr(i).x:l(rr(i).x,bs(i),ys(i),ha(i)),u=s?l(rr(i).y,vs(i),xs(i),ha(i)):rr(i).y;return Uc(a,Wc(c,u)),g.some(c)})(e,t,o,n).map(pt),bM=jc(-1,!1),vM=jc(1,!1),yM=jc(-1,!0),xM=jc(1,!0),wM={"top-left":g.some((e,t)=>{$o(e,Fr(Fc(t),Ic(t)))}),top:g.some((e,t)=>{$o(e,Fr(qw(t),Ic(t)))}),"top-right":g.some((e,t)=>{$o(e,Fr(Rc(t),Ic(t)))}),right:g.some((e,t)=>{$o(e,Fr(Rc(t),Xw(t)))}),"bottom-right":g.some((e,t)=>{$o(e,Fr(Rc(t),Nc(t)))}),bottom:g.some((e,t)=>{$o(e,Fr(qw(t),Nc(t)))}),"bottom-left":g.some((e,t)=>{$o(e,Fr(Fc(t),Nc(t)))}),left:g.some((e,t)=>{$o(e,Fr(Fc(t),Xw(t)))})};var SM=Object.freeze({__proto__:null,setValueFrom:(e,t,o)=>{const n=wg(e,t,o.left),r=kg(e,t,o.top),s=Wc(n,r);return Uc(e,s),s},setToMin:(e,t)=>{const o=bs(t),n=vs(t);Uc(e,Wc(o,n))},setToMax:(e,t)=>{const o=ys(t),n=xs(t);Uc(e,Wc(o,n))},getValueFromEvent:e=>pg(e),setPositionFromValue:(e,t,o,n)=>{const r=rr(o),s=Sg(e,n.getSpectrum(e),r.x,n.getLeftEdge(e),n.getRightEdge(e),o),a=Cg(e,n.getSpectrum(e),r.y,n.getTopEdge(e),n.getBottomEdge(e),o),i=Xt(t.element)/2,l=Rt(t.element)/2;se(t.element,"left",s-i+"px"),se(t.element,"top",a-l+"px")},onLeft:bM,onRight:vM,onUp:yM,onDown:xM,edgeActions:wM});const Xo=Vt({name:"Slider",configFields:[T("stepSize",1),T("onChange",H),T("onChoose",H),T("onInit",H),T("onDragStart",H),T("onDragEnd",H),T("snapToGrid",!1),T("rounded",!0),Se("snapStart"),go("model",mo("mode",{x:[T("minX",0),T("maxX",100),zt("value",e=>Z(e.mode.minX)),M("getInitialValue"),Ne("manager",dM)],y:[T("minY",0),T("maxY",100),zt("value",e=>Z(e.mode.minY)),M("getInitialValue"),Ne("manager",fM)],xy:[T("minX",0),T("maxX",100),T("minY",0),T("maxY",100),zt("value",e=>Z({x:e.mode.minX,y:e.mode.minY})),M("getInitialValue"),Ne("manager",SM)]})),mt("sliderBehaviours",[$,V]),zt("mouseIsDown",()=>Z(!1))],partFields:rM,factory:(e,t,o,n)=>{const r=y=>On(y,e,"thumb"),s=y=>On(y,e,"spectrum"),a=y=>Ee(y,e,"left-edge"),i=y=>Ee(y,e,"right-edge"),l=y=>Ee(y,e,"top-edge"),c=y=>Ee(y,e,"bottom-edge"),u=e.model,d=u.manager,m=(y,x)=>{d.setPositionFromValue(y,x,e,{getLeftEdge:a,getRightEdge:i,getTopEdge:l,getBottomEdge:c,getSpectrum:s})},p=(y,x)=>{u.value.set(x);const b=r(y);m(y,b)},h=y=>{const x=e.mouseIsDown.get();e.mouseIsDown.set(!1),x&&Ee(y,e,"thumb").each(b=>{const w=u.value.get();e.onChoose(y,b,w)})},f=(y,x)=>{x.stop(),e.mouseIsDown.set(!0),e.onDragStart(y,r(y))},v=(y,x)=>{x.stop(),e.onDragEnd(y,r(y)),h(y)};return{uid:e.uid,dom:e.dom,components:t,behaviours:vt(e.sliderBehaviours,[$.config({mode:"special",focusIn:y=>Ee(y,e,"spectrum").map($.focusIn).map(pt)}),V.config({store:{mode:"manual",getValue:y=>u.value.get(),setValue:p}}),Wo.config({channels:{[Wu()]:{onReceive:h}}})]),events:Re([B(Gi(),(y,x)=>{((b,w)=>{p(b,w);const S=r(b);e.onChange(b,S,w),g.some(!0)})(y,x.event.value)}),Ge((y,x)=>{const b=u.getInitialValue();u.value.set(b);const w=r(y);m(y,w);const S=s(y);e.onInit(y,w,S,u.value.get())}),B($n(),f),B(Qa(),v),B(Po(),f),B(Qd(),v)]),apis:{resetToMin:y=>{d.setToMin(y,e)},resetToMax:y=>{d.setToMax(y,e)},setValue:p,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:(e,t,o)=>{e.setValue(t,o)},resetToMin:(e,t)=>{e.resetToMin(t)},resetToMax:(e,t)=>{e.resetToMax(t)},refresh:(e,t)=>{e.refresh(t)}}}),Og=j("rgb-hex-update"),f0=j("slider-update"),b0=j("palette-update"),v0="form",kM=[mt("formBehaviours",[V])],y0=e=>"<alloy.field."+e+">",CM=(e,t)=>({uid:e.uid,dom:e.dom,components:t,behaviours:vt(e.formBehaviours,[V.config({store:{mode:"manual",getValue:o=>{const n=Sv(o,e);return ft(n,(r,s)=>r().bind(a=>{return i=de.getCurrent(a),l=new Error(`Cannot find a current component to extract the value from for form part '${s}': `+kr(a.element)),i.fold(()=>ue.error(l),ue.value);var i,l}).map(V.getValue))},setValue:(o,n)=>{It(n,(r,s)=>{Ee(o,e,s).each(a=>{de.getCurrent(a).each(i=>{V.setValue(i,r)})})})}}})]),apis:{getField:(o,n)=>Ee(o,e,n).bind(de.getCurrent)}}),fa={getField:Nl((e,t,o)=>e.getField(t,o)),sketch:e=>{const t=(()=>{const s=[];return{field:(a,i)=>(s.push(a),em(v0,y0(a),i)),record:E(s)}})(),o=e(t),n=t.record(),r=N(n,s=>Dt({name:s,pname:y0(s)}));return sm(v0,kM,r,CM,o)}},x0=j("valid-input"),w0=j("invalid-input"),S0=j("validating-input"),k0="colorcustom.rgb.",OM=(e,t,o,n)=>{const r=(u,d)=>Tn.config({invalidClass:t("invalid"),notify:{onValidate:m=>{Y(m,S0,{type:u})},onValid:m=>{Y(m,x0,{type:u,value:V.getValue(m)})},onInvalid:m=>{Y(m,w0,{type:u,value:V.getValue(m)})}},validator:{validate:m=>{const p=V.getValue(m),h=d(p)?ue.value(!0):ue.error(e("aria.input.invalid"));return or(h)},validateOnLoad:!1}}),s=(u,d,m,p,h)=>{const f=e("colorcustom.rgb.range"),v=ve.parts.label({dom:{tag:"label",attributes:{"aria-label":p}},components:[dt(m)]}),y=ve.parts.field({data:h,factory:ia,inputAttributes:k({type:"text"},d==="hex"?{"aria-live":"polite"}:{}),inputClasses:[t("textfield")],inputBehaviours:I([r(d,u),qe.config({})]),onSetValue:w=>{Tn.isInvalid(w)&&Tn.run(w).get(H)}}),x=[v,y],b=d!=="hex"?[ve.parts["aria-descriptor"]({text:f})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:x.concat(b)}},a=(u,d)=>{const m=d.red,p=d.green,h=d.blue;V.setValue(u,{red:m,green:p,blue:h})},i=De({dom:{tag:"div",classes:[t("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),l=(u,d)=>{i.getOpt(u).each(m=>{se(m.element,"background-color","#"+d.value)})};return xo({factory:()=>{const u={red:Z(g.some(255)),green:Z(g.some(255)),blue:Z(g.some(255)),hex:Z(g.some("ffffff"))},d=S=>u[S].get(),m=(S,C)=>{u[S].set(C)},p=S=>{const C=S.red,O=S.green,A=S.blue;m("red",g.some(C)),m("green",g.some(O)),m("blue",g.some(A))},h=(S,C)=>{const O=C.event;O.type!=="hex"?m(O.type,g.none()):n(S)},f=(S,C)=>{const O=C.event;(A=>A.type==="hex")(O)?((A,F)=>{o(A);const D=$x(F);m("hex",g.some(F));const R=Ni(D);a(A,R),p(R),Y(A,Og,{hex:D}),l(A,D)})(S,O.value):((A,F,D)=>{const R=parseInt(D,10);m(F,g.some(R)),d("red").bind(L=>d("green").bind(P=>d("blue").map(z=>Ar(L,P,z,1)))).each(L=>{const P=((z,oe)=>{const W=Ri(oe);return fa.getField(z,"hex").each(ne=>{te.isFocused(ne)||V.setValue(z,{hex:W.value})}),W})(A,L);Y(A,Og,{hex:P}),l(A,P)})})(S,O.type,O.value)},v=S=>({label:e(k0+S+".label"),description:e(k0+S+".description")}),y=v("red"),x=v("green"),b=v("blue"),w=v("hex");return je(fa.sketch(S=>({dom:{tag:"form",classes:[t("rgb-form")],attributes:{"aria-label":e("aria.color.picker")}},components:[S.field("red",ve.sketch(s(Jm,"red",y.label,y.description,255))),S.field("green",ve.sketch(s(Jm,"green",x.label,x.description,255))),S.field("blue",ve.sketch(s(Jm,"blue",b.label,b.description,255))),S.field("hex",ve.sketch(s(Kx,"hex",w.label,w.description,"ffffff"))),i.asSpec()],formBehaviours:I([Tn.config({invalidClass:t("form-invalid")}),le("rgb-form-events",[B(x0,f),B(w0,h),B(S0,h)])])})),{apis:{updateHex:(S,C)=>{V.setValue(S,{hex:C.value}),((O,A)=>{const F=Ni(A);a(O,F),p(F)})(S,C),l(S,C)}}})},name:"RgbForm",configFields:[],apis:{updateHex:(u,d,m)=>{u.updateHex(d,m)}},extraApis:{}})},_M=(e,t)=>xo({name:"ColourPicker",configFields:[M("dom"),T("onValidHex",H),T("onInvalidHex",H)],factory:n=>{const r=OM(e,t,n.onValidHex,n.onInvalidHex),s=((f,v)=>{const y=Xo.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[v("sv-palette-spectrum")]}}),x=Xo.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[v("sv-palette-thumb")],innerHtml:`<div class=${v("sv-palette-inner-thumb")} role="presentation"></div>`}}),b=(w,S)=>{const{width:C,height:O}=w,A=w.getContext("2d");if(A===null)return;A.fillStyle=S,A.fillRect(0,0,C,O);const F=A.createLinearGradient(0,0,C,0);F.addColorStop(0,"rgba(255,255,255,1)"),F.addColorStop(1,"rgba(255,255,255,0)"),A.fillStyle=F,A.fillRect(0,0,C,O);const D=A.createLinearGradient(0,0,0,O);D.addColorStop(0,"rgba(0,0,0,0)"),D.addColorStop(1,"rgba(0,0,0,1)"),A.fillStyle=D,A.fillRect(0,0,C,O)};return xo({factory:w=>{const S=E({x:0,y:0}),C=I([de.config({find:g.some}),te.config({})]);return Xo.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[v("sv-palette")]},model:{mode:"xy",getInitialValue:S},rounded:!1,components:[y,x],onChange:(O,A,F)=>{Y(O,b0,{value:F})},onInit:(O,A,F,D)=>{b(F.element.dom,tw(ow))},sliderBehaviours:C})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(w,S,C)=>{((O,A)=>{const F=O.components()[0].element.dom,D=Vi(A,100,100),R=Zx(D);b(F,tw(R))})(S,C)},setThumb:(w,S,C)=>{((O,A)=>{const F=Qm(Ni(A));Xo.setValue(O,{x:F.saturation,y:100-F.value})})(S,C)}},extraApis:{}})})(0,t),a={paletteRgba:Z(ow),paletteHue:Z(0)},i=De(((f,v)=>{const y=Xo.parts.spectrum({dom:{tag:"div",classes:[v("hue-slider-spectrum")],attributes:{role:"presentation"}}}),x=Xo.parts.thumb({dom:{tag:"div",classes:[v("hue-slider-thumb")],attributes:{role:"presentation"}}});return Xo.sketch({dom:{tag:"div",classes:[v("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:E(0)},components:[y,x],sliderBehaviours:I([te.config({})]),onChange:(b,w,S)=>{Y(b,f0,{value:S})}})})(0,t)),l=De(s.sketch({})),c=De(r.sketch({})),u=(f,v,y)=>{l.getOpt(f).each(x=>{s.setHue(x,y)})},d=(f,v)=>{c.getOpt(f).each(y=>{r.updateHex(y,v)})},m=(f,v,y)=>{i.getOpt(f).each(x=>{Xo.setValue(x,(b=>100-b/360*100)(y))})},p=(f,v)=>{l.getOpt(f).each(y=>{s.setThumb(y,v)})},h=(f,v,y,x)=>{((b,w)=>{const S=Ni(b);a.paletteRgba.set(S),a.paletteHue.set(w)})(v,y),q(x,b=>{b(f,v,y)})};return{uid:n.uid,dom:n.dom,components:[l.asSpec(),i.asSpec(),c.asSpec()],behaviours:I([le("colour-picker-events",[B(Og,(()=>{const f=[u,m,p];return(v,y)=>{const x=y.event.hex,b=(w=>Qm(Ni(w)))(x);h(v,x,b.hue,f)}})()),B(b0,(()=>{const f=[d];return(v,y)=>{const x=y.event.value,b=a.paletteHue.get(),w=Vi(b,x.x,100-x.y),S=aw(w);h(v,S,b,f)}})()),B(f0,(()=>{const f=[u,d];return(v,y)=>{const x=(O=>(100-O)/100*360)(y.event.value),b=a.paletteRgba.get(),w=Qm(b),S=Vi(x,w.saturation,w.value),C=aw(S);h(v,C,x,f)}})())]),de.config({find:f=>c.getOpt(f)}),$.config({mode:"acyclic"})])}}}),Ir=()=>de.config({find:g.some}),_g=e=>de.config({find:t=>Gr(t.element,e).bind(o=>t.getSystem().getByDom(o).toOptional())}),TM=X([T("preprocess",xe),T("postprocess",xe)]),C0=(e,t,o)=>V.config({store:k(k({mode:"manual"},e.map(n=>({initialValue:n})).getOr({})),{getValue:t,setValue:o})}),O0=(e,t,o)=>C0(e,n=>t(n.element),(n,r)=>o(n.element,r)),EM=(e,t)=>{const o=Kt("RepresentingConfigs.memento processors",TM,t);return V.config({store:{mode:"manual",getValue:n=>{const r=e.get(n),s=V.getValue(r);return o.postprocess(s)},setValue:(n,r)=>{const s=o.preprocess(r),a=e.get(n);V.setValue(a,s)}}})},AM=O0,ba=C0,Gc=e=>V.config({store:{mode:"memory",initialValue:e}}),MM={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"};var DM=tinymce.util.Tools.resolve("tinymce.Resource"),ws=tinymce.util.Tools.resolve("tinymce.util.Tools");const Tg=j("alloy-fake-before-tabstop"),Eg=j("alloy-fake-after-tabstop"),_0=e=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:I([te.config({ignore:!0}),qe.config({})])}),T0=e=>({dom:{tag:"div",classes:["tox-navobj"]},components:[_0([Tg]),e,_0([Eg])],behaviours:I([_g(1)])}),E0=(e,t)=>{Y(e,ei(),{raw:{which:9,shiftKey:t}})},BM=(e,t)=>{const o=t.element;vo(o,Tg)?E0(e,!0):vo(o,Eg)&&E0(e,!1)},$i=e=>zi(e,["."+Tg,"."+Eg].join(","),Ve),A0=j("toolbar.button.execute"),M0={[fo()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},D0=(e,t,o)=>dn(e,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:o},t),$c=(e,t)=>D0(e,t,[]),B0=(e,t)=>D0(e,t,[re.config({})]),Ag=(e,t,o)=>({dom:{tag:"span",classes:[`${t}__select-label`]},components:[dt(o.translate(e))],behaviours:I([re.config({})])}),va=j("update-menu-text"),F0=j("update-menu-icon"),Mg=(e,t,o)=>{const n=Z(H),r=e.text.map(d=>De(Ag(d,t,o.providers))),s=e.icon.map(d=>De(B0(d,o.providers.icons))),a=(d,m)=>{const p=V.getValue(d);return te.focus(p),Y(p,"keydown",{raw:m.event.raw}),Io.close(p),g.some(!0)},i=e.role.fold(()=>({}),d=>({role:d})),l=e.tooltip.fold(()=>({}),d=>{const m=o.providers.translate(d);return{title:m,"aria-label":m}}),c=dn("chevron-down",{tag:"div",classes:[`${t}__select-chevron`]},o.providers.icons);return De(Io.sketch(k(k(k({},e.uid?{uid:e.uid}:{}),i),{dom:{tag:"button",classes:[t,`${t}--select`].concat(N(e.classes,d=>`${t}--${d}`)),attributes:k({},l)},components:Fi([s.map(d=>d.asSpec()),r.map(d=>d.asSpec()),g.some(c)]),matchWidth:!0,useMinWidth:!0,onOpen:(d,m,p)=>{e.searchable&&(h=>{yx(h).each(f=>te.focus(f))})(p)},dropdownBehaviours:I([...e.dropdownBehaviours,ua(()=>e.disabled||o.providers.isDisabled()),et(),ji.config({}),re.config({}),le("dropdown-events",[Di(e,n),Bi(e,n)]),le("menubutton-update-display-text",[B(va,(d,m)=>{r.bind(p=>p.getOpt(d)).each(p=>{re.set(p,[dt(o.providers.translate(m.event.text))])})}),B(F0,(d,m)=>{s.bind(p=>p.getOpt(d)).each(p=>{re.set(p,[B0(m.event.icon,o.providers.icons)])})})])]),eventOrder:je(M0,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:I([$.config({mode:"special",onLeft:a,onRight:a}),le("dropdown-sandbox-events",[B(bx,(d,m)=>{(p=>{const h=V.getValue(p),f=wc(p).map(xx);Io.refetch(h).get(()=>{const v=Pe.getCoupled(h,"sandbox");f.each(y=>wc(v).each(x=>((b,w)=>{V.setValue(b,w.fetchPattern),b.element.dom.selectionStart=w.selectionStart,b.element.dom.selectionEnd=w.selectionEnd})(x,y)))})})(d),m.stop()}),B(vx,(d,m)=>{((p,h)=>{(f=>ge.getState(f).bind(be.getHighlighted).bind(be.getHighlighted))(p).each(f=>{((v,y,x,b)=>{const w=k(k({},b),{target:y});v.getSystem().triggerEvent(x,y,w)})(p,f.element,h.event.eventType,h.event.interactionEvent)})})(d,m),m.stop()})])]),lazySink:o.getSink,toggleClass:`${t}--active`,parts:{menu:k(k({},xc(0,e.columns,e.presets)),{fakeFocus:e.searchable,onHighlightItem:Tw,onCollapseMenu:(d,m,p)=>{be.getHighlighted(p).each(h=>{Tw(d,p,h)})},onDehighlightItem:FA})},fetch:d=>Mr(Co(e.fetch,d))}))).asSpec()},I0=e=>e.type==="separator",FM={type:"separator"},R0=(e,t)=>{const o=((n,r)=>{const s=Ft(n,(a,i)=>(l=>_e(l))(i)?i===""?a:i==="|"?a.length>0&&!I0(a[a.length-1])?a.concat([FM]):a:Te(r,i.toLowerCase())?a.concat([r[i.toLowerCase()]]):a:a.concat([i]),[]);return s.length>0&&I0(s[s.length-1])&&s.pop(),s})(_e(e)?e.split(" "):e,t);return Bs(o,(n,r)=>{if((s=>Te(s,"getSubmenuItems"))(r)){const s=(i=>{const l=K(i,"value").getOrThunk(()=>j("generated-menu-item"));return je({value:l},i)})(r),a=((i,l)=>{const c=i.getSubmenuItems(),u=R0(c,l);return{item:i,menus:je(u.menus,{[i.value]:u.items}),expansions:je(u.expansions,{[i.value]:i.value})}})(s,t);return{menus:je(n.menus,a.menus),items:[a.item,...n.items],expansions:je(n.expansions,a.expansions)}}return k(k({},n),{items:[r,...n.items]})},{menus:{},expansions:{},items:[]})},ya=(e,t,o,n)=>{const r=j("primary-menu"),s=R0(e,o.shared.providers.menuItems());if(s.items.length===0)return g.none();const a=(d=>d.search.fold(()=>({searchMode:"no-search"}),m=>({searchMode:"search-with-field",placeholder:m.placeholder})))(n),i=Ew(r,s.items,t,o,n.isHorizontalMenu,a),l=(d=>d.search.fold(()=>({searchMode:"no-search"}),m=>({searchMode:"search-with-results"})))(n),c=ft(s.menus,(d,m)=>Ew(m,d,t,o,!1,l)),u=je(c,Jr(r,i));return g.from(us.tieredData(r,u,s.expansions))},Dg=e=>!Te(e,"items"),N0="data-value",V0=(e,t,o,n)=>N(o,r=>Dg(r)?{type:"togglemenuitem",text:r.text,value:r.value,active:r.value===n,onAction:()=>{V.setValue(e,r.value),Y(e,no,{name:t}),te.focus(e)}}:{type:"nestedmenuitem",text:r.text,getSubmenuItems:()=>V0(e,t,r.items,n)}),Bg=(e,t)=>yn(e,o=>Dg(o)?za(o.value===t,o):Bg(o.items,t)),IM=xo({name:"HtmlSelect",configFields:[M("options"),mt("selectBehaviours",[te,V]),T("selectClasses",[]),T("selectAttributes",{}),Se("data")],factory:(e,t)=>{const o=N(e.options,r=>({dom:{tag:"option",value:r.value,innerHtml:r.text}})),n=e.data.map(r=>Jr("initialValue",r)).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:o,behaviours:vt(e.selectBehaviours,[te.config({}),V.config({store:k({mode:"manual",getValue:r=>Xn(r.element),setValue:(r,s)=>{Ke(e.options,a=>a.value===s).isSome()&&qs(r.element,s)}},n)})])}}}),RM=E([T("field1Name","field1"),T("field2Name","field2"),is("onLockedChange"),as(["lockClass"]),T("locked",!1),Qs("coupledFieldBehaviours",[de,V])]),H0=(e,t)=>Dt({factory:ve,name:e,overrides:o=>({fieldBehaviours:I([le("coupled-input-behaviour",[B(Zr(),n=>{((r,s,a)=>Ee(r,s,a).bind(de.getCurrent))(n,o,t).each(r=>{Ee(n,o,"lock").each(s=>{he.isOn(s)&&o.onLockedChange(n,r,s)})})})])])})}),NM=E([H0("field1","field2"),H0("field2","field1"),Dt({factory:Zt,schema:[M("dom")],name:"lock",overrides:e=>({buttonBehaviours:I([he.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])})})]),wo=Vt({name:"FormCoupledInputs",configFields:RM(),partFields:NM(),factory:(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,behaviours:ea(e.coupledFieldBehaviours,[de.config({find:g.some}),V.config({store:{mode:"manual",getValue:r=>{const s=nm(r,e,["field1","field2"]);return{[e.field1Name]:V.getValue(s.field1()),[e.field2Name]:V.getValue(s.field2())}},setValue:(r,s)=>{const a=nm(r,e,["field1","field2"]);Vo(s,e.field1Name)&&V.setValue(a.field1(),s[e.field1Name]),Vo(s,e.field2Name)&&V.setValue(a.field2(),s[e.field2Name])}}})]),apis:{getField1:r=>Ee(r,e,"field1"),getField2:r=>Ee(r,e,"field2"),getLock:r=>Ee(r,e,"lock")}}),apis:{getField1:(e,t)=>e.getField1(t),getField2:(e,t)=>e.getField2(t),getLock:(e,t)=>e.getLock(t)}}),Fg=e=>{const t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(e);if(t!==null){const o=parseFloat(t[1]),n=t[2];return ue.value({value:o,unit:n})}return ue.error(e)},z0=(e,t)=>{const o={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},n=r=>Te(o,r);return e.unit===t?g.some(e.value):n(e.unit)&&n(t)?o[e.unit]===o[t]?g.some(e.value):g.some(e.value/o[e.unit]*o[t]):g.none()},Ig=e=>g.none(),L0=(e,t)=>{const o=e.label.map(c=>Dr(c,t)),n=[Q.config({disabled:()=>e.disabled||t.isDisabled()}),et(),$.config({mode:"execution",useEnter:e.multiline!==!0,useControlEnter:e.multiline===!0,execute:c=>(we(c,Wi),g.some(!0))}),le("textfield-change",[B(Zr(),(c,u)=>{Y(c,no,{name:e.name})}),B(tu(),(c,u)=>{Y(c,no,{name:e.name})})]),qe.config({})],r=e.validation.map(c=>Tn.config({getRoot:u=>Ua(u.element),invalidClass:"tox-invalid",validator:{validate:u=>{const d=V.getValue(u),m=c.validator(d);return or(m===!0?ue.value(d):ue.error(m))},validateOnLoad:c.validateOnLoad}})).toArray(),s=k(k({},e.placeholder.fold(E({}),c=>({placeholder:t.translate(c)}))),e.inputMode.fold(E({}),c=>({inputmode:c}))),a=ve.parts.field(k(k({tag:e.multiline===!0?"textarea":"input"},e.data.map(c=>({data:c})).getOr({})),{inputAttributes:s,inputClasses:[e.classname],inputBehaviours:I(xt([n,r])),selectOnFocus:!1,factory:ia})),i=(e.flex?["tox-form__group--stretched"]:[]).concat(e.maximized?["tox-form-group--maximize"]:[]),l=[Q.config({disabled:()=>e.disabled||t.isDisabled(),onDisabled:c=>{ve.getField(c).each(Q.disable)},onEnabled:c=>{ve.getField(c).each(Q.enable)}}),et()];return Pi(o,a,i,l)};var VM=Object.freeze({__proto__:null,events:(e,t)=>{const o=e.stream.streams.setup(e,t);return Re([B(e.event,o),Cn(()=>t.cancel())].concat(e.cancelEvent.map(n=>[B(n,()=>t.cancel())]).getOr([])))}});const P0=(e,t)=>{let o=null;const n=()=>{il(o)||(clearTimeout(o),o=null)};return{cancel:n,throttle:(...r)=>{n(),o=setTimeout(()=>{o=null,e.apply(null,r)},t)}}},U0=e=>{const t=Z(null);return bo({readState:()=>({timer:t.get()!==null?"set":"unset"}),setTimer:o=>{t.set(o)},cancel:()=>{const o=t.get();o!==null&&o.cancel()}})};var HM=Object.freeze({__proto__:null,throttle:U0,init:e=>e.stream.streams.state(e)}),zM=[go("stream",mo("mode",{throttle:[M("delay"),T("stopEvent",!0),Ne("streams",{setup:(e,t)=>{const o=e.stream,n=P0(e.onStream,o.delay);return t.setTimer(n),(r,s)=>{n.throttle(r,s),o.stopEvent&&s.stop()}},state:U0})]})),T("event","input"),Se("cancelEvent"),is("onStream")];const Rg=bt({fields:zM,name:"streaming",active:VM,state:HM}),qc=(e,t,o)=>{const n=V.getValue(o);V.setValue(t,n),j0(t)},W0=(e,t)=>{const o=e.element,n=Xn(o),r=o.dom;Tt(o,"type")!=="number"&&t(r,n)},j0=e=>{W0(e,(t,o)=>t.setSelectionRange(o.length,o.length))},Ng=E("alloy.typeahead.itemexecute"),LM=E([Se("lazySink"),M("fetch"),T("minChars",5),T("responseTime",1e3),me("onOpen"),T("getHotspot",g.some),T("getAnchorOverrides",E({})),T("layouts",g.none()),T("eventOrder",{}),Yd("model",{},[T("getDisplayText",e=>e.meta!==void 0&&e.meta.text!==void 0?e.meta.text:e.value),T("selectsOver",!0),T("populateFromBrowse",!0)]),me("onSetValue"),to("onExecute"),me("onItemExecute"),T("inputClasses",[]),T("inputAttributes",{}),T("inputStyles",{}),T("matchWidth",!0),T("useMinWidth",!1),T("dismissOnBlur",!0),as(["openClass"]),Se("initialData"),mt("typeaheadBehaviours",[te,V,Rg,$,he,Pe]),zt("lazyTypeaheadComp",()=>Z(g.none)),zt("previewing",()=>Z(!0))].concat(px()).concat(cg())),PM=E([jo({schema:[Hl()],name:"menu",overrides:e=>({fakeFocus:!0,onHighlightItem:(t,o,n)=>{e.previewing.get()?e.lazyTypeaheadComp.get().each(r=>{((s,a,i)=>{if(s.selectsOver){const l=V.getValue(a),c=s.getDisplayText(l),u=V.getValue(i);return s.getDisplayText(u).indexOf(c)===0?g.some(()=>{qc(0,a,i),((d,m)=>{W0(d,(p,h)=>p.setSelectionRange(m,h.length))})(a,c.length)}):g.none()}return g.none()})(e.model,r,n).fold(()=>{e.model.selectsOver?(be.dehighlight(o,n),e.previewing.set(!0)):e.previewing.set(!1)},s=>{s(),e.previewing.set(!1)})}):e.lazyTypeaheadComp.get().each(r=>{e.model.populateFromBrowse&&qc(e.model,r,n)})},onExecute:(t,o)=>e.lazyTypeaheadComp.get().map(n=>(Y(n,Ng(),{item:o}),!0)),onHover:(t,o)=>{e.previewing.set(!1),e.lazyTypeaheadComp.get().each(n=>{e.model.populateFromBrowse&&qc(e.model,n,o)})}})})]),UM=Vt({name:"Typeahead",configFields:LM(),partFields:PM(),factory:(e,t,o,n)=>{const r=(d,m,p)=>{e.previewing.set(!1);const h=Pe.getCoupled(d,"sandbox");if(ge.isOpen(h))de.getCurrent(h).each(f=>{be.getHighlighted(f).fold(()=>{p(f)},()=>{Ef(h,f.element,"keydown",m)})});else{const f=v=>{de.getCurrent(v).each(p)};Dc(e,a(d),d,h,n,f,jt.HighlightMenuAndItem).get(H)}},s=hx(e),a=d=>m=>m.map(p=>{const h=Ed(p.menus),f=nt(h,v=>He(v.items,y=>y.type==="item"));return V.getState(d).update(N(f,v=>v.data)),p}),i=d=>de.getCurrent(d),l="typeaheadevents",c=[te.config({}),V.config({onSetValue:e.onSetValue,store:k({mode:"dataset",getDataKey:d=>Xn(d.element),getFallbackEntry:d=>({value:d,meta:{}}),setValue:(d,m)=>{qs(d.element,e.model.getDisplayText(m))}},e.initialData.map(d=>Jr("initialValue",d)).getOr({}))}),Rg.config({stream:{mode:"throttle",delay:e.responseTime,stopEvent:!1},onStream:(d,m)=>{const p=Pe.getCoupled(d,"sandbox");if(te.isFocused(d)&&Xn(d.element).length>=e.minChars){const h=i(p).bind(v=>be.getHighlighted(v).map(V.getValue));e.previewing.set(!0);const f=v=>{i(p).each(y=>{h.fold(()=>{e.model.selectsOver&&be.highlightFirst(y)},x=>{be.highlightBy(y,b=>V.getValue(b).value===x.value),be.getHighlighted(y).orThunk(()=>(be.highlightFirst(y),g.none()))})})};Dc(e,a(d),d,p,n,f,jt.HighlightJustMenu).get(H)}},cancelEvent:ou()}),$.config({mode:"special",onDown:(d,m)=>(r(d,m,be.highlightFirst),g.some(!0)),onEscape:d=>{const m=Pe.getCoupled(d,"sandbox");return ge.isOpen(m)?(ge.close(m),g.some(!0)):g.none()},onUp:(d,m)=>(r(d,m,be.highlightLast),g.some(!0)),onEnter:d=>{const m=Pe.getCoupled(d,"sandbox"),p=ge.isOpen(m);if(p&&!e.previewing.get())return i(m).bind(h=>be.getHighlighted(h)).map(h=>(Y(d,Ng(),{item:h}),!0));{const h=V.getValue(d);return we(d,ou()),e.onExecute(m,d,h),p&&ge.close(m),g.some(!0)}}}),he.config({toggleClass:e.markers.openClass,aria:{mode:"expanded"}}),Pe.config({others:{sandbox:d=>lg(e,d,{onOpen:()=>he.on(d),onClose:()=>he.off(d)})}}),le(l,[Ge(d=>{e.lazyTypeaheadComp.set(g.some(d))}),Cn(d=>{e.lazyTypeaheadComp.set(g.none())}),qn(d=>{const m=H;ig(e,a(d),d,n,m,jt.HighlightMenuAndItem).get(H)}),B(Ng(),(d,m)=>{const p=Pe.getCoupled(d,"sandbox");qc(e.model,d,m.event.item),we(d,ou()),e.onItemExecute(d,p,m.event.item,V.getValue(d)),ge.close(p),j0(d)})].concat(e.dismissOnBlur?[B(eu(),d=>{const m=Pe.getCoupled(d,"sandbox");sn(m.element).isNone()&&ge.close(m)})]:[]))],u=k({[Ps()]:[V.name(),Rg.name(),l]},e.eventOrder);return{uid:e.uid,dom:fx(je(e,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:k(k({},s),vt(e.typeaheadBehaviours,c)),eventOrder:u}}}),Ss=e=>k(k({},e),{toCached:()=>Ss(e.toCached()),bindFuture:t=>Ss(e.bind(o=>o.fold(n=>or(ue.error(n)),n=>t(n)))),bindResult:t=>Ss(e.map(o=>o.bind(t))),mapResult:t=>Ss(e.map(o=>o.map(t))),mapError:t=>Ss(e.map(o=>o.mapError(t))),foldResult:(t,o)=>e.map(n=>n.fold(t,o)),withTimeout:(t,o)=>Ss(Mr(n=>{let r=!1;const s=setTimeout(()=>{r=!0,n(ue.error(o()))},t);e.get(a=>{r||(clearTimeout(s),n(a))})}))}),WM=e=>Ss(Mr(e)),jM=e=>({isEnabled:()=>!Q.isDisabled(e),setEnabled:t=>Q.set(e,!t),setActive:t=>{const o=e.element;t?(ct(o,"tox-tbtn--enabled"),ie(o,"aria-pressed",!0)):(Ze(o,"tox-tbtn--enabled"),at(o,"aria-pressed"))},isActive:()=>vo(e.element,"tox-tbtn--enabled")}),Vg=(e,t,o,n)=>Mg({text:e.text,icon:e.icon,tooltip:e.tooltip,searchable:e.search.isSome(),role:n,fetch:(r,s)=>{const a={pattern:e.search.isSome()?IA(r):""};e.fetch(i=>{s(ya(i,un.CLOSE_ON_EXECUTE,o,{isHorizontalMenu:!1,search:e.search}))},a)},onSetup:e.onSetup,getApi:jM,columns:1,presets:"normal",classes:[],dropdownBehaviours:[qe.config({})]},t,o.shared),GM=(e,t,o)=>{const n=s=>a=>{const i=!a.isActive();a.setActive(i),s.storage.set(i),o.shared.getSink().each(l=>{t().getOpt(l).each(c=>{Kn(c.element),Y(c,nr,{name:s.name,value:s.storage.get()})})})},r=s=>a=>{a.setActive(s.storage.get())};return s=>{s(N(e,a=>{const i=a.text.fold(()=>({}),l=>({text:l}));return k(k({type:a.type,active:!1},i),{onAction:n(a),onSetup:r(a)})}))}},G0=(e,t,o=[],n,r,s)=>{const a=t.fold(()=>({}),c=>({action:c})),i=k({buttonBehaviours:I([ua(()=>!e.enabled||s.isDisabled()),et(),qe.config({}),le("button press",[Mf("click"),Mf("mousedown")])].concat(o)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},a),l=je(i,{dom:n});return je(l,{components:r})},$M=(e,t,o,n=[])=>{const r={tag:"button",classes:["tox-tbtn"],attributes:e.tooltip.map(i=>({"aria-label":o.translate(i),title:o.translate(i)})).getOr({})},s=e.icon.map(i=>$c(i,o.icons)),a=Fi([s]);return G0(e,t,n,r,a,o)},$0=(e,t,o,n=[],r=[])=>{const s=o.translate(e.text),a=e.icon.map(c=>$c(c,o.icons)),i=[a.getOrThunk(()=>dt(s))],l=[...(c=>{switch(c){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];default:return["tox-button","tox-button--secondary"]}})(e.buttonType.getOr(e.primary||e.borderless?"primary":"secondary")),...a.isSome()?["tox-button--icon"]:[],...e.borderless?["tox-button--naked"]:[],...r];return G0(e,t,n,{tag:"button",classes:l,attributes:{title:s}},i,o)},Hg=(e,t,o,n=[],r=[])=>{const s=$0(e,g.some(t),o,n,r);return Zt.sketch(s)},q0=(e,t)=>o=>{t==="custom"?Y(o,nr,{name:e,value:{}}):t==="submit"?we(o,Wi):t==="cancel"?we(o,fs):console.error("Unknown button type: ",t)},Xc=(e,t,o)=>{if(((n,r)=>r==="menu")(0,t)){const n=()=>a,r=e,s=k(k({},e),{type:"menubutton",search:g.none(),onSetup:i=>(i.setEnabled(e.enabled),H),fetch:GM(r.items,n,o)}),a=De(Vg(s,"tox-tbtn",o,g.none()));return a.asSpec()}if(((n,r)=>r==="custom"||r==="cancel"||r==="submit")(0,t)){const n=q0(e.name,t),r=k(k({},e),{borderless:!1});return Hg(r,n,o.shared.providers,[])}throw console.error("Unknown footer button type: ",t),new Error("Unknown footer button type")},qM={type:"separator"},XM=e=>({type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:H}),zg=(e,t)=>({type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:H}),X0=(e,t)=>(o=>N(o,XM))(((o,n)=>He(n,r=>r.type===o))(e,t)),KM=e=>X0("header",e.targets),YM=e=>X0("anchor",e.targets),JM=e=>g.from(e.anchorTop).map(t=>zg("<top>",t)).toArray(),ZM=e=>g.from(e.anchorBottom).map(t=>zg("<bottom>",t)).toArray(),Lg=(e,t)=>{const o=e.toLowerCase();return He(t,n=>{var r;const s=n.meta!==void 0&&n.meta.text!==void 0?n.meta.text:n.text,a=(r=n.value)!==null&&r!==void 0?r:"";return qt(s.toLowerCase(),o)||qt(a.toLowerCase(),o)})},K0=j("aria-invalid"),QM=(e,t)=>{e.dom.checked=t},eD=e=>e.dom.checked,st=e=>(t,o,n,r)=>K(o,"name").fold(()=>e(o,r,g.none()),s=>t.field(s,e(o,r,K(n,s)))),tD={bar:st((e,t)=>((o,n)=>({dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:N(o.items,n.interpreter)}))(e,t.shared)),collection:st((e,t,o)=>((n,r,s)=>{const a=n.label.map(p=>Dr(p,r)),i=p=>(h,f)=>{rn(f.event.target,"[data-collection-item-value]").each(v=>{p(h,f,v,Tt(v,"data-collection-item-value"))})},l=i((p,h,f,v)=>{h.stop(),r.isDisabled()||Y(p,nr,{name:n.name,value:v})}),c=[B(xr(),i((p,h,f)=>{Kn(f)})),B(oi(),l),B(si(),l),B(wr(),i((p,h,f)=>{ut(p.element,"."+Oi).each(v=>{Ze(v,Oi)}),ct(f,Oi)})),B(n_(),i(p=>{ut(p.element,"."+Oi).each(h=>{Ze(h,Oi)})})),qn(i((p,h,f,v)=>{Y(p,nr,{name:n.name,value:v})}))],u=(p,h)=>N(Ut(p.element,".tox-collection__item"),h),d=ve.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(n.columns!==1?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:xe},behaviours:I([Q.config({disabled:r.isDisabled,onDisabled:p=>{u(p,h=>{ct(h,"tox-collection__item--state-disabled"),ie(h,"aria-disabled",!0)})},onEnabled:p=>{u(p,h=>{Ze(h,"tox-collection__item--state-disabled"),at(h,"aria-disabled")})}}),et(),re.config({}),V.config({store:{mode:"memory",initialValue:s.getOr([])},onSetValue:(p,h)=>{((f,v)=>{const y=N(v,w=>{const S=cn.translate(w.text),C=n.columns===1?`<div class="tox-collection__item-label">${S}</div>`:"",O=`<div class="tox-collection__item-icon">${w.icon}</div>`,A={_:" "," - ":" ","-":" "},F=S.replace(/\_| \- |\-/g,D=>A[D]);return`<div class="tox-collection__item${r.isDisabled()?" tox-collection__item--state-disabled":""}" tabindex="-1" data-collection-item-value="${jA.encodeAllRaw(w.value)}" title="${F}" aria-label="${F}">${O}${C}</div>`}),x=n.columns!=="auto"&&n.columns>1?ah(y,n.columns):[y],b=N(x,w=>`<div class="tox-collection__group">${w.join("")}</div>`);Gs(f.element,b.join(""))})(p,h),n.columns==="auto"&&qm(p,5,"tox-collection__item").each(({numRows:f,numColumns:v})=>{$.setGridSize(p,f,v)}),we(p,Hw)}}),qe.config({}),$.config((m=n.columns,m===1?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:m==="auto"?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:`.${yc}`}})),le("collection-events",c)]),eventOrder:{[fo()]:["disabling","alloy.base.behaviour","collection-events"]}});var m;return Pi(a,d,["tox-form__group--collection"],[])})(e,t.shared.providers,o)),alertbanner:st((e,t)=>((o,n)=>gn.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in",`tox-notification--${o.level}`]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Zt.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:My(o.icon,n.icons),attributes:{title:n.translate(o.iconTooltip)}},action:r=>{Y(r,nr,{name:"alert-banner",value:o.url})},buttonBehaviours:I([xm()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(o.text)}}]}))(e,t.shared.providers)),input:st((e,t,o)=>((n,r,s)=>L0({name:n.name,multiline:!1,label:n.label,inputMode:n.inputMode,placeholder:n.placeholder,flex:!1,disabled:!n.enabled,classname:"tox-textfield",validation:g.none(),maximized:n.maximized,data:s},r))(e,t.shared.providers,o)),textarea:st((e,t,o)=>((n,r,s)=>L0({name:n.name,multiline:!0,label:n.label,inputMode:g.none(),placeholder:n.placeholder,flex:!0,disabled:!n.enabled,classname:"tox-textarea",validation:g.none(),maximized:n.maximized,data:s},r))(e,t.shared.providers,o)),label:st((e,t)=>((o,n)=>{return{dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"label",classes:["tox-label"]},components:[dt(n.providers.translate(o.label))]},...N(o.items,n.interpreter)],behaviours:I([Ir(),re.config({}),(r=g.none(),O0(r,du,Gs)),$.config({mode:"acyclic"})])};var r})(e,t.shared)),iframe:(kS=(e,t,o)=>((n,r,s)=>{const a=n.sandboxed,i=n.transparent,l="tox-dialog__iframe",c=k(k(k({},n.label.map(p=>({title:p})).getOr({})),s.map(p=>({srcdoc:p})).getOr({})),a?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(p=>{const h=Z(p.getOr(""));return{getValue:f=>h.get(),setValue:(f,v)=>{h.get()!==v&&ie(f.element,"srcdoc",v),h.set(v)}}})(s),d=n.label.map(p=>Dr(p,r)),m=ve.parts.field({factory:{sketch:p=>T0({uid:p.uid,dom:{tag:"iframe",attributes:c,classes:i?[l]:[l,`${l}--opaque`]},behaviours:I([qe.config({}),te.config({}),ba(s,u.getValue,u.setValue)])})}});return Pi(d,m,["tox-form__group--stretched"],[])})(e,t.shared.providers,o),(e,t,o,n)=>{const r=je(t,{source:"dynamic"});return st(kS)(e,r,o,n)}),button:st((e,t)=>((o,n)=>{const r=q0(o.name,"custom");return s=g.none(),a=ve.parts.field(k({factory:Zt},$0(o,g.some(r),n,[Gc(""),Ir()]))),Pi(s,a,[],[]);var s,a})(e,t.shared.providers)),checkbox:st((e,t,o)=>((n,r,s)=>{const a=d=>(d.element.dom.click(),g.some(!0)),i=ve.parts.field({factory:{sketch:xe},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:I([Ir(),Q.config({disabled:()=>!n.enabled||r.isDisabled()}),qe.config({}),te.config({}),AM(s,eD,QM),$.config({mode:"special",onEnter:a,onSpace:a,stopSpaceKeyup:!0}),le("checkbox-events",[B(ti(),(d,m)=>{Y(d,no,{name:n.name})})])])}),l=ve.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[dt(r.translate(n.label))],behaviours:I([ji.config({})])}),c=d=>dn(d==="checked"?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+d]},r.icons),u=De({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[c("checked"),c("unchecked")]});return ve.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[i,u.asSpec(),l],fieldBehaviours:I([Q.config({disabled:()=>!n.enabled||r.isDisabled(),disableClass:"tox-checkbox--disabled",onDisabled:d=>{ve.getField(d).each(Q.disable)},onEnabled:d=>{ve.getField(d).each(Q.enable)}}),et()])})})(e,t.shared.providers,o)),colorinput:st((e,t,o)=>((n,r,s,a)=>{const i=ve.parts.field({factory:ia,inputClasses:["tox-textfield"],data:a,onSetValue:d=>Tn.run(d).get(H),inputBehaviours:I([Q.config({disabled:r.providers.isDisabled}),et(),qe.config({}),Tn.config({invalidClass:"tox-textbox-field-invalid",getRoot:d=>Ua(d.element),notify:{onValid:d=>{const m=V.getValue(d);Y(d,Ww,{color:m})}},validator:{validateOnLoad:!1,validate:d=>{const m=V.getValue(d);if(m.length===0)return or(ue.value(!0));{const p=Rs("span");se(p,"background-color",m);const h=Et(p,"background-color").fold(()=>ue.error("blah"),f=>ue.value(m));return or(h)}}}})]),selectOnFocus:!1}),l=n.label.map(d=>Dr(d,r.providers)),c=(d,m)=>{Y(d,jw,{value:m})},u=De(((d,m)=>Io.sketch({dom:d.dom,components:d.components,toggleClass:"mce-active",dropdownBehaviours:I([ua(m.providers.isDisabled),et(),ji.config({}),qe.config({})]),layouts:d.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:m.getSink,fetch:p=>Mr(h=>d.fetch(h)).map(h=>g.from(dg(je(sg(j("menu-value"),h,f=>{d.onItemAction(p,f)},d.columns,d.presets,un.CLOSE_ON_EXECUTE,Ve,m.providers),{movement:Mc(d.columns,d.presets)})))),parts:{menu:xc(0,0,d.presets)}}))({dom:{tag:"span",attributes:{"aria-label":r.providers.translate("Color swatch")}},layouts:{onRtl:()=>[Mt,At,_t],onLtr:()=>[At,Mt,_t]},components:[],fetch:mw(s.getColors(n.storageKey),n.storageKey,s.hasCustomColors()),columns:s.getColorCols(n.storageKey),presets:"color",onItemAction:(d,m)=>{u.getOpt(d).each(p=>{m==="custom"?s.colorPicker(h=>{h.fold(()=>we(p,Gw),f=>{c(p,f),sw(n.storageKey,f)})},"#ffffff"):c(p,m==="remove"?"":m)})}},r));return ve.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:l.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[i,u.asSpec()]}]),fieldBehaviours:I([le("form-field-events",[B(Ww,(d,m)=>{u.getOpt(d).each(p=>{se(p.element,"background-color",m.event.color)}),Y(d,no,{name:n.name})}),B(jw,(d,m)=>{ve.getField(d).each(p=>{V.setValue(p,m.event.value),de.getCurrent(d).each(te.focus)})}),B(Gw,(d,m)=>{ve.getField(d).each(p=>{de.getCurrent(d).each(te.focus)})})])])})})(e,t.shared,t.colorinput,o)),colorpicker:st((e,t,o)=>((n,r,s)=>{const a=c=>"tox-"+c,i=_M((c=>u=>c.translate(MM[u]))(r),a),l=De(i.sketch({dom:{tag:"div",classes:[a("color-picker-container")],attributes:{role:"presentation"}},onValidHex:c=>{Y(c,nr,{name:"hex-valid",value:!0})},onInvalidHex:c=>{Y(c,nr,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[l.asSpec()],behaviours:I([ba(s,c=>{const u=l.get(c);return de.getCurrent(u).bind(d=>V.getValue(d).hex).map(d=>"#"+d).getOr("")},(c,u)=>{const d=g.from(/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(u)).bind(p=>dl(p,1)),m=l.get(c);de.getCurrent(m).fold(()=>{console.log("Can not find form")},p=>{V.setValue(p,{hex:d.getOr("")}),fa.getField(p,"hex").each(h=>{we(h,Zr())})})}),Ir()])}})(0,t.shared.providers,o)),dropzone:st((e,t,o)=>((n,r,s)=>{const a=(h,f)=>{f.stop()},i=h=>(f,v)=>{q(h,y=>{y(f,v)})},l=(h,f)=>{var v;if(!Q.isDisabled(h)){const y=f.event.raw;u(h,(v=y.dataTransfer)===null||v===void 0?void 0:v.files)}},c=(h,f)=>{const v=f.event.raw.target;u(h,v.files)},u=(h,f)=>{f&&(V.setValue(h,((v,y)=>{const x=ws.explode(y.getOption("images_file_types"));return He(OO(v),b=>Yo(x,w=>gl(b.name.toLowerCase(),`.${w.toLowerCase()}`)))})(f,r)),Y(h,no,{name:n.name}))},d=De({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:I([le("input-file-events",[os(oi()),os(si())])])}),m=n.label.map(h=>Dr(h,r)),p=ve.parts.field({factory:{sketch:h=>({uid:h.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:I([Gc(s.getOr([])),Ir(),Q.config({}),he.config({toggleClass:"dragenter",toggleOnExecute:!1}),le("dropzone-events",[B("dragenter",i([a,he.toggle])),B("dragleave",i([a,he.toggle])),B("dragover",a),B("drop",i([a,l])),B(ti(),c)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[dt(r.translate("Drop an image here"))]},Zt.sketch({dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[dt(r.translate("Browse for an image")),d.asSpec()],action:f=>{d.get(f).element.dom.click()},buttonBehaviours:I([qe.config({}),ua(r.isDisabled),et()])})]}]})}});return Pi(m,p,["tox-form__group--stretched"],[])})(e,t.shared.providers,o)),grid:st((e,t)=>((o,n)=>({dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${o.columns}col`]},components:N(o.items,n.interpreter)}))(e,t.shared)),listbox:st((e,t,o)=>((n,r,s)=>{const a=r.shared.providers,i=s.bind(d=>Bg(n.items,d)).orThunk(()=>Hn(n.items).filter(Dg)),l=n.label.map(d=>Dr(d,a)),c=ve.parts.field({dom:{},factory:{sketch:d=>Mg({uid:d.uid,text:i.map(m=>m.text),icon:g.none(),tooltip:n.label,role:g.none(),fetch:(m,p)=>{const h=V0(m,n.name,n.items,V.getValue(m));p(ya(h,un.CLOSE_ON_EXECUTE,r,{isHorizontalMenu:!1,search:g.none()}))},onSetup:E(H),getApi:E({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[qe.config({}),ba(i.map(m=>m.value),m=>Tt(m.element,N0),(m,p)=>{Bg(n.items,p).each(h=>{ie(m.element,N0,h.value),Y(m,va,{text:h.text})})})]},"tox-listbox",r.shared)}}),u={dom:{tag:"div",classes:["tox-listboxfield"]},components:[c]};return ve.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:xt([l.toArray(),[u]]),fieldBehaviours:I([Q.config({disabled:E(!n.enabled),onDisabled:d=>{ve.getField(d).each(Q.disable)},onEnabled:d=>{ve.getField(d).each(Q.enable)}})])})})(e,t,o)),selectbox:st((e,t,o)=>((n,r,s)=>{const a=N(n.items,d=>({text:r.translate(d.text),value:d.value})),i=n.label.map(d=>Dr(d,r)),l=ve.parts.field(k(k({dom:{}},s.map(d=>({data:d})).getOr({})),{selectAttributes:{size:n.size},options:a,factory:IM,selectBehaviours:I([Q.config({disabled:()=>!n.enabled||r.isDisabled()}),qe.config({}),le("selectbox-change",[B(ti(),(d,m)=>{Y(d,no,{name:n.name})})])])})),c=n.size>1?g.none():g.some(dn("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},r.icons)),u={dom:{tag:"div",classes:["tox-selectfield"]},components:xt([[l],c.toArray()])};return ve.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:xt([i.toArray(),[u]]),fieldBehaviours:I([Q.config({disabled:()=>!n.enabled||r.isDisabled(),onDisabled:d=>{ve.getField(d).each(Q.disable)},onEnabled:d=>{ve.getField(d).each(Q.enable)}}),et()])})})(e,t.shared.providers,o)),sizeinput:st((e,t)=>((o,n)=>{let r=Ig;const s=j("ratio-event"),a=p=>dn(p,{tag:"span",classes:["tox-icon","tox-lock-icon__"+p]},n.icons),i=wo.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(o.label.getOr("Constrain proportions"))}},components:[a("lock"),a("unlock")],buttonBehaviours:I([Q.config({disabled:()=>!o.enabled||n.isDisabled()}),et(),qe.config({})])}),l=p=>({dom:{tag:"div",classes:["tox-form__group"]},components:p}),c=p=>ve.parts.field({factory:ia,inputClasses:["tox-textfield"],inputBehaviours:I([Q.config({disabled:()=>!o.enabled||n.isDisabled()}),et(),qe.config({}),le("size-input-events",[B(wr(),(h,f)=>{Y(h,s,{isField1:p})}),B(ti(),(h,f)=>{Y(h,no,{name:o.name})})])]),selectOnFocus:!1}),u=p=>({dom:{tag:"label",classes:["tox-label"]},components:[dt(n.translate(p))]}),d=wo.parts.field1(l([ve.parts.label(u("Width")),c(!0)])),m=wo.parts.field2(l([ve.parts.label(u("Height")),c(!1)]));return wo.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[d,m,l([u("\xA0"),i])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(p,h,f)=>{Fg(V.getValue(p)).each(v=>{r(v).each(y=>{V.setValue(h,(x=>{const b={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4};let w=x.value.toFixed((S=x.unit)in b?b[S]:1);var S;return w.indexOf(".")!==-1&&(w=w.replace(/\.?0*$/,"")),w+x.unit})(y))})})},coupledFieldBehaviours:I([Q.config({disabled:()=>!o.enabled||n.isDisabled(),onDisabled:p=>{wo.getField1(p).bind(ve.getField).each(Q.disable),wo.getField2(p).bind(ve.getField).each(Q.disable),wo.getLock(p).each(Q.disable)},onEnabled:p=>{wo.getField1(p).bind(ve.getField).each(Q.enable),wo.getField2(p).bind(ve.getField).each(Q.enable),wo.getLock(p).each(Q.enable)}}),et(),le("size-input-events2",[B(s,(p,h)=>{const f=h.event.isField1,v=f?wo.getField1(p):wo.getField2(p),y=f?wo.getField2(p):wo.getField1(p),x=v.map(V.getValue).getOr(""),b=y.map(V.getValue).getOr("");r=((w,S)=>{const C=Fg(w).toOptional(),O=Fg(S).toOptional();return ml(C,O,(A,F)=>z0(A,F.unit).map(D=>F.value/D).map(D=>{return R=D,L=F.unit,P=>z0(P,L).map(z=>({value:z*R,unit:L}));var R,L}).getOr(Ig)).getOr(Ig)})(x,b)})])])})})(e,t.shared.providers)),slider:st((e,t,o)=>((n,r,s)=>{const a=Xo.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[dt(r.translate(n.label))]}),i=Xo.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),l=Xo.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Xo.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:n.min,maxX:n.max,getInitialValue:E(s.getOrThunk(()=>(Math.abs(n.max)-Math.abs(n.min))/2))},components:[a,i,l],sliderBehaviours:I([Ir(),te.config({})]),onChoose:(c,u,d)=>{Y(c,no,{name:n.name,value:d})}})})(e,t.shared.providers,o)),urlinput:st((e,t,o)=>((n,r,s,a)=>{const i=r.shared.providers,l=x=>{const b=V.getValue(x);s.addToHistory(b.value,n.filetype)},c=k(k({},a.map(x=>({initialData:x})).getOr({})),{dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":K0,type:"url"},minChars:0,responseTime:0,fetch:x=>{const b=((S,C,O)=>{const A=V.getValue(C),F=A.meta.text!==void 0?A.meta.text:A.value;return O.getLinkInformation().fold(()=>[],D=>{const R=Lg(F,(P=>N(P,z=>zg(z,z)))(O.getHistory(S)));return S==="file"?(L=[R,Lg(F,KM(D)),Lg(F,xt([JM(D),YM(D),ZM(D)]))],Ft(L,(P,z)=>P.length===0||z.length===0?P.concat(z):P.concat(qM,z),[])):R;var L})})(n.filetype,x,s),w=ya(b,un.BUBBLE_TO_SANDBOX,r,{isHorizontalMenu:!1,search:g.none()});return or(w)},getHotspot:x=>v.getOpt(x),onSetValue:(x,b)=>{x.hasConfigured(Tn)&&Tn.run(x).get(H)},typeaheadBehaviours:I([...s.getValidationHandler().map(x=>Tn.config({getRoot:b=>Ua(b.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(b,w)=>{m.getOpt(b).each(S=>{ie(S.element,"title",i.translate(w))})}},validator:{validate:b=>{const w=V.getValue(b);return WM(S=>{x({type:n.filetype,url:w.value},C=>{if(C.status==="invalid"){const O=ue.error(C.message);S(O)}else{const O=ue.value(C.message);S(O)}})})},validateOnLoad:!1}})).toArray(),Q.config({disabled:()=>!n.enabled||i.isDisabled()}),qe.config({}),le("urlinput-events",[B(Zr(),x=>{const b=Xn(x.element),w=b.trim();w!==b&&qs(x.element,w),n.filetype==="file"&&Y(x,no,{name:n.name})}),B(ti(),x=>{Y(x,no,{name:n.name}),l(x)}),B(tu(),x=>{Y(x,no,{name:n.name}),l(x)})])]),eventOrder:{[Zr()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:x=>x.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:r.shared.getSink,parts:{menu:xc(0,0,"normal")},onExecute:(x,b,w)=>{Y(b,Wi,{})},onItemExecute:(x,b,w,S)=>{l(x),Y(x,no,{name:n.name})}}),u=ve.parts.field(k(k({},c),{factory:UM})),d=n.label.map(x=>Dr(x,i)),m=De(((x,b,w=x,S=x)=>dn(w,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+x],attributes:k({title:i.translate(S),"aria-live":"polite"},b.fold(()=>({}),C=>({id:C})))},i.icons))("invalid",g.some(K0),"warning")),p=De({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[m.asSpec()]}),h=s.getUrlPicker(n.filetype),f=j("browser.url.event"),v=De({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,p.asSpec()],behaviours:I([Q.config({disabled:()=>!n.enabled||i.isDisabled()})])}),y=De(Hg({name:n.name,icon:g.some("browse"),text:n.label.getOr(""),enabled:n.enabled,primary:!1,buttonType:g.none(),borderless:!0},x=>we(x,f),i,[],["tox-browse-url"]));return ve.sketch({dom:Nw([]),components:d.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:xt([[v.asSpec()],h.map(()=>y.asSpec()).toArray()])}]),fieldBehaviours:I([Q.config({disabled:()=>!n.enabled||i.isDisabled(),onDisabled:x=>{ve.getField(x).each(Q.disable),y.getOpt(x).each(Q.disable)},onEnabled:x=>{ve.getField(x).each(Q.enable),y.getOpt(x).each(Q.enable)}}),et(),le("url-input-events",[B(f,x=>{de.getCurrent(x).each(b=>{const w=V.getValue(b),S=k({fieldname:n.name},w);h.each(C=>{C(S).get(O=>{V.setValue(b,O),Y(x,no,{name:n.name})})})})})])])})})(e,t,t.urlinput,o)),customeditor:st(e=>{const t=ze(),o=De({dom:{tag:e.tag}}),n=ze();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:I([le("custom-editor-events",[Ge(r=>{o.getOpt(r).each(s=>{((a=>Te(a,"init"))(e)?e.init(s.element.dom):DM.load(e.scriptId,e.scriptUrl).then(a=>a(s.element.dom,e.settings))).then(a=>{n.on(i=>{a.setValue(i)}),n.clear(),t.set(a)})})})]),ba(g.none(),()=>t.get().fold(()=>n.get().getOr(""),r=>r.getValue()),(r,s)=>{t.get().fold(()=>n.set(s),a=>a.setValue(s))}),Ir()]),components:[o.asSpec()]}}),htmlpanel:st(e=>e.presets==="presentation"?gn.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}):gn.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:I([qe.config({}),te.config({})])})),imagepreview:st((e,t,o)=>((n,r)=>{const s=Z(r.getOr({url:""})),a=De({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:r.map(u=>({src:u.url})).getOr({})}}),i=De({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[a.asSpec()]}),l={};n.height.each(u=>l.height=u);const c=r.map(u=>({url:u.url,zoom:g.from(u.zoom),cachedWidth:g.from(u.cachedWidth),cachedHeight:g.from(u.cachedHeight)}));return{dom:{tag:"div",classes:["tox-imagepreview"],styles:l,attributes:{role:"presentation"}},components:[i.asSpec()],behaviours:I([Ir(),ba(c,()=>s.get(),(u,d)=>{const m={url:d.url};d.zoom.each(h=>m.zoom=h),d.cachedWidth.each(h=>m.cachedWidth=h),d.cachedHeight.each(h=>m.cachedHeight=h),s.set(m);const p=()=>{const{cachedWidth:h,cachedHeight:f,zoom:v}=m;if(!Vn(h)&&!Vn(f)){if(Vn(v)){const x=((b,w,S)=>{const C=Xt(b),O=Rt(b);return Math.min(C/w,O/S,1)})(u.element,h,f);m.zoom=x}const y=((x,b,w,S,C)=>{const O=w*C,A=S*C,F=Math.max(0,x/2-O/2),D=Math.max(0,b/2-A/2);return{left:F.toString()+"px",top:D.toString()+"px",width:O.toString()+"px",height:A.toString()+"px"}})(Xt(u.element),Rt(u.element),h,f,m.zoom);i.getOpt(u).each(x=>{Ns(x.element,y)})}};a.getOpt(u).each(h=>{const f=h.element;var v;d.url!==Tt(f,"src")&&(ie(f,"src",d.url),Ze(u.element,"tox-imagepreview__loaded")),p(),(v=f,new Promise((y,x)=>{const b=()=>{S(),y(v)},w=[Pt(v,"load",b),Pt(v,"error",()=>{S(),x("Unable to load data from image: "+v.dom.src)})],S=()=>q(w,C=>C.unbind());v.dom.complete&&b()})).then(y=>{u.getSystem().isConnected()&&(ct(u.element,"tox-imagepreview__loaded"),m.cachedWidth=y.dom.naturalWidth,m.cachedHeight=y.dom.naturalHeight,p())})})})])}})(e,o)),table:st((e,t)=>((o,n)=>{const r=i=>({dom:{tag:"td",innerHtml:n.translate(i)}});return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(a=o.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:N(a,i=>({dom:{tag:"th",innerHtml:n.translate(i)}}))}]}),(s=o.cells,{dom:{tag:"tbody"},components:N(s,i=>({dom:{tag:"tr"},components:N(i,r)}))})],behaviours:I([qe.config({}),te.config({})])};var s,a})(e,t.shared.providers)),panel:st((e,t)=>((o,n)=>({dom:{tag:"div",classes:o.classes},components:N(o.items,n.shared.interpreter)}))(e,t))},oD={field:(e,t)=>t,record:E([])},Y0=(e,t,o,n)=>{const r=je(n,{shared:{interpreter:s=>Pg(e,s,o,r)}});return Pg(e,t,o,r)},Pg=(e,t,o,n)=>K(tD,t.type).fold(()=>(console.error(`Unknown factory type "${t.type}", defaulting to container: `,t),t),r=>r(e,t,o,n)),J0=(e,t,o)=>Pg(oD,e,t,o),Rr="layout-inset",Ug=e=>e.x,Z0=(e,t)=>e.x+e.width/2-t.width/2,Wg=(e,t)=>e.x+e.width-t.width,jg=e=>e.y,Gg=(e,t)=>e.y+e.height-t.height,Q0=(e,t)=>e.y+e.height/2-t.height/2,Kc=(e,t,o)=>Ct(Wg(e,t),Gg(e,t),o.insetSouthwest(),ku(),"southwest",Ot(e,{right:0,bottom:3}),Rr),Yc=(e,t,o)=>Ct(Ug(e),Gg(e,t),o.insetSoutheast(),Su(),"southeast",Ot(e,{left:1,bottom:3}),Rr),qi=(e,t,o)=>Ct(Wg(e,t),jg(e),o.insetNorthwest(),wu(),"northwest",Ot(e,{right:0,top:2}),Rr),Xi=(e,t,o)=>Ct(Ug(e),jg(e),o.insetNortheast(),Ll(),"northeast",Ot(e,{left:1,top:2}),Rr),An=(e,t,o)=>Ct(Z0(e,t),jg(e),o.insetNorth(),Zf(),"north",Ot(e,{top:2}),Rr),Ki=(e,t,o)=>Ct(Z0(e,t),Gg(e,t),o.insetSouth(),Qf(),"south",Ot(e,{bottom:3}),Rr),eS=(e,t,o)=>Ct(Wg(e,t),Q0(e,t),o.insetEast(),tb(),"east",Ot(e,{right:0}),Rr),tS=(e,t,o)=>Ct(Ug(e),Q0(e,t),o.insetWest(),eb(),"west",Ot(e,{left:1}),Rr),nD=e=>{switch(e){case"north":return An;case"northeast":return Xi;case"northwest":return qi;case"south":return Ki;case"southeast":return Yc;case"southwest":return Kc;case"east":return eS;case"west":return tS}},oS=(e,t,o,n,r)=>bb(n).map(nD).getOr(An)(e,t,o,n,r),rD=e=>{switch(e){case"north":return Ki;case"northeast":return Yc;case"northwest":return Kc;case"south":return An;case"southeast":return Xi;case"southwest":return qi;case"east":return tS;case"west":return eS}},sD=(e,t,o,n,r)=>bb(n).map(rD).getOr(An)(e,t,o,n,r),nS={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},aD=(e,t,o)=>{const n={maxHeightFunction:ci()};return()=>o()?{type:"node",root:vl(_o(e())),node:g.from(e()),bubble:Js(12,12,nS),layouts:{onRtl:()=>[Xi],onLtr:()=>[qi]},overrides:n}:{type:"hotspot",hotspot:t(),bubble:Js(-12,12,nS),layouts:{onRtl:()=>[At],onLtr:()=>[Mt]},overrides:n}},iD=(e,t,o)=>()=>o()?{type:"node",root:vl(_o(e())),node:g.from(e()),layouts:{onRtl:()=>[An],onLtr:()=>[An]}}:{type:"hotspot",hotspot:t(),layouts:{onRtl:()=>[_t],onLtr:()=>[_t]}},lD=(e,t)=>()=>({type:"selection",root:t(),getSelection:()=>{const o=e.selection.getRng();return g.some(di.range(U(o.startContainer),o.startOffset,U(o.endContainer),o.endOffset))}}),cD=e=>t=>({type:"node",root:e(),node:t}),dD=(e,t,o)=>{const n=ki(e),r=()=>U(e.getBody()),s=()=>U(e.getContentAreaContainer()),a=()=>n||!o();return{inlineDialog:aD(s,t,a),banner:iD(s,t,a),cursor:lD(e,r),node:cD(r)}},uD=e=>(t,o)=>{fw(e)(t,o)},mD=e=>()=>lw(e),gD=e=>t=>Hi(e,t),pD=e=>t=>iw(e,t),hD=e=>()=>Ky(e),rS=e=>Vo(e,"items"),sS=e=>Vo(e,"format"),aS=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],iS=e=>Ft(e,(t,o)=>{if(Te(o,"items")){const n=iS(o.items);return{customFormats:t.customFormats.concat(n.customFormats),formats:t.formats.concat([{title:o.title,items:n.formats}])}}if(Te(o,"inline")||(n=>Te(n,"block"))(o)||(n=>Te(n,"selector"))(o)){const n=`custom-${_e(o.name)?o.name:o.title.toLowerCase()}`;return{customFormats:t.customFormats.concat([{name:n,format:o}]),formats:t.formats.concat([{title:o.title,format:n,icon:o.icon}])}}return k(k({},t),{formats:t.formats.concat(o)})},{customFormats:[],formats:[]}),lS=e=>Iy(e).map(t=>{const o=((n,r)=>{const s=iS(r),a=i=>{q(i,l=>{n.formatter.has(l.name)||n.formatter.register(l.name,l.format)})};return n.formatter?a(s.customFormats):n.on("init",()=>{a(s.customFormats)}),s.formats})(e,t);return Ry(e)?aS.concat(o):o}).getOr(aS),cS=(e,t,o)=>k(k({},e),{type:"formatter",isSelected:t(e.format),getStylePreview:o(e.format)}),dS=(e,t,o,n)=>{const r=s=>N(s,a=>rS(a)?(i=>{const l=r(i.items);return k(k({},i),{type:"submenu",getStyleItems:E(l)})})(a):sS(a)?(i=>cS(i,o,n))(a):(i=>{const l=rt(i);return l.length===1&&ht(l,"title")})(a)?k(k({},a),{type:"separator"}):(i=>{const l=_e(i.name)?i.name:j(i.title),c=`custom-${l}`,u=k(k({},i),{type:"formatter",format:c,isSelected:o(c),getStylePreview:n(c)});return e.formatter.register(l,u),u})(a));return r(t)},fD=ws.trim,uS=e=>t=>!!((o=>No(o)&&o.nodeType===1)(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e)),bD=uS("true"),vD=uS("false"),mS=(e,t,o,n,r)=>({type:e,title:t,url:o,level:n,attach:r}),gS=e=>e.innerText||e.textContent,yD=e=>(t=>t&&t.nodeName==="A"&&(t.id||t.name)!==void 0)(e)&&hS(e),pS=e=>e&&/^(H[1-6])$/.test(e.nodeName),hS=e=>(t=>{let o=t;for(;o=o.parentNode;){const n=o.contentEditable;if(n&&n!=="inherit")return bD(o)}return!1})(e)&&!vD(e),xD=e=>pS(e)&&hS(e),wD=e=>{var t;const o=(n=>n.id?n.id:j("h"))(e);return mS("header",(t=gS(e))!==null&&t!==void 0?t:"","#"+o,(n=>pS(n)?parseInt(n.nodeName.substr(1),10):0)(e),()=>{e.id=o})},SD=e=>{const t=e.id||e.name,o=gS(e);return mS("anchor",o||"#"+t,"#"+t,0,H)},kD=e=>fD(e.title).length>0,CD=e=>{const t=(o=>N(Ut(U(o),"h1,h2,h3,h4,h5,h6,a:not([href])"),r=>r.dom))(e);return He((o=>N(He(o,xD),wD))(t).concat((o=>N(He(o,yD),SD))(t)),kD)},Jc="tinymce-url-history",fS=e=>_e(e)&&/^https?/.test(e),bS=e=>gr(e)&&Td(e,t=>{return!(pr(o=t)&&o.length<=5&&Is(o,fS));var o}).isNone(),vS=()=>{const e=hs.getItem(Jc);if(e===null)return{};let t;try{t=JSON.parse(e)}catch(o){if(o instanceof SyntaxError)return console.log("Local storage "+Jc+" was not valid JSON",o),{};throw o}return bS(t)?t:(console.log("Local storage "+Jc+" was not valid format",t),{})},OD=e=>{const t=vS();return K(t,e).getOr([])},_D=(e,t)=>{if(!fS(e))return;const o=vS(),n=K(o,t).getOr([]),r=He(n,s=>s!==e);o[t]=[e].concat(r).slice(0,5),(s=>{if(!bS(s))throw new Error(`Bad format for history:
`+JSON.stringify(s));hs.setItem(Jc,JSON.stringify(s))})(o)},yS=e=>!!e,TD=e=>ft(ws.makeMap(e,/[, ]/),yS),$g=e=>g.from(Wy(e)),xS=e=>g.from(e).filter(_e).getOrUndefined(),ED=e=>({getHistory:OD,addToHistory:_D,getLinkInformation:()=>(t=>$y(t)?g.some({targets:CD(t.getBody()),anchorTop:xS(qy(t)),anchorBottom:xS(Xy(t))}):g.none())(e),getValidationHandler:()=>(t=>g.from(jy(t)))(e),getUrlPicker:t=>((o,n)=>((r,s)=>{const a=(i=>{const l=g.from(Gy(i)).filter(yS).map(TD);return $g(i).fold(Ve,c=>l.fold(pt,u=>rt(u).length>0&&u))})(r);return Nn(a)?a?$g(r):g.none():a[s]?$g(r):g.none()})(o,n).map(r=>s=>Mr(a=>{const i=k({filetype:n,fieldname:s.fieldname},g.from(s.meta).getOr({}));r.call(o,(l,c)=>{if(!_e(l))throw new Error("Expected value to be string");if(c!==void 0&&!gr(c))throw new Error("Expected meta to be a object");a({value:l,meta:c})},s.value,i)})))(e,t)}),gt=LT,Mn=HT,AD=E([T("shell",!1),M("makeItem"),T("setupItem",H),Qs("listBehaviours",[re])]),MD=Bo({name:"items",overrides:()=>({behaviours:I([re.config({})])})}),DD=E([MD]),wS=Vt({name:E("CustomList")(),configFields:AD(),partFields:DD(),factory:(e,t,o,n)=>{const r=e.shell?{behaviours:[re.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:r.components,behaviours:vt(e.listBehaviours,r.behaviours),apis:{setItems:(s,a)=>{var i;(i=s,e.shell?g.some(i):Ee(i,e,"items")).fold(()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},l=>{const c=re.contents(l),u=a.length,d=u-c.length,m=d>0?Cd(d,()=>e.makeItem()):[],p=c.slice(u);q(p,f=>re.remove(l,f)),q(m,f=>re.append(l,f));const h=re.contents(l);q(h,(f,v)=>{e.setupItem(s,f,a[v],v)})})}}}},apis:{setItems:(e,t,o)=>{e.setItems(t,o)}}}),xa=E([M("dom"),T("shell",!0),mt("toolbarBehaviours",[re])]),BD=E([Bo({name:"groups",overrides:()=>({behaviours:I([re.config({})])})})]),pn=Vt({name:"Toolbar",configFields:xa(),partFields:BD(),factory:(e,t,o,n)=>{const r=e.shell?{behaviours:[re.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:r.components,behaviours:vt(e.toolbarBehaviours,r.behaviours),apis:{setGroups:(s,a)=>{var i;(i=s,e.shell?g.some(i):Ee(i,e,"groups")).fold(()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},l=>{re.set(l,a)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)}}}),FD=H,ID=Ve,SS=E([]);var kS,RD=Object.freeze({__proto__:null,setup:FD,isDocked:ID,getBehaviours:SS});const CS=e=>(Jo(Et(e,"position"),"fixed")?g.none():vh(e)).orThunk(()=>{const t=Rs("span");return xn(e).bind(o=>{zo(o,t);const n=vh(t);return Un(t),n})}),OS=e=>CS(e).map(fr).getOrThunk(()=>We(0,0)),qg=Mo([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),ND=(e,t)=>{const o=e.element;ct(o,t.transitionClass),Ze(o,t.fadeOutClass),ct(o,t.fadeInClass),t.onShow(e)},VD=(e,t)=>{const o=e.element;ct(o,t.transitionClass),Ze(o,t.fadeInClass),ct(o,t.fadeOutClass),t.onHide(e)},_S=(e,t,o)=>Is(e,n=>{switch(n){case"bottom":return((r,s)=>r.bottom<=s.bottom)(t,o);case"top":return((r,s)=>r.y>=s.y)(t,o)}}),TS=(e,t)=>t.getInitialPos().map(o=>Nt(o.bounds.x,o.bounds.y,Xt(e),Rt(e))),ES=(e,t,o)=>o.getInitialPos().bind(n=>{switch(o.clearInitialPos(),n.position){case"static":return g.some(qg.static());case"absolute":const r=CS(e).map(Qt).getOrThunk(()=>Qt(Ln()));return g.some(qg.absolute(an("absolute",K(n.style,"left").map(s=>t.x-r.x),K(n.style,"top").map(s=>t.y-r.y),K(n.style,"right").map(s=>r.right-t.right),K(n.style,"bottom").map(s=>r.bottom-t.bottom))));default:return g.none()}}),HD=(e,t,o)=>{const n=e.element;return Jo(Et(n,"position"),"fixed")?((r,s,a)=>TS(r,a).filter(i=>_S(a.getModes(),i,s)).bind(i=>ES(r,i,a)))(n,t,o):((r,s,a)=>{const i=Qt(r);if(_S(a.getModes(),i,s))return g.none();{((p,h,f)=>{f.setInitialPos({style:Eh(p),position:co(p,"position")||"static",bounds:h})})(r,i,a);const l=kn(),c=i.x-l.x,u=s.y-l.y,d=l.bottom-s.bottom,m=i.y<=s.y;return g.some(qg.fixed(an("fixed",g.some(c),m?g.some(u):g.none(),g.none(),m?g.none():g.some(d))))}})(n,t,o)},AS=(e,t,o)=>{o.setDocked(!1),q(["left","right","top","bottom","position"],n=>Me(e.element,n)),t.onUndocked(e)},Xg=(e,t,o,n)=>{const r=n.position==="fixed";o.setDocked(r),gb(e.element,n),(r?t.onDocked:t.onUndocked)(e)},MS=(e,t,o,n,r=!1)=>{t.contextual.each(s=>{s.lazyContext(e).each(a=>{const i=((l,c)=>l.y<c.bottom&&l.bottom>c.y)(a,n);i!==o.isVisible()&&(o.setVisible(i),r&&!i?(rs(e.element,[s.fadeOutClass]),s.onHide(e)):(i?ND:VD)(e,s))})})},Kg=(e,t,o)=>{e.getSystem().isConnected()&&((n,r,s)=>{const a=r.lazyViewport(n);s.isDocked()&&MS(n,r,s,a),HD(n,a,s).each(i=>{i.fold(()=>AS(n,r,s),l=>Xg(n,r,s,l),l=>{MS(n,r,s,a,!0),Xg(n,r,s,l)})})})(e,t,o)},DS=(e,t,o)=>{o.isDocked()&&((n,r,s)=>{const a=n.element;s.setDocked(!1),((i,l)=>{const c=i.element;return TS(c,l).bind(u=>ES(c,u,l))})(n,s).each(i=>{i.fold(()=>AS(n,r,s),l=>Xg(n,r,s,l),H)}),s.setVisible(!0),r.contextual.each(i=>{nn(a,[i.fadeInClass,i.fadeOutClass,i.transitionClass]),i.onShow(n)}),Kg(n,r,s)})(e,t,o)};var zD=Object.freeze({__proto__:null,refresh:Kg,reset:DS,isDocked:(e,t,o)=>o.isDocked(),getModes:(e,t,o)=>o.getModes(),setModes:(e,t,o,n)=>o.setModes(n)}),LD=Object.freeze({__proto__:null,events:(e,t)=>Re([js(ni(),(o,n)=>{e.contextual.each(r=>{vo(o.element,r.transitionClass)&&(nn(o.element,[r.transitionClass,r.fadeInClass]),(t.isVisible()?r.onShown:r.onHidden)(o)),n.stop()})}),B(nu(),(o,n)=>{Kg(o,e,t)}),B(Bl(),(o,n)=>{DS(o,e,t)})])}),PD=[po("contextual",[it("fadeInClass"),it("fadeOutClass"),it("transitionClass"),Lo("lazyContext"),me("onShow"),me("onShown"),me("onHide"),me("onHidden")]),lt("lazyViewport",kn),El("modes",["top","bottom"],wt),me("onDocked"),me("onUndocked")];const Ht=bt({fields:PD,name:"docking",active:LD,apis:zD,state:Object.freeze({__proto__:null,init:e=>{const t=Z(!1),o=Z(!0),n=ze(),r=Z(e.modes);return bo({isDocked:t.get,setDocked:t.set,getInitialPos:n.get,setInitialPos:n.set,clearInitialPos:n.clear,isVisible:o.get,setVisible:o.set,getModes:r.get,setModes:r.set,readState:()=>`docked:  ${t.get()}, visible: ${o.get()}, modes: ${r.get().join(",")}`})}})}),Yg=E(j("toolbar-height-change")),Dn={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},BS="tox-tinymce--toolbar-sticky-on",FS="tox-tinymce--toolbar-sticky-off",Jg=(e,t)=>ht(Ht.getModes(e),t),Zg=e=>{const t=e.element;Ua(t).each(o=>{const n="padding-"+Ht.getModes(e)[0];if(Ht.isDocked(e)){const r=Xt(o);se(t,"width",r+"px"),se(o,n,(s=>$r(s)+(parseInt(co(s,"margin-top"),10)||0)+(parseInt(co(s,"margin-bottom"),10)||0))(t)+"px")}else Me(t,"width"),Me(o,n)})},IS=(e,t)=>{t?(Ze(e,Dn.fadeOutClass),rs(e,[Dn.transitionClass,Dn.fadeInClass])):(Ze(e,Dn.fadeInClass),rs(e,[Dn.fadeOutClass,Dn.transitionClass]))},RS=(e,t)=>{const o=U(e.getContainer());t?(ct(o,BS),Ze(o,FS)):(ct(o,FS),Ze(o,BS))},NS=(e,t)=>{const o=ze(),n=t.getSink,r=i=>{n().each(l=>i(l.element))},s=i=>{e.inline||Zg(i),RS(e,Ht.isDocked(i)),i.getSystem().broadcastOn([Zs()],{}),n().each(l=>l.getSystem().broadcastOn([Zs()],{}))},a=e.inline?[]:[Wo.config({channels:{[Yg()]:{onReceive:Zg}}})];return[te.config({}),Ht.config({contextual:k({lazyContext:i=>{const l=$r(i.element),c=e.inline?e.getContentAreaContainer():e.getContainer(),u=Qt(U(c)),d=u.height-l,m=u.y+(Jg(i,"top")?0:l);return g.some(Nt(u.x,m,u.width,d))},onShow:()=>{r(i=>IS(i,!0))},onShown:i=>{r(l=>nn(l,[Dn.transitionClass,Dn.fadeInClass])),o.get().each(l=>{((c,u)=>{const d=Zo(u);Yn(d).filter(m=>!Le(u,m)).filter(m=>Le(m,U(d.dom.body))||fl(c,m)).each(()=>Kn(u))})(i.element,l),o.clear()})},onHide:i=>{((l,c)=>sn(l).orThunk(()=>c().toOptional().bind(u=>sn(u.element))))(i.element,n).fold(o.clear,o.set),r(l=>IS(l,!1))},onHidden:()=>{r(i=>nn(i,[Dn.transitionClass]))}},Dn),lazyViewport:i=>{const l=kn(),c=Py(e),u=l.y+(Jg(i,"top")?c:0),d=l.height-(Jg(i,"bottom")?c:0);return Nt(l.x,u,l.width,d)},modes:[t.header.getDockingMode()],onDocked:s,onUndocked:s}),...a]};var UD=Object.freeze({__proto__:null,setup:(e,t,o)=>{e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",()=>{o().each(Ht.reset)}),e.on("ResizeWindow ResizeEditor",()=>{o().each(Zg)}),e.on("SkinLoaded",()=>{o().each(n=>{Ht.isDocked(n)?Ht.reset(n):Ht.refresh(n)})}),e.on("FullscreenStateChanged",()=>{o().each(Ht.reset)})),e.on("AfterScrollIntoView",n=>{o().each(r=>{Ht.refresh(r);const s=r.element;Uv(s)&&((a,i)=>{const l=Zo(i),c=Pa(i).dom.innerHeight,u=Sn(l),d=U(a.elm),m=Xr(d),p=Rt(d),h=m.y,f=h+p,v=fr(i),y=Rt(i),x=v.top,b=x+y,w=Math.abs(x-u.top)<2,S=Math.abs(b-(u.top+c))<2;if(w&&h<b)Qh(u.left,h-y,l);else if(S&&f>x){const C=h-c+p+y;Qh(u.left,C,l)}})(n,s)})}),e.on("PostRender",()=>{RS(e,!1)})},isDocked:e=>e().map(Ht.isDocked).getOr(!1),getBehaviours:NS});const WD=X([Ye,go("items",Gd([$d([Lm,Eo("items",wt)]),wt]))].concat(Ti)),jD=[eo("text"),eo("tooltip"),eo("icon"),Ao("search",!1,Gd([Xa,X([eo("placeholder")])],e=>Nn(e)?e?g.some({placeholder:g.none()}):g.none():g.some(e))),Lo("fetch"),lt("onSetup",()=>H)],GD=X([Ye,...jD]),VS=e=>Ue("menubutton",GD,e),$D=X([Ye,Cc,mn,ca,FE,EE,gs,Gn("presets","normal",["normal","color","listpreview"]),Ox(1),la,ME]);var Qg=xo({factory:(e,t)=>{const o={focus:$.focusIn,setMenus:(n,r)=>{const s=N(r,a=>{const i={type:"menubutton",text:a.text,fetch:c=>{c(a.getItems())}},l=VS(i).mapError(c=>Hs(c)).getOrDie();return Vg(l,"tox-mbtn",t.backstage,g.some("menuitem"))});re.set(n,s)}};return{uid:e.uid,dom:e.dom,components:[],behaviours:I([re.config({}),le("menubar-events",[Ge(n=>{e.onSetup(n)}),B(xr(),(n,r)=>{ut(n.element,".tox-mbtn--active").each(s=>{rn(r.event.target,".tox-mbtn").each(a=>{Le(s,a)||n.getSystem().getByDom(s).each(i=>{n.getSystem().getByDom(a).each(l=>{Io.expand(l),Io.close(i),te.focus(l)})})})})}),B(Cf(),(n,r)=>{r.event.prevFocus.bind(s=>n.getSystem().getByDom(s).toOptional()).each(s=>{r.event.newFocus.bind(a=>n.getSystem().getByDom(a).toOptional()).each(a=>{Io.isOpen(s)&&(Io.expand(a),Io.close(s))})})})]),$.config({mode:"flow",selector:".tox-mbtn",onEscape:n=>(e.onEscape(n),g.some(!0))}),qe.config({})]),apis:o,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[M("dom"),M("uid"),M("onEscape"),M("backstage"),T("onSetup",H)],apis:{focus:(e,t)=>{e.focus(t)},setMenus:(e,t,o)=>{e.setMenus(t,o)}}});const Yi=(e,t)=>t.getAnimationRoot.fold(()=>e.element,o=>o(e)),sr=e=>e.dimension.property,ks=(e,t)=>e.dimension.getDimension(t),Zc=(e,t)=>{const o=Yi(e,t);nn(o,[t.shrinkingClass,t.growingClass])},ep=(e,t)=>{Ze(e.element,t.openClass),ct(e.element,t.closedClass),se(e.element,sr(t),"0px"),Wa(e.element)},tp=(e,t)=>{Ze(e.element,t.closedClass),ct(e.element,t.openClass),Me(e.element,sr(t))},HS=(e,t,o,n)=>{o.setCollapsed(),se(e.element,sr(t),ks(t,e.element)),Zc(e,t),ep(e,t),t.onStartShrink(e),t.onShrunk(e)},qD=(e,t,o,n)=>{const r=n.getOrThunk(()=>ks(t,e.element));o.setCollapsed(),se(e.element,sr(t),r),Wa(e.element);const s=Yi(e,t);Ze(s,t.growingClass),ct(s,t.shrinkingClass),ep(e,t),t.onStartShrink(e)},zS=(e,t,o)=>{const n=ks(t,e.element);(n==="0px"?HS:qD)(e,t,o,g.some(n))},LS=(e,t,o)=>{const n=Yi(e,t),r=vo(n,t.shrinkingClass),s=ks(t,e.element);tp(e,t);const a=ks(t,e.element);(r?()=>{se(e.element,sr(t),s),Wa(e.element)}:()=>{ep(e,t)})(),Ze(n,t.shrinkingClass),ct(n,t.growingClass),tp(e,t),se(e.element,sr(t),a),o.setExpanded(),t.onStartGrow(e)},PS=(e,t,o)=>{const n=Yi(e,t);return vo(n,t.growingClass)===!0},US=(e,t,o)=>{const n=Yi(e,t);return vo(n,t.shrinkingClass)===!0};var XD=Object.freeze({__proto__:null,refresh:(e,t,o)=>{if(o.isExpanded()){Me(e.element,sr(t));const n=ks(t,e.element);se(e.element,sr(t),n)}},grow:(e,t,o)=>{o.isExpanded()||LS(e,t,o)},shrink:(e,t,o)=>{o.isExpanded()&&zS(e,t,o)},immediateShrink:(e,t,o)=>{o.isExpanded()&&HS(e,t,o)},hasGrown:(e,t,o)=>o.isExpanded(),hasShrunk:(e,t,o)=>o.isCollapsed(),isGrowing:PS,isShrinking:US,isTransitioning:(e,t,o)=>PS(e,t)||US(e,t),toggleGrow:(e,t,o)=>{(o.isExpanded()?zS:LS)(e,t,o)},disableTransitions:Zc,immediateGrow:(e,t,o)=>{o.isExpanded()||(tp(e,t),se(e.element,sr(t),ks(t,e.element)),Zc(e,t),o.setExpanded(),t.onStartGrow(e),t.onGrown(e))}}),KD=Object.freeze({__proto__:null,exhibit:(e,t,o)=>{const n=t.expanded;return on(n?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:Jr(t.dimension.property,"0px")})},events:(e,t)=>Re([js(ni(),(o,n)=>{n.event.raw.propertyName===e.dimension.property&&(Zc(o,e),t.isExpanded()&&Me(o.element,e.dimension.property),(t.isExpanded()?e.onGrown:e.onShrunk)(o))})])}),YD=[M("closedClass"),M("openClass"),M("shrinkingClass"),M("growingClass"),Se("getAnimationRoot"),me("onShrunk"),me("onStartShrink"),me("onGrown"),me("onStartGrow"),T("expanded",!1),go("dimension",mo("property",{width:[Ne("property","width"),Ne("getDimension",e=>Xt(e)+"px")],height:[Ne("property","height"),Ne("getDimension",e=>Rt(e)+"px")]}))];const Ko=bt({fields:YD,name:"sliding",active:KD,apis:XD,state:Object.freeze({__proto__:null,init:e=>{const t=Z(e.expanded);return bo({isExpanded:()=>t.get()===!0,isCollapsed:()=>t.get()===!1,setCollapsed:Co(t.set,!1),setExpanded:Co(t.set,!0),readState:()=>"expanded: "+t.get()})}})}),WS="container",JD=[mt("slotBehaviours",[])],jS=e=>"<alloy.field."+e+">",ZD=(e,t)=>{const o=d=>kv(e),n=(d,m)=>(p,h)=>Ee(p,e,h).map(f=>d(f,h)).getOr(m),r=(d,m)=>Tt(d.element,"aria-hidden")!=="true",s=n(r,!1),a=n((d,m)=>{if(r(d)){const p=d.element;se(p,"display","none"),ie(p,"aria-hidden","true"),Y(d,ru(),{name:m,visible:!1})}}),i=(l=a,(d,m)=>{q(m,p=>l(d,p))});var l;const c=n((d,m)=>{if(!r(d)){const p=d.element;Me(p,"display"),at(p,"aria-hidden"),Y(d,ru(),{name:m,visible:!0})}}),u={getSlotNames:o,getSlot:(d,m)=>Ee(d,e,m),isShowing:s,hideSlot:a,hideAllSlots:d=>i(d,o()),showSlot:c};return{uid:e.uid,dom:e.dom,components:t,behaviours:qu(e.slotBehaviours),apis:u}},QD=ft({getSlotNames:(e,t)=>e.getSlotNames(t),getSlot:(e,t,o)=>e.getSlot(t,o),isShowing:(e,t,o)=>e.isShowing(t,o),hideSlot:(e,t,o)=>e.hideSlot(t,o),hideAllSlots:(e,t)=>e.hideAllSlots(t),showSlot:(e,t,o)=>e.showSlot(t,o)},e=>Nl(e)),Bt=k(k({},QD),{sketch:e=>{const t=(()=>{const s=[];return{slot:(a,i)=>(s.push(a),em(WS,jS(a),i)),record:E(s)}})(),o=e(t),n=t.record(),r=N(n,s=>Dt({name:s,pname:jS(s)}));return sm(WS,JD,r,ZD,o)}}),eB=X([mn,Cc,lt("onShow",H),lt("onHide",H),gs]),tB=e=>({element:()=>e.element.dom}),oB=(e,t)=>{const o=N(rt(t),n=>{const r=t[n],s=en((a=>Ue("sidebar",eB,a))(r));return{name:n,getApi:tB,onSetup:s.onSetup,onShow:s.onShow,onHide:s.onHide}});return N(o,n=>{const r=Z(H);return e.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Ei([Di(n,r),Bi(n,r),B(ru(),(s,a)=>{const i=a.event;Ke(o,c=>c.name===i.name).each(c=>{(i.visible?c.onShow:c.onHide)(c.getApi(s))})})])})})},nB=e=>Bt.sketch(t=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:oB(t,e),slotBehaviours:Ei([Ge(o=>Bt.hideAllSlots(o))])})),rB=e=>de.getCurrent(e).bind(t=>Ko.isGrowing(t)||Ko.hasGrown(t)?de.getCurrent(t).bind(o=>Ke(Bt.getSlotNames(o),n=>Bt.isShowing(o,n))):g.none()),op=j("FixSizeEvent"),np=j("AutoSizeEvent");var sB=Object.freeze({__proto__:null,block:(e,t,o,n)=>{ie(e.element,"aria-busy",!0);const r=t.getRoot(e).getOr(e),s=I([$.config({mode:"special",onTab:()=>g.some(!0),onShiftTab:()=>g.some(!0)}),te.config({})]),a=n(r,s),i=r.getSystem().build(a);re.append(r,Uo(i)),i.hasConfigured($)&&t.focus&&$.focusIn(i),o.isBlocked()||t.onBlock(e),o.blockWith(()=>re.remove(r,i))},unblock:(e,t,o)=>{at(e.element,"aria-busy"),o.isBlocked()&&t.onUnblock(e),o.clear()}}),aB=[lt("getRoot",g.none),ho("focus",!0),me("onBlock"),me("onUnblock")];const ar=bt({fields:aB,name:"blocking",apis:sB,state:Object.freeze({__proto__:null,init:()=>{const e=Ru(t=>t.destroy());return bo({readState:e.isSet,blockWith:t=>{e.set({destroy:t})},clear:e.clear,isBlocked:e.isSet})}})}),Nr=e=>{const t=EO(e),o=wn(t),n=(a=>{const i=a.dom.attributes!==void 0?a.dom.attributes:[];return Ft(i,(l,c)=>c.name==="class"?l:k(k({},l),{[c.name]:c.value}),{})})(t),r=(a=>Array.prototype.slice.call(a.dom.classList,0))(t),s=o.length===0?{}:{innerHtml:du(t)};return k({tag:zn(t),classes:r,attributes:n},s)},GS=e=>de.getCurrent(e).each(t=>Kn(t.element)),iB=(e,t,o)=>{const n=Z(!1),r=ze(),s=i=>{var l;n.get()&&(!(c=>c.type==="focusin")(l=i)||!(l.composed?Hn(l.composedPath()):g.from(l.target)).map(U).filter(Oo).exists(c=>vo(c,"mce-pastebin")))&&(i.preventDefault(),GS(t()),e.editorManager.setActive(e))};e.inline||e.on("PreInit",()=>{e.dom.bind(e.getWin(),"focusin",s),e.on("BeforeExecCommand",i=>{i.command.toLowerCase()==="mcefocus"&&i.value!==!0&&s(i)})});const a=i=>{i!==n.get()&&(n.set(i),((l,c,u,d)=>{const m=c.element;if(((p,h)=>{const f="tabindex",v="data-mce-tabindex";g.from(p.iframeElement).map(U).each(y=>{h?(lo(y,f).each(x=>ie(y,v,x)),ie(y,f,-1)):(at(y,f),lo(y,v).each(x=>{ie(y,f,x),at(y,v)}))})})(l,u),u)ar.block(c,(p=>(h,f)=>({dom:{tag:"div",attributes:{"aria-label":p.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:Nr('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}))(d)),Me(m,"display"),at(m,"aria-hidden"),l.hasFocus()&&GS(c);else{const p=de.getCurrent(c).exists(h=>mb(h.element));ar.unblock(c),se(m,"display","none"),ie(m,"aria-hidden","true"),p&&l.focus()}})(e,t(),i,o.providers),((l,c)=>{l.dispatch("AfterProgressState",{state:c})})(e,i))};e.on("ProgressState",i=>{if(r.on(clearTimeout),hr(i.time)){const l=pc.setEditorTimeout(e,()=>a(i.state),i.time);r.set(l)}else a(i.state),r.clear()})},rp=(e,t,o)=>({within:e,extra:t,withinWidth:o}),$S=(e,t,o)=>{const n=Ft(e,(a,i)=>((l,c)=>{const u=o(l);return g.some({element:l,start:c,finish:c+u,width:u})})(i,a.len).fold(E(a),l=>({len:l.finish,list:a.list.concat([l])})),{len:0,list:[]}).list,r=He(n,a=>a.finish<=t),s=Bs(r,(a,i)=>a+i.width,0);return{within:r,extra:n.slice(r.length),withinWidth:s}},Qc=e=>N(e,t=>t.element),qS=(e,t)=>{const o=N(t,n=>Uo(n));pn.setGroups(e,o)},XS=(e,t,o)=>{const n=t.builtGroups.get();if(n.length===0)return;const r=On(e,t,"primary"),s=Pe.getCoupled(e,"overflowGroup");se(r.element,"visibility","hidden");const a=n.concat([s]),i=yn(a,c=>sn(c.element).bind(u=>c.getSystem().getByDom(u).toOptional()));o([]),qS(r,a);const l=((c,u,d,m)=>{const p=((y,x,b)=>{const w=$S(x,y,b);return w.extra.length===0?g.some(w):g.none()})(c,u,d).getOrThunk(()=>$S(u,c-d(m),d)),h=p.within,f=p.extra,v=p.withinWidth;return f.length===1&&f[0].width<=d(m)?((y,x,b)=>{const w=Qc(y.concat(x));return rp(w,[],b)})(h,f,v):f.length>=1?((y,x,b,w)=>{const S=Qc(y).concat([b]);return rp(S,Qc(x),w)})(h,f,m,v):((y,x,b)=>rp(Qc(y),[],b))(h,0,v)})(Xt(r.element),t.builtGroups.get(),c=>Xt(c.element),s);l.extra.length===0?(re.remove(r,s),o([])):(qS(r,l.within),o(l.extra)),Me(r.element,"visibility"),Wa(r.element),i.each(te.focus)},KS=E([mt("splitToolbarBehaviours",[Pe]),zt("builtGroups",()=>Z([]))]),lB=E([as(["overflowToggledClass"]),Tl("getOverflowBounds"),M("lazySink"),zt("overflowGroups",()=>Z([])),me("onOpened"),me("onClosed")].concat(KS())),cB=E([Dt({factory:pn,schema:xa(),name:"primary"}),jo({schema:xa(),name:"overflow"}),jo({name:"overflow-button"}),jo({name:"overflow-group"})]),sp=E((e,t)=>{((o,n)=>{const r=wl.max(o,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);se(o,"max-width",r+"px")})(e,Math.floor(t))}),dB=E([as(["toggledClass"]),M("lazySink"),Lo("fetch"),Tl("getBounds"),po("fireDismissalEventInstead",[T("event",Us())]),_r(),me("onToggled")]),uB=E([jo({name:"button",overrides:e=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:I([he.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:e.onToggled})])})}),jo({factory:pn,schema:xa(),name:"toolbar",overrides:e=>({toolbarBehaviours:I([$.config({mode:"cyclic",onEscape:t=>(Ee(t,e,"button").each(te.focus),g.none())})])})})]),YS=(e,t)=>{const o=Pe.getCoupled(e,"toolbarSandbox");ge.isOpen(o)?ge.close(o):ge.open(o,t.toolbar())},ap=(e,t,o,n)=>{const r=o.getBounds.map(a=>a()),s=o.lazySink(e).getOrDie();Wt.positionWithinBounds(s,t,{anchor:{type:"hotspot",hotspot:e,layouts:n,overrides:{maxWidthFunction:sp()}}},r)},JS=(e,t,o,n,r)=>{pn.setGroups(t,r),ap(e,t,o,n),he.on(e)},Cs=Vt({name:"FloatingToolbarButton",factory:(e,t,o,n)=>k(k({},Zt.sketch(k(k({},n.button()),{action:r=>{YS(r,n)},buttonBehaviours:ea({dump:n.button().buttonBehaviours},[Pe.config({others:{toolbarSandbox:r=>((s,a,i)=>{const l=Xf();return{dom:{tag:"div",attributes:{id:l.id}},behaviours:I([$.config({mode:"special",onEscape:c=>(ge.close(c),g.some(!0))}),ge.config({onOpen:(c,u)=>{i.fetch().get(d=>{JS(s,u,i,a.layouts,d),l.link(s.element),$.focusIn(u)})},onClose:()=>{he.off(s),te.focus(s),l.unlink(s.element)},isPartOf:(c,u,d)=>ss(u,d)||ss(s,d),getAttachPoint:()=>i.lazySink(s).getOrDie()}),Wo.config({channels:k(k({},ju(k({isExtraPart:Ve},i.fireDismissalEventInstead.map(c=>({fireEventInstead:{event:c.event}})).getOr({})))),Gu({doReposition:()=>{ge.getState(Pe.getCoupled(s,"toolbarSandbox")).each(c=>{ap(s,c,i,a.layouts)})}}))})])}})(r,o,e)}})])}))),{apis:{setGroups:(r,s)=>{ge.getState(Pe.getCoupled(r,"toolbarSandbox")).each(a=>{JS(r,a,e,o.layouts,s)})},reposition:r=>{ge.getState(Pe.getCoupled(r,"toolbarSandbox")).each(s=>{ap(r,s,e,o.layouts)})},toggle:r=>{YS(r,n)},getToolbar:r=>ge.getState(Pe.getCoupled(r,"toolbarSandbox")),isOpen:r=>ge.isOpen(Pe.getCoupled(r,"toolbarSandbox"))}}),configFields:dB(),partFields:uB(),apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},getToolbar:(e,t)=>e.getToolbar(t),isOpen:(e,t)=>e.isOpen(t)}}),mB=E([M("items"),as(["itemSelector"]),mt("tgroupBehaviours",[$])]),gB=E([oc({name:"items",unit:"item"})]),ed=Vt({name:"ToolbarGroup",configFields:mB(),partFields:gB(),factory:(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,behaviours:vt(e.tgroupBehaviours,[$.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}})}),ZS=e=>N(e,t=>Uo(t)),QS=(e,t,o)=>{XS(e,o,n=>{o.overflowGroups.set(n),t.getOpt(e).each(r=>{Cs.setGroups(r,ZS(n))})})},ek=Vt({name:"SplitFloatingToolbar",configFields:lB(),partFields:cB(),factory:(e,t,o,n)=>{const r=De(Cs.sketch({fetch:()=>Mr(s=>{s(ZS(e.overflowGroups.get()))}),layouts:{onLtr:()=>[Mt,At],onRtl:()=>[At,Mt],onBottomLtr:()=>[Jt,Yt],onBottomRtl:()=>[Yt,Jt]},getBounds:o.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:n["overflow-button"](),toolbar:n.overflow()},onToggled:(s,a)=>e[a?"onOpened":"onClosed"](s)}));return{uid:e.uid,dom:e.dom,components:t,behaviours:vt(e.splitToolbarBehaviours,[Pe.config({others:{overflowGroup:()=>ed.sketch(k(k({},n["overflow-group"]()),{items:[r.asSpec()]}))}})]),apis:{setGroups:(s,a)=>{e.builtGroups.set(N(a,s.getSystem().build)),QS(s,r,e)},refresh:s=>QS(s,r,e),toggle:s=>{r.getOpt(s).each(a=>{Cs.toggle(a)})},isOpen:s=>r.getOpt(s).map(Cs.isOpen).getOr(!1),reposition:s=>{r.getOpt(s).each(a=>{Cs.reposition(a)})},getOverflow:s=>r.getOpt(s).bind(Cs.getToolbar)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t),getOverflow:(e,t)=>e.getOverflow(t)}}),pB=E([as(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),me("onOpened"),me("onClosed")].concat(KS())),hB=E([Dt({factory:pn,schema:xa(),name:"primary"}),Dt({factory:pn,schema:xa(),name:"overflow",overrides:e=>({toolbarBehaviours:I([Ko.config({dimension:{property:"height"},closedClass:e.markers.closedClass,openClass:e.markers.openClass,shrinkingClass:e.markers.shrinkingClass,growingClass:e.markers.growingClass,onShrunk:t=>{Ee(t,e,"overflow-button").each(o=>{he.off(o),te.focus(o)}),e.onClosed(t)},onGrown:t=>{$.focusIn(t),e.onOpened(t)},onStartGrow:t=>{Ee(t,e,"overflow-button").each(he.on)}}),$.config({mode:"acyclic",onEscape:t=>(Ee(t,e,"overflow-button").each(te.focus),g.some(!0))})])})}),jo({name:"overflow-button",overrides:e=>({buttonBehaviours:I([he.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])})}),jo({name:"overflow-group"})]),tk=(e,t)=>{Ee(e,t,"overflow-button").bind(()=>Ee(e,t,"overflow")).each(o=>{ip(e,t),Ko.toggleGrow(o)})},ip=(e,t)=>{Ee(e,t,"overflow").each(o=>{XS(e,t,n=>{const r=N(n,s=>Uo(s));pn.setGroups(o,r)}),Ee(e,t,"overflow-button").each(n=>{Ko.hasGrown(o)&&he.on(n)}),Ko.refresh(o)})},lp=Vt({name:"SplitSlidingToolbar",configFields:pB(),partFields:hB(),factory:(e,t,o,n)=>{const r="alloy.toolbar.toggle";return{uid:e.uid,dom:e.dom,components:t,behaviours:vt(e.splitToolbarBehaviours,[Pe.config({others:{overflowGroup:s=>ed.sketch(k(k({},n["overflow-group"]()),{items:[Zt.sketch(k(k({},n["overflow-button"]()),{action:a=>{we(s,r)}}))]}))}}),le("toolbar-toggle-events",[B(r,s=>{tk(s,e)})])]),apis:{setGroups:(s,a)=>{((i,l)=>{const c=N(l,i.getSystem().build);e.builtGroups.set(c)})(s,a),ip(s,e)},refresh:s=>ip(s,e),toggle:s=>tk(s,e),isOpen:s=>((a,i)=>Ee(a,i,"overflow").map(Ko.hasGrown).getOr(!1))(s,e)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t)}}),ok=e=>{const t=e.title.fold(()=>({}),o=>({attributes:{title:o}}));return{dom:k({tag:"div",classes:["tox-toolbar__group"]},t),components:[ed.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:I([qe.config({}),te.config({})])}},td=e=>ed.sketch(ok(e)),nk=(e,t)=>{const o=Ge(n=>{const r=N(e.initGroups,td);pn.setGroups(n,r)});return I([Xm(e.providers.isDisabled),et(),$.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),le("toolbar-events",[o])])},rk=e=>{const t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":ok({title:g.none(),items:[]}),"overflow-button":$M({name:"more",icon:g.some("more-drawer"),enabled:!0,tooltip:g.some("More..."),primary:!1,buttonType:g.none(),borderless:!1},g.none(),e.providers)},splitToolbarBehaviours:nk(e,t)}},fB=e=>{const t=rk(e),o=ek.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return ek.sketch(k(k({},t),{lazySink:e.getSink,getOverflowBounds:()=>{const n=e.moreDrawerData.lazyHeader().element,r=Xr(n),s=Dd(n),a=Xr(s),i=Math.max(s.dom.scrollHeight,a.height);return Nt(r.x+4,a.y,r.width-8,i)},parts:k(k({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e.attributes}}}),components:[o],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:n=>e.onToggled(n,!0),onClosed:n=>e.onToggled(n,!1)}))},bB=e=>{const t=lp.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),o=lp.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),n=rk(e);return lp.sketch(k(k({},n),{components:[t,o],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:r=>{r.getSystem().broadcastOn([Yg()],{type:"opened"}),e.onToggled(r,!0)},onClosed:r=>{r.getSystem().broadcastOn([Yg()],{type:"closed"}),e.onToggled(r,!1)}}))},cp=e=>{const t=e.cyclicKeying?"cyclic":"acyclic";return pn.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===Fo.scrolling?["tox-toolbar--scrolling"]:[])},components:[pn.parts.groups({})],toolbarBehaviours:nk(e,t)})},vB=[Ya("type",["button"]),er,Gn("buttonType","secondary",["primary","secondary"]),Lo("onAction")],yB=mo("type",{button:vB}),xB=X([El("buttons",[],yB),Lo("onShow"),Lo("onHide")]);var wa=Vt({name:"silver.View",configFields:[M("viewConfig")],partFields:[Bo({factory:{sketch:e=>{const t=N(e.buttons,o=>((n,r)=>Hg({text:n.text,enabled:!0,primary:!1,name:"name",icon:g.none(),borderless:!1,buttonType:g.some(n.buttonType)},s=>{n.onAction()},r))(o,e.providers));return{uid:e.uid,dom:{tag:"div",classes:["tox-view__header"]},components:[gn.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),gn.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:t})]}}},schema:[M("buttons"),M("providers")],name:"header"}),Bo({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-view__pane"]}})},schema:[],name:"pane"})],factory:(e,t,o,n)=>{const r={getPane:s=>gt.getPart(s,e,"pane"),getOnShow:s=>e.viewConfig.onShow,getOnHide:s=>e.viewConfig.onHide};return{uid:e.uid,dom:e.dom,components:t,apis:r}},apis:{getPane:(e,t)=>e.getPane(t),getOnShow:(e,t)=>e.getOnShow(t),getOnHide:(e,t)=>e.getOnHide(t)}});const wB=(e,t,o)=>ul(t,(n,r)=>{const s=en(Ue("view",xB,n));return e.slot(r,wa.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:s,components:[...s.buttons.length>0?[wa.parts.header({buttons:s.buttons,providers:o})]:[],wa.parts.pane({})]}))}),SB=(e,t)=>Bt.sketch(o=>({dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:wB(o,e,t),slotBehaviours:Ei([Ge(n=>Bt.hideAllSlots(n))])})),sk=e=>Ke(Bt.getSlotNames(e),t=>Bt.isShowing(e,t)),ak=(e,t,o)=>{Bt.getSlot(e,t).each(n=>{wa.getPane(n).each(r=>{var s;o(n)((s=r.element.dom,{getContainer:E(s)}))})})};var od=xo({factory:(e,t)=>{const o={setViews:(n,r)=>{re.set(n,[SB(r,t.backstage.shared.providers)])},whichView:n=>de.getCurrent(n).bind(sk),toggleView:(n,r,s,a)=>de.getCurrent(n).exists(i=>{const l=sk(i),c=l.exists(d=>a===d),u=Bt.getSlot(i,a).isSome();return u&&(Bt.hideAllSlots(i),c?((d=>{const m=d.element;se(m,"display","none"),ie(m,"aria-hidden","true")})(n),r()):(s(),(d=>{const m=d.element;Me(m,"display"),at(m,"aria-hidden")})(n),Bt.showSlot(i,a),((d,m)=>{ak(d,m,wa.getOnShow)})(i,a)),l.each(d=>((m,p)=>ak(m,p,wa.getOnHide))(i,d))),u})};return{uid:e.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:I([re.config({}),de.config({find:n=>{const r=re.contents(n);return Hn(r)}})]),apis:o}},name:"silver.ViewWrapper",configFields:[M("backstage")],apis:{setViews:(e,t,o)=>e.setViews(t,o),toggleView:(e,t,o,n,r)=>e.toggleView(t,o,n,r),whichView:(e,t)=>e.whichView(t)}});const kB=Mn.optional({factory:Qg,name:"menubar",schema:[M("backstage")]}),CB=Mn.optional({factory:{sketch:e=>wS.sketch({uid:e.uid,dom:e.dom,listBehaviours:I([$.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>cp({type:e.type,uid:j("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:()=>(e.onEscape(),g.some(!0))}),setupItem:(t,o,n,r)=>{pn.setGroups(o,n)},shell:!0})},name:"multiple-toolbar",schema:[M("dom"),M("onEscape")]}),OB=Mn.optional({factory:{sketch:e=>(o=>o.type===Fo.sliding?bB:o.type===Fo.floating?fB:cp)(e)({type:e.type,uid:e.uid,onEscape:()=>(e.onEscape(),g.some(!0)),onToggled:(o,n)=>e.onToolbarToggled(n),cyclicKeying:!1,initGroups:[],getSink:e.getSink,providers:e.providers,moreDrawerData:{lazyToolbar:e.lazyToolbar,lazyMoreButton:e.lazyMoreButton,lazyHeader:e.lazyHeader},attributes:e.attributes})},name:"toolbar",schema:[M("dom"),M("onEscape"),M("getSink")]}),_B=Mn.optional({factory:{sketch:e=>{const t=e.editor,o=e.sticky?NS:SS;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:I(o(t,e.sharedBackstage))}}},name:"header",schema:[M("dom")]}),TB=Mn.optional({factory:{sketch:e=>({uid:e.uid,dom:e.dom,components:[]})},name:"promotion",schema:[M("dom")]}),EB=Mn.optional({name:"socket",schema:[M("dom")]}),AB=Mn.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:I([qe.config({}),te.config({}),Ko.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:t=>{de.getCurrent(t).each(Bt.hideAllSlots),we(t,np)},onGrown:t=>{we(t,np)},onStartGrow:t=>{Y(t,op,{width:Et(t.element,"width").getOr("")})},onStartShrink:t=>{Y(t,op,{width:Xt(t.element)+"px"})}}),re.config({}),de.config({find:t=>{const o=re.contents(t);return Hn(o)}})])}],behaviours:I([_g(0),le("sidebar-sliding-events",[B(op,(t,o)=>{se(t.element,"width",o.event.width)}),B(np,(t,o)=>{Me(t.element,"width")})])])})},name:"sidebar",schema:[M("dom")]}),MB=Mn.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:I([re.config({}),ar.config({focus:!1}),de.config({find:t=>Hn(t.components())})]),components:[]})},name:"throbber",schema:[M("dom")]}),DB=Mn.optional({factory:od,name:"viewWrapper",schema:[M("backstage")]}),BB=Mn.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:e.components})},name:"editorContainer",schema:[]});var Fe=Vt({name:"OuterContainer",factory:(e,t,o)=>{let n=!1;const r={getSocket:s=>gt.getPart(s,e,"socket"),setSidebar:(s,a,i)=>{gt.getPart(s,e,"sidebar").each(l=>((c,u,d)=>{de.getCurrent(c).each(m=>{re.set(m,[nB(u)]);const p=d==null?void 0:d.toLowerCase();_e(p)&&Te(u,p)&&de.getCurrent(m).each(h=>{Bt.showSlot(h,p),Ko.immediateGrow(m),Me(m.element,"width")})})})(l,a,i))},toggleSidebar:(s,a)=>{gt.getPart(s,e,"sidebar").each(i=>((l,c)=>{de.getCurrent(l).each(u=>{de.getCurrent(u).each(d=>{Ko.hasGrown(u)?Bt.isShowing(d,c)?Ko.shrink(u):(Bt.hideAllSlots(d),Bt.showSlot(d,c)):(Bt.hideAllSlots(d),Bt.showSlot(d,c),Ko.grow(u))})})})(i,a))},whichSidebar:s=>gt.getPart(s,e,"sidebar").bind(rB).getOrNull(),getHeader:s=>gt.getPart(s,e,"header"),getToolbar:s=>gt.getPart(s,e,"toolbar"),setToolbar:(s,a)=>{gt.getPart(s,e,"toolbar").each(i=>{const l=N(a,td);i.getApis().setGroups(i,l)})},setToolbars:(s,a)=>{gt.getPart(s,e,"multiple-toolbar").each(i=>{const l=N(a,c=>N(c,td));wS.setItems(i,l)})},refreshToolbar:s=>{gt.getPart(s,e,"toolbar").each(a=>a.getApis().refresh(a))},toggleToolbarDrawer:s=>{gt.getPart(s,e,"toolbar").each(a=>{var i,l;l=c=>c(a),(i=a.getApis().toggle)!=null?g.some(l(i)):g.none()})},isToolbarDrawerToggled:s=>gt.getPart(s,e,"toolbar").bind(a=>g.from(a.getApis().isOpen).map(i=>i(a))).getOr(!1),getThrobber:s=>gt.getPart(s,e,"throbber"),focusToolbar:s=>{gt.getPart(s,e,"toolbar").orThunk(()=>gt.getPart(s,e,"multiple-toolbar")).each(a=>{$.focusIn(a)})},setMenubar:(s,a)=>{gt.getPart(s,e,"menubar").each(i=>{Qg.setMenus(i,a)})},focusMenubar:s=>{gt.getPart(s,e,"menubar").each(a=>{Qg.focus(a)})},setViews:(s,a)=>{gt.getPart(s,e,"viewWrapper").each(i=>{od.setViews(i,a)})},toggleView:(s,a)=>gt.getPart(s,e,"viewWrapper").exists(i=>od.toggleView(i,()=>r.showMainView(s),()=>r.hideMainView(s),a)),whichView:s=>gt.getPart(s,e,"viewWrapper").bind(od.whichView).getOrNull(),hideMainView:s=>{n=r.isToolbarDrawerToggled(s),n&&r.toggleToolbarDrawer(s),gt.getPart(s,e,"editorContainer").each(a=>{const i=a.element;se(i,"display","none"),ie(i,"aria-hidden","true")})},showMainView:s=>{n&&r.toggleToolbarDrawer(s),gt.getPart(s,e,"editorContainer").each(a=>{const i=a.element;Me(i,"display"),at(i,"aria-hidden")})}};return{uid:e.uid,dom:e.dom,components:t,apis:r,behaviours:e.behaviours}},configFields:[M("dom"),M("behaviours")],partFields:[_B,kB,OB,CB,EB,AB,TB,MB,DB,BB],apis:{getSocket:(e,t)=>e.getSocket(t),setSidebar:(e,t,o,n)=>{e.setSidebar(t,o,n)},toggleSidebar:(e,t,o)=>{e.toggleSidebar(t,o)},whichSidebar:(e,t)=>e.whichSidebar(t),getHeader:(e,t)=>e.getHeader(t),getToolbar:(e,t)=>e.getToolbar(t),setToolbar:(e,t,o)=>{e.setToolbar(t,o)},setToolbars:(e,t,o)=>{e.setToolbars(t,o)},refreshToolbar:(e,t)=>e.refreshToolbar(t),toggleToolbarDrawer:(e,t)=>{e.toggleToolbarDrawer(t)},isToolbarDrawerToggled:(e,t)=>e.isToolbarDrawerToggled(t),getThrobber:(e,t)=>e.getThrobber(t),setMenubar:(e,t,o)=>{e.setMenubar(t,o)},focusMenubar:(e,t)=>{e.focusMenubar(t)},focusToolbar:(e,t)=>{e.focusToolbar(t)},setViews:(e,t,o)=>{e.setViews(t,o)},toggleView:(e,t,o)=>e.toggleView(t,o),whichView:(e,t)=>e.whichView(t)}});const ik={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},dp=e=>e.split(" "),lk=(e,t)=>{const o=k(k({},ik),t.menus),n=rt(t.menus).length>0,r=t.menubar===void 0||t.menubar===!0?dp("file edit view insert format tools table help"):dp(t.menubar===!1?"":t.menubar),s=He(r,i=>{const l=Te(ik,i);return n?l||K(t.menus,i).exists(c=>Te(c,"items")):l}),a=N(s,i=>{const l=o[i];return((c,u,d)=>{const m=Hy(d).split(/[ ,]/);return{text:c.title,getItems:()=>nt(c.items,p=>{const h=p.toLowerCase();return h.trim().length===0||Yo(m,f=>f===h)?[]:h==="separator"||h==="|"?[{type:"separator"}]:u.menuItems[h]?[u.menuItems[h]]:[]})}})({title:l.title,items:dp(l.items)},t,e)});return He(a,i=>i.getItems().length>0&&Yo(i.getItems(),l=>_e(l)||l.type!=="separator"))},ck=e=>{const t=()=>{e._skinLoaded=!0,(o=>{o.dispatch("SkinLoaded")})(e)};return()=>{e.initialized?t():e.on("init",t)}},dk=(e,t,o)=>(e.on("remove",()=>o.unload(t)),o.load(t)),FB=(e,t)=>dk(e,t+"/skin.min.css",e.ui.styleSheetLoader),IB=(e,t)=>{var o;return o=U(e.getElement()),Sh(o).isSome()?dk(e,t+"/skin.shadowdom.min.css",xi.DOM.styleSheetLoader):Promise.resolve()},uk=(e,t)=>{const o=ox(t);o&&t.contentCSS.push(o+(e?"/content.inline":"/content")+".min.css"),!Em(t)&&_e(o)?Promise.all([FB(t,o),IB(t,o)]).then(ck(t),((n,r)=>()=>((s,a)=>{s.dispatch("SkinLoadError",a)})(n,{message:"Skin could not be loaded"}))(t)):ck(t)()},RB=Co(uk,!1),NB=Co(uk,!0),nd=(e,t)=>o=>{const n=Ys(),r=()=>{o.setActive(e.formatter.match(t));const s=e.formatter.formatChanged(t,o.setActive);n.set(s)};return e.initialized?r():e.once("init",r),()=>{e.off("init",r),n.clear()}},rd=(e,t,o)=>n=>{const r=()=>o(n),s=()=>{o(n),e.on(t,r)};return e.initialized?s():e.once("init",s),()=>{e.off("init",s),e.off(t,r)}},mk=e=>t=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("mceToggleFormat",!1,t.format)})},Ro=(e,t)=>()=>e.execCommand(t),VB=(e,t,o)=>{const n=(a,i,l,c)=>{const u=t.shared.providers.translate(a.title);if(a.type==="separator")return g.some({type:"separator",text:u});if(a.type==="submenu"){const d=nt(a.getStyleItems(),m=>r(m,i,c));return i===0&&d.length<=0?g.none():g.some({type:"nestedmenuitem",text:u,enabled:d.length>0,getSubmenuItems:()=>nt(a.getStyleItems(),m=>r(m,i,c))})}return g.some(k({type:"togglemenuitem",text:u,icon:a.icon,active:a.isSelected(c),enabled:!l,onAction:o.onAction(a)},a.getStylePreview().fold(()=>({}),d=>({meta:{style:d}}))))},r=(a,i,l)=>{const c=a.type==="formatter"&&o.isInvalid(a);return i===0?c?[]:n(a,i,!1,l).toArray():n(a,i,c,l).toArray()},s=a=>{const i=o.getCurrentValue(),l=o.shouldHide?0:1;return nt(a,c=>r(c,l,i))};return{validateItems:s,getFetch:(a,i)=>(l,c)=>{const u=i(),d=s(u);c(ya(d,un.CLOSE_ON_EXECUTE,a,{isHorizontalMenu:!1,search:g.none()}))}}},Sa=(e,t,o)=>{const n=o.dataset,r=n.type==="basic"?()=>N(n.data,s=>cS(s,o.isSelectedFor,o.getPreviewFor)):n.getData;return{items:VB(0,t,o),getStyleItems:r}},Ji=(e,t,o)=>{const{items:n,getStyleItems:r}=Sa(0,t,o),s=rd(e,"NodeChange",a=>{const i=a.getComponent();o.updateText(i)});return Mg({text:o.icon.isSome()?g.none():o.text,icon:o.icon,tooltip:g.from(o.tooltip),role:g.none(),fetch:n.getFetch(t,r),onSetup:s,getApi:a=>({getComponent:E(a)}),columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)};var ka;(function(e){e[e.SemiColon=0]="SemiColon",e[e.Space=1]="Space"})(ka||(ka={}));const up=(e,t,o)=>{const n=(r=((s,a)=>a===ka.SemiColon?s.replace(/;$/,"").split(";"):s.split(" "))(e.options.get(t),o),N(r,s=>{let a=s,i=s;const l=s.split("=");return l.length>1&&(a=l[0],i=l[1]),{title:a,format:i}}));var r;return{type:"basic",data:n}},mp=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],gk=e=>{const t={type:"basic",data:mp};return{tooltip:"Align",text:g.none(),icon:g.some("align-left"),isSelectedFor:o=>()=>e.formatter.match(o),getCurrentValue:g.none,getPreviewFor:o=>g.none,onAction:o=>()=>Ke(mp,n=>n.format===o.format).each(n=>e.execCommand(n.command)),updateText:o=>{const n=Ke(mp,r=>e.formatter.match(r.format)).fold(E("left"),r=>r.title.toLowerCase());Y(o,F0,{icon:`align-${n}`})},dataset:t,shouldHide:!1,isInvalid:o=>!e.formatter.canApply(o.format)}},pk=(e,t)=>{const o=t(),n=N(o,r=>r.format);return g.from(e.formatter.closest(n)).bind(r=>Ke(o,s=>s.format===r)).orThunk(()=>za(e.formatter.match("p"),{title:"Paragraph",format:"p"}))},hk=e=>{const t="Paragraph",o=up(e,"block_formats",ka.SemiColon);return{tooltip:"Blocks",text:g.some(t),icon:g.none(),isSelectedFor:n=>()=>e.formatter.match(n),getCurrentValue:g.none,getPreviewFor:n=>()=>{const r=e.formatter.get(n);return r?g.some({tag:r.length>0&&(r[0].inline||r[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(n))}):g.none()},onAction:mk(e),updateText:n=>{const r=pk(e,()=>o.data).fold(E(t),s=>s.title);Y(n,va,{text:r})},dataset:o,shouldHide:!1,isInvalid:n=>!e.formatter.canApply(n.format)}},HB=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],fk=e=>{const t=e.split(/\s*,\s*/);return N(t,o=>o.replace(/^['"]+|['"]+$/g,""))},bk=e=>{const t="System Font",o=()=>{const r=c=>c?fk(c)[0]:"",s=e.queryCommandValue("FontName"),a=n.data,i=s?s.toLowerCase():"";return{matchOpt:Ke(a,c=>{const u=c.format;return u.toLowerCase()===i||r(u).toLowerCase()===r(i).toLowerCase()}).orThunk(()=>za((c=>c.indexOf("-apple-system")===0&&(()=>{const u=fk(c.toLowerCase());return Is(HB,d=>u.indexOf(d.toLowerCase())>-1)})())(i),{title:t,format:i})),font:s}},n=up(e,"font_family_formats",ka.SemiColon);return{tooltip:"Fonts",text:g.some(t),icon:g.none(),isSelectedFor:r=>s=>s.exists(a=>a.format===r),getCurrentValue:()=>{const{matchOpt:r}=o();return r},getPreviewFor:r=>()=>g.some({tag:"div",styles:r.indexOf("dings")===-1?{"font-family":r}:{}}),onAction:r=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("FontName",!1,r.format)})},updateText:r=>{const{matchOpt:s,font:a}=o(),i=s.fold(E(a),l=>l.title);Y(r,va,{text:i})},dataset:n,shouldHide:!1,isInvalid:Ve}},zB={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},LB={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},PB=(e,t)=>/[0-9.]+px$/.test(e)?((o,n)=>{const r=Math.pow(10,n);return Math.round(o*r)/r})(72*parseInt(e,10)/96,t||0)+"pt":K(LB,e).getOr(e),UB=e=>K(zB,e).getOr(""),vk=e=>{const t=()=>{let r=g.none();const s=n.data,a=e.queryCommandValue("FontSize");if(a)for(let i=3;r.isNone()&&i>=0;i--){const l=PB(a,i),c=UB(l);r=Ke(s,u=>u.format===a||u.format===l||u.format===c)}return{matchOpt:r,size:a}},o=E(g.none),n=up(e,"font_size_formats",ka.Space);return{tooltip:"Font sizes",text:g.some("12pt"),icon:g.none(),isSelectedFor:r=>s=>s.exists(a=>a.format===r),getPreviewFor:o,getCurrentValue:()=>{const{matchOpt:r}=t();return r},onAction:r=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("FontSize",!1,r.format)})},updateText:r=>{const{matchOpt:s,size:a}=t(),i=s.fold(E(a),l=>l.title);Y(r,va,{text:i})},dataset:n,shouldHide:!1,isInvalid:Ve}},yk=(e,t)=>{const o="Paragraph";return{tooltip:"Formats",text:g.some(o),icon:g.none(),isSelectedFor:n=>()=>e.formatter.match(n),getCurrentValue:g.none,getPreviewFor:n=>()=>{const r=e.formatter.get(n);return r!==void 0?g.some({tag:r.length>0&&(r[0].inline||r[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(n))}):g.none()},onAction:mk(e),updateText:n=>{const r=i=>rS(i)?nt(i.items,r):sS(i)?[{title:i.title,format:i.format}]:[],s=nt(lS(e),r),a=pk(e,E(s)).fold(E(o),i=>i.title);Y(n,va,{text:a})},shouldHide:Ny(e),isInvalid:n=>!e.formatter.canApply(n.format),dataset:t}};var WB=Object.freeze({__proto__:null,events:(e,t)=>{const o=(n,r)=>{e.updateState.each(s=>{const a=s(n,r);t.set(a)}),e.renderComponents.each(s=>{const a=s(r,t.get());(e.reuseDom?dy:cy)(n,a)})};return Re([B(Qr(),(n,r)=>{const s=r;if(!s.universal){const a=e.channel;ht(s.channels,a)&&o(n,s.data)}}),Ge((n,r)=>{e.initialData.each(s=>{o(n,s)})})])}}),jB=Object.freeze({__proto__:null,getState:(e,t,o)=>o}),GB=[M("channel"),Se("renderComponents"),Se("updateState"),Se("initialData"),ho("reuseDom",!0)];const ro=bt({fields:GB,name:"reflecting",active:WB,apis:jB,state:Object.freeze({__proto__:null,init:()=>{const e=Z(g.none());return{readState:()=>e.get().getOr("none"),get:e.get,set:e.set,clear:()=>e.set(g.none())}}})}),$B=E([M("toggleClass"),M("fetch"),is("onExecute"),T("getHotspot",g.some),T("getAnchorOverrides",E({})),_r(),is("onItemExecute"),Se("lazySink"),M("dom"),me("onOpen"),mt("splitDropdownBehaviours",[Pe,$,te]),T("matchWidth",!1),T("useMinWidth",!1),T("eventOrder",{}),Se("role")].concat(cg())),qB=Dt({factory:Zt,schema:[M("dom")],name:"arrow",defaults:()=>({buttonBehaviours:I([te.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(ts)},buttonBehaviours:I([he.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])})}),XB=Dt({factory:Zt,schema:[M("dom")],name:"button",defaults:()=>({buttonBehaviours:I([te.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(o=>{e.onExecute(o,t)})}})}),KB=E([qB,XB,Bo({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[M("text")],name:"aria-descriptor"}),jo({schema:[Hl()],name:"menu",defaults:e=>({onExecute:(t,o)=>{t.getSystem().getByUid(e.uid).each(n=>{e.onItemExecute(n,t,o)})}})}),Sw()]),sd=Vt({name:"SplitDropdown",configFields:$B(),partFields:KB(),factory:(e,t,o,n)=>{const r=c=>{de.getCurrent(c).each(u=>{be.highlightFirst(u),$.focusIn(u)})},s=c=>{ig(e,xe,c,n,r,jt.HighlightMenuAndItem).get(H)},a=c=>{const u=On(c,e,"button");return ts(u),g.some(!0)},i=k(k({},Re([Ge((c,u)=>{Ee(c,e,"aria-descriptor").each(d=>{const m=j("aria");ie(d.element,"id",m),ie(c.element,"aria-describedby",m)})})])),gc(g.some(s))),l={repositionMenus:c=>{he.isOn(c)&&_w(c)}};return{uid:e.uid,dom:e.dom,components:t,apis:l,eventOrder:k(k({},e.eventOrder),{[fo()]:["disabling","toggling","alloy.base.behaviour"]}),events:i,behaviours:vt(e.splitDropdownBehaviours,[Pe.config({others:{sandbox:c=>{const u=On(c,e,"arrow");return lg(e,c,{onOpen:()=>{he.on(u),he.on(c)},onClose:()=>{he.off(u),he.off(c)}})}}}),$.config({mode:"special",onSpace:a,onEnter:a,onDown:c=>(s(c),g.some(!0))}),te.config({}),he.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:e.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:(e,t)=>e.repositionMenus(t)}}),YB=e=>({isEnabled:()=>!Q.isDisabled(e),setEnabled:t=>Q.set(e,!t)}),JB=e=>({setActive:t=>{he.set(e,t)},isActive:()=>he.isOn(e),isEnabled:()=>!Q.isDisabled(e),setEnabled:t=>Q.set(e,!t)}),xk=(e,t)=>e.map(o=>({"aria-label":t.translate(o),title:t.translate(o)})).getOr({}),wk=j("focus-button"),gp=(e,t,o,n,r,s)=>({dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]),attributes:xk(o,s)},components:Fi([e.map(a=>$c(a,s.icons)),t.map(a=>Ag(a,"tox-tbtn",s))]),eventOrder:{[Po()]:["focusing","alloy.base.behaviour","common-button-display-events"]},buttonBehaviours:I([Xm(s.isDisabled),et(),le("common-button-display-events",[B(Po(),(a,i)=>{i.event.prevent(),we(a,wk)})])].concat(n.map(a=>ro.config({channel:a,initialData:{icon:e,text:t},renderComponents:(i,l)=>Fi([i.icon.map(c=>$c(c,s.icons)),i.text.map(c=>Ag(c,"tox-tbtn",s))])})).toArray()).concat(r.getOr([])))}),Sk=(e,t,o)=>{const n=Z(H),r=gp(e.icon,e.text,e.tooltip,g.none(),g.none(),o);return Zt.sketch({dom:r.dom,components:r.components,eventOrder:M0,buttonBehaviours:I([le("toolbar-button-events",[(s={onAction:e.onAction,getApi:t.getApi},qn((a,i)=>{Ec(s,a)(l=>{Y(a,A0,{buttonApi:l}),s.onAction(l)})})),Di(t,n),Bi(t,n)]),Xm(()=>!e.enabled||o.isDisabled()),et()].concat(t.toolbarButtonBehaviours))});var s},kk=(e,t,o)=>Sk(e,{toolbarButtonBehaviours:o.length>0?[le("toolbarButtonWith",o)]:[],getApi:YB,onSetup:e.onSetup},t),Ck=(e,t,o)=>Sk(e,{toolbarButtonBehaviours:[re.config({}),he.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(o.length>0?[le("toolbarToggleButtonWith",o)]:[]),getApi:JB,onSetup:e.onSetup},t),ZB=(e,t,o)=>n=>Mr(r=>t.fetch(r)).map(r=>g.from(dg(je(sg(j("menu-value"),r,s=>{t.onItemAction(e(n),s)},t.columns,t.presets,un.CLOSE_ON_EXECUTE,t.select.getOr(Ve),o),{movement:Mc(t.columns,t.presets),menuBehaviours:Ei(t.columns!=="auto"?[]:[Ge((s,a)=>{qm(s,4,gx(t.presets)).each(({numRows:i,numColumns:l})=>{$.setGridSize(s,i,l)})})])})))),QB=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Zi=(e,t)=>(o,n,r)=>{const s=e(o).mapError(a=>Hs(a)).getOrDie();return t(s,n,r)},eF={button:Zi(Tx,(e,t)=>{return o=e,n=t.shared.providers,kk(o,n,[]);var o,n}),togglebutton:Zi(Ex,(e,t)=>{return o=e,n=t.shared.providers,Ck(o,n,[]);var o,n}),menubutton:Zi(VS,(e,t)=>Vg(e,"tox-tbtn",t,g.none())),splitbutton:Zi(e=>Ue("SplitButton",$D,e),(e,t)=>((o,n)=>{const r=j("channel-update-split-dropdown-display"),s=l=>({isEnabled:()=>!Q.isDisabled(l),setEnabled:c=>Q.set(l,!c),setIconFill:(c,u)=>{ut(l.element,'svg path[id="'+c+'"], rect[id="'+c+'"]').each(d=>{ie(d,"fill",u)})},setActive:c=>{ie(l.element,"aria-pressed",c),ut(l.element,"span").each(u=>{l.getSystem().getByDom(u).each(d=>he.set(d,c))})},isActive:()=>ut(l.element,"span").exists(c=>l.getSystem().getByDom(c).exists(he.isOn))}),a=Z(H),i={getApi:s,onSetup:o.onSetup};return sd.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:k({"aria-pressed":!1},xk(o.tooltip,n.providers))},onExecute:l=>{o.onAction(s(l))},onItemExecute:(l,c,u)=>{},splitDropdownBehaviours:I([Vx(n.providers.isDisabled),et(),le("split-dropdown-events",[B(wk,te.focus),Di(i,a),Bi(i,a)]),ji.config({})]),eventOrder:{[es()]:["alloy.base.behaviour","split-dropdown-events"]},toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:ZB(s,o,n.providers),parts:{menu:xc(0,o.columns,o.presets)},components:[sd.parts.button(gp(o.icon,o.text,g.none(),g.some(r),g.some([he.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),sd.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:My("chevron-down",n.providers.icons)},buttonBehaviours:I([Vx(n.providers.isDisabled),et(),xm()])}),sd.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})})(e,t.shared)),grouptoolbarbutton:Zi(e=>Ue("GroupToolbarButton",WD,e),(e,t,o)=>{const n=o.ui.registry.getAll().buttons,r={[Vu]:t.shared.header.isPositionedAtTop()?Jn.TopToBottom:Jn.BottomToTop};if(aa(o)===Fo.floating)return((s,a,i,l)=>{const c=a.shared;return Cs.sketch({lazySink:c.getSink,fetch:()=>Mr(u=>{u(N(i(s.items),td))}),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:gp(s.icon,s.text,s.tooltip,g.none(),g.none(),c.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:l}}}})})(e,t,s=>ad(o,{buttons:n,toolbar:s,allowToolbarGroups:!1},t,g.none()),r);throw new Error("Toolbar groups are only supported when using floating toolbar mode")})},Ok={styles:(e,t)=>{const o=k({type:"advanced"},t.styles);return Ji(e,t,yk(e,o))},fontsize:(e,t)=>Ji(e,t,vk(e)),fontfamily:(e,t)=>Ji(e,t,bk(e)),blocks:(e,t)=>Ji(e,t,hk(e)),align:(e,t)=>Ji(e,t,gk(e))},ad=(e,t,o,n)=>{const r=(a=>{const i=a.toolbar,l=a.buttons;return i===!1?[]:i===void 0||i===!0?(c=>{const u=N(QB,d=>{const m=He(d.items,p=>Te(c,p)||Te(Ok,p));return{name:d.name,items:m}});return He(u,d=>d.items.length>0)})(l):_e(i)?(c=>{const u=c.split("|");return N(u,d=>({items:d.trim().split(" ")}))})(i):(c=>Na(c,u=>Te(u,"name")&&Te(u,"items")))(i)?i:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])})(t),s=N(r,a=>{const i=nt(a.items,l=>l.trim().length===0?[]:((c,u,d,m,p,h)=>K(u,d.toLowerCase()).orThunk(()=>h.bind(f=>yn(f,v=>K(u,v+d.toLowerCase())))).fold(()=>K(Ok,d.toLowerCase()).map(f=>f(c,p)),f=>f.type!=="grouptoolbarbutton"||m?((v,y,x)=>K(eF,v.type).fold(()=>(console.error("skipping button defined by",v),g.none()),b=>g.some(b(v,y,x))))(f,p,c):(console.warn(`Ignoring the '${d}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),g.none())))(e,t.buttons,l,t.allowToolbarGroups,o,n).toArray());return{title:g.from(e.translate(a.name)),items:i}});return He(s,a=>a.items.length>0)},_k=(e,t,o,n)=>{const r=t.mainUi.outerContainer,s=o.toolbar,a=o.buttons;if(Na(s,_e)){const i=s.map(l=>{const c={toolbar:l,buttons:a,allowToolbarGroups:o.allowToolbarGroups};return ad(e,c,n,g.none())});Fe.setToolbars(r,i)}else Fe.setToolbar(r,ad(e,o,n,g.none()))},Tk=qr(),tF=Tk.os.isiOS()&&Tk.os.version.major<=12;var oF=Object.freeze({__proto__:null,render:(e,t,o,n,r)=>{const{mainUi:s,uiMotherships:a}=t,i=Z(0),l=s.outerContainer;RB(e);const c=U(r.targetNode),u=vl(_o(c));((h,f)=>{ov(h,f,$O)})(c,s.mothership),((h,f)=>{Uu(h,f.dialogUi.mothership)})(u,t),e.on("PostRender",()=>{Fe.setSidebar(l,o.sidebar,ex(e)),_k(e,t,o,n),i.set(e.getWin().innerWidth),Fe.setMenubar(l,lk(e,o)),Fe.setViews(l,o.views),((h,f)=>{const{uiMotherships:v}=f,y=h.dom;let x=h.getWin();const b=h.getDoc().documentElement,w=Z(We(x.innerWidth,x.innerHeight)),S=Z(We(b.offsetWidth,b.offsetHeight)),C=()=>{const D=w.get();D.left===x.innerWidth&&D.top===x.innerHeight||(w.set(We(x.innerWidth,x.innerHeight)),Zm(h))},O=()=>{const D=h.getDoc().documentElement,R=S.get();R.left===D.offsetWidth&&R.top===D.offsetHeight||(S.set(We(D.offsetWidth,D.offsetHeight)),Zm(h))},A=D=>{((R,L)=>{R.dispatch("ScrollContent",L)})(h,D)};y.bind(x,"resize",C),y.bind(x,"scroll",A);const F=yb(U(h.getBody()),"load",O);h.on("hide",()=>{q(v,D=>{se(D.element,"display","none")})}),h.on("show",()=>{q(v,D=>{Me(D.element,"display")})}),h.on("NodeChange",O),h.on("remove",()=>{F.unbind(),y.unbind(x,"resize",C),y.unbind(x,"scroll",A),x=null})})(e,t)});const d=Fe.getSocket(l).getOrDie("Could not find expected socket element");if(tF){Ns(d.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});const h=((v,y)=>{let x=null;return{cancel:()=>{il(x)||(clearTimeout(x),x=null)},throttle:(...b)=>{il(x)&&(x=setTimeout(()=>{x=null,v.apply(null,b)},20))}}})(()=>{e.dispatch("ScrollContent")}),f=Pt(d.element,"scroll",h.throttle);e.on("remove",f.unbind)}Nx(e,t),e.addCommand("ToggleSidebar",(h,f)=>{Fe.toggleSidebar(l,f),e.dispatch("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",()=>{var h;return(h=Fe.whichSidebar(l))!==null&&h!==void 0?h:""}),e.addCommand("ToggleView",(h,f)=>{if(Fe.toggleView(l,f)){const v=l.element;s.mothership.broadcastOn([Tr()],{target:v}),q(a,y=>{y.broadcastOn([Tr()],{target:v})}),il(Fe.whichView(l))&&(e.focus(),e.nodeChanged())}}),e.addQueryValueHandler("ToggleView",()=>{var h;return(h=Fe.whichView(l))!==null&&h!==void 0?h:""});const m=aa(e);m!==Fo.sliding&&m!==Fo.floating||e.on("ResizeWindow ResizeEditor ResizeContent",()=>{const h=e.getWin().innerWidth;h!==i.get()&&(Fe.refreshToolbar(t.mainUi.outerContainer),i.set(h))});const p={setEnabled:h=>{Tc(t,!h)},isEnabled:()=>!Q.isDisabled(l)};return{iframeContainer:d.element.dom,editorContainer:l.element.dom,api:p}}});const pp=e=>/^[0-9\.]+(|px)$/i.test(""+e)?g.some(parseInt(""+e,10)):g.none(),hp=e=>hr(e)?e+"px":e,id=(e,t,o)=>{const n=t.filter(s=>e<s),r=o.filter(s=>e>s);return n.or(r).getOr(e)},Ek=e=>{const t=km(e),o=Cm(e),n=hc(e);return pp(t).map(r=>id(r,o,n))},{ToolbarLocation:fp,ToolbarMode:Ak}=yE,Mk=(e,t)=>{const o=Qt(e);return{pos:t?o.y:o.bottom,bounds:o}};var nF=Object.freeze({__proto__:null,render:(e,t,o,n,r)=>{const{mainUi:s}=t,a=ze(),i=U(r.targetNode),l=((m,p,h,f,v)=>{const{mainUi:y,uiMotherships:x}=h,b=xi.DOM,w=ki(m),S=Ci(m),C=hc(m).or(Ek(m)),O=f.shared.header,A=O.isPositionedAtTop,F=aa(m),D=F===Ak.sliding||F===Ak.floating,R=Z(!1),L=()=>R.get()&&!m.removed,P=ne=>D?ne.fold(E(0),ce=>ce.components().length>1?Rt(ce.components()[1].element):0):0,z=()=>{q(x,ne=>{ne.broadcastOn([Zs()],{})})},oe=(ne=!1)=>{if(L()){if(w||v.on(ce=>{const ee=C.getOrThunk(()=>{const ae=pp(co(Ln(),"margin-left")).getOr(0);return Xt(Ln())-fr(p).left+ae});se(ce.element,"max-width",ee+"px")}),D&&Fe.refreshToolbar(y.outerContainer),w||v.on(ce=>{const ee=Fe.getToolbar(y.outerContainer),ae=P(ee),ke=Qt(p),ye=A()?Math.max(ke.y-Rt(ce.element)+ae,0):ke.bottom;Ns(y.outerContainer.element,{position:"absolute",top:Math.round(ye)+"px",left:Math.round(ke.x)+"px"})}),S){const ce=ne?Ht.reset:Ht.refresh;v.on(ce)}z()}},W=(ne=!0)=>{!w&&S&&L()&&v.on(ce=>{const ee=O.getDockingMode(),ae=(ye=>{switch(Tm(m)){case fp.auto:const Ce=Fe.getToolbar(y.outerContainer),Ae=P(Ce),Gt=Rt(ye.element)-Ae,Qe=Qt(p);if(Qe.y>Gt)return"top";{const lr=Dd(p),ot=Math.max(lr.dom.scrollHeight,Rt(lr));return Qe.bottom<ot-Gt||kn().bottom<Qe.bottom-Gt?"bottom":"top"}case fp.bottom:return"bottom";case fp.top:default:return"top"}})(ce);var ke;ae!==ee&&(ke=ae,v.on(ye=>{Ht.setModes(ye,[ke]),O.setDockingMode(ke);const Ce=A()?Jn.TopToBottom:Jn.BottomToTop;ie(ye.element,Vu,Ce)}),ne&&oe(!0))})};return{isVisible:L,isPositionedAtTop:A,show:()=>{R.set(!0),se(y.outerContainer.element,"display","flex"),b.addClass(m.getBody(),"mce-edit-focus"),q(x,ne=>{Me(ne.element,"display")}),W(!1),oe()},hide:()=>{R.set(!1),se(y.outerContainer.element,"display","none"),b.removeClass(m.getBody(),"mce-edit-focus"),q(x,ne=>{se(ne.element,"display","none")})},update:oe,updateMode:W,repositionPopups:z}})(e,i,t,n,a),c=Ly(e);NB(e);const u=()=>{if(a.isSet())return void l.show();a.set(Fe.getHeader(s.outerContainer).getOrDie());const m=Dm(e);Uu(m,s.mothership),((p,h)=>{Uu(p,h.dialogUi.mothership)})(m,t),_k(e,t,o,n),Fe.setMenubar(s.outerContainer,lk(e,o)),l.show(),((p,h,f,v)=>{const y=Z(Mk(h,f.isPositionedAtTop())),x=w=>{const{pos:S,bounds:C}=Mk(h,f.isPositionedAtTop()),{pos:O,bounds:A}=y.get(),F=C.height!==A.height||C.width!==A.width;y.set({pos:S,bounds:C}),F&&Zm(p,w),f.isVisible()&&(O!==S?f.update(!0):F&&(f.updateMode(),f.repositionPopups()))};v||(p.on("activate",f.show),p.on("deactivate",f.hide)),p.on("SkinLoaded ResizeWindow",()=>f.update(!0)),p.on("NodeChange keydown",w=>{requestAnimationFrame(()=>x(w))}),p.on("ScrollWindow",()=>f.updateMode());const b=Ys();b.set(yb(U(p.getBody()),"load",w=>x(w.raw))),p.on("remove",()=>{b.clear()})})(e,i,l,c),e.nodeChanged()};e.on("show",u),e.on("hide",l.hide),c||(e.on("focus",u),e.on("blur",l.hide)),e.on("init",()=>{(e.hasFocus()||c)&&u()}),Nx(e,t);const d={show:u,hide:l.hide,setEnabled:m=>{Tc(t,!m)},isEnabled:()=>!Q.isDisabled(s.outerContainer)};return{editorContainer:s.outerContainer.element.dom,api:d}}});const Dk="contexttoolbar-hide",Bk=(e,t)=>B(A0,(o,n)=>{const r=(s=>({hide:()=>we(s,Ml()),getValue:()=>V.getValue(s)}))(e.get(o));t.onAction(r,n.event.buttonApi)}),rF=(e,t)=>{const o=e.label.fold(()=>({}),s=>({"aria-label":s})),n=De(ia.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:e.initValue(),inputAttributes:o,selectOnFocus:!0,inputBehaviours:I([$.config({mode:"special",onEnter:s=>r.findPrimary(s).map(a=>(ts(a),!0)),onLeft:(s,a)=>(a.cut(),g.none()),onRight:(s,a)=>(a.cut(),g.none())})])})),r=((s,a,i)=>{const l=N(a,c=>De(((u,d,m)=>(p=>p.type==="contextformtogglebutton")(d)?((p,h,f)=>{const b=h.original,{primary:v}=b,y=Ia(b,["primary"]),x=en(Ex(k(k({},y),{type:"togglebutton",onAction:H})));return Ck(x,f,[Bk(p,h)])})(u,d,m):((p,h,f)=>{const b=h.original,{primary:v}=b,y=Ia(b,["primary"]),x=en(Tx(k(k({},y),{type:"button",onAction:H})));return kk(x,f,[Bk(p,h)])})(u,d,m))(s,c,i)));return{asSpecs:()=>N(l,c=>c.asSpec()),findPrimary:c=>yn(a,(u,d)=>u.primary?g.from(l[d]).bind(m=>m.getOpt(c)).filter(Va(Q.isDisabled)):g.none())}})(n,e.commands,t);return[{title:g.none(),items:[n.asSpec()]},{title:g.none(),items:r.asSpecs()}]},Fk=(e,t,o)=>t.bottom-e.y>=o&&e.bottom-t.y>=o,bp=e=>{const t=(o=>{const n=o.getBoundingClientRect();if(n.height<=0&&n.width<=0){const r=xh(U(o.startContainer),o.startOffset).element;return(jr(r)?xn(r):g.some(r)).filter(Oo).map(s=>s.dom.getBoundingClientRect()).getOr(n)}return n})(e.selection.getRng());if(e.inline){const o=Sn();return Nt(o.left+t.left,o.top+t.top,t.width,t.height)}{const o=Xr(U(e.getBody()));return Nt(o.x+t.left,o.y+t.top,t.width,t.height)}},Ik=(e,t,o,n=0)=>{const r=tf(window),s=Qt(U(e.getContentAreaContainer())),a=bc(e)||vc(e)||Si(e),{x:i,width:l}=((c,u,d)=>{const m=Math.max(c.x+d,u.x);return{x:m,width:Math.min(c.right-d,u.right)-m}})(s,r,n);if(e.inline&&!a)return Nt(i,r.y,l,r.height);{const c=t.header.isPositionedAtTop(),{y:u,bottom:d}=((m,p,h,f,v,y)=>{const x=U(m.getContainer()),b=ut(x,".tox-editor-header").getOr(x),w=Qt(b),S=w.y>=p.bottom,C=f&&!S;if(m.inline&&C)return{y:Math.max(w.bottom+y,h.y),bottom:h.bottom};if(m.inline&&!C)return{y:h.y,bottom:Math.min(w.y-y,h.bottom)};const O=v==="line"?Qt(x):p;return C?{y:Math.max(w.bottom+y,h.y),bottom:Math.min(O.bottom-y,h.bottom)}:{y:Math.max(O.y+y,h.y),bottom:Math.min(w.y-y,h.bottom)}})(e,s,r,c,o,n);return Nt(i,u,l,d-u)}},Rk={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},Nk={maxHeightFunction:ci(),maxWidthFunction:sp()},Vk=e=>e==="node",sF=(e,t,o,n,r)=>{const s=bp(e),a=n.lastElement().exists(i=>Le(o,i));return((i,l)=>{const c=i.selection.getRng(),u=xh(U(c.startContainer),c.startOffset);return c.startContainer===c.endContainer&&c.startOffset===c.endOffset-1&&Le(u.element,l)})(e,o)?a?oS:An:a?((i,l,c)=>{const u=Et(i,"position");se(i,"position",l);const d=Fk(s,Qt(t),-20)&&!n.isReposition()?sD:oS;return u.each(m=>se(i,"position",m)),d})(t,n.getMode()):(n.getMode()==="fixed"?r.y+Sn().top:r.y)+(Rt(t)+12)<=s.y?An:Ki},aF=(e,t,o,n)=>{const r=a=>(i,l,c,u,d)=>k(k({},sF(e,u,a,o,d)(k(k({},i),{y:d.y,height:d.height}),l,c,u,d)),{alwaysFit:!0}),s=a=>Vk(n)?[r(a)]:[];return t?{onLtr:a=>[_t,At,Mt,Yt,Jt,yo].concat(s(a)),onRtl:a=>[_t,Mt,At,Jt,Yt,yo].concat(s(a))}:{onLtr:a=>[yo,_t,Yt,At,Jt,Mt].concat(s(a)),onRtl:a=>[yo,_t,Jt,Mt,Yt,At].concat(s(a))}},vp=(e,t)=>{const o=He(t,s=>s.predicate(e.dom)),{pass:n,fail:r}=ih(o,s=>s.type==="contexttoolbar");return{contextToolbars:n,contextForms:r}},iF=(e,t)=>{const o={},n=[],r=[],s={},a={},i=rt(e);return q(i,l=>{const c=e[l];c.type==="contextform"?((u,d)=>{const m=en(Ue("ContextForm",WE,d));o[u]=m,m.launch.map(p=>{s["form:"+u]=k(k({},d.launch),{type:p.type==="contextformtogglebutton"?"togglebutton":"button",onAction:()=>{t(m)}})}),m.scope==="editor"?r.push(m):n.push(m),a[u]=m})(l,c):c.type==="contexttoolbar"&&((u,d)=>{var m;(m=d,Ue("ContextToolbar",jE,m)).each(p=>{d.scope==="editor"?r.push(p):n.push(p),a[u]=p})})(l,c)}),{forms:o,inNodeScope:n,inEditorScope:r,lookupTable:a,formNavigators:s}},Hk=j("forward-slide"),zk=j("backward-slide"),yp=j("change-slide-event"),xp="tox-pop--resizing",wp="tox-pop--transition",lF=(e,t,o,n)=>{const r=n.backstage,s=r.shared,a=qr().deviceType.isTouch,i=ze(),l=ze(),c=ze(),u=Lt((S=>{const C=Z([]);return $e.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:O=>{C.set([]),$e.getContent(O).each(A=>{Me(A.element,"visibility")}),Ze(O.element,xp),Me(O.element,"width")},inlineBehaviours:I([le("context-toolbar-events",[js(ni(),(O,A)=>{A.event.raw.propertyName==="width"&&(Ze(O.element,xp),Me(O.element,"width"))}),B(yp,(O,A)=>{const F=O.element;Me(F,"width");const D=Xt(F);$e.setContent(O,A.event.contents),ct(F,xp);const R=Xt(F);se(F,"width",D+"px"),$e.getContent(O).each(L=>{A.event.focus.bind(P=>(Kn(P),sn(F))).orThunk(()=>($.focusIn(L),Yn(_o(F))))}),setTimeout(()=>{se(O.element,"width",R+"px")},0)}),B(Hk,(O,A)=>{$e.getContent(O).each(F=>{C.set(C.get().concat([{bar:F,focus:Yn(_o(O.element))}]))}),Y(O,yp,{contents:A.event.forwardContents,focus:g.none()})}),B(zk,(O,A)=>{Od(C.get()).each(F=>{C.set(C.get().slice(0,C.get().length-1)),Y(O,yp,{contents:Uo(F.bar),focus:F.focus})})})]),$.config({mode:"special",onEscape:O=>Od(C.get()).fold(()=>S.onEscape(),A=>(we(O,zk),g.some(!0)))})]),lazySink:()=>ue.value(S.sink)})})({sink:o,onEscape:()=>(e.focus(),g.some(!0))})),d=()=>{const S=c.get().getOr("node"),C=Vk(S)?1:0;return Ik(e,s,S,C)},m=()=>!(e.removed||a()&&r.isContextMenuOpen()),p=()=>{if(m()){const S=d(),C=Jo(c.get(),"node")?((O,A)=>A.filter(F=>Ho(F)&&(D=>Oo(D)&&DO(D.dom))(F)).map(Xr).getOrThunk(()=>bp(O)))(e,i.get()):bp(e);return S.height<=0||!Fk(C,S,.01)}return!0},h=()=>{i.clear(),l.clear(),c.clear(),$e.hide(u)},f=()=>{if($e.isOpen(u)){const S=u.element;Me(S,"display"),p()?se(S,"display","none"):(l.set(0),$e.reposition(u))}},v=S=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[S],behaviours:I([$.config({mode:"acyclic"}),le("pop-dialog-wrap-events",[Ge(C=>{e.shortcuts.add("ctrl+F9","focus statusbar",()=>$.focusIn(C))}),Cn(C=>{e.shortcuts.remove("ctrl+F9")})])])}),y=br(()=>iF(t,S=>{const C=x([S]);Y(u,Hk,{forwardContents:v(C)})})),x=S=>{const{buttons:C}=e.ui.registry.getAll(),O=k(k({},C),y().formNavigators),A=aa(e)===Fo.scrolling?Fo.scrolling:Fo.default,F=xt(N(S,D=>D.type==="contexttoolbar"?((R,L)=>ad(e,{buttons:R,toolbar:L.items,allowToolbarGroups:!1},n.backstage,g.some(["form:"])))(O,D):((R,L)=>rF(R,L))(D,s.providers)));return cp({type:A,uid:j("context-toolbar"),initGroups:F,onEscape:g.none,cyclicKeying:!0,providers:s.providers})},b=(S,C)=>{if(w.cancel(),!m())return;const O=x(S),A=S[0].position,F=((R,L)=>{const P=R==="node"?s.anchors.node(L):s.anchors.cursor(),z=((oe,W,ne,ce)=>W==="line"?{bubble:Js(12,0,Rk),layouts:{onLtr:()=>[_u],onRtl:()=>[Tu]},overrides:Nk}:{bubble:Js(0,12,Rk,1/12),layouts:aF(oe,ne,ce,W),overrides:Nk})(e,R,a(),{lastElement:i.get,isReposition:()=>Jo(l.get(),0),getMode:()=>Wt.getMode(o)});return je(P,z)})(A,C);c.set(A),l.set(1);const D=u.element;Me(D,"display"),(R=>Jo(ml(R,i.get(),Le),!0))(C)||(Ze(D,wp),Wt.reset(o,u)),$e.showWithinBounds(u,v(O),{anchor:F,transition:{classes:[wp],mode:"placement"}},()=>g.some(d())),C.fold(i.clear,i.set),p()&&se(D,"display","none")},w=P0(()=>{e.hasFocus()&&!e.removed&&(vo(u.element,wp)?w.throttle():((S,C)=>{const O=U(C.getBody()),A=D=>Le(D,O),F=U(C.selection.getNode());return(D=>!A(D)&&!fl(O,D))(F)?g.none():((D,R,L)=>{const P=vp(D,R);if(P.contextForms.length>0)return g.some({elem:D,toolbars:[P.contextForms[0]]});{const z=vp(D,L);if(z.contextForms.length>0)return g.some({elem:D,toolbars:[z.contextForms[0]]});if(P.contextToolbars.length>0||z.contextToolbars.length>0){const oe=(W=>{if(W.length<=1)return W;{const ne=ke=>Yo(W,ye=>ye.position===ke),ce=ke=>He(W,ye=>ye.position===ke),ee=ne("selection"),ae=ne("node");if(ee||ae){if(ae&&ee){const ke=ce("node"),ye=N(ce("selection"),Ce=>k(k({},Ce),{position:"node"}));return ke.concat(ye)}return ce(ee?"selection":"node")}return ce("line")}})(P.contextToolbars.concat(z.contextToolbars));return g.some({elem:D,toolbars:oe})}return g.none()}})(F,S.inNodeScope,S.inEditorScope).orThunk(()=>((D,R,L)=>D(R)?g.none():xf(R,P=>{if(Oo(P)){const{contextToolbars:z,contextForms:oe}=vp(P,L.inNodeScope),W=oe.length>0?oe:(ne=>{if(ne.length<=1)return ne;{const ce=ee=>Ke(ne,ae=>ae.position===ee);return ce("selection").orThunk(()=>ce("node")).orThunk(()=>ce("line")).map(ee=>ee.position).fold(()=>[],ee=>He(ne,ae=>ae.position===ee))}})(z);return W.length>0?g.some({elem:P,toolbars:W}):g.none()}return g.none()},D))(A,F,S))})(y(),e).fold(h,S=>{b(S.toolbars,g.some(S.elem))}))},17);e.on("init",()=>{e.on("remove",h),e.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",f),e.on("click keyup focus SetContent",w.throttle),e.on(Dk,h),e.on("contexttoolbar-show",S=>{const C=y();K(C.lookupTable,S.toolbarKey).each(O=>{b([O],za(S.target!==e,S.target)),$e.getContent(u).each($.focusIn)})}),e.on("focusout",S=>{pc.setEditorTimeout(e,()=>{sn(o.element).isNone()&&sn(u.element).isNone()&&h()},0)}),e.on("SwitchMode",()=>{e.mode.isReadOnly()&&h()}),e.on("AfterProgressState",S=>{S.state?h():e.hasFocus()&&w.throttle()}),e.on("NodeChange",S=>{sn(u.element).fold(w.throttle,H)})})},cF={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},dF=(()=>{const e="[0-9]+",t="[eE][+-]?[0-9]+",o=r=>`(?:${r})?`,n=["Infinity","[0-9]+\\."+o(e)+o(t),"\\.[0-9]+"+o(t),e+o(t)].join("|");return new RegExp(`^([+-]?(?:${n}))(.*)$`)})(),Lk=(e,t)=>{const o=()=>{const n=t.getOptions(e),r=t.getCurrent(e).map(t.hash),s=ze();return N(n,a=>({type:"togglemenuitem",text:t.display(a),onSetup:i=>{const l=u=>{u&&(s.on(d=>d.setActive(!1)),s.set(i)),i.setActive(u)};l(Jo(r,t.hash(a)));const c=t.watcher(e,a,l);return()=>{s.clear(),c()}},onAction:()=>t.setCurrent(e,a)}))};e.ui.registry.addMenuButton(t.name,{tooltip:t.text,icon:t.icon,fetch:n=>n(o()),onSetup:t.onToolbarSetup}),e.ui.registry.addNestedMenuItem(t.name,{type:"nestedmenuitem",text:t.text,getSubmenuItems:o,onSetup:t.onMenuSetup})},uF={name:"lineheight",text:"Line height",icon:"line-height",getOptions:nx,hash:e=>((t,o)=>((n,r)=>g.from(dF.exec(n)).bind(s=>{const a=Number(s[1]),i=s[2];return((l,c)=>Yo(c,u=>Yo(cF[u],d=>l===d)))(i,r)?g.some({value:a,unit:i}):g.none()}))(t,["fixed","relative","empty"]).map(({value:n,unit:r})=>n+r))(e).getOr(e),display:xe,watcher:(e,t,o)=>e.formatter.formatChanged("lineheight",o,!1,{value:t}).unbind,getCurrent:e=>g.from(e.queryCommandValue("LineHeight")),setCurrent:(e,t)=>e.execCommand("LineHeight",!1,t)},mF=e=>rd(e,"NodeChange",t=>{t.setEnabled(e.queryCommandState("outdent"))}),Pk=(e,t)=>o=>{o.setActive(t.get());const n=r=>{t.set(r.state),o.setActive(r.state)};return e.on("PastePlainTextToggle",n),()=>e.off("PastePlainTextToggle",n)},Sp=(e,t)=>()=>{e.execCommand("mceToggleFormat",!1,t)},gF=e=>{(t=>{(o=>{ws.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(n,r)=>{o.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:nd(o,n.name),onAction:Sp(o,n.name)})});for(let n=1;n<=6;n++){const r="h"+n;o.ui.registry.addToggleButton(r,{text:r.toUpperCase(),tooltip:"Heading "+n,onSetup:nd(o,r),onAction:Sp(o,r)})}})(t),(o=>{ws.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"print",text:"Print",action:"mcePrint",icon:"print"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],n=>{o.ui.registry.addButton(n.name,{tooltip:n.text,icon:n.icon,onAction:Ro(o,n.action)})})})(t),(o=>{ws.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],n=>{o.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:Ro(o,n.action),onSetup:nd(o,n.name)})})})(t)})(e),(t=>{ws.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],o=>{t.ui.registry.addMenuItem(o.name,{text:o.text,icon:o.icon,shortcut:o.shortcut,onAction:Ro(t,o.action)})}),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:Sp(t,"code")})})(e)},ld=(e,t)=>rd(e,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o=>{o.setEnabled(!e.mode.isReadOnly()&&e.undoManager[t]())}),pF=e=>rd(e,"VisualAid",t=>{t.setActive(e.hasVisual)}),hF=(e,t)=>{(o=>{q([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],n=>{o.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:Ro(o,n.cmd),onSetup:nd(o,n.name)})}),o.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:Ro(o,"JustifyNone")})})(e),gF(e),((o,n)=>{((r,s)=>{const a=Sa(0,s,gk(r));r.ui.registry.addNestedMenuItem("align",{text:s.shared.providers.translate("Align"),getSubmenuItems:()=>a.items.validateItems(a.getStyleItems())})})(o,n),((r,s)=>{const a=Sa(0,s,bk(r));r.ui.registry.addNestedMenuItem("fontfamily",{text:s.shared.providers.translate("Fonts"),getSubmenuItems:()=>a.items.validateItems(a.getStyleItems())})})(o,n),((r,s)=>{const a=k({type:"advanced"},s.styles),i=Sa(0,s,yk(r,a));r.ui.registry.addNestedMenuItem("styles",{text:"Formats",getSubmenuItems:()=>i.items.validateItems(i.getStyleItems())})})(o,n),((r,s)=>{const a=Sa(0,s,hk(r));r.ui.registry.addNestedMenuItem("blocks",{text:"Blocks",getSubmenuItems:()=>a.items.validateItems(a.getStyleItems())})})(o,n),((r,s)=>{const a=Sa(0,s,vk(r));r.ui.registry.addNestedMenuItem("fontsize",{text:"Font sizes",getSubmenuItems:()=>a.items.validateItems(a.getStyleItems())})})(o,n)})(e,t),(o=>{(n=>{n.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:ld(n,"hasUndo"),onAction:Ro(n,"undo")}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:ld(n,"hasRedo"),onAction:Ro(n,"redo")})})(o),(n=>{n.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:ld(n,"hasUndo"),onAction:Ro(n,"undo")}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:ld(n,"hasRedo"),onAction:Ro(n,"redo")})})(o)})(e),(o=>{(i=>{i.addCommand("mceApplyTextcolor",(l,c)=>{((u,d,m)=>{u.undoManager.transact(()=>{u.focus(),u.formatter.apply(d,{value:m}),u.nodeChanged()})})(i,l,c)}),i.addCommand("mceRemoveTextcolor",l=>{((c,u)=>{c.undoManager.transact(()=>{c.focus(),c.formatter.remove(u,{value:null},void 0,!0),c.nodeChanged()})})(i,l)})})(o);const n=yA(o),r=xA(o),s=Z(n),a=Z(r);pw(o,"forecolor","forecolor","Text color",s),pw(o,"backcolor","hilitecolor","Background color",a),hw(o,"forecolor","forecolor","Text color"),hw(o,"backcolor","hilitecolor","Background color")})(e),(o=>{(n=>{n.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:Ro(n,"mceToggleVisualAid")})})(o),(n=>{n.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:pF(n),onAction:Ro(n,"mceToggleVisualAid")})})(o)})(e),(o=>{(n=>{n.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:mF(n),onAction:Ro(n,"outdent")}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:Ro(n,"indent")})})(o)})(e),(o=>{Lk(o,uF),(n=>g.from(Vy(n)).map(r=>({name:"language",text:"Language",icon:"language",getOptions:E(r),hash:s=>Vn(s.customCode)?s.code:`${s.code}/${s.customCode}`,display:s=>s.title,watcher:(s,a,i)=>{var l;return s.formatter.formatChanged("lang",i,!1,{value:a.code,customValue:(l=a.customCode)!==null&&l!==void 0?l:null}).unbind},getCurrent:s=>{const a=U(s.selection.getNode());return Jd(a,i=>g.some(i).filter(Oo).bind(l=>lo(l,"lang").map(c=>({code:c,customCode:lo(l,"data-mce-lang").getOrUndefined(),title:""}))))},setCurrent:(s,a)=>s.execCommand("Lang",!1,a),onToolbarSetup:s=>{const a=Ys();return s.setActive(n.formatter.match("lang",{},void 0,!0)),a.set(n.formatter.formatChanged("lang",s.setActive,!0)),a.clear}})))(o).each(n=>Lk(o,n))})(e),(o=>{const n=Z(Qy(o)),r=()=>o.execCommand("mceTogglePlainTextPaste");o.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:r,onSetup:Pk(o,n)}),o.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:r,onSetup:Pk(o,n)})})(e)},fF=e=>_e(e)?e.split(/[ ,]/):e,Uk=e=>t=>t.options.get(e),Wk=Uk("contextmenu_never_use_native"),bF=Uk("contextmenu_avoid_overlap"),jk=e=>{const t=e.ui.registry.getAll().contextMenus,o=e.options.get("contextmenu");return e.options.isSet("contextmenu")?o:He(o,n=>Te(t,n))},Qi=(e,t)=>({type:"makeshift",x:e,y:t}),Gk=e=>e.type==="longpress"||e.type.indexOf("touch")===0,vF=(e,t)=>t.type==="contextmenu"||t.type==="longpress"?e.inline?(o=>{if(Gk(o)){const n=o.touches[0];return Qi(n.pageX,n.pageY)}return Qi(o.pageX,o.pageY)})(t):((o,n)=>{const r=xi.DOM.getPos(o);return((s,a,i)=>Qi(s.x+a,s.y+i))(n,r.x,r.y)})(e.getContentAreaContainer(),(o=>{if(Gk(o)){const n=o.touches[0];return Qi(n.clientX,n.clientY)}return Qi(o.clientX,o.clientY)})(t)):$k(e),$k=e=>({type:"selection",root:U(e.selection.getNode())}),qk=(e,t,o)=>{switch(o){case"node":return(n=>({type:"node",node:g.some(U(n.selection.getNode())),root:U(n.getBody())}))(e);case"point":return vF(e,t);case"selection":return $k(e)}},yF=(e,t,o,n,r,s)=>{const a=o(),i=qk(e,t,s);ya(a,un.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:g.none()}).map(l=>{t.preventDefault(),$e.showMenuAt(r,{anchor:i},{menu:{markers:ms("normal")},data:l})})},xF={onLtr:()=>[_t,At,Mt,Yt,Jt,yo,An,Ki,Xi,Yc,qi,Kc],onRtl:()=>[_t,Mt,At,Jt,Yt,yo,An,Ki,qi,Kc,Xi,Yc]},wF={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},SF=(e,t,o,n,r,s)=>{const a=qr(),i=a.os.isiOS(),l=a.os.isMacOS(),c=a.os.isAndroid(),u=a.deviceType.isTouch(),d=()=>{const m=o();((p,h,f,v,y,x,b)=>{const w=((S,C,O)=>{const A=qk(S,C,O);return k({bubble:Js(0,O==="point"?12:0,wF),layouts:xF,overrides:{maxWidthFunction:sp(),maxHeightFunction:ci()}},A)})(p,h,x);ya(f,un.CLOSE_ON_EXECUTE,v,{isHorizontalMenu:!0,search:g.none()}).map(S=>{h.preventDefault();const C=b?jt.HighlightMenuAndItem:jt.HighlightNone;$e.showMenuWithinBounds(y,{anchor:w},{menu:{markers:ms("normal"),highlightOnOpen:C},data:S,type:"horizontal"},()=>g.some(Ik(p,v.shared,x==="node"?"node":"selection"))),p.dispatch(Dk)})})(e,t,m,n,r,s,!(c||i||l&&u))};if((l||i)&&s!=="node"){const m=()=>{(p=>{const h=p.selection.getRng(),f=()=>{pc.setEditorTimeout(p,()=>{p.selection.setRng(h)},10),x()};p.once("touchend",f);const v=b=>{b.preventDefault(),b.stopImmediatePropagation()};p.on("mousedown",v,!0);const y=()=>x();p.once("longpresscancel",y);const x=()=>{p.off("touchend",f),p.off("longpresscancel",y),p.off("mousedown",v)}})(e),d()};((p,h)=>{const f=p.selection;if(f.isCollapsed()||h.touches.length<1)return!1;{const v=h.touches[0],y=f.getRng();return Nb(p.getWin(),di.domRange(y)).exists(x=>x.left<=v.clientX&&x.right>=v.clientX&&x.top<=v.clientY&&x.bottom>=v.clientY)}})(e,t)?m():(e.once("selectionchange",m),e.once("touchend",()=>e.off("selectionchange",m)))}else d()},Xk=e=>_e(e)?e==="|":e.type==="separator",kp={type:"separator"},Kk=e=>{const t=n=>({text:n.text,icon:n.icon,enabled:n.enabled,shortcut:n.shortcut});if(_e(e))return e;switch(e.type){case"separator":return kp;case"submenu":return k(k({type:"nestedmenuitem"},t(e)),{getSubmenuItems:()=>{const r=e.getSubmenuItems();return _e(r)?r:N(r,Kk)}});default:const n=e;return k(k({type:"menuitem"},t(n)),{onAction:(o=n.onAction,()=>o())})}var o},Yk=(e,t)=>{if(t.length===0)return e;const o=Od(e).filter(n=>!Xk(n)).fold(()=>[],n=>[kp]);return e.concat(o).concat(t).concat([kp])},Jk=(e,t)=>!(o=>o.type==="longpress"||Te(o,"touches"))(t)&&(t.button!==2||t.target===e.getBody()&&t.pointerType===""),Zk=(e,t)=>Jk(e,t)?e.selection.getStart(!0):t.target,kF=(e,t,o)=>{const n=qr().deviceType.isTouch,r=Lt($e.sketch({dom:{tag:"div"},lazySink:t,onEscape:()=>e.focus(),onShow:()=>o.setContextMenuState(!0),onHide:()=>o.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:I([le("dismissContextMenu",[B(Us(),(i,l)=>{ge.close(i),e.focus()})])])})),s=()=>$e.hide(r),a=i=>{if(Wk(e)&&i.preventDefault(),((c,u)=>u.ctrlKey&&!Wk(c))(e,i)||(c=>jk(c).length===0)(e))return;const l=((c,u)=>{const d=bF(c),m=Jk(c,u)?"selection":"point";if(Ad(d)){const p=Zk(c,u);return zi(U(p),d)?"node":m}return m})(e,i);(n()?SF:yF)(e,i,()=>{const c=Zk(e,i),u=e.ui.registry.getAll(),d=jk(e);return((m,p,h)=>{const f=Ft(p,(v,y)=>K(m,y.toLowerCase()).map(x=>{const b=x.update(h);if(_e(b))return Yk(v,b.split(" "));if(b.length>0){const w=N(b,Kk);return Yk(v,w)}return v}).getOrThunk(()=>v.concat([y])),[]);return f.length>0&&Xk(f[f.length-1])&&f.pop(),f})(u.contextMenus,d,c)},o,r,l)};e.on("init",()=>{const i="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(n()?"":" ResizeWindow");e.on(i,s),e.on("longpress contextmenu",a)})},Cp=Mo([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),cd=e=>t=>t.translate(-e.left,-e.top),dd=e=>t=>t.translate(e.left,e.top),ir=e=>(t,o)=>Ft(e,(n,r)=>r(n),We(t,o)),ud=(e,t,o)=>e.fold(ir([dd(o),cd(t)]),ir([cd(t)]),ir([])),Ca=(e,t,o)=>e.fold(ir([dd(o)]),ir([]),ir([dd(t)])),Qk=(e,t,o)=>e.fold(ir([]),ir([cd(o)]),ir([dd(t),cd(o)])),eC=(e,t,o)=>{const n=e.fold((r,s)=>({position:g.some("absolute"),left:g.some(r+"px"),top:g.some(s+"px")}),(r,s)=>({position:g.some("absolute"),left:g.some(r-o.left+"px"),top:g.some(s-o.top+"px")}),(r,s)=>({position:g.some("fixed"),left:g.some(r+"px"),top:g.some(s+"px")}));return k({right:g.none(),bottom:g.none()},n)},Op=(e,t,o,n)=>{const r=(s,a)=>(i,l)=>{const c=s(t,o,n);return a(i.getOr(c.left),l.getOr(c.top))};return e.fold(r(Qk,md),r(Ca,Vr),r(ud,Os))},md=Cp.offset,Vr=Cp.absolute,Os=Cp.fixed,tC=(e,t)=>{const o=Tt(e,t);return Vn(o)?NaN:parseInt(o,10)},CF=(e,t,o,n,r,s)=>{const a=((c,u,d,m)=>((p,h)=>{const f=p.element,v=tC(f,h.leftAttr),y=tC(f,h.topAttr);return isNaN(v)||isNaN(y)?g.none():g.some(We(v,y))})(c,u).fold(()=>d,p=>Os(p.left+m.left,p.top+m.top)))(e,t,o,n),i=t.mustSnap?OF(e,t,a,r,s):_F(e,t,a,r,s),l=ud(a,r,s);return((c,u,d)=>{const m=c.element;ie(m,u.leftAttr,d.left+"px"),ie(m,u.topAttr,d.top+"px")})(e,t,l),i.fold(()=>({coord:Os(l.left,l.top),extra:g.none()}),c=>({coord:c.output,extra:c.extra}))},oC=(e,t,o,n)=>yn(e,r=>{const s=r.sensor;return((i,l,c,u,d,m)=>{const p=Ca(i,d,m),h=Ca(l,d,m);return Math.abs(p.left-h.left)<=c&&Math.abs(p.top-h.top)<=u})(t,s,r.range.left,r.range.top,o,n)?g.some({output:Op(r.output,t,o,n),extra:r.extra}):g.none()}),OF=(e,t,o,n,r)=>{const s=t.getSnapPoints(e);return oC(s,o,n,r).orThunk(()=>Ft(s,(i,l)=>{const c=l.sensor,u=((d,m,p,h,f,v)=>{const y=Ca(d,f,v),x=Ca(m,f,v),b=Math.abs(y.left-x.left),w=Math.abs(y.top-x.top);return We(b,w)})(o,c,l.range.left,l.range.top,n,r);return i.deltas.fold(()=>({deltas:g.some(u),snap:g.some(l)}),d=>(u.left+u.top)/2<=(d.left+d.top)/2?{deltas:g.some(u),snap:g.some(l)}:i)},{deltas:g.none(),snap:g.none()}).snap.map(i=>({output:Op(i.output,o,n,r),extra:i.extra})))},_F=(e,t,o,n,r)=>{const s=t.getSnapPoints(e);return oC(s,o,n,r)};var TF=Object.freeze({__proto__:null,snapTo:(e,t,o,n)=>{const r=t.getTarget(e.element);if(t.repositionTarget){const s=Zo(e.element),a=Sn(s),i=OS(r),l=((u,d,m)=>({coord:Op(u.output,u.output,d,m),extra:u.extra}))(n,a,i),c=eC(l.coord,0,i);yl(r,c)}}});const _p="data-initial-z-index",nC=(e,t)=>{e.getSystem().addToGui(t),(o=>{xn(o.element).filter(Oo).each(n=>{Et(n,"z-index").each(r=>{ie(n,_p,r)}),se(n,"z-index",co(o.element,"z-index"))})})(t)},EF=e=>{(t=>{xn(t.element).filter(Oo).each(o=>{lo(o,_p).fold(()=>Me(o,"z-index"),n=>se(o,"z-index",n)),at(o,_p)})})(e),e.getSystem().removeFromGui(e)},rC=(e,t,o)=>e.getSystem().build(gn.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:o}));var AF=po("snaps",[M("getSnapPoints"),me("onSensor"),M("leftAttr"),M("topAttr"),T("lazyViewport",kn),T("mustSnap",!1)]);const Tp=[T("useFixed",Ve),M("blockerClass"),T("getTarget",xe),T("onDrag",H),T("repositionTarget",!0),T("onDrop",H),lt("getBounds",kn),AF],sC=(e,t)=>({bounds:e.getBounds(),height:$r(t.element),width:ja(t.element)}),Ep=(e,t,o,n,r)=>{const s=o.update(n,r),a=o.getStartData().getOrThunk(()=>sC(t,e));s.each(i=>{((l,c,u,d)=>{const m=c.getTarget(l.element);if(c.repositionTarget){const p=Zo(l.element),h=Sn(p),f=OS(m),v=(b=>{return(w=Et(b,"left"),S=Et(b,"top"),C=Et(b,"position"),O=(A,F,D)=>(D==="fixed"?Os:md)(parseInt(A,10),parseInt(F,10)),w.isSome()&&S.isSome()&&C.isSome()?g.some(O(w.getOrDie(),S.getOrDie(),C.getOrDie())):g.none()).getOrThunk(()=>{const A=fr(b);return Vr(A.left,A.top)});var w,S,C,O})(m),y=((b,w,S,C,O,A,F)=>((D,R,L,P,z)=>{const oe=z.bounds,W=Ca(R,L,P),ne=Do(W.left,oe.x,oe.x+oe.width-z.width),ce=Do(W.top,oe.y,oe.y+oe.height-z.height),ee=Vr(ne,ce);return R.fold(()=>{const ae=Qk(ee,L,P);return md(ae.left,ae.top)},E(ee),()=>{const ae=ud(ee,L,P);return Os(ae.left,ae.top)})})(0,w.fold(()=>{const D=(R=S,L=A.left,P=A.top,R.fold((oe,W)=>md(oe+L,W+P),(oe,W)=>Vr(oe+L,W+P),(oe,W)=>Os(oe+L,W+P)));var R,L,P;const z=ud(D,C,O);return Os(z.left,z.top)},D=>{const R=CF(b,D,S,A,C,O);return R.extra.each(L=>{D.onSensor(b,L)}),R.coord}),C,O,F))(l,c.snaps,v,h,f,d,u),x=eC(y,0,f);yl(m,x)}c.onDrag(l,m,d)})(e,t,a,i)})},aC=(e,t,o,n)=>{t.each(EF),o.snaps.each(s=>{((a,i)=>{((l,c)=>{const u=l.element;at(u,c.leftAttr),at(u,c.topAttr)})(a,i)})(e,s)});const r=o.getTarget(e.element);n.reset(),o.onDrop(e,r)},Ap=e=>(t,o)=>{const n=r=>{o.setStartData(sC(t,r))};return Re([B(nu(),r=>{o.getStartData().each(()=>n(r))}),...e(t,o,n)])};var MF=Object.freeze({__proto__:null,getData:e=>g.from(We(e.x,e.y)),getDelta:(e,t)=>We(t.left-e.left,t.top-e.top)});const iC=(e,t,o)=>[B(Po(),(n,r)=>{if(r.event.raw.button!==0)return;r.stop();const s=()=>aC(n,g.some(l),e,t),a=Aw(s,200),i={drop:s,delayDrop:a.schedule,forceDrop:s,move:c=>{a.cancel(),Ep(n,e,t,MF,c)}},l=rC(n,e.blockerClass,(c=>Re([B(Po(),c.forceDrop),B(Qd(),c.drop),B(Al(),(u,d)=>{c.move(d.event)}),B(Zd(),c.delayDrop)]))(i));o(n),nC(n,l)})],DF=[...Tp,Ne("dragger",{handlers:Ap(iC)})];var lC=Object.freeze({__proto__:null,getData:e=>{const t=e.raw.touches;return t.length===1?(o=>{const n=o[0];return g.some(We(n.clientX,n.clientY))})(t):g.none()},getDelta:(e,t)=>We(t.left-e.left,t.top-e.top)});const cC=(e,t,o)=>{const n=ze(),r=s=>{aC(s,n.get(),e,t),n.clear()};return[B($n(),(s,a)=>{a.stop();const i=()=>r(s),l={drop:i,delayDrop:H,forceDrop:i,move:u=>{Ep(s,e,t,lC,u)}},c=rC(s,e.blockerClass,(u=>Re([B($n(),u.forceDrop),B(Qa(),u.drop),B(Sf(),u.drop),B(Za(),(d,m)=>{u.move(m.event)})]))(l));n.set(c),o(s),nC(s,c)}),B(Za(),(s,a)=>{a.stop(),Ep(s,e,t,lC,a.event)}),B(Qa(),(s,a)=>{a.stop(),r(s)}),B(Sf(),r)]},BF=DF,FF=[...Tp,Ne("dragger",{handlers:Ap(cC)})],IF=[...Tp,Ne("dragger",{handlers:Ap((e,t,o)=>[...iC(e,t,o),...cC(e,t,o)])})];var RF=Object.freeze({__proto__:null,mouse:BF,touch:FF,mouseOrTouch:IF}),NF=Object.freeze({__proto__:null,init:()=>{let e=g.none(),t=g.none();const o=E({});return bo({readState:o,reset:()=>{e=g.none(),t=g.none()},update:(n,r)=>n.getData(r).bind(s=>((a,i)=>{const l=e.map(c=>a.getDelta(c,i));return e=g.some(i),l})(n,s)),getStartData:()=>t,setStartData:n=>{t=g.some(n)}})}});const _s=ub({branchKey:"mode",branches:RF,name:"dragging",active:{events:(e,t)=>e.dragger.handlers(e,t)},extra:{snap:e=>({sensor:e.sensor,range:e.range,output:e.output,extra:g.from(e.extra)})},state:NF,apis:TF}),dC=(e,t,o,n,r,s)=>e.fold(()=>_s.snap({sensor:Vr(o-20,n-20),range:We(r,s),output:Vr(g.some(o),g.some(n)),extra:{td:t}}),a=>{const i=o-20,l=n-20,c=a.element.dom.getBoundingClientRect();return _s.snap({sensor:Vr(i,l),range:We(40,40),output:Vr(g.some(o-c.width/2),g.some(n-c.height/2)),extra:{td:t}})}),uC=(e,t,o)=>({getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(n,r)=>{const s=r.td;((a,i)=>a.exists(l=>Le(l,i)))(t.get(),s)||(t.set(s),o(s))},mustSnap:!0}),mC=e=>De(Zt.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:I([_s.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),ji.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),VF=(e,t)=>{const o=Z([]),n=Z([]),r=Z(!1),s=ze(),a=ze(),i=x=>{const b=Xr(x);return dC(d.getOpt(t),x,b.x,b.y,b.width,b.height)},l=x=>{const b=Xr(x);return dC(m.getOpt(t),x,b.right,b.bottom,b.width,b.height)},c=uC(()=>N(o.get(),x=>i(x)),s,x=>{a.get().each(b=>{e.dispatch("TableSelectorChange",{start:x,finish:b})})}),u=uC(()=>N(n.get(),x=>l(x)),a,x=>{s.get().each(b=>{e.dispatch("TableSelectorChange",{start:b,finish:x})})}),d=mC(c),m=mC(u),p=Lt(d.asSpec()),h=Lt(m.asSpec()),f=(x,b,w,S)=>{const C=w(b);_s.snapTo(x,C),((O,A,F,D)=>{const R=A.dom.getBoundingClientRect();Me(O.element,"display");const L=Pa(U(e.getBody())).dom.innerHeight,P=R[S]<0,z=((oe,W)=>oe[S]>W)(R,L);(P||z)&&se(O.element,"display","none")})(x,b)},v=x=>f(p,x,i,"top"),y=x=>f(h,x,l,"bottom");qr().deviceType.isTouch()&&(e.on("TableSelectionChange",x=>{r.get()||(ls(t,p),ls(t,h),r.set(!0)),s.set(x.start),a.set(x.finish),x.otherCells.each(b=>{o.set(b.upOrLeftCells),n.set(b.downOrRightCells),v(x.start),y(x.finish)})}),e.on("ResizeEditor ResizeWindow ScrollContent",()=>{s.get().each(v),a.get().each(y)}),e.on("TableSelectionClear",()=>{r.get()&&(Zn(p),Zn(h),r.set(!1)),s.clear(),a.clear()}))},HF=(e,t,o)=>{var n;const r=(n=t.delimiter)!==null&&n!==void 0?n:"\u203A";return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:I([$.config({mode:"flow",selector:"div[role=button]"}),Q.config({disabled:o.isDisabled}),et(),qe.config({}),re.config({}),le("elementPathEvents",[Ge((s,a)=>{e.shortcuts.add("alt+F11","focus statusbar elementpath",()=>$.focusIn(s)),e.on("NodeChange",i=>{const l=(u=>{const d=[];let m=u.length;for(;m-- >0;){const h=u[m];if(h.nodeType===1&&(p=h).nodeName!=="BR"&&!p.getAttribute("data-mce-bogus")&&p.getAttribute("data-mce-type")!=="bookmark"){const f=fA(e,h);if(f.isDefaultPrevented()||d.push({name:f.name,element:h}),f.isPropagationStopped())break}}var p;return d})(i.parents),c=l.length>0?Ft(l,(u,d,m)=>{const p=((h,f,v)=>Zt.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":v,"aria-level":v+1}},components:[dt(h)],action:y=>{e.focus(),e.selection.select(f),e.nodeChanged()},buttonBehaviours:I([ua(o.isDisabled),et()])}))(d.name,d.element,m);return m===0?u.concat([p]):u.concat([{dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[dt(` ${r} `)]},p])},[]):[];re.set(s,c)})})])]),components:[]}};var Ts;(function(e){e[e.None=0]="None",e[e.Both=1]="Both",e[e.Vertical=2]="Vertical"})(Ts||(Ts={}));const gC=(e,t,o)=>{const n=U(e.getContainer()),r=((s,a,i,l,c)=>{const u={height:id(l+a.top,Om(s),_m(s))};return i===Ts.Both&&(u.width=id(c+a.left,Cm(s),hc(s))),u})(e,t,o,Rt(n),Xt(n));It(r,(s,a)=>{hr(s)&&se(n,a,hp(s))}),(s=>{s.dispatch("ResizeEditor")})(e)},gd=(e,t,o,n)=>{const r=We(20*o,20*n);return gC(e,r,t),g.some(!0)},zF=(e,t)=>({dom:{tag:"div",classes:["tox-statusbar"]},components:(()=>{const o=(()=>{const r=[];return Jy(e)&&r.push(HF(e,{},t)),e.hasPlugin("wordcount")&&r.push(((s,a)=>{const i=(l,c,u)=>re.set(l,[dt(a.translate(["{0} "+u,c[u]]))]);return Zt.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:I([ua(a.isDisabled),et(),qe.config({}),re.config({}),V.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),le("wordcount-events",[qn(l=>{const c=V.getValue(l),u=c.mode==="words"?"characters":"words";V.setValue(l,{mode:u,count:c.count}),i(l,c.count,u)}),Ge(l=>{s.on("wordCountUpdate",c=>{const{mode:u}=V.getValue(l);V.setValue(l,{mode:u,count:c.wordCount}),i(l,c.wordCount,u)})})])]),eventOrder:{[fo()]:["disabling","alloy.base.behaviour","wordcount-events"]}})})(e,t)),r.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:r}]:[]})(),n=((r,s)=>{const a=(i=>{const l=Zy(i);return l===!1?Ts.None:l==="both"?Ts.Both:Ts.Vertical})(r);return a===Ts.None?g.none():g.some(dn("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:s.translate("Resize")},behaviours:[_s.config({mode:"mouse",repositionTarget:!1,onDrag:(i,l,c)=>gC(r,c,a),blockerClass:"tox-blocker"}),$.config({mode:"special",onLeft:()=>gd(r,a,-1,0),onRight:()=>gd(r,a,1,0),onUp:()=>gd(r,a,0,-1),onDown:()=>gd(r,a,0,1)}),qe.config({}),te.config({})]},s.icons))})(e,t);return o.concat(n.toArray())})()}),pC=(e,t)=>t.get().getOrDie(`UI for ${e} has not been rendered`),LF=e=>{const t=e.inline,o=t?nF:oF,n=Ci(e)?UD:RD,r=(()=>{const b=ze(),w=ze(),S=ze();return{dialogUi:b,popupUi:w,mainUi:S,getUiMotherships:()=>[...b.get().map(C=>C.mothership).toArray()],setupDialogUi:C=>{b.set(C)},lazyGetInOuterOrDie:(C,O)=>()=>S.get().bind(A=>O(A.outerContainer)).getOrDie(`Could not find ${C} element in OuterContainer`)}})(),s=ze(),a=ze(),i=qr().deviceType.isTouch()?["tox-platform-touch"]:[],l=Mm(e),c=aa(e),u=De({dom:{tag:"div",classes:["tox-anchorbar"]}}),d=()=>r.mainUi.get().map(b=>b.outerContainer).bind(Fe.getHeader),m=r.lazyGetInOuterOrDie("anchor bar",u.getOpt),p=r.lazyGetInOuterOrDie("toolbar",Fe.getToolbar),h=r.lazyGetInOuterOrDie("throbber",Fe.getThrobber),f=((b,w,S)=>{const C=Z(!1),O=(W=>{const ne=Z(Mm(W)?"bottom":"top");return{isPositionedAtTop:()=>ne.get()==="top",getDockingMode:ne.get,setDockingMode:ne.set}})(w),A={icons:()=>w.ui.registry.getAll().icons,menuItems:()=>w.ui.registry.getAll().menuItems,translate:cn.translate,isDisabled:()=>w.mode.isReadOnly()||!w.ui.isEnabled(),getOption:w.options.get},F=ED(w),D=(W=>{const ne=ye=>()=>W.formatter.match(ye),ce=ye=>()=>{const Ce=W.formatter.get(ye);return Ce!==void 0?g.some({tag:Ce.length>0&&(Ce[0].inline||Ce[0].block)||"div",styles:W.dom.parseStyle(W.formatter.getCssText(ye))}):g.none()},ee=Z([]),ae=Z([]),ke=Z(!1);return W.on("PreInit",ye=>{const Ce=lS(W),Ae=dS(W,Ce,ne,ce);ee.set(Ae)}),W.on("addStyleModifications",ye=>{const Ce=dS(W,ye.items,ne,ce);ae.set(Ce),ke.set(ye.replace)}),{getData:()=>{const ye=ke.get()?[]:ee.get(),Ce=ae.get();return ye.concat(Ce)}}})(w),R=(W=>({colorPicker:uD(W),hasCustomColors:mD(W),getColors:gD(W),getColorCols:pD(W)}))(w),L=(W=>({isDraggableModal:hD(W)}))(w),P={shared:{providers:A,anchors:dD(w,S,O.isPositionedAtTop),header:O},urlinput:F,styles:D,colorinput:R,dialog:L,isContextMenuOpen:()=>C.get(),setContextMenuState:W=>C.set(W)},z=k(k({},P),{shared:k(k({},P.shared),{interpreter:W=>J0(W,{},z),getSink:b.popup})}),oe=k(k({},P),{shared:k(k({},P.shared),{interpreter:W=>J0(W,{},oe),getSink:b.dialog})});return{popup:z,dialog:oe}})({popup:()=>ue.fromOption(r.popupUi.get().map(b=>b.sink),"(popup) UI has not been rendered"),dialog:()=>ue.fromOption(r.dialogUi.get().map(b=>b.sink),"UI has not been rendered")},e,m),v=xe,y=()=>{const b=(()=>{const z={attributes:{[Vu]:l?Jn.BottomToTop:Jn.TopToBottom}},oe=Fe.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:f.popup,onEscape:()=>{e.focus()}}),W=Fe.parts.toolbar(k({dom:{tag:"div",classes:["tox-toolbar"]},getSink:f.popup.shared.getSink,providers:f.popup.shared.providers,onEscape:()=>{e.focus()},onToolbarToggled:Gt=>{((Qe,lr)=>{Qe.dispatch("ToggleToolbarDrawer",{state:lr})})(e,Gt)},type:c,lazyToolbar:p,lazyHeader:()=>d().getOrDie("Could not find header element")},z)),ne=Fe.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:f.popup.shared.providers,onEscape:()=>{e.focus()},type:c}),ce=Si(e),ee=vc(e),ae=bc(e),ke=tx(e),ye=Fe.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),Ce=ce||ee||ae,Ae=ke?[ye,oe]:[oe];return Fe.parts.header({dom:k({tag:"div",classes:["tox-editor-header"].concat(Ce?[]:["tox-editor-header--empty"])},z),components:xt([ae?Ae:[],ce?[ne]:ee?[W]:[],ki(e)?[]:[u.asSpec()]]),sticky:Ci(e),editor:e,sharedBackstage:f.popup.shared})})(),w={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[Fe.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),Fe.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}})]},S=Fe.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:f.popup}),C=Fe.parts.viewWrapper({backstage:f.popup}),O=Yy(e)&&!t?g.some(zF(e,f.popup.shared.providers)):g.none(),A=xt([l?[]:[b],t?[]:[w],l?[b]:[]]),F=Fe.parts.editorContainer({components:xt([A,t?[]:O.toArray()])}),D=Bm(e),R=k(k({role:"application"},cn.isRtl()?{dir:"rtl"}:{}),D?{"aria-hidden":"true"}:{}),L=Lt(Fe.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(t?["tox-tinymce-inline"]:[]).concat(l?["tox-tinymce--toolbar-bottom"]:[]).concat(i),styles:k({visibility:"hidden"},D?{opacity:"0",border:"0"}:{}),attributes:R},components:[F,...t?[]:[C],S],behaviours:I([et(),Q.config({disableClass:"tox-tinymce--disabled"}),$.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),P=Rw(L);return s.set(P),{mothership:P,outerContainer:L}},x=b=>{const w=hp((C=>(A=>{const F=Sm(A),D=Om(A),R=_m(A);return pp(F).map(L=>id(L,D,R))})(C).getOr(Sm(C)))(e)),S=hp((C=>Ek(C).getOr(km(C)))(e));return e.inline||(Ah("div","width",S)&&se(b.element,"width",S),Ah("div","height",w)?se(b.element,"height",w):se(b.element,"height","400px")),w};return{popups:{backstage:f.popup,getMothership:()=>pC("popups",a)},dialogs:{backstage:f.dialog,getMothership:()=>pC("dialogs",a)},renderUI:()=>{const b=y(),w=(()=>{const C=Dm(e),O=Le(Ln(),C)&&co(C,"display")==="grid",A={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(i),attributes:k({},cn.isRtl()?{dir:"rtl"}:{})},behaviours:I([Wt.config({useFixed:()=>n.isDocked(d)})])},F={dom:{styles:{width:document.body.clientWidth+"px"}},events:Re([B(Bl(),L=>{se(L.element,"width",document.body.clientWidth+"px")})])},D=Lt(je(A,O?F:{})),R=Rw(D);return a.set(R),{sink:D,mothership:R}})(),S=v(w);return r.dialogUi.set(w),r.popupUi.set(S),r.mainUi.set(b),(C=>{const{mainUi:O,popupUi:A,uiMotherships:F}=C;ft(zy(e),(ee,ae)=>{e.ui.registry.addGroupToolbarButton(ae,ee)});const{buttons:D,menuItems:R,contextToolbars:L,sidebars:P,views:z}=e.ui.registry.getAll(),oe=Am(e),W={menuItems:R,menus:sx(e),menubar:Uy(e),toolbar:oe.getOrThunk(()=>fc(e)),allowToolbarGroups:c===Fo.floating,buttons:D,sidebar:P,views:z};var ne;ne=O.outerContainer,e.addShortcut("alt+F9","focus menubar",()=>{Fe.focusMenubar(ne)}),e.addShortcut("alt+F10","focus toolbar",()=>{Fe.focusToolbar(ne)}),e.addCommand("ToggleToolbarDrawer",()=>{Fe.toggleToolbarDrawer(ne)}),e.addQueryStateHandler("ToggleToolbarDrawer",()=>Fe.isToolbarDrawerToggled(ne)),((ee,ae,ke)=>{const ye=(Ie,zr)=>{q([ae,...ke],Ma=>{Ma.broadcastEvent(Ie,zr)})},Ce=(Ie,zr)=>{q([ae,...ke],Ma=>{Ma.broadcastOn([Ie],zr)})},Ae=Ie=>Ce(Tr(),{target:Ie.target}),Gt=zd(),Qe=Pt(Gt,"touchstart",Ae),lr=Pt(Gt,"touchmove",Ie=>ye(d_(),Ie)),ot=Pt(Gt,"touchend",Ie=>ye(u_(),Ie)),Ms=Pt(Gt,"mousedown",Ae),ol=Pt(Gt,"mouseup",Ie=>{Ie.raw.button===0&&Ce(Wu(),{target:Ie.target})}),Ds=Ie=>Ce(Tr(),{target:U(Ie.target)}),Ta=Ie=>{Ie.button===0&&Ce(Wu(),{target:U(Ie.target)})},nl=()=>{q(ee.editorManager.get(),Ie=>{ee!==Ie&&Ie.dispatch("DismissPopups",{relatedTarget:ee})})},cr=Ie=>ye(nu(),xb(Ie)),Fn=Ie=>{Ce(Zs(),{}),ye(Bl(),xb(Ie))},Ea=()=>Ce(Zs(),{}),Aa=Ie=>{Ie.state&&Ce(Tr(),{target:U(ee.getContainer())})},dr=Ie=>{Ce(Tr(),{target:U(Ie.relatedTarget.getContainer())})};ee.on("PostRender",()=>{ee.on("click",Ds),ee.on("tap",Ds),ee.on("mouseup",Ta),ee.on("mousedown",nl),ee.on("ScrollWindow",cr),ee.on("ResizeWindow",Fn),ee.on("ResizeEditor",Ea),ee.on("AfterProgressState",Aa),ee.on("DismissPopups",dr)}),ee.on("remove",()=>{ee.off("click",Ds),ee.off("tap",Ds),ee.off("mouseup",Ta),ee.off("mousedown",nl),ee.off("ScrollWindow",cr),ee.off("ResizeWindow",Fn),ee.off("ResizeEditor",Ea),ee.off("AfterProgressState",Aa),ee.off("DismissPopups",dr),Ms.unbind(),Qe.unbind(),lr.unbind(),ot.unbind(),ol.unbind()}),ee.on("detach",()=>{q([ae,...ke],vT),q([ae,...ke],Ie=>Ie.destroy())})})(e,O.mothership,F),n.setup(e,f.popup.shared,d),hF(e,f.popup),kF(e,f.popup.shared.getSink,f.popup),(ee=>{const{sidebars:ae}=ee.ui.registry.getAll();q(rt(ae),ke=>{const ye=ae[ke],Ce=()=>Jo(g.from(ee.queryCommandValue("ToggleSidebar")),ke);ee.ui.registry.addToggleButton(ke,{icon:ye.icon,tooltip:ye.tooltip,onAction:Ae=>{ee.execCommand("ToggleSidebar",!1,ke),Ae.setActive(Ce())},onSetup:Ae=>{Ae.setActive(Ce());const Gt=()=>Ae.setActive(Ce());return ee.on("ToggleSidebar",Gt),()=>{ee.off("ToggleSidebar",Gt)}}})})})(e),iB(e,h,f.popup.shared),lF(e,L,A.sink,{backstage:f.popup}),VF(e,A.sink);const ce={targetNode:e.getElement(),height:x(O.outerContainer)};return o.render(e,C,W,f.popup,ce)})({popupUi:S,dialogUi:w,mainUi:b,uiMotherships:r.getUiMotherships()})}}},PF=E([M("lazySink"),Se("dragBlockClass"),lt("getBounds",kn),T("useTabstopAt",pt),T("eventOrder",{}),mt("modalBehaviours",[$]),to("onExecute"),xu("onEscape")]),Mp={sketch:xe},UF=E([Bo({name:"draghandle",overrides:(e,t)=>({behaviours:I([_s.config({mode:"mouse",getTarget:o=>Vl(o,'[role="dialog"]').getOr(o),blockerClass:e.dragBlockClass.getOrDie(new Error(`The drag blocker class was not specified for a dialog with a drag handle: 
`+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])})}),Dt({schema:[M("dom")],name:"title"}),Dt({factory:Mp,schema:[M("dom")],name:"close"}),Dt({factory:Mp,schema:[M("dom")],name:"body"}),Bo({factory:Mp,schema:[M("dom")],name:"footer"}),jo({factory:{sketch:(e,t)=>k(k({},e),{dom:t.dom,components:t.components})},schema:[T("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),T("components",[])],name:"blocker"})]),tt=Vt({name:"ModalDialog",configFields:PF(),partFields:UF(),factory:(e,t,o,n)=>{const r=ze(),s=j("modal-events"),a=k(k({},e.eventOrder),{[es()]:[s].concat(e.eventOrder["alloy.system.attached"]||[])});return{uid:e.uid,dom:e.dom,components:t,apis:{show:i=>{r.set(i);const l=e.lazySink(i).getOrDie(),c=n.blocker(),u=l.getSystem().build(k(k({},c),{components:c.components.concat([Uo(i)]),behaviours:I([te.config({}),le("dialog-blocker-events",[js(wr(),()=>{$.focusIn(i)})])])}));ls(l,u),$.focusIn(i)},hide:i=>{r.clear(),xn(i.element).each(l=>{i.getSystem().getByDom(l).each(c=>{Zn(c)})})},getBody:i=>On(i,e,"body"),getFooter:i=>On(i,e,"footer"),setIdle:i=>{ar.unblock(i)},setBusy:(i,l)=>{ar.block(i,l)}},eventOrder:a,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:vt(e.modalBehaviours,[re.config({}),$.config({mode:"cyclic",onEnter:e.onExecute,onEscape:e.onEscape,useTabstopAt:e.useTabstopAt}),ar.config({getRoot:r.get}),le(s,[Ge(i=>{((l,c)=>{const u=lo(l,"id").fold(()=>{const d=j("dialog-label");return ie(c,"id",d),d},xe);ie(l,"aria-labelledby",u)})(i.element,On(i,e,"title").element),((l,c)=>{const u=g.from(Tt(l,"id")).fold(()=>{const d=j("dialog-describe");return ie(c,"id",d),d},xe);ie(l,"aria-describedby",u)})(i.element,On(i,e,"body").element)})])])}},apis:{show:(e,t)=>{e.show(t)},hide:(e,t)=>{e.hide(t)},getBody:(e,t)=>e.getBody(t),getFooter:(e,t)=>e.getFooter(t),setBusy:(e,t,o)=>{e.setBusy(t,o)},setIdle:(e,t)=>{e.setIdle(t)}}}),WF=X([Ye,Lm].concat(da)),jF=Xa,hC=[Gm("button"),mn,Gn("align","end",["start","end"]),_c,Go,bf("buttonType",["primary","secondary"])],fC=[...hC,er],Dp=[Ya("type",["submit","cancel","custom"]),...fC],GF=[Ya("type",["menu"]),ca,Cc,mn,Eo("items",WF),...hC],$F=mo("type",{submit:Dp,cancel:Dp,custom:Dp,menu:GF}),qF=[Ye,er,Ya("level",["info","warn","error","success"]),Cx,T("url","")],XF=X(qF),KF=[Ye,er,Go,Gm("button"),mn,IE,bf("buttonType",["primary","secondary","toolbar"]),_c],YF=X(KF),Oa=[Ye,Lm],hn=Oa.concat([Um]),JF=Oa.concat([Pm,Go]),ZF=X(JF),QF=Xa,eI=hn.concat([Ox("auto")]),tI=X(eI),oI=$d([_i,er,Cx]),nI=hn.concat([jn("storageKey","default")]),rI=X(nI),sI=wt,aI=X(hn),iI=wt,lI=Oa.concat([jn("tag","textarea"),it("scriptId"),it("scriptUrl"),Ao("settings",void 0,e_)]),cI=Oa.concat([jn("tag","textarea"),Lo("init")]),dI=Ka(e=>Ue("customeditor.old",uo(cI),e).orThunk(()=>Ue("customeditor.new",uo(lI),e))),uI=wt,mI=X(hn),gI=vr(uf),pI=e=>[Ye,t_("columns"),e],hI=[Ye,it("html"),Gn("presets","presentation",["presentation","document"])],fI=X(hI),bI=hn.concat([ho("sandboxed",!0),ho("transparent",!0)]),vI=X(bI),yI=wt,xI=X(Oa.concat([eo("height")])),wI=X([it("url"),Ja("zoom"),Ja("cachedWidth"),Ja("cachedHeight")]),SI=hn.concat([eo("inputMode"),eo("placeholder"),ho("maximized",!1),Go]),kI=X(SI),CI=wt,OI=e=>[Ye,Pm,e],_I=[er,_i],TI=[er,Eo("items",((e,t)=>{const o=br(t);return{extract:(n,r)=>o().extract(n,r),toString:()=>o().toString()}})(0,()=>bC))],bC=Gd([X(_I),X(TI)]),EI=hn.concat([Eo("items",bC),Go]),AI=X(EI),MI=wt,DI=hn.concat([ff("items",[er,_i]),Kd("size",1),Go]),BI=X(DI),FI=wt,II=hn.concat([ho("constrain",!0),Go]),RI=X(II),vC=X([it("width"),it("height")]),NI=Oa.concat([Pm,Kd("min",0),Kd("max",0)]),VI=X(NI),HI=Ol,zI=[Ye,Eo("header",wt),Eo("cells",vr(wt))],LI=X(zI),PI=hn.concat([eo("placeholder"),ho("maximized",!1),Go]),UI=X(PI),WI=wt,jI=hn.concat([Gn("filetype","file",["image","media","file"]),Go]),GI=X(jI),$I=X([_i,Wm]),Bp=e=>St("items","items",{tag:"required",process:{}},vr(Ka(t=>Ue(`Checking item of ${e}`,Fp,t).fold(o=>ue.error(Hs(o)),o=>ue.value(o))))),Fp=gf(()=>{return _l("type",{alertbanner:XF,bar:X((e=Bp("bar"),[Ye,e])),button:YF,checkbox:ZF,colorinput:rI,colorpicker:aI,dropzone:mI,grid:X(pI(Bp("grid"))),iframe:vI,input:kI,listbox:AI,selectbox:BI,sizeinput:RI,slider:VI,textarea:UI,urlinput:GI,customeditor:dI,htmlpanel:fI,imagepreview:xI,collection:tI,label:X(OI(Bp("label"))),table:LI,panel:yC});var e}),qI=[Ye,T("classes",[]),Eo("items",Fp)],yC=X(qI),XI=[Gm("tab"),TE,Eo("items",Fp)],KI=[Ye,ff("tabs",XI)],YI=X(KI),JI=fC,ZI=$F,QI=X([it("title"),go("body",_l("type",{panel:yC,tabpanel:YI})),jn("size","normal"),Eo("buttons",ZI),T("initialData",{}),lt("onAction",H),lt("onChange",H),lt("onSubmit",H),lt("onClose",H),lt("onCancel",H),lt("onTabChange",H)]),eR=X([Ya("type",["cancel","custom"]),...JI]),tR=X([it("title"),it("url"),Ja("height"),Ja("width"),vf("buttons",eR),lt("onAction",H),lt("onCancel",H),lt("onClose",H),lt("onMessage",H)]),Ip=e=>gr(e)?[e].concat(nt(Ed(e),Ip)):pr(e)?nt(e,Ip):[],oR=e=>_e(e.type)&&_e(e.name),nR={checkbox:QF,colorinput:sI,colorpicker:iI,dropzone:gI,input:CI,iframe:yI,imagepreview:wI,selectbox:FI,sizeinput:vC,slider:HI,listbox:MI,size:vC,textarea:WI,urlinput:$I,customeditor:uI,collection:oI,togglemenuitem:jF},rR=e=>{const t=(n=>He(Ip(n),oR))(e),o=nt(t,n=>(r=>g.from(nR[r.type]))(n).fold(()=>[],r=>[go(n.name,r)]));return X(o)},xC=e=>{var t;return{internalDialog:en(Ue("dialog",QI,e)),dataValidator:rR(e),initialData:(t=e.initialData)!==null&&t!==void 0?t:{}}},el={open:(e,t)=>{const o=xC(t);return e(o.internalDialog,o.initialData,o.dataValidator)},openUrl:(e,t)=>e(en(Ue("dialog",tR,t))),redial:e=>xC(e)},wC=e=>{const t=[],o={};return It(e,(n,r)=>{n.fold(()=>{t.push(r)},s=>{o[r]=s})}),t.length>0?ue.error(t):ue.value(o)},sR=(e,t,o)=>{const n=De(fa.sketch(s=>({dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:N(e.items,a=>Y0(s,a,t,o))})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[n.asSpec()]}],behaviours:I([$.config({mode:"acyclic",useTabstopAt:Va($i)}),(r=n,de.config({find:r.getOpt})),EM(n,{postprocess:s=>wC(s).fold(a=>(console.error(a),{}),xe)})])};var r},aR=xo({name:"TabButton",configFields:[T("uid",void 0),M("value"),St("dom","dom",Wd(()=>({attributes:{role:"tab",id:j("aria"),"aria-selected":"false"}})),Qo()),Se("action"),T("domModification",{}),mt("tabButtonBehaviours",[te,$,V]),M("view")],factory:(e,t)=>({uid:e.uid,dom:e.dom,components:e.components,events:gc(e.action),behaviours:vt(e.tabButtonBehaviours,[te.config({}),$.config({mode:"execution",useSpace:!0,useEnter:!0}),V.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification})}),iR=E([M("tabs"),M("dom"),T("clickToDismiss",!1),mt("tabbarBehaviours",[be,$]),as(["tabClass","selectedClass"])]),lR=oc({factory:aR,name:"tabs",unit:"tab",overrides:e=>{const t=(n,r)=>{be.dehighlight(n,r),Y(n,_f(),{tabbar:n,button:r})},o=(n,r)=>{be.highlight(n,r),Y(n,Of(),{tabbar:n,button:r})};return{action:n=>{const r=n.getSystem().getByUid(e.uid).getOrDie(),s=be.isHighlighted(r,n);(s&&e.clickToDismiss?t:s?H:o)(r,n)},domModification:{classes:[e.markers.tabClass]}}}}),cR=E([lR]),SC=Vt({name:"Tabbar",configFields:iR(),partFields:cR(),factory:(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:vt(e.tabbarBehaviours,[be.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:(r,s)=>{ie(s.element,"aria-selected","true")},onDehighlight:(r,s)=>{ie(s.element,"aria-selected","false")}}),$.config({mode:"flow",getInitial:r=>be.getHighlighted(r).map(s=>s.element),selector:"."+e.markers.tabClass,executeOnMove:!0})])})}),dR=xo({name:"Tabview",configFields:[mt("tabviewBehaviours",[re])],factory:(e,t)=>({uid:e.uid,dom:e.dom,behaviours:vt(e.tabviewBehaviours,[re.config({})]),domModification:{attributes:{role:"tabpanel"}}})}),uR=E([T("selectFirst",!0),me("onChangeTab"),me("onDismissTab"),T("tabs",[]),mt("tabSectionBehaviours",[])]),mR=Dt({factory:SC,schema:[M("dom"),yr("markers",[M("tabClass"),M("selectedClass")])],name:"tabbar",defaults:e=>({tabs:e.tabs})}),gR=Dt({factory:dR,name:"tabview"}),pR=E([mR,gR]),_a=Vt({name:"TabSection",configFields:uR(),partFields:pR(),factory:(e,t,o,n)=>{const r=(s,a)=>{Ee(s,e,"tabbar").each(i=>{a(i).each(ts)})};return{uid:e.uid,dom:e.dom,components:t,behaviours:qu(e.tabSectionBehaviours),events:Re(xt([e.selectFirst?[Ge((s,a)=>{r(s,be.getFirst)})]:[],[B(Of(),(s,a)=>{(i=>{const l=V.getValue(i);Ee(i,e,"tabview").each(c=>{Ke(e.tabs,u=>u.value===l).each(u=>{const d=u.view();lo(i.element,"id").each(m=>{ie(c.element,"aria-labelledby",m)}),re.set(c,d),e.onChangeTab(c,i,d)})})})(a.event.button)}),B(_f(),(s,a)=>{const i=a.event.button;e.onDismissTab(s,i)})]])),apis:{getViewItems:s=>Ee(s,e,"tabview").map(a=>re.contents(a)).getOr([]),showTab:(s,a)=>{r(s,i=>{const l=be.getCandidates(i);return Ke(l,c=>V.getValue(c)===a).filter(c=>!be.isHighlighted(i,c))})}}}},apis:{getViewItems:(e,t)=>e.getViewItems(t),showTab:(e,t,o)=>{e.showTab(t,o)}}}),kC=(e,t)=>{se(e,"height",t+"px"),se(e,"flex-basis",t+"px")},pd=(e,t,o)=>{Vl(e,'[role="dialog"]').each(n=>{ut(n,'[role="tablist"]').each(r=>{o.get().map(s=>(se(t,"height","0"),se(t,"flex-basis","0"),Math.min(s,((a,i,l)=>{const c=Dd(a).dom,u=Vl(a,".tox-dialog-wrap").getOr(a);let d;d=co(u,"position")==="fixed"?Math.max(c.clientHeight,window.innerHeight):Math.max(c.offsetHeight,c.scrollHeight);const m=Rt(i),p=i.dom.offsetLeft>=l.dom.offsetLeft+Xt(l)?Math.max(Rt(l),m):m,h=parseInt(co(a,"margin-top"),10)||0,f=parseInt(co(a,"margin-bottom"),10)||0;return d-(Rt(a)+h+f-p)})(n,t,r)))).each(s=>{kC(t,s)})})})},Rp=e=>ut(e,'[role="tabpanel"]'),CC="send-data-to-section",OC="send-data-to-view",hR=(e,t,o)=>{const n=Z({}),r=c=>{const u=V.getValue(c),d=wC(u).getOr({}),m=n.get(),p=je(m,d);n.set(p)},s=c=>{const u=n.get();V.setValue(c,u)},a=Z(null),i=N(e.tabs,c=>({value:c.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[dt(o.shared.providers.translate(c.title))],view:()=>[fa.sketch(u=>({dom:{tag:"div",classes:["tox-form"]},components:N(c.items,d=>Y0(u,d,t,o)),formBehaviours:I([$.config({mode:"acyclic",useTabstopAt:Va($i)}),le("TabView.form.events",[Ge(s),Cn(r)]),Wo.config({channels:zs([{key:CC,value:{onReceive:r}},{key:OC,value:{onReceive:s}}])})])}))]})),l=(c=>{const u=ze();return{extraEvents:[Ge(m=>{const p=m.element;Rp(p).each(h=>{se(h,"visibility","hidden"),m.getSystem().getByDom(h).toOptional().each(f=>{const v=((x,b,w)=>N(x,(S,C)=>{re.set(w,x[C].view());const O=b.dom.getBoundingClientRect();return re.set(w,[]),O.height}))(c,h,f);(x=>Hn(ch(x,(b,w)=>b>w?-1:b<w?1:0)))(v).fold(u.clear,u.set)}),pd(p,h,u),Me(h,"visibility"),((f,v)=>{Hn(f).each(y=>_a.showTab(v,y.value))})(c,m),requestAnimationFrame(()=>{pd(p,h,u)})})}),B(Bl(),m=>{const p=m.element;Rp(p).each(h=>{pd(p,h,u)})}),B(Hw,(m,p)=>{const h=m.element;Rp(h).each(f=>{const v=Yn(_o(f));se(f,"visibility","hidden");const y=Et(f,"height").map(b=>parseInt(b,10));Me(f,"height"),Me(f,"flex-basis");const x=f.dom.getBoundingClientRect().height;y.forall(b=>x>b)?(u.set(x),pd(h,f,u)):y.each(b=>{kC(f,b)}),Me(f,"visibility"),v.each(Kn)})})],selectFirst:!1}})(i);return _a.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(c,u,d)=>{const m=V.getValue(u);Y(c,Vw,{name:m,oldName:a.get()}),a.set(m)},tabs:i,components:[_a.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[SC.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:I([qe.config({})])}),_a.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:l.selectFirst,tabSectionBehaviours:I([le("tabpanel",l.extraEvents),$.config({mode:"acyclic"}),de.config({find:c=>Hn(_a.getViewItems(c))}),ba(g.none(),c=>(c.getSystem().broadcastOn([CC],{}),n.get()),(c,u)=>{n.set(u),c.getSystem().broadcastOn([OC],{})})])})},Np=j("update-dialog"),_C=j("update-title"),TC=j("update-body"),EC=j("update-footer"),AC=j("body-send-message"),MC=(e,t,o,n,r)=>({dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:k(k({},o.map(s=>({id:s})).getOr({})),r?{"aria-live":"polite"}:{})},components:[],behaviours:I([_g(0),ro.config({channel:`${TC}-${t}`,updateState:(s,a)=>g.some({isTabPanel:()=>a.body.type==="tabpanel"}),renderComponents:s=>{const a=s.body;return a.type==="tabpanel"?[hR(a,s.initialData,n)]:[sR(a,s.initialData,n)]},initialData:e})])});function Es(e){return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function Vp(e,t){return Vp=Object.setPrototypeOf||function(o,n){return o.__proto__=n,o},Vp(e,t)}function fR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Hp(e,t,o){return Hp=fR()?Reflect.construct:function(n,r,s){var a=[null];a.push.apply(a,r);var i=new(Function.bind.apply(n,a));return s&&Vp(i,s.prototype),i},Hp.apply(null,arguments)}function fn(e){return function(t){if(Array.isArray(t))return zp(t)}(e)||function(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(e)||function(t,o){if(t){if(typeof t=="string")return zp(t,o);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zp(t,o):void 0}}(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function zp(e,t){(t==null||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var bR=Object.hasOwnProperty,DC=Object.setPrototypeOf,vR=Object.isFrozen,yR=Object.getPrototypeOf,xR=Object.getOwnPropertyDescriptor,so=Object.freeze,Bn=Object.seal,wR=Object.create,BC=typeof Reflect!="undefined"&&Reflect,hd=BC.apply,Lp=BC.construct;hd||(hd=function(e,t,o){return e.apply(t,o)}),so||(so=function(e){return e}),Bn||(Bn=function(e){return e}),Lp||(Lp=function(e,t){return Hp(e,fn(t))});var FC,SR=bn(Array.prototype.forEach),kR=bn(Array.prototype.pop),tl=bn(Array.prototype.push),fd=bn(String.prototype.toLowerCase),CR=bn(String.prototype.match),Hr=bn(String.prototype.replace),OR=bn(String.prototype.indexOf),_R=bn(String.prototype.trim),ao=bn(RegExp.prototype.test),Pp=(FC=TypeError,function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return Lp(FC,t)});function bn(e){return function(t){for(var o=arguments.length,n=new Array(o>1?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];return hd(e,t,n)}}function Oe(e,t){DC&&DC(e,null);for(var o=t.length;o--;){var n=t[o];if(typeof n=="string"){var r=fd(n);r!==n&&(vR(t)||(t[o]=r),n=r)}e[n]=!0}return e}function As(e){var t,o=wR(null);for(t in e)hd(bR,e,[t])&&(o[t]=e[t]);return o}function bd(e,t){for(;e!==null;){var o=xR(e,t);if(o){if(o.get)return bn(o.get);if(typeof o.value=="function")return bn(o.value)}e=yR(e)}return function(n){return console.warn("fallback value for",n),null}}var IC=so(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Up=so(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Wp=so(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),TR=so(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),jp=so(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ER=so(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),RC=so(["#text"]),NC=so(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Gp=so(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),VC=so(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),vd=so(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),AR=Bn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),MR=Bn(/<%[\w\W]*|[\w\W]*%>/gm),DR=Bn(/^data-[\-\w.\u00B7-\uFFFF]/),BR=Bn(/^aria-[\-\w]+$/),FR=Bn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IR=Bn(/^(?:\w+script|data):/i),RR=Bn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),NR=Bn(/^html$/i),VR=function(){return typeof window=="undefined"?null:window},HR=function(e,t){if(Es(e)!=="object"||typeof e.createPolicy!="function")return null;var o=null,n="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(n)&&(o=t.currentScript.getAttribute(n));var r="dompurify"+(o?"#"+o:"");try{return e.createPolicy(r,{createHTML:function(s){return s}})}catch(s){return console.warn("TrustedTypes policy "+r+" could not be created."),null}},zR=function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:VR(),o=function(_){return e(_)};if(o.version="2.3.8",o.removed=[],!t||!t.document||t.document.nodeType!==9)return o.isSupported=!1,o;var n=t.document,r=t.document,s=t.DocumentFragment,a=t.HTMLTemplateElement,i=t.Node,l=t.Element,c=t.NodeFilter,u=t.NamedNodeMap,d=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,m=t.HTMLFormElement,p=t.DOMParser,h=t.trustedTypes,f=l.prototype,v=bd(f,"cloneNode"),y=bd(f,"nextSibling"),x=bd(f,"childNodes"),b=bd(f,"parentNode");if(typeof a=="function"){var w=r.createElement("template");w.content&&w.content.ownerDocument&&(r=w.content.ownerDocument)}var S=HR(h,n),C=S?S.createHTML(""):"",O=r,A=O.implementation,F=O.createNodeIterator,D=O.createDocumentFragment,R=O.getElementsByTagName,L=n.importNode,P={};try{P=As(r).documentMode?r.documentMode:{}}catch(_){}var z={};o.isSupported=typeof b=="function"&&A&&A.createHTMLDocument!==void 0&&P!==9;var oe,W,ne=AR,ce=MR,ee=DR,ae=BR,ke=IR,ye=RR,Ce=FR,Ae=null,Gt=Oe({},[].concat(fn(IC),fn(Up),fn(Wp),fn(jp),fn(RC))),Qe=null,lr=Oe({},[].concat(fn(NC),fn(Gp),fn(VC),fn(vd))),ot=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ms=null,ol=null,Ds=!0,Ta=!0,nl=!1,cr=!1,Fn=!1,Ea=!1,Aa=!1,dr=!1,Ie=!1,zr=!1,Ma=!0,Xp=!0,rl=!1,Da={},Ba=null,aO=Oe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),iO=null,lO=Oe({},["audio","video","img","source","image","track"]),Kp=null,cO=Oe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Yp="http://www.w3.org/1998/Math/MathML",Jp="http://www.w3.org/2000/svg",Lr="http://www.w3.org/1999/xhtml",yd=Lr,dO=!1,qR=["application/xhtml+xml","text/html"],XR="text/html",Fa=null,KR=r.createElement("form"),uO=function(_){return _ instanceof RegExp||_ instanceof Function},Zp=function(_){Fa&&Fa===_||(_&&Es(_)==="object"||(_={}),_=As(_),Ae="ALLOWED_TAGS"in _?Oe({},_.ALLOWED_TAGS):Gt,Qe="ALLOWED_ATTR"in _?Oe({},_.ALLOWED_ATTR):lr,Kp="ADD_URI_SAFE_ATTR"in _?Oe(As(cO),_.ADD_URI_SAFE_ATTR):cO,iO="ADD_DATA_URI_TAGS"in _?Oe(As(lO),_.ADD_DATA_URI_TAGS):lO,Ba="FORBID_CONTENTS"in _?Oe({},_.FORBID_CONTENTS):aO,Ms="FORBID_TAGS"in _?Oe({},_.FORBID_TAGS):{},ol="FORBID_ATTR"in _?Oe({},_.FORBID_ATTR):{},Da="USE_PROFILES"in _&&_.USE_PROFILES,Ds=_.ALLOW_ARIA_ATTR!==!1,Ta=_.ALLOW_DATA_ATTR!==!1,nl=_.ALLOW_UNKNOWN_PROTOCOLS||!1,cr=_.SAFE_FOR_TEMPLATES||!1,Fn=_.WHOLE_DOCUMENT||!1,dr=_.RETURN_DOM||!1,Ie=_.RETURN_DOM_FRAGMENT||!1,zr=_.RETURN_TRUSTED_TYPE||!1,Aa=_.FORCE_BODY||!1,Ma=_.SANITIZE_DOM!==!1,Xp=_.KEEP_CONTENT!==!1,rl=_.IN_PLACE||!1,Ce=_.ALLOWED_URI_REGEXP||Ce,yd=_.NAMESPACE||Lr,_.CUSTOM_ELEMENT_HANDLING&&uO(_.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ot.tagNameCheck=_.CUSTOM_ELEMENT_HANDLING.tagNameCheck),_.CUSTOM_ELEMENT_HANDLING&&uO(_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ot.attributeNameCheck=_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),_.CUSTOM_ELEMENT_HANDLING&&typeof _.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ot.allowCustomizedBuiltInElements=_.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),oe=oe=qR.indexOf(_.PARSER_MEDIA_TYPE)===-1?XR:_.PARSER_MEDIA_TYPE,W=oe==="application/xhtml+xml"?function(J){return J}:fd,cr&&(Ta=!1),Ie&&(dr=!0),Da&&(Ae=Oe({},fn(RC)),Qe=[],Da.html===!0&&(Oe(Ae,IC),Oe(Qe,NC)),Da.svg===!0&&(Oe(Ae,Up),Oe(Qe,Gp),Oe(Qe,vd)),Da.svgFilters===!0&&(Oe(Ae,Wp),Oe(Qe,Gp),Oe(Qe,vd)),Da.mathMl===!0&&(Oe(Ae,jp),Oe(Qe,VC),Oe(Qe,vd))),_.ADD_TAGS&&(Ae===Gt&&(Ae=As(Ae)),Oe(Ae,_.ADD_TAGS)),_.ADD_ATTR&&(Qe===lr&&(Qe=As(Qe)),Oe(Qe,_.ADD_ATTR)),_.ADD_URI_SAFE_ATTR&&Oe(Kp,_.ADD_URI_SAFE_ATTR),_.FORBID_CONTENTS&&(Ba===aO&&(Ba=As(Ba)),Oe(Ba,_.FORBID_CONTENTS)),Xp&&(Ae["#text"]=!0),Fn&&Oe(Ae,["html","head","body"]),Ae.table&&(Oe(Ae,["tbody"]),delete Ms.tbody),so&&so(_),Fa=_)},mO=Oe({},["mi","mo","mn","ms","mtext"]),gO=Oe({},["foreignobject","desc","title","annotation-xml"]),YR=Oe({},["title","style","font","a","script"]),xd=Oe({},Up);Oe(xd,Wp),Oe(xd,TR);var Qp=Oe({},jp);Oe(Qp,ER);var JR=function(_){var J=b(_);J&&J.tagName||(J={namespaceURI:Lr,tagName:"template"});var G=fd(_.tagName),Xe=fd(J.tagName);return _.namespaceURI===Jp?J.namespaceURI===Lr?G==="svg":J.namespaceURI===Yp?G==="svg"&&(Xe==="annotation-xml"||mO[Xe]):Boolean(xd[G]):_.namespaceURI===Yp?J.namespaceURI===Lr?G==="math":J.namespaceURI===Jp?G==="math"&&gO[Xe]:Boolean(Qp[G]):_.namespaceURI===Lr&&!(J.namespaceURI===Jp&&!gO[Xe])&&!(J.namespaceURI===Yp&&!mO[Xe])&&!Qp[G]&&(YR[G]||!xd[G])},ur=function(_){tl(o.removed,{element:_});try{_.parentNode.removeChild(_)}catch(J){try{_.outerHTML=C}catch(G){_.remove()}}},wd=function(_,J){try{tl(o.removed,{attribute:J.getAttributeNode(_),from:J})}catch(G){tl(o.removed,{attribute:null,from:J})}if(J.removeAttribute(_),_==="is"&&!Qe[_])if(dr||Ie)try{ur(J)}catch(G){}else try{J.setAttribute(_,"")}catch(G){}},pO=function(_){var J,G;if(Aa)_="<remove></remove>"+_;else{var Xe=CR(_,/^[\r\n\t ]+/);G=Xe&&Xe[0]}oe==="application/xhtml+xml"&&(_='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+_+"</body></html>");var yt=S?S.createHTML(_):_;if(yd===Lr)try{J=new p().parseFromString(yt,oe)}catch($t){}if(!J||!J.documentElement){J=A.createDocument(yd,"template",null);try{J.documentElement.innerHTML=dO?"":yt}catch($t){}}var io=J.body||J.documentElement;return _&&G&&io.insertBefore(r.createTextNode(G),io.childNodes[0]||null),yd===Lr?R.call(J,Fn?"html":"body")[0]:Fn?J.documentElement:io},hO=function(_){return F.call(_.ownerDocument||_,_,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},ZR=function(_){return _ instanceof m&&(typeof _.nodeName!="string"||typeof _.textContent!="string"||typeof _.removeChild!="function"||!(_.attributes instanceof d)||typeof _.removeAttribute!="function"||typeof _.setAttribute!="function"||typeof _.namespaceURI!="string"||typeof _.insertBefore!="function")},sl=function(_){return Es(i)==="object"?_ instanceof i:_&&Es(_)==="object"&&typeof _.nodeType=="number"&&typeof _.nodeName=="string"},mr=function(_,J,G){z[_]&&SR(z[_],function(Xe){Xe.call(o,J,G,Fa)})},fO=function(_){var J;if(mr("beforeSanitizeElements",_,null),ZR(_)||ao(/[\u0080-\uFFFF]/,_.nodeName))return ur(_),!0;var G=W(_.nodeName);if(mr("uponSanitizeElement",_,{tagName:G,allowedTags:Ae}),_.hasChildNodes()&&!sl(_.firstElementChild)&&(!sl(_.content)||!sl(_.content.firstElementChild))&&ao(/<[/\w]/g,_.innerHTML)&&ao(/<[/\w]/g,_.textContent)||G==="select"&&ao(/<template/i,_.innerHTML))return ur(_),!0;if(!Ae[G]||Ms[G]){if(!Ms[G]&&vO(G)&&(ot.tagNameCheck instanceof RegExp&&ao(ot.tagNameCheck,G)||ot.tagNameCheck instanceof Function&&ot.tagNameCheck(G)))return!1;if(Xp&&!Ba[G]){var Xe=b(_)||_.parentNode,yt=x(_)||_.childNodes;if(yt&&Xe)for(var io=yt.length-1;io>=0;--io)Xe.insertBefore(v(yt[io],!0),y(_))}return ur(_),!0}return _ instanceof l&&!JR(_)?(ur(_),!0):G!=="noscript"&&G!=="noembed"||!ao(/<\/no(script|embed)/i,_.innerHTML)?(cr&&_.nodeType===3&&(J=_.textContent,J=Hr(J,ne," "),J=Hr(J,ce," "),_.textContent!==J&&(tl(o.removed,{element:_.cloneNode()}),_.textContent=J)),mr("afterSanitizeElements",_,null),!1):(ur(_),!0)},bO=function(_,J,G){if(Ma&&(J==="id"||J==="name")&&(G in r||G in KR))return!1;if(!(Ta&&!ol[J]&&ao(ee,J))){if(!(Ds&&ao(ae,J))){if(!Qe[J]||ol[J]){if(!(vO(_)&&(ot.tagNameCheck instanceof RegExp&&ao(ot.tagNameCheck,_)||ot.tagNameCheck instanceof Function&&ot.tagNameCheck(_))&&(ot.attributeNameCheck instanceof RegExp&&ao(ot.attributeNameCheck,J)||ot.attributeNameCheck instanceof Function&&ot.attributeNameCheck(J))||J==="is"&&ot.allowCustomizedBuiltInElements&&(ot.tagNameCheck instanceof RegExp&&ao(ot.tagNameCheck,G)||ot.tagNameCheck instanceof Function&&ot.tagNameCheck(G))))return!1}else if(!Kp[J]){if(!ao(Ce,Hr(G,ye,""))){if((J!=="src"&&J!=="xlink:href"&&J!=="href"||_==="script"||OR(G,"data:")!==0||!iO[_])&&!(nl&&!ao(ke,Hr(G,ye,"")))){if(G)return!1}}}}}return!0},vO=function(_){return _.indexOf("-")>0},yO=function(_){var J,G,Xe,yt;mr("beforeSanitizeAttributes",_,null);var io=_.attributes;if(io){var $t={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Qe};for(yt=io.length;yt--;){var al=J=io[yt],In=al.name,vn=al.namespaceURI;G=In==="value"?J.value:_R(J.value),Xe=W(In);var eN=G;if($t.attrName=Xe,$t.attrValue=G,$t.keepAttr=!0,$t.forceKeepAttr=void 0,mr("uponSanitizeAttribute",_,$t),G=$t.attrValue,!$t.forceKeepAttr)if($t.keepAttr)if(ao(/\/>/i,G))wd(In,_);else{cr&&(G=Hr(G,ne," "),G=Hr(G,ce," "));var tN=W(_.nodeName);if(bO(tN,Xe,G)){if(G!==eN)try{vn?_.setAttributeNS(vn,In,G):_.setAttribute(In,G)}catch(rN){wd(In,_)}}else wd(In,_)}else wd(In,_)}mr("afterSanitizeAttributes",_,null)}},QR=function _(J){var G,Xe=hO(J);for(mr("beforeSanitizeShadowDOM",J,null);G=Xe.nextNode();)mr("uponSanitizeShadowNode",G,null),fO(G)||(G.content instanceof s&&_(G.content),yO(G));mr("afterSanitizeShadowDOM",J,null)};return o.sanitize=function(_,J){var G,Xe,yt,io,$t;if((dO=!_)&&(_="<!-->"),typeof _!="string"&&!sl(_)){if(typeof _.toString!="function")throw Pp("toString is not a function");if(typeof(_=_.toString())!="string")throw Pp("dirty is not a string, aborting")}if(!o.isSupported){if(Es(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof _=="string")return t.toStaticHTML(_);if(sl(_))return t.toStaticHTML(_.outerHTML)}return _}if(Ea||Zp(J),o.removed=[],typeof _=="string"&&(rl=!1),rl){if(_.nodeName){var al=W(_.nodeName);if(!Ae[al]||Ms[al])throw Pp("root node is forbidden and cannot be sanitized in-place")}}else if(_ instanceof i)(Xe=(G=pO("<!---->")).ownerDocument.importNode(_,!0)).nodeType===1&&Xe.nodeName==="BODY"||Xe.nodeName==="HTML"?G=Xe:G.appendChild(Xe);else{if(!dr&&!cr&&!Fn&&_.indexOf("<")===-1)return S&&zr?S.createHTML(_):_;if(!(G=pO(_)))return dr?null:zr?C:""}G&&Aa&&ur(G.firstChild);for(var In=hO(rl?_:G);yt=In.nextNode();)yt.nodeType===3&&yt===io||fO(yt)||(yt.content instanceof s&&QR(yt.content),yO(yt),io=yt);if(io=null,rl)return _;if(dr){if(Ie)for($t=D.call(G.ownerDocument);G.firstChild;)$t.appendChild(G.firstChild);else $t=G;return Qe.shadowroot&&($t=L.call(n,$t,!0)),$t}var vn=Fn?G.outerHTML:G.innerHTML;return Fn&&Ae["!doctype"]&&G.ownerDocument&&G.ownerDocument.doctype&&G.ownerDocument.doctype.name&&ao(NR,G.ownerDocument.doctype.name)&&(vn="<!DOCTYPE "+G.ownerDocument.doctype.name+`>
`+vn),cr&&(vn=Hr(vn,ne," "),vn=Hr(vn,ce," ")),S&&zr?S.createHTML(vn):vn},o.setConfig=function(_){Zp(_),Ea=!0},o.clearConfig=function(){Fa=null,Ea=!1},o.isValidAttribute=function(_,J,G){Fa||Zp({});var Xe=W(_),yt=W(J);return bO(Xe,yt,G)},o.addHook=function(_,J){typeof J=="function"&&(z[_]=z[_]||[],tl(z[_],J))},o.removeHook=function(_){if(z[_])return kR(z[_])},o.removeHooks=function(_){z[_]&&(z[_]=[])},o.removeAllHooks=function(){z={}},o}();const LR=e=>zR().sanitize(e),PR=sa.deviceType.isTouch(),HC=(e,t)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}),zC=(e,t)=>tt.parts.close(Zt.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:I([qe.config({})])})),LC=()=>tt.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),PC=(e,t)=>tt.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:Nr(`<p>${LR(t.translate(e))}</p>`)}]}]}),UC=e=>tt.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e}),WC=(e,t)=>[gn.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),gn.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})],$p=e=>{const t="tox-dialog",o=t+"-wrap",n=o+"__backdrop",r=t+"__disable-scroll";return tt.sketch({lazySink:e.lazySink,onEscape:s=>(e.onEscape(s),g.some(!0)),useTabstopAt:s=>!$i(s),dom:{tag:"div",classes:[t].concat(e.extraClasses),styles:k({position:"relative"},e.extraStyles)},components:[e.header,e.body,...e.footer.toArray()],parts:{blocker:{dom:Nr(`<div class="${o}"></div>`),components:[{dom:{tag:"div",classes:PR?[n,n+"--opaque"]:[n]}}]}},dragBlockClass:o,modalBehaviours:I([te.config({}),le("dialog-events",e.dialogEvents.concat([js(wr(),(s,a)=>{$.focusIn(s)})])),le("scroll-lock",[Ge(()=>{ct(Ln(),r)}),Cn(()=>{Ze(Ln(),r)})]),...e.extraBehaviours]),eventOrder:k({[fo()]:["dialog-events"],[es()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[Ps()]:["alloy.base.behaviour","dialog-events","scroll-lock"]},e.eventOrder)})},jC=e=>Zt.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},components:[dn("close",{tag:"div",classes:["tox-icon"]},e.icons)],action:t=>{we(t,fs)}}),GC=(e,t,o,n)=>({dom:{tag:"div",classes:["tox-dialog__title"],attributes:k({},o.map(r=>({id:r})).getOr({}))},components:[],behaviours:I([ro.config({channel:`${_C}-${t}`,initialData:e,renderComponents:r=>[dt(n.translate(r.title))]})])}),$C=()=>({dom:Nr('<div class="tox-dialog__draghandle"></div>')}),qC=(e,t,o)=>((n,r,s)=>{const a=tt.parts.title(GC(n,r,g.none(),s)),i=tt.parts.draghandle($C()),l=tt.parts.close(jC(s)),c=[a].concat(n.draggable?[i]:[]).concat([l]);return gn.sketch({dom:Nr('<div class="tox-dialog__header"></div>'),components:c})})({title:o.shared.providers.translate(e),draggable:o.dialog.isDraggableModal()},t,o.shared.providers),XC=(e,t,o)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":o.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:Nr('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),KC=(e,t,o)=>({onClose:()=>o.closeWindow(),onBlock:n=>{tt.setBusy(e(),(r,s)=>XC(n.message,s,t))},onUnblock:()=>{tt.setIdle(e())}}),YC=(e,t,o,n)=>Lt($p(k(k({},e),{lazySink:n.shared.getSink,extraBehaviours:[ro.config({channel:`${Np}-${e.id}`,updateState:(r,s)=>g.some(s),initialData:t}),Gc({}),...e.extraBehaviours],onEscape:r=>{we(r,fs)},dialogEvents:o,eventOrder:{[Qr()]:[ro.name(),Wo.name()],[es()]:["scroll-lock",ro.name(),"messages","dialog-events","alloy.base.behaviour"],[Ps()]:["alloy.base.behaviour","dialog-events","messages",ro.name(),"scroll-lock"]}}))),JC=e=>N(e,t=>t.type==="menu"?(o=>{const n=N(o.items,r=>k(k({},r),{storage:Z(!1)}));return k(k({},o),{items:n})})(t):t),ZC=e=>Ft(e,(t,o)=>o.type==="menu"?Ft(o.items,(n,r)=>(n[r.name]=r.storage,n),t):t,{}),QC=(e,t)=>[cu(wr(),BM),e(Ui,(o,n)=>{t.onClose(),n.onClose()}),e(fs,(o,n,r,s)=>{n.onCancel(o),we(s,Ui)}),B(mg,(o,n)=>t.onUnblock()),B(ug,(o,n)=>t.onBlock(n.event))],eO=(e,t,o)=>{const n=(s,a)=>B(s,(i,l)=>{r(i,(c,u)=>{a(e(),c,l.event,i)})}),r=(s,a)=>{ro.getState(s).get().each(i=>{a(i.internalDialog,s)})};return[...QC(n,t),n(Wi,(s,a)=>a.onSubmit(s)),n(no,(s,a,i)=>{a.onChange(s,{name:i.name})}),n(nr,(s,a,i,l)=>{const c=()=>$.focusIn(l),u=p=>Oh(p,"disabled")||lo(p,"aria-disabled").exists(h=>h==="true"),d=_o(l.element),m=Yn(d);a.onAction(s,{name:i.name,value:i.value}),Yn(d).fold(c,p=>{u(p)||m.exists(h=>fl(p,h)&&u(h))?c():o().toOptional().filter(h=>!fl(h.element,p)).each(c)})}),n(Vw,(s,a,i)=>{a.onTabChange(s,{newTabName:i.name,oldTabName:i.oldName})}),Cn(s=>{const a=e();V.setValue(s,a.getData())})]},UR=(e,t)=>{const o=t.map(s=>s.footerButtons).getOr([]),n=ih(o,s=>s.align==="start"),r=(s,a)=>gn.sketch({dom:{tag:"div",classes:[`tox-dialog__footer-${s}`]},components:N(a,i=>i.memento.asSpec())});return[r("start",n.pass),r("end",n.fail)]},tO=(e,t,o)=>({dom:Nr('<div class="tox-dialog__footer"></div>'),components:[],behaviours:I([ro.config({channel:`${EC}-${t}`,initialData:e,updateState:(n,r)=>{const s=N(r.buttons,a=>{const i=De(((l,c)=>Xc(l,l.type,c))(a,o));return{name:a.name,align:a.align,memento:i}});return g.some({lookupByName:a=>((i,l,c)=>Ke(l,u=>u.name===c).bind(u=>u.memento.getOpt(i)))(n,s,a),footerButtons:s})},renderComponents:UR})])}),oO=(e,t,o)=>tt.parts.footer(tO(e,t,o)),nO=(e,t)=>{if(e.getRoot().getSystem().isConnected()){const o=de.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper());return fa.getField(o,t).orThunk(()=>{const n=e.getFooter();return ro.getState(n).get().bind(r=>r.lookupByName(t))})}return g.none()},rO=(e,t,o)=>{const n=s=>{const a=e.getRoot();a.getSystem().isConnected()&&s(a)},r={getData:()=>{const s=e.getRoot(),a=s.getSystem().isConnected()?e.getFormWrapper():s;return k(k({},V.getValue(a)),ft(o,i=>i.get()))},setData:s=>{n(a=>{const i=r.getData(),l=je(i,s),c=((d,m)=>{const p=d.getRoot();return ro.getState(p).get().map(h=>en(Ue("data",h.dataValidator,m))).getOr(m)})(e,l),u=e.getFormWrapper();V.setValue(u,c),It(o,(d,m)=>{Te(l,m)&&d.set(l[m])})})},setEnabled:(s,a)=>{nO(e,s).each(a?Q.enable:Q.disable)},focus:s=>{nO(e,s).each(te.focus)},block:s=>{if(!_e(s))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n(a=>{Y(a,ug,{message:s})})},unblock:()=>{n(s=>{we(s,mg)})},showTab:s=>{n(a=>{const i=e.getBody();ro.getState(i).get().exists(l=>l.isTabPanel())&&de.getCurrent(i).each(l=>{_a.showTab(l,s)})})},redial:s=>{n(a=>{const i=e.getId(),l=t(s);a.getSystem().broadcastOn([`${Np}-${i}`],l),a.getSystem().broadcastOn([`${_C}-${i}`],l.internalDialog),a.getSystem().broadcastOn([`${TC}-${i}`],l.internalDialog),a.getSystem().broadcastOn([`${EC}-${i}`],l.internalDialog),r.setData(l.initialData)})},close:()=>{n(s=>{we(s,Ui)})}};return r};var qp=tinymce.util.Tools.resolve("tinymce.util.URI");const WR=["insertContent","setContent","execCommand","close","block","unblock"],sO=e=>gr(e)&&WR.indexOf(e.mceAction)!==-1,jR=(e,t,o,n)=>{const r=j("dialog"),s=qC(e.title,r,n),a=(y=>{const x={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[T0({dom:{tag:"iframe",attributes:{src:y.url}},behaviours:I([qe.config({}),te.config({})])})]}],behaviours:I([$.config({mode:"acyclic",useTabstopAt:Va($i)})])};return tt.parts.body(x)})(e),i=e.buttons.bind(y=>y.length===0?g.none():g.some(oO({buttons:y},r,n))),l=((y,x)=>{const b=(S,C)=>B(S,(O,A)=>{w(O,(F,D)=>{C(y(),F,A.event,O)})}),w=(S,C)=>{ro.getState(S).get().each(O=>{C(O,S)})};return[...QC(b,x),b(nr,(S,C,O)=>{C.onAction(S,{name:O.name})})]})(()=>v,KC(()=>f,n.shared.providers,t)),c=k(k({},e.height.fold(()=>({}),y=>({height:y+"px","max-height":y+"px"}))),e.width.fold(()=>({}),y=>({width:y+"px","max-width":y+"px"}))),u=e.width.isNone()&&e.height.isNone()?["tox-dialog--width-lg"]:[],d=new qp(e.url,{base_uri:new qp(window.location.href)}),m=`${d.protocol}://${d.host}${d.port?":"+d.port:""}`,p=Ys(),h=[le("messages",[Ge(()=>{const y=Pt(U(window),"message",x=>{if(d.isSameOrigin(new qp(x.raw.origin))){const b=x.raw.data;sO(b)?((w,S,C)=>{switch(C.mceAction){case"insertContent":w.insertContent(C.content);break;case"setContent":w.setContent(C.content);break;case"execCommand":const O=!!Nn(C.ui)&&C.ui;w.execCommand(C.cmd,O,C.value);break;case"close":S.close();break;case"block":S.block(C.message);break;case"unblock":S.unblock()}})(o,v,b):(w=>!sO(w)&&gr(w)&&Te(w,"mceAction"))(b)&&e.onMessage(v,b)}});p.set(y)}),Cn(p.clear)]),Wo.config({channels:{[AC]:{onReceive:(y,x)=>{ut(y.element,"iframe").each(b=>{const w=b.dom.contentWindow;No(w)&&w.postMessage(x,m)})}}}})],f=YC({id:r,header:s,body:a,footer:i,extraClasses:u,extraBehaviours:h,extraStyles:c},e,l,n),v=(y=>{const x=b=>{y.getSystem().isConnected()&&b(y)};return{block:b=>{if(!_e(b))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");x(w=>{Y(w,ug,{message:b})})},unblock:()=>{x(b=>{we(b,mg)})},close:()=>{x(b=>{we(b,Ui)})},sendMessage:b=>{x(w=>{w.getSystem().broadcastOn([AC],b)})}}})(f);return{dialog:f,instanceApi:v}},GR=(e,t,o)=>t&&o?[]:[Ht.config({contextual:{lazyContext:()=>g.some(Qt(U(e.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})],$R=e=>{const t=e.editor,o=Ci(t),n=(i=>{const l=i.shared;return{open:(c,u)=>{const d=()=>{tt.hide(f),u()},m=De(Xc({name:"close-alert",text:"OK",primary:!0,buttonType:g.some("primary"),align:"end",enabled:!0,icon:g.none()},"cancel",i)),p=LC(),h=zC(d,l.providers),f=Lt($p({lazySink:()=>l.getSink(),header:HC(p,h),body:PC(c,l.providers),footer:g.some(UC(WC([],[m.asSpec()]))),onEscape:d,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[B(fs,d)],eventOrder:{}}));tt.show(f);const v=m.get(f);te.focus(v)}}})(e.backstages.dialog),r=(i=>{const l=i.shared;return{open:(c,u)=>{const d=x=>{tt.hide(v),u(x)},m=De(Xc({name:"yes",text:"Yes",primary:!0,buttonType:g.some("primary"),align:"end",enabled:!0,icon:g.none()},"submit",i)),p=Xc({name:"no",text:"No",primary:!1,buttonType:g.some("secondary"),align:"end",enabled:!0,icon:g.none()},"cancel",i),h=LC(),f=zC(()=>d(!1),l.providers),v=Lt($p({lazySink:()=>l.getSink(),header:HC(h,f),body:PC(c,l.providers),footer:g.some(UC(WC([],[p,m.asSpec()]))),onEscape:()=>d(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[B(fs,()=>d(!1)),B(Wi,()=>d(!0))],eventOrder:{}}));tt.show(v);const y=m.get(v);te.focus(y)}}})(e.backstages.dialog),s=(i,l)=>el.open((c,u,d)=>{const m=u,p=((h,f,v)=>{const y=j("dialog"),x=h.internalDialog,b=qC(x.title,y,v),w=((z,oe,W)=>{const ne=MC(z,oe,g.none(),W,!1);return tt.parts.body(ne)})({body:x.body,initialData:x.initialData},y,v),S=JC(x.buttons),C=ZC(S),O=oO({buttons:S},y,v),A=eO(()=>P,KC(()=>R,v.shared.providers,f),v.shared.getSink),F=(z=>{switch(z){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}})(x.size),D={id:y,header:b,body:w,footer:g.some(O),extraClasses:F,extraBehaviours:[],extraStyles:{}},R=YC(D,h,A,v),L={getId:E(y),getRoot:E(R),getBody:()=>tt.getBody(R),getFooter:()=>tt.getFooter(R),getFormWrapper:()=>{const z=tt.getBody(R);return de.getCurrent(z).getOr(z)}},P=rO(L,f.redial,C);return{dialog:R,instanceApi:P}})({dataValidator:d,initialData:m,internalDialog:c},{redial:el.redial,closeWindow:()=>{tt.hide(p.dialog),l(p.instanceApi)}},e.backstages.dialog);return tt.show(p.dialog),p.instanceApi.setData(m),p.instanceApi},i),a=(i,l,c,u=!1)=>el.open((d,m,p)=>{const h=en(Ue("data",p,m)),f=ze(),v=e.backstages.popup.shared.header.isPositionedAtTop(),y=()=>f.on(w=>{$e.reposition(w),Ht.refresh(w)}),x=((w,S,C,O)=>{const A=j("dialog"),F=j("dialog-label"),D=j("dialog-content"),R=w.internalDialog,L=De(((ae,ke,ye,Ce)=>gn.sketch({dom:Nr('<div class="tox-dialog__header"></div>'),components:[GC(ae,ke,g.some(ye),Ce),$C(),jC(Ce)],containerBehaviours:I([_s.config({mode:"mouse",blockerClass:"blocker",getTarget:Ae=>rn(Ae,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))({title:R.title,draggable:!0},A,F,C.shared.providers)),P=De(((ae,ke,ye,Ce,Ae)=>MC(ae,ke,g.some(ye),Ce,Ae))({body:R.body,initialData:R.initialData},A,D,C,O)),z=JC(R.buttons),oe=ZC(z),W=De(((ae,ke,ye)=>tO(ae,ke,ye))({buttons:z},A,C)),ne=eO(()=>ee,{onBlock:ae=>{ar.block(ce,(ke,ye)=>XC(ae.message,ye,C.shared.providers))},onUnblock:()=>{ar.unblock(ce)},onClose:()=>S.closeWindow()},C.shared.getSink),ce=Lt({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:{role:"dialog","aria-labelledby":F,"aria-describedby":D}},eventOrder:{[Qr()]:[ro.name(),Wo.name()],[fo()]:["execute-on-form"],[es()]:["reflecting","execute-on-form"]},behaviours:I([$.config({mode:"cyclic",onEscape:ae=>(we(ae,Ui),g.some(!0)),useTabstopAt:ae=>!$i(ae)&&(zn(ae)!=="button"||Tt(ae,"disabled")!=="disabled")}),ro.config({channel:`${Np}-${A}`,updateState:(ae,ke)=>g.some(ke),initialData:w}),te.config({}),le("execute-on-form",ne.concat([js(wr(),(ae,ke)=>{$.focusIn(ae)})])),ar.config({getRoot:()=>g.some(ce)}),re.config({}),Gc({})]),components:[L.asSpec(),P.asSpec(),W.asSpec()]}),ee=rO({getId:E(A),getRoot:E(ce),getFooter:()=>W.get(ce),getBody:()=>P.get(ce),getFormWrapper:()=>{const ae=P.get(ce);return de.getCurrent(ae).getOr(ae)}},S.redial,oe);return{dialog:ce,instanceApi:ee}})({dataValidator:p,initialData:h,internalDialog:d},{redial:el.redial,closeWindow:()=>{f.on($e.hide),t.off("ResizeEditor",y),f.clear(),c(x.instanceApi)}},e.backstages.popup,u),b=Lt($e.sketch(k(k({lazySink:e.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},v?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:I([le("window-manager-inline-events",[B(Us(),(w,S)=>{we(x.dialog,fs)})]),...GR(t,o,v)]),isExtraPart:(w,S)=>(C=>zi(C,".tox-alert-dialog")||zi(C,".tox-confirm-dialog"))(S)})));return f.set(b),$e.showWithin(b,Uo(x.dialog),{anchor:l},g.some(Ln())),o&&v||(Ht.refresh(b),t.on("ResizeEditor",y)),x.instanceApi.setData(h),$.focusIn(x.dialog),x.instanceApi},i);return{open:(i,l,c)=>l!==void 0&&l.inline==="toolbar"?a(i,e.backstages.popup.shared.anchors.inlineDialog(),c,l.ariaAttrs):l!==void 0&&l.inline==="cursor"?a(i,e.backstages.popup.shared.anchors.cursor(),c,l.ariaAttrs):s(i,c),openUrl:(i,l)=>((c,u)=>el.openUrl(d=>{const m=jR(d,{closeWindow:()=>{tt.hide(m.dialog),u(m.instanceApi)}},t,e.backstages.dialog);return tt.show(m.dialog),m.instanceApi},c))(i,l),alert:(i,l)=>{n.open(i,l)},close:i=>{i.close()},confirm:(i,l)=>{r.open(i,l)}}};wO.add("silver",e=>{(s=>{By(s),(a=>{const i=a.options.register,l=c=>Na(c,_e)?{value:vA(c),valid:!0}:{valid:!1,message:"Must be an array of strings."};i("color_map",{processor:l,default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),i("color_map_background",{processor:l}),i("color_map_foreground",{processor:l}),i("color_cols",{processor:"number",default:og(Hi(a,"default").length)}),i("color_cols_foreground",{processor:"number",default:og(Hi(a,eg).length)}),i("color_cols_background",{processor:"number",default:og(Hi(a,tg).length)}),i("custom_colors",{processor:"boolean",default:!0}),i("color_default_foreground",{processor:"string",default:ng}),i("color_default_background",{processor:"string",default:ng})})(s),(a=>{const i=a.options.register;i("contextmenu_avoid_overlap",{processor:"string",default:""}),i("contextmenu_never_use_native",{processor:"boolean",default:!1}),i("contextmenu",{processor:l=>l===!1?{value:[],valid:!0}:_e(l)||Na(l,_e)?{value:fF(l),valid:!0}:{valid:!1,message:"Must be false or a string."},default:"link linkchecker image editimage table spellchecker configurepermanentpen"})})(s)})(e);const{dialogs:t,popups:o,renderUI:n}=LF(e);VA(e,o.backstage.shared);const r=$R({editor:e,backstages:{popup:o.backstage,dialog:t.backstage}});return{renderUI:n,getWindowManagerImpl:E(r),getNotificationManagerImpl:()=>((s,a,i)=>{const l=a.backstage.shared,c=()=>{const u=Qt(U(s.getContentAreaContainer())),d=kn(),m=Do(d.x,u.x,u.right),p=Do(d.y,u.y,u.bottom),h=Math.max(u.right,d.right),f=Math.max(u.bottom,d.bottom);return g.some(Nt(m,p,h-m,f-p))};return{open:(u,d)=>{const m=()=>{d(),$e.hide(h)},p=Lt(wm.sketch({text:u.text,level:ht(["success","error","warning","warn","info"],u.type)?u.type:void 0,progress:u.progressBar===!0,icon:u.icon,closeButton:u.closeButton,onAction:m,iconProvider:l.providers.icons,translationProvider:l.providers.translate})),h=Lt($e.sketch(k({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:l.getSink,fireDismissalEventInstead:{}},l.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));i.add(h),hr(u.timeout)&&u.timeout>0&&pc.setEditorTimeout(s,()=>{m()},u.timeout);const f={close:m,reposition:()=>{const v=Uo(p),y={maxHeightFunction:ci()},x=s.notificationManager.getNotifications();if(x[0]===f){const b=k(k({},l.anchors.banner()),{overrides:y});$e.showWithinBounds(h,v,{anchor:b},c)}else sh(x,f).each(b=>{const w=x[b-1].getEl(),S={type:"node",root:Ln(),node:g.some(U(w)),overrides:y,layouts:{onRtl:()=>[_t],onLtr:()=>[_t]}};$e.showWithinBounds(h,v,{anchor:S},c)})},text:v=>{wm.updateText(p,v)},settings:u,getEl:()=>p.element.dom,progressBar:{value:v=>{wm.updateProgress(p,v)}}};return f},close:u=>{u.close()},getArgs:u=>u.settings}})(e,{backstage:o.backstage},o.getMothership())}})})();
