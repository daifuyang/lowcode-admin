var xt=Object.assign;(function(){"use strict";var It=tinymce.util.Tools.resolve("tinymce.PluginManager");const re=e=>t=>(n=>{const o=typeof n;return n===null?"null":o==="object"&&Array.isArray(n)?"array":o==="object"&&(r=s=n,(i=String).prototype.isPrototypeOf(r)||((a=s.constructor)===null||a===void 0?void 0:a.name)===i.name)?"string":o;var r,s,i,a})(t)===e,oe=e=>t=>typeof t===e,Ie=re("string"),V=re("object"),Pt=re("array"),Mt=oe("boolean"),k=e=>!(t=>t==null)(e),z=oe("function"),Rt=oe("number"),Ut=()=>{},Pe=(e,t)=>e===t,Me=e=>t=>!e(t),Re=()=>!1;class v{constructor(t,n){this.tag=t,this.value=n}static some(t){return new v(!0,t)}static none(){return v.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?v.some(t(this.value)):v.none()}bind(t){return this.tag?t(this.value):v.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:v.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t!=null?t:"Called getOrDie on None")}static from(t){return k(t)?v.some(t):v.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}v.singletonNone=new v(!1);const $t=Array.prototype.slice,Ht=Array.prototype.indexOf,jt=Array.prototype.push,Ue=(e,t)=>{return n=e,o=t,Ht.call(n,o)>-1;var n,o},$e=(e,t)=>{for(let n=0,o=e.length;n<o;n++)if(t(e[n],n))return!0;return!1},T=(e,t)=>{const n=e.length,o=new Array(n);for(let r=0;r<n;r++){const s=e[r];o[r]=t(s,r)}return o},N=(e,t)=>{for(let n=0,o=e.length;n<o;n++)t(e[n],n)},B=(e,t)=>{const n=[];for(let o=0,r=e.length;o<r;o++){const s=e[o];t(s,o)&&n.push(s)}return n},se=(e,t,n)=>(N(e,(o,r)=>{n=t(n,o,r)}),n),_=(e,t,n)=>{for(let o=0,r=e.length;o<r;o++){const s=e[o];if(t(s,o))return v.some(s);if(n(s,o))break}return v.none()},ie=(e,t)=>_(e,t,Re),He=(e,t)=>(n=>{const o=[];for(let r=0,s=n.length;r<s;++r){if(!Pt(n[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+n);jt.apply(o,n[r])}return o})(T(e,t)),ae=e=>{const t=$t.call(e,0);return t.reverse(),t},je=(e,t)=>t>=0&&t<e.length?v.some(e[t]):v.none(),le=e=>je(e,0),Q=e=>je(e,e.length-1),Fe=(e,t)=>{const n=[],o=z(t)?r=>$e(n,s=>t(s,r)):r=>Ue(n,r);for(let r=0,s=e.length;r<s;r++){const i=e[r];o(i)||n.push(i)}return n},Ke=(e,t,n=Pe)=>e.exists(o=>n(o,t)),de=(e,t,n)=>e.isSome()&&t.isSome()?v.some(n(e.getOrDie(),t.getOrDie())):v.none(),Ve=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},q=(e,t)=>{const n=(t||document).createElement(e);return Ve(n)},b=Ve,ce=(e,t)=>e.dom===t.dom;typeof window!="undefined"||Function("return this;")();const W=e=>e.dom.nodeName.toLowerCase(),ze=e=>(t=>t.dom.nodeType)(e)===1,_e=e=>t=>ze(t)&&W(t)===e,ue=e=>v.from(e.dom.parentNode).map(b),Z=e=>T(e.dom.childNodes,b),Qe=(e,t)=>{const n=e.dom.childNodes;return v.from(n[t]).map(b)},qe=e=>Qe(e,0),We=e=>Qe(e,e.dom.childNodes.length-1),Ft=(e,t,n)=>{let o=e.dom;const r=z(n)?n:Re;for(;o.parentNode;){o=o.parentNode;const s=b(o);if(t(s))return v.some(s);if(r(s))break}return v.none()},Ze=(e,t,n)=>((o,r,s,i,a)=>i(s)?v.some(s):z(a)&&a(s)?v.none():r(s,i,a))(0,Ft,e,t,n),Ge=(e,t)=>{ue(e).each(n=>{n.dom.insertBefore(t.dom,e.dom)})},M=(e,t)=>{e.dom.appendChild(t.dom)},me=(e,t)=>{N(t,n=>{M(e,n)})},Je=e=>{e.dom.textContent="",N(Z(e),t=>{pe(t)})},pe=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)};var Xe=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),Kt=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),G=tinymce.util.Tools.resolve("tinymce.util.VK");const Ye=e=>T(e,b),Vt=Object.keys,ge=(e,t)=>{const n=Vt(e);for(let o=0,r=n.length;o<r;o++){const s=n[o];t(e[s],s)}},R=(e,t)=>{const n=e.dom;ge(t,(o,r)=>{((s,i,a)=>{if(!(Ie(a)||Mt(a)||Rt(a)))throw console.error("Invalid call to Attribute.set. Key ",i,":: Value ",a,":: Element ",s),new Error("Attribute value was not simple");s.setAttribute(i,a+"")})(n,r,o)})},he=e=>se(e.dom.attributes,(t,n)=>(t[n.name]=n.value,t),{}),zt=e=>((t,n)=>b(t.dom.cloneNode(!0)))(e),fe=(e,t)=>{const n=((r,s)=>{const i=q(s),a=he(r);return R(i,a),i})(e,t);((r,s)=>{(a=>v.from(a.dom.nextSibling).map(b))(r).fold(()=>{ue(r).each(a=>{M(a,s)})},a=>{Ge(a,s)})})(e,n);const o=Z(e);return me(n,o),pe(e),n};var ye=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),L=tinymce.util.Tools.resolve("tinymce.util.Tools");const et=e=>t=>k(t)&&t.nodeName.toLowerCase()===e,U=e=>t=>k(t)&&e.test(t.nodeName),x=e=>k(e)&&e.nodeType===3,$=e=>k(e)&&e.nodeType===1,S=U(/^(OL|UL|DL)$/),_t=U(/^(OL|UL)$/),tt=et("ol"),ve=U(/^(LI|DT|DD)$/),Qt=U(/^(DT|DD)$/),qt=U(/^(TH|TD)$/),w=et("br"),Ce=(e,t)=>k(t)&&t.nodeName in e.schema.getTextBlockElements(),nt=(e,t)=>k(e)&&e.nodeName in t,D=(e,t,n)=>{const o=e.isEmpty(t);return!(n&&e.select("span[data-mce-type=bookmark]",t).length>0)&&o},rt=(e,t)=>e.isChildOf(t,e.getRoot()),be=e=>t=>t.options.get(e),Wt=be("lists_indent_on_tab"),Zt=be("forced_root_block"),Gt=be("forced_root_block_attrs"),ot=(e,t)=>{const n=e.dom,o=e.schema.getBlockElements(),r=n.createFragment(),s=Zt(e),i=Gt(e);let a,d,l=!1;for(d=n.create(s,i),nt(t.firstChild,o)||r.appendChild(d);a=t.firstChild;){const c=a.nodeName;l||c==="SPAN"&&a.getAttribute("data-mce-type")==="bookmark"||(l=!0),nt(a,o)?(r.appendChild(a),d=null):(d||(d=n.create(s,i),r.appendChild(d)),d.appendChild(a))}return!l&&d&&d.appendChild(n.create("br",{"data-mce-bogus":"1"})),r},A=ye.DOM,Jt=_e("dd"),st=_e("dt"),Xt=(e,t)=>{var n;Jt(t)?fe(t,"dt"):st(t)&&(n=t,v.from(n.dom.parentElement).map(b)).each(o=>((r,s,i)=>{const a=A.select('span[data-mce-type="bookmark"]',s),d=ot(r,i),l=A.createRng();l.setStartAfter(i),l.setEndAfter(s);const c=l.extractContents();for(let p=c.firstChild;p;p=p.firstChild)if(p.nodeName==="LI"&&r.dom.isEmpty(p)){A.remove(p);break}r.dom.isEmpty(c)||A.insertAfter(c,s),A.insertAfter(d,s);const m=i.parentElement;m&&D(r.dom,m)&&(p=>{const g=p.parentNode;g&&L.each(a,h=>{g.insertBefore(h,i.parentNode)}),A.remove(p)})(m),A.remove(i),D(r.dom,s)&&A.remove(s)})(e,o.dom,t.dom))},Yt=e=>{st(e)&&fe(e,"dd")},it=(e,t)=>{if(x(e))return{container:e,offset:t};const n=Xe.getNode(e,t);return x(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:n.previousSibling&&x(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&x(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:e,offset:t}},J=e=>{const t=e.cloneRange(),n=it(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);const o=it(e.endContainer,e.endOffset);return t.setEnd(o.container,o.offset),t},at=["OL","UL","DL"],lt=at.join(","),E=(e,t)=>{const n=t||e.selection.getStart(!0);return e.dom.getParent(n,lt,X(e,n))},Se=e=>{const t=e.selection.getSelectedBlocks();return B(((n,o)=>{const r=L.map(o,s=>n.dom.getParent(s,"li,dd,dt",X(n,s))||s);return Fe(r)})(e,t),ve)},Ne=(e,t)=>{const n=e.dom.getParents(t,"TD,TH");return n.length>0?n[0]:e.getBody()},X=(e,t)=>{const n=e.dom.getParents(t,e.dom.isBlock);return ie(n,r=>{return s=e.schema,!S(i=r)&&!ve(i)&&$e(at,a=>s.isValidChild(i.nodeName,a));var s,i}).getOr(e.getBody())},dt=(e,t)=>{const n=e.dom.getParents(t,"ol,ul",X(e,t));return Q(n)},en=(e,t)=>{const n=T(t,o=>dt(e,o).getOr(o));return Fe(n)},ct=e=>/\btox\-/.test(e.className),ut=(e,t)=>_(e,S,qt).exists(n=>n.nodeName===t&&!ct(n)),mt=(e,t)=>t!==null&&e.dom.getContentEditableParent(t)==="false",I=(e,t)=>{const n=e.dom.getParent(t,"ol,ul,dl");return mt(e,n)},pt=(e,t)=>{const n=e.selection.getNode();return t({parents:e.dom.getParents(n),element:n}),e.on("NodeChange",t),()=>e.off("NodeChange",t)},H=(e,t,n)=>e.dispatch("ListMutation",{action:t,element:n}),tn=(gt=/^\s+|\s+$/g,e=>e.replace(gt,""));var gt;const nn=(e,t,n)=>{((o,r,s)=>{if(!Ie(s))throw console.error("Invalid call to CSS.set. Property ",r,":: Value ",s,":: Element ",o),new Error("CSS value must be a string: "+s);(i=>i.style!==void 0&&z(i.style.getPropertyValue))(o)&&o.style.setProperty(r,s)})(e.dom,t,n)},ht=(e,t)=>{M(e.item,t.list)},rn=(e,t)=>{const n={list:q(t,e),item:q("li",e)};return M(n.list,n.item),n},j=e=>((t,n)=>{const o=t.dom;if(o.nodeType!==1)return!1;{const r=o;if(r.matches!==void 0)return r.matches(n);if(r.msMatchesSelector!==void 0)return r.msMatchesSelector(n);if(r.webkitMatchesSelector!==void 0)return r.webkitMatchesSelector(n);if(r.mozMatchesSelector!==void 0)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}})(e,"OL,UL"),ft=e=>qe(e).exists(j),yt=e=>e.depth>0,on=e=>e.isSelected,sn=e=>{const t=Z(e),n=We(e).exists(j)?t.slice(0,-1):t;return T(n,zt)},vt=e=>(N(e,(t,n)=>{((o,r)=>{const s=o[r].depth,i=d=>d.depth===s&&!d.dirty,a=d=>d.depth<s;return _(ae(o.slice(0,r)),i,a).orThunk(()=>_(o.slice(r+1),i,a))})(e,n).fold(()=>{t.dirty&&(o=>{o.listAttributes=((r,s)=>{const i={};var a;return((d,l,c,m)=>{ge(d,(p,g)=>{(l(p,g)?c:m)(p,g)})})(r,s,(a=i,(d,l)=>{a[l]=d}),Ut),i})(o.listAttributes,(r,s)=>s!=="start")})(t)},o=>{return s=o,(r=t).listType=s.listType,void(r.listAttributes=xt({},s.listAttributes));var r,s})}),e),an=(e,t,n,o)=>qe(o).filter(j).fold(()=>{t.each(i=>{ce(i.start,o)&&n.set(!0)});const r=((i,a,d)=>ue(i).filter(ze).map(l=>({depth:a,dirty:!1,isSelected:d,content:sn(i),itemAttributes:he(i),listAttributes:he(l),listType:W(l)})))(o,e,n.get());t.each(i=>{ce(i.end,o)&&n.set(!1)});const s=We(o).filter(j).map(i=>Y(e,t,n,i)).getOr([]);return r.toArray().concat(s)},r=>Y(e,t,n,r)),Y=(e,t,n,o)=>He(Z(o),r=>(j(r)?Y:an)(e+1,t,n,r)),ln=(e,t)=>{const n=vt(t);return((o,r)=>{const s=se(r,(i,a)=>a.depth>i.length?((d,l,c)=>{const m=((g,h,u)=>{const f=[];for(let y=0;y<u;y++)f.push(rn(g,h.listType));return f})(d,c,c.depth-l.length);var p;return(g=>{for(let h=1;h<g.length;h++)ht(g[h-1],g[h])})(m),((g,h)=>{for(let u=0;u<g.length-1;u++)nn(g[u].item,"list-style-type","none");Q(g).each(u=>{R(u.list,h.listAttributes),R(u.item,h.itemAttributes),me(u.item,h.content)})})(m,c),p=m,de(Q(l),le(p),ht),l.concat(m)})(o,i,a):((d,l,c)=>{const m=l.slice(0,c.depth);return Q(m).each(p=>{const g=((h,u,f)=>{const y=q("li",h);return R(y,u),me(y,f),y})(d,c.itemAttributes,c.content);((h,u)=>{M(h.list,u),h.item=u})(p,g),((h,u)=>{W(h.list)!==u.listType&&(h.list=fe(h.list,u.listType)),R(h.list,u.listAttributes)})(p,c)}),m})(o,i,a),[]);return le(s).map(i=>i.list)})(e.contentDocument,n).toArray()},dn=(e,t,n)=>{const o=((r,s)=>{const i=(a=>{let d=!1;return{get:()=>d,set:l=>{d=l}}})();return T(r,a=>({sourceList:a,entries:Y(0,s,i,a)}))})(t,(r=>{const s=T(Se(r),b);return de(ie(s,Me(ft)),ie(ae(s),Me(ft)),(i,a)=>({start:i,end:a}))})(e));N(o,r=>{((a,d)=>{N(B(a,on),l=>((c,m)=>{switch(c){case"Indent":m.depth++;break;case"Outdent":m.depth--;break;case"Flatten":m.depth=0}m.dirty=!0})(d,l))})(r.entries,n);const s=((a,d)=>He(((l,c)=>{if(l.length===0)return[];{let m=c(l[0]);const p=[];let g=[];for(let h=0,u=l.length;h<u;h++){const f=l[h],y=c(f);y!==m&&(p.push(g),g=[]),m=y,g.push(f)}return g.length!==0&&p.push(g),p}})(d,yt),l=>le(l).exists(yt)?ln(a,l):((c,m)=>{const p=vt(m);return T(p,g=>{const h=((u,f)=>{const y=document.createDocumentFragment();return N(u,C=>{y.appendChild(C.dom)}),b(y)})(g.content);return b(ot(c,h.dom))})})(a,l)))(e,r.entries);var i;N(s,a=>{H(e,n==="Indent"?"IndentList":"OutdentList",a.dom)}),i=r.sourceList,N(s,a=>{Ge(i,a)}),pe(r.sourceList)})},cn=(e,t)=>{const n=Ye((s=>{const i=(a=>{const d=dt(a,a.selection.getStart()),l=B(a.selection.getSelectedBlocks(),_t);return d.toArray().concat(l)})(s);return en(s,i)})(e)),o=Ye((s=>B(Se(s),Qt))(e));let r=!1;if(n.length||o.length){const s=e.selection.getBookmark();dn(e,n,t),((i,a,d)=>{N(d,a==="Indent"?Yt:l=>Xt(i,l))})(e,t,o),e.selection.moveToBookmark(s),e.selection.setRng(J(e.selection.getRng())),e.nodeChanged(),r=!0}return r},Le=(e,t)=>!(n=>{const o=E(n);return mt(n,o)})(e)&&cn(e,t),Ct=e=>Le(e,"Indent"),Oe=e=>Le(e,"Outdent"),ee=e=>Le(e,"Flatten");var un=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager");const P=ye.DOM,F=e=>{const t={},n=o=>{let r=e[o?"startContainer":"endContainer"],s=e[o?"startOffset":"endOffset"];if($(r)){const i=P.create("span",{"data-mce-type":"bookmark"});r.hasChildNodes()?(s=Math.min(s,r.childNodes.length-1),o?r.insertBefore(i,r.childNodes[s]):P.insertAfter(i,r.childNodes[s])):r.appendChild(i),r=i,s=0}t[o?"startContainer":"endContainer"]=r,t[o?"startOffset":"endOffset"]=s};return n(!0),e.collapsed||n(),t},K=e=>{const t=o=>{let r=e[o?"startContainer":"endContainer"],s=e[o?"startOffset":"endOffset"];if(r){if($(r)&&r.parentNode){const i=r;s=(a=>{var d;let l=(d=a.parentNode)===null||d===void 0?void 0:d.firstChild,c=0;for(;l;){if(l===a)return c;$(l)&&l.getAttribute("data-mce-type")==="bookmark"||c++,l=l.nextSibling}return-1})(r),r=r.parentNode,P.remove(i),!r.hasChildNodes()&&P.isBlock(r)&&r.appendChild(P.create("br"))}e[o?"startContainer":"endContainer"]=r,e[o?"startOffset":"endOffset"]=s}};t(!0),t();const n=P.createRng();return n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),J(n)},te=e=>{switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},bt=(e,t)=>{L.each(t,(n,o)=>{e.setAttribute(o,n)})},ne=(e,t,n)=>{((o,r,s)=>{const i=s["list-style-type"]?s["list-style-type"]:null;o.setStyle(r,"list-style-type",i)})(e,t,n),((o,r,s)=>{bt(r,s["list-attributes"]),L.each(o.select("li",r),i=>{bt(i,s["list-item-attributes"])})})(e,t,n)},St=(e,t,n,o)=>{let r=t[n?"startContainer":"endContainer"];const s=t[n?"startOffset":"endOffset"];for($(r)&&(r=r.childNodes[Math.min(s,r.childNodes.length-1)]||r),!n&&w(r.nextSibling)&&(r=r.nextSibling);r.parentNode!==o;){const i=r.parentNode;if(Ce(e,r)||/^(TD|TH)$/.test(i.nodeName))return r;r=i}return r},ke=(e,t,n)=>{const o=e.selection.getRng();let r="LI";const s=X(e,e.selection.getStart(!0)),i=e.dom;if(i.getContentEditable(e.selection.getNode())==="false")return;(t=t.toUpperCase())==="DL"&&(r="DT");const a=F(o),d=((l,c,m)=>{const p=[],g=l.dom,h=St(l,c,!0,m),u=St(l,c,!1,m);let f;const y=[];for(let C=h;C&&(y.push(C),C!==u);C=C.nextSibling);return L.each(y,C=>{var O;if(Ce(l,C))return p.push(C),void(f=null);if(g.isBlock(C)||w(C))return w(C)&&g.remove(C),void(f=null);const xe=C.nextSibling;un.isBookmarkNode(C)&&(S(xe)||Ce(l,xe)||!xe&&C.parentNode===m)?f=null:(f||(f=g.create("p"),(O=C.parentNode)===null||O===void 0||O.insertBefore(f,C),p.push(f)),f.appendChild(C))}),p})(e,o,s);L.each(d,l=>{let c;const m=l.previousSibling,p=l.parentNode;ve(p)||(m&&S(m)&&m.nodeName===t&&((g,h,u)=>{const f=g.getStyle(h,"list-style-type");let y=u?u["list-style-type"]:"";return y=y===null?"":y,f===y})(i,m,n)?(c=m,l=i.rename(l,r),m.appendChild(l)):(c=i.create(t),p.insertBefore(c,l),c.appendChild(l),l=i.rename(l,r)),((g,h,u)=>{L.each(["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"],f=>g.setStyle(h,f,""))})(i,l),ne(i,c,n),Te(e.dom,c))}),e.selection.setRng(K(a))},Nt=(e,t,n)=>{return((r,s)=>S(r)&&r.nodeName===(s==null?void 0:s.nodeName))(t,n)&&((r,s,i)=>r.getStyle(s,"list-style-type",!0)===r.getStyle(i,"list-style-type",!0))(e,t,n)&&(o=n,t.className===o.className);var o},Te=(e,t)=>{let n,o=t.nextSibling;if(Nt(e,t,o)){const r=o;for(;n=r.firstChild;)t.appendChild(n);e.remove(r)}if(o=t.previousSibling,Nt(e,t,o)){const r=o;for(;n=r.lastChild;)t.insertBefore(n,t.firstChild);e.remove(r)}},Lt=e=>"list-style-type"in e,Ae=(e,t,n)=>{const o=E(e);if(I(e,o))return;const r=(i=>{const a=E(i),d=i.selection.getSelectedBlocks();return((l,c)=>k(l)&&c.length===1&&c[0]===l)(a,d)?(l=>B(l.querySelectorAll(lt),S))(a):B(d,l=>S(l)&&a!==l)})(e),s=V(n)?n:{};r.length>0?((i,a,d,l,c)=>{const m=S(a);if(m&&a.nodeName===l&&!Lt(c))ee(i);else{ke(i,l,c);const p=F(i.selection.getRng()),g=m?[a,...d]:d;L.each(g,h=>{((u,f,y,C)=>{if(f.nodeName!==y){const O=u.dom.rename(f,y);ne(u.dom,O,C),H(u,te(y),O)}else ne(u.dom,f,C),H(u,te(y),f)})(i,h,l,c)}),i.selection.setRng(K(p))}})(e,o,r,t,s):((i,a,d,l)=>{if(a!==i.getBody())if(a)if(a.nodeName!==d||Lt(l)||ct(a)){const c=F(i.selection.getRng());ne(i.dom,a,l);const m=i.dom.rename(a,d);Te(i.dom,m),i.selection.setRng(K(c)),ke(i,d,l),H(i,te(d),m)}else ee(i);else ke(i,d,l),H(i,te(d),a)})(e,o,t,s)},Ot=ye.DOM,kt=(e,t)=>{const n=L.grep(e.select("ol,ul",t));L.each(n,o=>{((r,s)=>{const i=s.parentElement;if(i&&i.nodeName==="LI"&&i.firstChild===s){const a=i.previousSibling;a&&a.nodeName==="LI"?(a.appendChild(s),D(r,i)&&Ot.remove(i)):Ot.setStyle(i,"listStyleType","none")}if(S(i)){const a=i.previousSibling;a&&a.nodeName==="LI"&&a.appendChild(s)}})(e,o)})},Tt=(e,t,n,o)=>{let r=t.startContainer;const s=t.startOffset;if(x(r)&&(n?s<r.data.length:s>0))return r;const i=e.schema.getNonEmptyElements();$(r)&&(r=Xe.getNode(r,s));const a=new Kt(r,o);n&&((l,c)=>!!w(c)&&l.isBlock(c.nextSibling)&&!w(c.previousSibling))(e.dom,r)&&a.next();const d=n?a.next.bind(a):a.prev2.bind(a);for(;r=d();)if(r.nodeName==="LI"&&!r.hasChildNodes()||i[r.nodeName]||x(r)&&r.data.length>0)return r;return null},At=(e,t)=>{const n=t.childNodes;return n.length===1&&!S(n[0])&&e.isBlock(n[0])},we=(e,t,n)=>{let o;const r=t.parentNode;if(!rt(e,t)||!rt(e,n))return;S(n.lastChild)&&(o=n.lastChild),r===n.lastChild&&w(r.previousSibling)&&e.remove(r.previousSibling);const s=n.lastChild;s&&w(s)&&t.hasChildNodes()&&e.remove(s),D(e,n,!0)&&Je(b(n)),((a,d,l)=>{let c;const m=At(a,l)?l.firstChild:l;if(((p,g)=>{At(p,g)&&p.remove(g.firstChild,!0)})(a,d),!D(a,d,!0))for(;c=d.firstChild;)m.appendChild(c)})(e,t,n),o&&n.appendChild(o);const i=((a,d)=>{const l=a.dom,c=d.dom;return l!==c&&l.contains(c)})(b(n),b(t))?e.getParents(t,S,n):[];e.remove(t),N(i,a=>{D(e,a)&&a!==e.getRoot()&&e.remove(a)})},mn=(e,t)=>{const n=e.dom,o=e.selection,r=o.getStart(),s=Ne(e,r),i=n.getParent(o.getStart(),"LI",s);if(i){const a=i.parentElement;if(a===e.getBody()&&D(n,a))return!0;const d=J(o.getRng()),l=n.getParent(Tt(e,d,t,s),"LI",s);if(l&&l!==i)return e.undoManager.transact(()=>{var c,m;t?((p,g,h,u)=>{const f=p.dom;if(f.isEmpty(u))((y,C,O)=>{Je(b(O)),we(y.dom,C,O),y.selection.setCursorLocation(O,0)})(p,h,u);else{const y=F(g);we(f,h,u),p.selection.setRng(K(y))}})(e,d,l,i):((m=(c=i).parentNode)===null||m===void 0?void 0:m.firstChild)===c?Oe(e):((p,g,h,u)=>{const f=F(g);we(p.dom,h,u);const y=K(f);p.selection.setRng(y)})(e,d,i,l)}),!0;if(!l&&!t&&d.startOffset===0&&d.endOffset===0)return e.undoManager.transact(()=>{ee(e)}),!0}return!1},wt=e=>{const t=e.selection.getStart(),n=Ne(e,t);return e.dom.getParent(t,"LI,DT,DD",n)||Se(e).length>0},De=(e,t)=>{const n=e.selection;return!I(e,n.getNode())&&(n.isCollapsed()?((o,r)=>mn(o,r)||((s,i)=>{const a=s.dom,d=s.selection.getStart(),l=Ne(s,d),c=a.getParent(d,a.isBlock,l);if(c&&a.isEmpty(c)){const m=J(s.selection.getRng()),p=a.getParent(Tt(s,m,i,l),"LI",l);if(p){const g=u=>Ue(["td","th","caption"],W(u)),h=u=>u.dom===l;return!!((u,f,y=Pe)=>de(u,f,y).getOr(u.isNone()&&f.isNone()))(Ze(b(p),g,h),Ze(b(m.startContainer),g,h),ce)&&(s.undoManager.transact(()=>{((u,f,y)=>{const C=u.getParent(f.parentNode,u.isBlock,y);u.remove(f),C&&u.isEmpty(C)&&u.remove(C)})(a,c,l),Te(a,p.parentNode),s.selection.select(p,!0),s.selection.collapse(i)}),!0)}}return!1})(o,r))(e,t):(o=>!!wt(o)&&(o.undoManager.transact(()=>{o.execCommand("Delete"),kt(o.dom,o.getBody())}),!0))(e))},Dt=e=>{const t=ae(tn(e).split("")),n=T(t,(o,r)=>{const s=o.toUpperCase().charCodeAt(0)-"A".charCodeAt(0)+1;return Math.pow(26,r)*s});return se(n,(o,r)=>o+r,0)},Ee=e=>{if(--e<0)return"";{const t=e%26,n=Math.floor(e/26);return Ee(n)+String.fromCharCode("A".charCodeAt(0)+t)}},pn=e=>{const t=parseInt(e.start,10);return Ke(e.listStyleType,"upper-alpha")?Ee(t):Ke(e.listStyleType,"lower-alpha")?Ee(t).toLowerCase():e.start},Be=(e,t)=>()=>{const n=E(e);return k(n)&&n.nodeName===t},Et=e=>{e.addCommand("mceListProps",()=>{(t=>{const n=E(t);tt(n)&&!I(t,n)&&t.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:pn({start:t.dom.getAttrib(n,"start","1"),listStyleType:v.from(t.dom.getStyle(n,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:o=>{(r=>{switch((s=>/^[0-9]+$/.test(s)?2:/^[A-Z]+$/.test(s)?0:/^[a-z]+$/.test(s)?1:s.length>0?4:3)(r)){case 2:return v.some({listStyleType:v.none(),start:r});case 0:return v.some({listStyleType:v.some("upper-alpha"),start:Dt(r).toString()});case 1:return v.some({listStyleType:v.some("lower-alpha"),start:Dt(r).toString()});case 3:return v.some({listStyleType:v.none(),start:""});case 4:return v.none()}})(o.getData().start).each(r=>{t.execCommand("mceListUpdate",!1,{attrs:{start:r.start==="1"?"":r.start},styles:{"list-style-type":r.listStyleType.getOr("")}})}),o.close()}})})(e)})},Bt=(e,t)=>n=>pt(e,o=>{n.setActive(ut(o.parents,t)),n.setEnabled(!I(e,o.element))}),gn=(e,t)=>n=>pt(e,o=>n.setEnabled(ut(o.parents,t)&&!I(e,o.element)));It.add("lists",e=>((t=>{(0,t.options.register)("lists_indent_on_tab",{processor:"boolean",default:!0})})(e),e.hasPlugin("rtc",!0)?Et(e):((t=>{Wt(t)&&(n=>{n.on("keydown",o=>{o.keyCode!==G.TAB||G.metaKeyPressed(o)||n.undoManager.transact(()=>{(o.shiftKey?Oe(n):Ct(n))&&o.preventDefault()})})})(t),(n=>{n.on("ExecCommand",o=>{const r=o.command.toLowerCase();r!=="delete"&&r!=="forwarddelete"||!wt(n)||kt(n.dom,n.getBody())}),n.on("keydown",o=>{o.keyCode===G.BACKSPACE?De(n,!1)&&o.preventDefault():o.keyCode===G.DELETE&&De(n,!0)&&o.preventDefault()})})(t)})(e),(t=>{t.on("BeforeExecCommand",n=>{const o=n.command.toLowerCase();o==="indent"?Ct(t):o==="outdent"&&Oe(t)}),t.addCommand("InsertUnorderedList",(n,o)=>{Ae(t,"UL",o)}),t.addCommand("InsertOrderedList",(n,o)=>{Ae(t,"OL",o)}),t.addCommand("InsertDefinitionList",(n,o)=>{Ae(t,"DL",o)}),t.addCommand("RemoveList",()=>{ee(t)}),Et(t),t.addCommand("mceListUpdate",(n,o)=>{V(o)&&((r,s)=>{const i=E(r);i===null||I(r,i)||r.undoManager.transact(()=>{V(s.styles)&&r.dom.setStyles(i,s.styles),V(s.attrs)&&ge(s.attrs,(a,d)=>r.dom.setAttrib(i,d,a))})})(t,o)}),t.addQueryStateHandler("InsertUnorderedList",Be(t,"UL")),t.addQueryStateHandler("InsertOrderedList",Be(t,"OL")),t.addQueryStateHandler("InsertDefinitionList",Be(t,"DL"))})(e)),(t=>{const n=o=>()=>t.execCommand(o);t.hasPlugin("advlist")||(t.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:n("InsertOrderedList"),onSetup:Bt(t,"OL")}),t.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:n("InsertUnorderedList"),onSetup:Bt(t,"UL")}))})(e),(t=>{const n={text:"List properties...",icon:"ordered-list",onAction:()=>t.execCommand("mceListProps"),onSetup:gn(t,"OL")};t.ui.registry.addMenuItem("listprops",n),t.ui.registry.addContextMenu("lists",{update:o=>{const r=E(t,o);return tt(r)?["listprops"]:[]}})})(e),(t=>({backspaceDelete:n=>{De(t,n)}}))(e)))})();
