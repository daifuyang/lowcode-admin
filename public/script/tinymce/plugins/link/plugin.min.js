var v=Object.assign;(function(){"use strict";var wt=tinymce.util.Tools.resolve("tinymce.PluginManager");const T=e=>t=>(n=>{const o=typeof n;return n===null?"null":o==="object"&&Array.isArray(n)?"array":o==="object"&&(r=a=n,(l=String).prototype.isPrototypeOf(r)||((i=a.constructor)===null||i===void 0?void 0:i.name)===l.name)?"string":o;var r,a,l,i})(t)===e,$=e=>t=>typeof t===e,y=T("string"),z=T("object"),E=T("array"),Ct=e=>e===null,G=$("boolean"),P=e=>!(t=>t==null)(e),H=$("function"),J=(e,t)=>{if(E(e)){for(let n=0,o=e.length;n<o;++n)if(!t(e[n]))return!1;return!0}return!1},_=()=>{},Ot=(e,t)=>e===t;class s{constructor(t,n){this.tag=t,this.value=n}static some(t){return new s(!0,t)}static none(){return s.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?s.some(t(this.value)):s.none()}bind(t){return this.tag?t(this.value):s.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:s.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t!=null?t:"Called getOrDie on None")}static from(t){return P(t)?s.some(t):s.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}s.singletonNone=new s(!1);const Nt=Array.prototype.indexOf,At=Array.prototype.push,W=e=>{const t=[];for(let n=0,o=e.length;n<o;++n){if(!E(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);At.apply(t,e[n])}return t},Q=(e,t)=>{for(let n=0;n<e.length;n++){const o=t(e[n],n);if(o.isSome())return o}return s.none()},X=(e,t,n=Ot)=>e.exists(o=>n(o,t)),St=e=>{const t=[],n=o=>{t.push(o)};for(let o=0;o<e.length;o++)e[o].each(n);return t},R=(e,t)=>e?s.some(t):s.none(),k=e=>t=>t.options.get(e),Y=k("link_assume_external_targets"),Tt=k("link_context_toolbar"),Et=k("link_list"),Z=k("link_default_target"),Pt=k("link_default_protocol"),tt=k("link_target_list"),et=k("link_rel_list"),Rt=k("link_class_list"),Lt=k("link_title"),nt=k("allow_unsafe_link_target"),Mt=k("link_quicklink");var N=tinymce.util.Tools.resolve("tinymce.util.Tools");const L=e=>y(e.value)?e.value:"",ot=(e,t)=>{const n=[];return N.each(e,o=>{const r=(a=>y(a.text)?a.text:y(a.title)?a.title:"")(o);if(o.menu!==void 0){const a=ot(o.menu,t);n.push({text:r,items:a})}else{const a=t(o);n.push({text:r,value:a})}}),n},rt=(e=L)=>t=>s.from(t).map(n=>ot(n,e)),M=e=>rt(L)(e),lt=rt,w=(e,t)=>n=>({name:e,type:"listbox",label:t,items:n}),Dt=L,Bt=Object.keys,It=Object.hasOwnProperty,D=(e,t)=>It.call(e,t);var jt=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Kt=tinymce.util.Tools.resolve("tinymce.util.URI");const at=e=>P(e)&&e.nodeName.toLowerCase()==="a",it=e=>at(e)&&!!B(e),st=(e,t)=>{if(e.collapsed)return[];{const n=e.cloneContents(),o=n.firstChild,r=new jt(o,n),a=[];let l=o;do t(l)&&a.push(l);while(l=r.next());return a}},ct=e=>/^\w+:/i.test(e),B=e=>{var t,n;return(n=(t=e.getAttribute("data-mce-href"))!==null&&t!==void 0?t:e.getAttribute("href"))!==null&&n!==void 0?n:""},ut=(e,t)=>{const n=["noopener"],o=e?e.split(/\s+/):[],r=l=>l.filter(i=>N.inArray(n,i)===-1),a=t?(l=>(l=r(l)).length>0?l.concat(n):n)(o):r(o);return a.length>0?(l=>N.trim(l.sort().join(" ")))(a):""},x=(e,t)=>(t=t||e.selection.getNode(),I(t)?s.from(e.dom.select("a[href]",t)[0]):s.from(e.dom.getParent(t,"a[href]"))),C=(e,t)=>x(e,t).isSome(),gt=(e,t)=>t.fold(()=>e.getContent({format:"text"}),n=>n.innerText||n.textContent||"").replace(/\uFEFF/g,""),dt=e=>N.grep(e,it).length>0,mt=e=>{const t=e.schema.getTextInlineElements();if(x(e).exists(o=>o.hasAttribute("data-mce-block")))return!1;const n=e.selection.getRng();return!!n.collapsed||st(n,o=>o.nodeType===1&&!at(o)&&!D(t,o.nodeName.toLowerCase())).length===0},I=e=>P(e)&&e.nodeName==="FIGURE"&&/\bimage\b/i.test(e.className),Ut=(e,t,n)=>{const o=e.selection.getNode(),r=x(e,o),a=((l,i)=>{const c=v({},i);if(et(l).length===0&&!nt(l)){const g=ut(c.rel,c.target==="_blank");c.rel=g||null}return s.from(c.target).isNone()&&tt(l)===!1&&(c.target=Z(l)),c.href=((g,d)=>d!=="http"&&d!=="https"||ct(g)?g:d+"://"+g)(c.href,Y(l)),c})(e,(l=>{return i=["title","rel","class","target"],c=(d,m)=>(l[m].each(u=>{d[m]=u.length>0?u:null}),d),g={href:l.href},((d,m)=>{for(let u=0,f=d.length;u<f;u++)m(d[u],u)})(i,(d,m)=>{g=c(g,d)}),g;var i,c,g})(n));e.undoManager.transact(()=>{n.href===t.href&&t.attach(),r.fold(()=>{((l,i,c,g)=>{const d=l.dom;I(i)?Vt(d,i,g):c.fold(()=>{l.execCommand("mceInsertLink",!1,g)},m=>{l.insertContent(d.createHTML("a",g,d.encode(m)))})})(e,o,n.text,a)},l=>{e.focus(),((i,c,g,d)=>{g.each(m=>{D(c,"innerText")?c.innerText=m:c.textContent=m}),i.dom.setAttribs(c,d),i.selection.select(c)})(e,l,n.text,a)})})},qt=e=>{const{class:t,href:n,rel:o,target:r,text:a,title:l}=e;return((i,c)=>{const g={};var d;return((m,u,f,p)=>{((h,b)=>{const S=Bt(h);for(let O=0,V=S.length;O<V;O++){const _t=S[O];b(h[_t],_t)}})(m,(h,b)=>{(u(h,b)?f:p)(h,b)})})(i,(m,u)=>Ct(m)===!1,(d=g,(m,u)=>{d[u]=m}),_),g})({class:t.getOrNull(),href:n,rel:o.getOrNull(),target:r.getOrNull(),text:a.getOrNull(),title:l.getOrNull()})},ht=(e,t,n)=>{const o=((r,a)=>{const l=r.options.get,i={allow_html_data_urls:l("allow_html_data_urls"),allow_script_urls:l("allow_script_urls"),allow_svg_data_urls:l("allow_svg_data_urls")},c=a.href;return v(v({},a),{href:Kt.isDomSafe(c,"a",i)?c:""})})(e,n);e.hasPlugin("rtc",!0)?e.execCommand("createlink",!1,qt(o)):Ut(e,t,o)},A=e=>{e.hasPlugin("rtc",!0)?e.execCommand("unlink"):(t=>{t.undoManager.transact(()=>{const n=t.selection.getNode();I(n)?Ft(t,n):(o=>{const r=o.dom,a=o.selection,l=a.getBookmark(),i=a.getRng().cloneRange(),c=r.getParent(i.startContainer,"a[href]",o.getBody()),g=r.getParent(i.endContainer,"a[href]",o.getBody());c&&i.setStartBefore(c),g&&i.setEndAfter(g),a.setRng(i),o.execCommand("unlink"),a.moveToBookmark(l)})(t),t.focus()})})(e)},Ft=(e,t)=>{var n;const o=e.dom.select("img",t)[0];if(o){const r=e.dom.getParents(o,"a[href]",t)[0];r&&((n=r.parentNode)===null||n===void 0||n.insertBefore(o,r),e.dom.remove(r))}},Vt=(e,t,n)=>{var o;const r=e.select("img",t)[0];if(r){const a=e.create("a",n);(o=r.parentNode)===null||o===void 0||o.insertBefore(a,r),a.appendChild(r)}},ft=(e,t)=>Q(t,n=>(o=>{return D(r=o,a="items")&&r[a]!==void 0&&r[a]!==null;var r,a})(n)?ft(e,n.items):R(n.value===e,n)),$t=(e,t)=>{const n={text:e.text,title:e.title},o=(r,a)=>{const l=(i=t,c=a,c==="link"?i.link:c==="anchor"?i.anchor:s.none()).getOr([]);var i,c;return((g,d,m,u)=>{const f=u[d],p=g.length>0;return f!==void 0?ft(f,m).map(h=>({url:{value:h.value,meta:{text:p?g:h.text,attach:_}},text:p?g:h.text})):s.none()})(n.text,a,l,r)};return{onChange:(r,a)=>{const l=a.name;return l==="url"?(i=>{const c=(g=i.url,R(n.text.length<=0,s.from((d=g.meta)===null||d===void 0?void 0:d.text).getOr(g.value)));var g,d;const m=(u=>{var f;return R(n.title.length<=0,s.from((f=u.meta)===null||f===void 0?void 0:f.title).getOr(""))})(i.url);return c.isSome()||m.isSome()?s.some(v(v({},c.map(u=>({text:u})).getOr({})),m.map(u=>({title:u})).getOr({}))):s.none()})(r()):((i,c)=>Nt.call(i,c))(["anchor","link"],l)>-1?o(r(),l):((l==="text"||l==="title")&&(n[l]=r()[l]),s.none())}}};var zt=tinymce.util.Tools.resolve("tinymce.util.Delay");const Gt=e=>{const t=e.href;return t.indexOf("@")>0&&t.indexOf("/")===-1&&t.indexOf("mailto:")===-1?s.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:n=>v(v({},n),{href:"mailto:"+t})}):s.none()},Ht=(e,t)=>n=>{const o=n.href;return e===1&&!ct(o)||e===0&&/^\s*www(\.|\d\.)/i.test(o)?s.some({message:`The URL you entered seems to be an external link. Do you want to add the required ${t}:// prefix?`,preprocess:r=>v(v({},r),{href:t+"://"+o})}):s.none()},Jt=e=>{const t=e.dom.select("a:not([href])"),n=W(((o,r)=>{const a=o.length,l=new Array(a);for(let i=0;i<a;i++){const c=o[i];l[i]=r(c,i)}return l})(t,o=>{const r=o.name||o.id;return r?[{text:r,value:"#"+r}]:[]}));return n.length>0?s.some([{text:"None",value:""}].concat(n)):s.none()},Wt=e=>{const t=Rt(e);return t.length>0?M(t):s.none()},Qt=e=>{try{return s.some(JSON.parse(e))}catch(t){return s.none()}},Xt=(e,t)=>{const n=et(e);if(n.length>0){const o=X(t,"_blank"),r=a=>ut(Dt(a),o);return(nt(e)===!1?lt(r):M)(n)}return s.none()},pt=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],Yt=e=>{const t=tt(e);return E(t)?M(t).orThunk(()=>s.some(pt)):t===!1?s.none():s.some(pt)},j=(e,t,n)=>{const o=e.getAttrib(t,n);return o!==null&&o.length>0?s.some(o):s.none()},Zt=(e,t)=>(n=>{const o=a=>n.convertURL(a.value||a.url||"","href"),r=Et(n);return new Promise(a=>{y(r)?fetch(r).then(l=>l.ok?l.text().then(Qt):Promise.reject()).then(a,()=>a(s.none())):H(r)?r(l=>a(s.some(l))):a(s.from(r))}).then(a=>a.bind(lt(o)).map(l=>l.length>0?[{text:"None",value:""}].concat(l):l))})(e).then(n=>{const o=((r,a)=>{const l=r.dom,i=mt(r)?s.some(gt(r.selection,a)):s.none(),c=a.bind(u=>s.from(l.getAttrib(u,"href"))),g=a.bind(u=>s.from(l.getAttrib(u,"target"))),d=a.bind(u=>j(l,u,"rel")),m=a.bind(u=>j(l,u,"class"));return{url:c,text:i,title:a.bind(u=>j(l,u,"title")),target:g,rel:d,linkClass:m}})(e,t);return{anchor:o,catalogs:{targets:Yt(e),rels:Xt(e,o.target),classes:Wt(e),anchor:Jt(e),link:n},optNode:t,flags:{titleEnabled:Lt(e)}}}),te=e=>{(n=>{const o=x(n);return Zt(n,o)})(e).then(n=>{const o=((r,a)=>l=>{const i=l.getData();if(!i.url.value)return A(r),void l.close();const c=m=>s.from(i[m]).filter(u=>!X(a.anchor[m],u)),g={href:i.url.value,text:c("text"),target:c("target"),rel:c("rel"),class:c("linkClass"),title:c("title")},d={href:i.url.value,attach:i.url.meta!==void 0&&i.url.meta.attach?i.url.meta.attach:_};((m,u)=>Q([Gt,Ht(Y(m),Pt(m))],f=>f(u)).fold(()=>Promise.resolve(u),f=>new Promise(p=>{((h,b,S)=>{const O=h.selection.getRng();zt.setEditorTimeout(h,()=>{h.windowManager.confirm(b,V=>{h.selection.setRng(O),S(V)})})})(m,f.message,h=>{p(h?f.preprocess(u):u)})})))(r,g).then(m=>{ht(r,d,m)}),l.close()})(e,n);return((r,a,l)=>{const i=r.anchor.text.map(()=>({name:"text",type:"input",label:"Text to display"})).toArray(),c=r.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],g=((u,f)=>{const p=u.anchor,h=p.url.getOr("");return{url:{value:h,meta:{original:{value:h}}},text:p.text.getOr(""),title:p.title.getOr(""),anchor:h,link:h,rel:p.rel.getOr(""),target:p.target.or(f).getOr(""),linkClass:p.linkClass.getOr("")}})(r,s.from(Z(l))),d=r.catalogs,m=$t(g,d);return{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:W([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],i,c,St([d.anchor.map(w("anchor","Anchors")),d.rels.map(w("rel","Rel")),d.targets.map(w("target","Open link in...")),d.link.map(w("link","Link list")),d.classes.map(w("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:g,onChange:(u,{name:f})=>{m.onChange(u.getData,{name:f}).each(p=>{u.setData(p)})},onSubmit:a}})(n,o,e)}).then(n=>{e.windowManager.open(n)})};var ee=tinymce.util.Tools.resolve("tinymce.util.VK");const kt=(e,t)=>e.dom.getParent(t,"a[href]"),vt=e=>kt(e,e.selection.getStart()),K=(e,t)=>{if(t){const n=B(t);if(/^#/.test(n)){const o=e.dom.select(n);o.length&&e.selection.scrollIntoView(o[0],!0)}else(o=>{const r=document.createElement("a");r.target="_blank",r.href=o,r.rel="noreferrer noopener";const a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),((l,i)=>{document.body.appendChild(l),l.dispatchEvent(i),document.body.removeChild(l)})(r,a)})(t.href)}},yt=e=>()=>{e.execCommand("mceLink",!1,{dialog:!0})},U=e=>()=>{K(e,vt(e))},q=(e,t)=>(e.on("NodeChange",t),()=>e.off("NodeChange",t)),F=e=>t=>{const n=()=>t.setActive(!e.mode.isReadOnly()&&C(e,e.selection.getNode()));return n(),q(e,n)},xt=e=>t=>{const n=()=>t.setEnabled(C(e,e.selection.getNode()));return n(),q(e,n)},bt=e=>t=>{const n=r=>{return dt(r)||(a=e.selection.getRng(),st(a,it).length>0);var a},o=e.dom.getParents(e.selection.getStart());return t.setEnabled(n(o)),q(e,r=>t.setEnabled(n(r.parents)))};wt.add("link",e=>{(t=>{const n=t.options.register;n("link_assume_external_targets",{processor:o=>{const r=y(o)||G(o);return r?o===!0?{value:1,valid:r}:o==="http"||o==="https"?{value:o,valid:r}:{value:0,valid:r}:{valid:!1,message:"Must be a string or a boolean."}},default:!1}),n("link_context_toolbar",{processor:"boolean",default:!1}),n("link_list",{processor:o=>y(o)||H(o)||J(o,z)}),n("link_default_target",{processor:"string"}),n("link_default_protocol",{processor:"string",default:"https"}),n("link_target_list",{processor:o=>G(o)||J(o,z),default:!0}),n("link_rel_list",{processor:"object[]",default:[]}),n("link_class_list",{processor:"object[]",default:[]}),n("link_title",{processor:"boolean",default:!0}),n("allow_unsafe_link_target",{processor:"boolean",default:!1}),n("link_quicklink",{processor:"boolean",default:!1})})(e),(t=>{t.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:yt(t),onSetup:F(t)}),t.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:U(t),onSetup:xt(t)}),t.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:()=>A(t),onSetup:bt(t)})})(e),(t=>{t.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:U(t),onSetup:xt(t)}),t.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:yt(t)}),t.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:()=>A(t),onSetup:bt(t)})})(e),(t=>{t.ui.registry.addContextMenu("link",{update:n=>dt(t.dom.getParents(n,"a"))?"link unlink openlink":"link"})})(e),(t=>{const n=o=>{const r=t.selection.getNode();return o.setEnabled(C(t,r)),_};t.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:F(t)},label:"Link",predicate:o=>Tt(t)&&C(t,o),initValue:()=>x(t).fold(()=>"",B),commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:o=>{const r=t.selection.getNode();return o.setActive(C(t,r)),F(t)(o)},onAction:o=>{const r=o.getValue(),a=(l=>{const i=x(t),c=mt(t);if(i.isNone()&&c){const g=gt(t.selection,i);return s.some(g.length>0?g:l)}return s.none()})(r);ht(t,{href:r,attach:_},{href:r,text:a,title:s.none(),rel:s.none(),target:s.none(),class:s.none()}),(l=>{l.selection.collapse(!1)})(t),o.hide()}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:n,onAction:o=>{A(t),o.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:n,onAction:o=>{U(t)(),o.hide()}}]})})(e),(t=>{t.on("click",n=>{const o=kt(t,n.target);o&&ee.metaKeyPressed(n)&&(n.preventDefault(),K(t,o))}),t.on("keydown",n=>{if(!n.isDefaultPrevented()&&n.keyCode===13&&(o=>o.altKey===!0&&o.shiftKey===!1&&o.ctrlKey===!1&&o.metaKey===!1)(n)){const o=vt(t);o&&(n.preventDefault(),K(t,o))}})})(e),(t=>{t.addCommand("mceLink",(n,o)=>{(o==null?void 0:o.dialog)!==!0&&Mt(t)?t.dispatch("contexttoolbar-show",{toolbarKey:"quicklink"}):te(t)})})(e),(t=>{t.addShortcut("Meta+K","",()=>{t.execCommand("mceLink")})})(e)})})();
