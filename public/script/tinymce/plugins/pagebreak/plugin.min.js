(function(){"use strict";var d=tinymce.util.Tools.resolve("tinymce.PluginManager"),k=tinymce.util.Tools.resolve("tinymce.Env");const c=t=>e=>e.options.get(t),b=c("pagebreak_separator"),i=c("pagebreak_split_block"),g="mce-pagebreak",l=t=>{const e=`<img src="${k.transparentSrc}" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />`;return t?`<p>${e}</p>`:e};d.add("pagebreak",t=>{(e=>{const a=e.options.register;a("pagebreak_separator",{processor:"string",default:"<!-- pagebreak -->"}),a("pagebreak_split_block",{processor:"boolean",default:!1})})(t),(e=>{e.addCommand("mcePageBreak",()=>{e.insertContent(l(i(e)))})})(t),(e=>{const a=()=>e.execCommand("mcePageBreak");e.ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:a}),e.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:a})})(t),(e=>{const a=b(e),p=()=>i(e),u=new RegExp(a.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,r=>"\\"+r),"gi");e.on("BeforeSetContent",r=>{r.content=r.content.replace(u,l(p()))}),e.on("PreInit",()=>{e.serializer.addNodeFilter("img",r=>{let n,s,m=r.length;for(;m--;)if(n=r[m],s=n.attr("class"),s&&s.indexOf(g)!==-1){const o=n.parent;if(o&&e.schema.getBlockElements()[o.name]&&p()){o.type=3,o.value=a,o.raw=!0,n.remove();continue}n.type=3,n.value=a,n.raw=!0}})})})(t),(e=>{e.on("ResolveName",a=>{a.target.nodeName==="IMG"&&e.dom.hasClass(a.target,g)&&(a.name="pagebreak")})})(t)})})();
