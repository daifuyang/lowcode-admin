(function(){"use strict";var d=tinymce.util.Tools.resolve("tinymce.PluginManager");const i=t=>typeof t=="function";var m=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),u=tinymce.util.Tools.resolve("tinymce.util.Tools");const c=t=>n=>n.options.get(t),s=c("save_enablewhendirty"),v=c("save_onsavecallback"),f=c("save_oncancelcallback"),r=(t,n)=>{t.notificationManager.open({text:n,type:"error"})},l=t=>n=>{const o=()=>{n.setEnabled(!s(t)||t.isDirty())};return o(),t.on("NodeChange dirty",o),()=>t.off("NodeChange dirty",o)};d.add("save",t=>{(n=>{const o=n.options.register;o("save_enablewhendirty",{processor:"boolean",default:!0}),o("save_onsavecallback",{processor:"function"}),o("save_oncancelcallback",{processor:"function"})})(t),(n=>{n.ui.registry.addButton("save",{icon:"save",tooltip:"Save",enabled:!1,onAction:()=>n.execCommand("mceSave"),onSetup:l(n)}),n.ui.registry.addButton("cancel",{icon:"cancel",tooltip:"Cancel",enabled:!1,onAction:()=>n.execCommand("mceCancel"),onSetup:l(n)}),n.addShortcut("Meta+S","","mceSave")})(t),(n=>{n.addCommand("mceSave",()=>{(o=>{const e=m.DOM.getParent(o.id,"form");if(s(o)&&!o.isDirty())return;o.save();const a=v(o);if(i(a))return a.call(o,o),void o.nodeChanged();e?(o.setDirty(!1),e.onsubmit&&!e.onsubmit()||(typeof e.submit=="function"?e.submit():r(o,"Error: Form submit field collision.")),o.nodeChanged()):r(o,"Error: No form element found.")})(n)}),n.addCommand("mceCancel",()=>{(o=>{const e=u.trim(o.startContent),a=f(o);i(a)?a.call(o,o):o.resetContent(e)})(n)})})(t)})})();
