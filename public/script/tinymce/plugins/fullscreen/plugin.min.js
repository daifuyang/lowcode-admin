var J=Object.assign;(function(){"use strict";const Q=e=>{let t=e;return{get:()=>t,set:r=>{t=r}}};var Ke=tinymce.util.Tools.resolve("tinymce.PluginManager");const Z=e=>t=>(r=>{const n=typeof r;return r===null?"null":n==="object"&&Array.isArray(r)?"array":n==="object"&&(o=s=r,(l=String).prototype.isPrototypeOf(o)||((i=s.constructor)===null||i===void 0?void 0:i.name)===l.name)?"string":n;var o,s,l,i})(t)===e,I=e=>t=>typeof t===e,_=e=>t=>e===t,ee=Z("string"),Xe=Z("array"),te=_(null),Ye=I("boolean"),Ge=_(void 0),M=e=>!(t=>t==null)(e),N=I("function"),Je=I("number"),P=()=>{},m=e=>()=>e;function Qe(e,...t){return(...r)=>{const n=t.concat(r);return e.apply(null,n)}}const ne=m(!1),Ze=m(!0);class d{constructor(t,r){this.tag=t,this.value=r}static some(t){return new d(!0,t)}static none(){return d.singletonNone}fold(t,r){return this.tag?r(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?d.some(t(this.value)):d.none()}bind(t){return this.tag?t(this.value):d.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:d.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t!=null?t:"Called getOrDie on None")}static from(t){return M(t)?d.some(t):d.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}d.singletonNone=new d(!1);const re=e=>{const t=Q(d.none()),r=()=>t.get().each(e);return{clear:()=>{r(),t.set(d.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:n=>{r(),t.set(d.some(n))}}},oe=()=>re(e=>e.unbind()),_e=Array.prototype.push,B=(e,t)=>{const r=e.length,n=new Array(r);for(let o=0;o<r;o++){const s=e[o];n[o]=t(s,o)}return n},V=(e,t)=>{for(let r=0,n=e.length;r<n;r++)t(e[r],r)},j=(e,t)=>{const r=[];for(let n=0,o=e.length;n<o;n++){const s=e[n];t(s,n)&&r.push(s)}return r},se=(e,t)=>((r,n,o)=>{for(let s=0,l=r.length;s<l;s++){const i=r[s];if(n(i,s))return d.some(i);if(o(i,s))break}return d.none()})(e,t,ne),et=Object.keys,x=(e,t,r=0,n)=>{const o=e.indexOf(t,r);return o!==-1&&(!!Ge(n)||o+t.length<=n)},ie=e=>e.style!==void 0&&N(e.style.getPropertyValue),tt=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},S=tt;typeof window!="undefined"||Function("return this;")();const D=e=>t=>(r=>r.dom.nodeType)(t)===e,nt=D(1),rt=D(3),ot=D(9),st=D(11),le=(e,t)=>{const r=e.dom;if(r.nodeType!==1)return!1;{const n=r;if(n.matches!==void 0)return n.matches(t);if(n.msMatchesSelector!==void 0)return n.msMatchesSelector(t);if(n.webkitMatchesSelector!==void 0)return n.webkitMatchesSelector(t);if(n.mozMatchesSelector!==void 0)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},A=e=>S(e.dom.ownerDocument),it=e=>B(e.dom.childNodes,S),ae=N(Element.prototype.attachShadow)&&N(Node.prototype.getRootNode),lt=m(ae),at=ae?e=>S(e.dom.getRootNode()):e=>ot(e)?e:A(e),z=e=>{const t=at(e);return st(r=t)&&M(r.dom.host)?d.some(t):d.none();var r},$=e=>S(e.dom.host),ce=e=>{const t=rt(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const r=t.ownerDocument;return z(S(t)).fold(()=>r.body.contains(t),(n=ce,o=$,s=>n(o(s))));var n,o},ue=(e,t)=>{const r=e.dom.getAttribute(t);return r===null?void 0:r},de=(e,t)=>{e.dom.removeAttribute(t)},U=(e,t)=>{const r=e.dom;((n,o)=>{const s=et(n);for(let l=0,i=s.length;l<i;l++){const c=s[l];o(n[c],c)}})(t,(n,o)=>{((s,l,i)=>{if(!ee(i))throw console.error("Invalid call to CSS.set. Property ",l,":: Value ",i,":: Element ",s),new Error("CSS value must be a string: "+i);ie(s)&&s.style.setProperty(l,i)})(r,o,n)})},me=e=>{const t=S((i=>{if(lt()&&M(i.target)){const c=S(i.target);if(nt(c)&&M(c.dom.shadowRoot)&&i.composed&&i.composedPath){const u=i.composedPath();if(u)return((a,h)=>0<a.length?d.some(a[0]):d.none())(u)}}return d.from(i.target)})(e).getOr(e.target)),r=()=>e.stopPropagation(),n=()=>e.preventDefault(),o=(s=n,l=r,(...i)=>s(l.apply(null,i)));var s,l;return((i,c,u,a,h,g,w)=>({target:i,x:c,y:u,stop:a,prevent:h,kill:g,raw:w}))(t,e.clientX,e.clientY,r,n,o,e)},ct=(e,t,r,n)=>{e.dom.removeEventListener(t,r,n)},ut=Ze,dt=(e,t,r)=>((n,o,s,l)=>((i,c,u,a,h)=>{const g=((w,y)=>O=>{w(O)&&y(me(O))})(u,a);return i.dom.addEventListener(c,g,h),{unbind:Qe(ct,i,c,g,h)}})(n,o,s,l,!1))(e,t,ut,r),he=()=>K(0,0),K=(e,t)=>({major:e,minor:t}),R={nu:K,detect:(e,t)=>{const r=String(t).toLowerCase();return e.length===0?he():((n,o)=>{const s=((i,c)=>{for(let u=0;u<i.length;u++){const a=i[u];if(a.test(c))return a}})(n,o);if(!s)return{major:0,minor:0};const l=i=>Number(o.replace(s,"$"+i));return K(l(1),l(2))})(e,r)},unknown:he},ge=(e,t)=>{const r=String(t).toLowerCase();return se(e,n=>n.search(r))},X=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,E=e=>t=>x(t,e),mt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>x(e,"edge/")&&x(e,"chrome")&&x(e,"safari")&&x(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,X],search:e=>x(e,"chrome")&&!x(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>x(e,"msie")||x(e,"trident")},{name:"Opera",versionRegexes:[X,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:E("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:E("firefox")},{name:"Safari",versionRegexes:[X,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(x(e,"safari")||x(e,"mobile/"))&&x(e,"applewebkit")}],ht=[{name:"Windows",search:E("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>x(e,"iphone")||x(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:E("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:E("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:E("linux"),versionRegexes:[]},{name:"Solaris",search:E("sunos"),versionRegexes:[]},{name:"FreeBSD",search:E("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:E("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],pe={browsers:m(mt),oses:m(ht)},fe="Edge",ve="Chromium",we="Opera",ye="Firefox",be="Safari",Se=e=>{const t=e.current,r=e.version,n=o=>()=>t===o;return{current:t,version:r,isEdge:n(fe),isChromium:n(ve),isIE:n("IE"),isOpera:n(we),isFirefox:n(ye),isSafari:n(be)}},gt=()=>Se({current:void 0,version:R.unknown()}),pt=Se,xe=(m(fe),m(ve),m("IE"),m(we),m(ye),m(be),"Windows"),Ee="Android",Fe="Linux",Oe="macOS",Te="Solaris",ke="FreeBSD",Ce="ChromeOS",Ae=e=>{const t=e.current,r=e.version,n=o=>()=>t===o;return{current:t,version:r,isWindows:n(xe),isiOS:n("iOS"),isAndroid:n(Ee),isMacOS:n(Oe),isLinux:n(Fe),isSolaris:n(Te),isFreeBSD:n(ke),isChromeOS:n(Ce)}},ft=()=>Ae({current:void 0,version:R.unknown()}),vt=Ae,wt=(m(xe),m("iOS"),m(Ee),m(Fe),m(Oe),m(Te),m(ke),m(Ce),(e,t,r)=>{const n=pe.browsers(),o=pe.oses(),s=t.bind(c=>((u,a)=>((h,g)=>{for(let w=0;w<h.length;w++){const y=g(h[w]);if(y.isSome())return y}return d.none()})(a.brands,h=>{const g=h.brand.toLowerCase();return se(u,w=>{var y;return g===((y=w.brand)===null||y===void 0?void 0:y.toLowerCase())}).map(w=>({current:w.name,version:R.nu(parseInt(h.version,10),0)}))}))(n,c)).orThunk(()=>((c,u)=>ge(c,u).map(a=>{const h=R.detect(a.versionRegexes,u);return{current:a.name,version:h}}))(n,e)).fold(gt,pt),l=((c,u)=>ge(c,u).map(a=>{const h=R.detect(a.versionRegexes,u);return{current:a.name,version:h}}))(o,e).fold(ft,vt),i=((c,u,a,h)=>{const g=c.isiOS()&&/ipad/i.test(a)===!0,w=c.isiOS()&&!g,y=c.isiOS()||c.isAndroid(),O=y||h("(pointer:coarse)"),f=g||!w&&y&&h("(min-device-width:768px)"),p=w||y&&!f,b=u.isSafari()&&c.isiOS()&&/safari/i.test(a)===!1,v=!p&&!f&&!b;return{isiPad:m(g),isiPhone:m(w),isTablet:m(f),isPhone:m(p),isTouch:m(O),isAndroid:c.isAndroid,isiOS:c.isiOS,isWebView:m(b),isDesktop:m(v)}})(l,s,e,r);return{browser:s,os:l,deviceType:i}}),yt=e=>window.matchMedia(e).matches;let bt=(e=>{let t,r=!1;return(...n)=>(r||(r=!0,t=e.apply(null,n)),t)})(()=>wt(navigator.userAgent,d.from(navigator.userAgentData),yt));const Re=(e,t)=>({left:e,top:t,translate:(r,n)=>Re(e+r,t+n)}),St=Re,Y=e=>{const t=e===void 0?window:e;return bt().browser.isFirefox()?d.none():d.from(t.visualViewport)},Le=(e,t,r,n)=>({x:e,y:t,width:r,height:n,right:e+r,bottom:t+n}),xt=e=>{const t=e===void 0?window:e,r=t.document,n=(o=>{const s=o!==void 0?o.dom:document,l=s.body.scrollLeft||s.documentElement.scrollLeft,i=s.body.scrollTop||s.documentElement.scrollTop;return St(l,i)})(S(r));return Y(t).fold(()=>{const o=t.document.documentElement,s=o.clientWidth,l=o.clientHeight;return Le(n.left,n.top,s,l)},o=>Le(Math.max(o.pageLeft,n.left),Math.max(o.pageTop,n.top),o.width,o.height))},Me=(e,t,r)=>Y(r).map(n=>{const o=s=>t(me(s));return n.addEventListener(e,o),{unbind:()=>n.removeEventListener(e,o)}}).getOrThunk(()=>({unbind:P}));var Et=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Ne=tinymce.util.Tools.resolve("tinymce.Env");const Pe=(e,t)=>{e.dispatch("FullscreenStateChanged",{state:t}),e.dispatch("ResizeEditor")},G=e=>e.options.get("fullscreen_native"),De=e=>{return e.dom===((t=A(e).dom).fullscreenElement!==void 0?t.fullscreenElement:t.msFullscreenElement!==void 0?t.msFullscreenElement:t.webkitFullscreenElement!==void 0?t.webkitFullscreenElement:null);var t},Ft=(e,t,r)=>((n,o,s)=>j(((l,i)=>{const c=N(i)?i:ne;let u=l.dom;const a=[];for(;u.parentNode!==null&&u.parentNode!==void 0;){const h=u.parentNode,g=S(h);if(a.push(g),c(g)===!0)break;u=h}return a})(n,s),o))(e,n=>le(n,t),r),Ot=(e,t)=>((r,n)=>{return j((s=>d.from(s.dom.parentNode).map(S))(o=r).map(it).map(s=>j(s,l=>{return i=l,o.dom!==i.dom;var i})).getOr([]),s=>le(s,t));var o})(e),W="data-ephox-mobile-fullscreen-style",We="position:absolute!important;",qe="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Tt=Ne.os.isAndroid(),kt=e=>{const t=((r,n)=>{const o=r.dom,s=window.getComputedStyle(o).getPropertyValue(n);return s!==""||ce(r)?s:((l,i)=>ie(l)?l.style.getPropertyValue(i):"")(o,n)})(e,"background-color");return t!==void 0&&t!==""?"background-color:"+t+"!important":"background-color:rgb(255,255,255)!important;"},He=Et.DOM,Ie=Y().fold(()=>({bind:P,unbind:P}),e=>{const t=(()=>{const s=re(P);return J(J({},s),{on:l=>s.get().each(l)})})(),r=oe(),n=oe(),o=((s,l)=>{let i=null;return{cancel:()=>{te(i)||(clearTimeout(i),i=null)},throttle:(...c)=>{te(i)&&(i=setTimeout(()=>{i=null,s.apply(null,c)},50))}}})(()=>{document.body.scrollTop=0,document.documentElement.scrollTop=0,window.requestAnimationFrame(()=>{t.on(s=>U(s,{top:e.offsetTop+"px",left:e.offsetLeft+"px",height:e.height+"px",width:e.width+"px"}))})});return{bind:s=>{t.set(s),o.throttle(),r.set(Me("resize",o.throttle)),n.set(Me("scroll",o.throttle))},unbind:()=>{t.on(()=>{r.clear(),n.clear()}),t.clear()}}}),Be=(e,t)=>{const r=document.body,n=document.documentElement,o=e.getContainer(),s=S(o),l=(f=>{const p=S(f.getElement());return z(p).map($).getOrThunk(()=>(b=>{const v=b.dom.body;if(v==null)throw new Error("Body is not available yet");return S(v)})(A(p)))})(e),i=t.get(),c=S(e.getBody()),u=Ne.deviceType.isTouch(),a=o.style,h=e.iframeElement,g=h==null?void 0:h.style,w=f=>{f(r,"tox-fullscreen"),f(n,"tox-fullscreen"),f(o,"tox-fullscreen"),z(s).map(p=>$(p).dom).each(p=>{f(p,"tox-fullscreen"),f(p,"tox-shadowhost")})},y=()=>{u&&(f=>{const p=((b,v)=>{const q=document;return(T=q).nodeType!==1&&T.nodeType!==9&&T.nodeType!==11||T.childElementCount===0?[]:B(q.querySelectorAll(b),S);var T})("["+W+"]");V(p,b=>{const v=ue(b,W);v&&v!=="no-styles"?U(b,f.parseStyle(v)):de(b,"style"),de(b,W)})})(e.dom),w(He.removeClass),Ie.unbind(),d.from(t.get()).each(f=>f.fullscreenChangeHandler.unbind())};if(i)i.fullscreenChangeHandler.unbind(),G(e)&&De(l)&&(f=>{const p=f.dom;p.exitFullscreen?p.exitFullscreen():p.msExitFullscreen?p.msExitFullscreen():p.webkitCancelFullScreen&&p.webkitCancelFullScreen()})(A(l)),g.width=i.iframeWidth,g.height=i.iframeHeight,a.width=i.containerWidth,a.height=i.containerHeight,a.top=i.containerTop,a.left=i.containerLeft,y(),O=i.scrollPos,window.scrollTo(O.x,O.y),t.set(null),Pe(e,!1),e.off("remove",y);else{const f=dt(A(l),document.fullscreenElement!==void 0?"fullscreenchange":document.msFullscreenElement!==void 0?"MSFullscreenChange":document.webkitFullscreenElement!==void 0?"webkitfullscreenchange":"fullscreenchange",b=>{G(e)&&(De(l)||t.get()===null||Be(e,t))}),p={scrollPos:xt(window),containerWidth:a.width,containerHeight:a.height,containerTop:a.top,containerLeft:a.left,iframeWidth:g.width,iframeHeight:g.height,fullscreenChangeHandler:f};u&&((b,v,q)=>{const T=F=>C=>{const k=ue(C,"style"),H=k===void 0?"no-styles":k.trim();H!==F&&(((At,Rt,Lt)=>{(($e,Ue,L)=>{if(!(ee(L)||Ye(L)||Je(L)))throw console.error("Invalid call to Attribute.set. Key ",Ue,":: Value ",L,":: Element ",$e),new Error("Attribute value was not simple");$e.setAttribute(Ue,L+"")})(At.dom,Rt,Lt)})(C,W,H),U(C,b.parseStyle(F)))},je=Ft(v,"*"),Ct=(F=>{const C=[];for(let k=0,H=F.length;k<H;++k){if(!Xe(F[k]))throw new Error("Arr.flatten item "+k+" was not an array, input: "+F);_e.apply(C,F[k])}return C})(B(je,F=>Ot(F,"*:not(.tox-silver-sink)"))),ze=kt(q);V(Ct,T("display:none!important;")),V(je,T(We+qe+ze)),T((Tt===!0?"":We)+qe+ze)(v)})(e.dom,s,c),g.width=g.height="100%",a.width=a.height="",w(He.addClass),Ie.bind(s),e.on("remove",y),t.set(p),G(e)&&(b=>{const v=b.dom;v.requestFullscreen?v.requestFullscreen():v.msRequestFullscreen?v.msRequestFullscreen():v.webkitRequestFullScreen&&v.webkitRequestFullScreen()})(l),Pe(e,!0)}var O},Ve=(e,t)=>r=>{r.setActive(t.get()!==null);const n=o=>r.setActive(o.state);return e.on("FullscreenStateChanged",n),()=>e.off("FullscreenStateChanged",n)};Ke.add("fullscreen",e=>{const t=Q(null);return e.inline||((r=>{(0,r.options.register)("fullscreen_native",{processor:"boolean",default:!1})})(e),((r,n)=>{r.addCommand("mceFullScreen",()=>{Be(r,n)})})(e,t),((r,n)=>{const o=()=>r.execCommand("mceFullScreen");r.ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:o,onSetup:Ve(r,n)}),r.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:o,onSetup:Ve(r,n)})})(e,t),e.addShortcut("Meta+Shift+F","","mceFullScreen")),(r=>({isFullscreen:()=>r.get()!==null}))(t)})})();
