(function(){"use strict";var L=tinymce.util.Tools.resolve("tinymce.PluginManager");const N=e=>t=>typeof t===e,P=e=>(t=>{const o=typeof t;return t===null?"null":o==="object"&&Array.isArray(t)?"array":o==="object"&&(r=n=t,(s=String).prototype.isPrototypeOf(r)||((i=n.constructor)===null||i===void 0?void 0:i.name)===s.name)?"string":o;var r,n,s,i})(e)==="string",B=N("boolean"),A=e=>!(t=>t==null)(e),g=N("function"),V=N("number"),x=()=>!1;class l{constructor(t,o){this.tag=t,this.value=o}static some(t){return new l(!0,t)}static none(){return l.singletonNone}fold(t,o){return this.tag?o(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?l.some(t(this.value)):l.none()}bind(t){return this.tag?t(this.value):l.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:l.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t!=null?t:"Called getOrDie on None")}static from(t){return A(t)?l.some(t):l.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}l.singletonNone=new l(!1);const T=(e,t)=>{for(let o=0,r=e.length;o<r;o++)t(e[o],o)},j=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},d=j,C=(e,t)=>{const o=e.dom;if(o.nodeType!==1)return!1;{const r=o;if(r.matches!==void 0)return r.matches(t);if(r.msMatchesSelector!==void 0)return r.msMatchesSelector(t);if(r.webkitMatchesSelector!==void 0)return r.webkitMatchesSelector(t);if(r.mozMatchesSelector!==void 0)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}};typeof window!="undefined"||Function("return this;")();const f=e=>t=>(o=>o.dom.nodeType)(t)===e,D=f(1),z=f(3),F=f(9),I=f(11),O=(e,t)=>{e.dom.removeAttribute(t)},K=g(Element.prototype.attachShadow)&&g(Node.prototype.getRootNode)?e=>d(e.dom.getRootNode()):e=>F(e)?e:d(e.dom.ownerDocument),U=e=>d(e.dom.host),k=e=>{const t=z(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const o=t.ownerDocument;return(s=>{const i=K(s);return I(u=i)&&A(u.dom.host)?l.some(i):l.none();var u})(d(t)).fold(()=>o.body.contains(t),(r=k,n=U,s=>r(n(s))));var r,n},b=e=>((t,o)=>{const r=t.dom,n=window.getComputedStyle(r).getPropertyValue(o);return n!==""||k(t)?n:((s,i)=>(u=>u.style!==void 0&&g(u.style.getPropertyValue))(s)?s.style.getPropertyValue(i):"")(r,o)})(e,"direction")==="rtl"?"rtl":"ltr",$=(e,t)=>((o,r)=>((n,s)=>{const i=[];for(let u=0,a=n.length;u<a;u++){const c=n[u];s(c,u)&&i.push(c)}return i})(((n,s)=>{const i=n.length,u=new Array(i);for(let a=0;a<i;a++){const c=n[a];u[a]=s(c,a)}return u})(o.dom.childNodes,d),n=>C(n,t)))(e),q=e=>D(e)&&e.dom.nodeName.toLowerCase()==="li",M=(e,t)=>{const o=e.selection.getSelectedBlocks();o.length>0&&(T(o,r=>{const n=d(r),s=q(n),i=((a,c)=>{return(c?(h=a,v="ol,ul",((y,m,E)=>{let w=y.dom;const G=g(E)?E:x;for(;w.parentNode;){w=w.parentNode;const S=d(w);if(C(S,v))return l.some(S);if(G(S))break}return l.none()})(h,0,p)):l.some(a)).getOr(a);var h,v,p})(n,s);var u;(u=i,(a=>l.from(a.dom.parentNode).map(d))(u).filter(D)).each(a=>{if(b(a)!==t?((c,h,v)=>{((p,y,m)=>{if(!(P(m)||B(m)||V(m)))throw console.error("Invalid call to Attribute.set. Key ",y,":: Value ",m,":: Element ",p),new Error("Attribute value was not simple");p.setAttribute(y,m+"")})(c.dom,h,v)})(i,"dir",t):b(i)!==t&&O(i,"dir"),s){const c=$(i,"li[dir]");T(c,h=>O(h,"dir"))}})}),e.nodeChanged())},R=(e,t)=>o=>{const r=n=>{const s=d(n.element);o.setActive(b(s)===t)};return e.on("NodeChange",r),()=>e.off("NodeChange",r)};L.add("directionality",e=>{(t=>{t.addCommand("mceDirectionLTR",()=>{M(t,"ltr")}),t.addCommand("mceDirectionRTL",()=>{M(t,"rtl")})})(e),(t=>{t.ui.registry.addToggleButton("ltr",{tooltip:"Left to right",icon:"ltr",onAction:()=>t.execCommand("mceDirectionLTR"),onSetup:R(t,"ltr")}),t.ui.registry.addToggleButton("rtl",{tooltip:"Right to left",icon:"rtl",onAction:()=>t.execCommand("mceDirectionRTL"),onSetup:R(t,"rtl")})})(e)})})();
