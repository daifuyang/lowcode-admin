var mO=Object.prototype.hasOwnProperty;var rx=Object.getOwnPropertySymbols,fO=Object.prototype.propertyIsEnumerable;var K=Object.assign;var sx=(gn,Yn)=>{var Zr={};for(var Ke in gn)mO.call(gn,Ke)&&Yn.indexOf(Ke)<0&&(Zr[Ke]=gn[Ke]);if(gn!=null&&rx)for(var Ke of rx(gn))Yn.indexOf(Ke)<0&&fO.call(gn,Ke)&&(Zr[Ke]=gn[Ke]);return Zr};(function(){"use strict";var gn=function(t){if(t===null)return"null";if(t===void 0)return"undefined";var e=typeof t;return e==="object"&&(Array.prototype.isPrototypeOf(t)||t.constructor&&t.constructor.name==="Array")?"array":e==="object"&&(String.prototype.isPrototypeOf(t)||t.constructor&&t.constructor.name==="String")?"string":e},Yn=function(t){return{eq:t}},Zr=Yn(function(t,e){return t===e}),Ke=function(t){return Yn(function(e,n){if(e.length!==n.length)return!1;for(var o=e.length,r=0;r<o;r++)if(!t.eq(e[r],n[r]))return!1;return!0})},Km=function(t){return Yn(function(e,n){var o=Object.keys(e),r=Object.keys(n);if(!function(l,d){return function(c,u){return Yn(function(g,p){return c.eq(u(g),u(p))})}(Ke(l),function(c){return function(u,g){return Array.prototype.slice.call(u).sort(g)}(c,d)})}(Zr).eq(o,r))return!1;for(var s=o.length,a=0;a<s;a++){var i=o[a];if(!t.eq(e[i],n[i]))return!1}return!0})},Pl=Yn(function(t,e){if(t===e)return!0;var n=gn(t);return n===gn(e)&&(function(o){return["undefined","boolean","number","string","function","xml","null"].indexOf(o)!==-1}(n)?t===e:n==="array"?Ke(Pl).eq(t,e):n==="object"&&Km(Pl).eq(t,e))});const ax=Object.getPrototypeOf,Gm=(t,e,n)=>{var o;return!!n(t,e.prototype)||((o=t.constructor)===null||o===void 0?void 0:o.name)===e.name},Ll=t=>e=>(n=>{const o=typeof n;return n===null?"null":o==="object"&&Array.isArray(n)?"array":o==="object"&&Gm(n,String,(r,s)=>s.isPrototypeOf(r))?"string":o})(e)===t,Ml=t=>e=>typeof e===t,Ym=t=>e=>t===e,Sa=(t,e)=>me(t)&&Gm(t,e,(n,o)=>ax(n)===o),it=Ll("string"),me=Ll("object"),Xm=t=>Sa(t,Object),$t=Ll("array"),wo=Ym(null),xo=Ml("boolean"),fe=Ym(void 0),jt=t=>t==null,Q=t=>!jt(t),wt=Ml("function"),Je=Ml("number"),cr=(t,e)=>{if($t(t)){for(let n=0,o=t.length;n<o;++n)if(!e(t[n]))return!1;return!0}return!1},bt=()=>{},ko=(t,e)=>(...n)=>t(e.apply(null,n)),Qm=(t,e)=>n=>t(e(n)),Y=t=>()=>t,ge=t=>t,ix=(t,e)=>t===e;function tt(t,...e){return(...n)=>{const o=e.concat(n);return t.apply(null,o)}}const Ea=t=>e=>!t(e),Il=t=>t(),ts=t=>{t()},Dt=Y(!1),Ht=Y(!0);class C{constructor(e,n){this.tag=e,this.value=n}static some(e){return new C(!0,e)}static none(){return C.singletonNone}fold(e,n){return this.tag?n(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?C.some(e(this.value)):C.none()}bind(e){return this.tag?e(this.value):C.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:C.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e!=null?e:"Called getOrDie on None")}static from(e){return Q(e)?C.some(e):C.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}C.singletonNone=new C(!1);const Fl=Array.prototype.slice,lx=Array.prototype.indexOf,dx=Array.prototype.push,Jm=(t,e)=>lx.call(t,e),_t=(t,e)=>Jm(t,e)>-1,It=(t,e)=>{for(let n=0,o=t.length;n<o;n++)if(e(t[n],n))return!0;return!1},yt=(t,e)=>{const n=t.length,o=new Array(n);for(let r=0;r<n;r++){const s=t[r];o[r]=e(s,r)}return o},H=(t,e)=>{for(let n=0,o=t.length;n<o;n++)e(t[n],n)},Zm=(t,e)=>{for(let n=t.length-1;n>=0;n--)e(t[n],n)},es=(t,e)=>{const n=[],o=[];for(let r=0,s=t.length;r<s;r++){const a=t[r];(e(a,r)?n:o).push(a)}return{pass:n,fail:o}},mt=(t,e)=>{const n=[];for(let o=0,r=t.length;o<r;o++){const s=t[o];e(s,o)&&n.push(s)}return n},_a=(t,e,n)=>(Zm(t,(o,r)=>{n=e(n,o,r)}),n),Re=(t,e,n)=>(H(t,(o,r)=>{n=e(n,o,r)}),n),tf=(t,e,n)=>{for(let o=0,r=t.length;o<r;o++){const s=t[o];if(e(s,o))return C.some(s);if(n(s,o))break}return C.none()},Wt=(t,e)=>tf(t,e,Dt),ns=(t,e)=>{for(let n=0,o=t.length;n<o;n++)if(e(t[n],n))return C.some(n);return C.none()},ef=t=>{const e=[];for(let n=0,o=t.length;n<o;++n){if(!$t(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);dx.apply(e,t[n])}return e},Ln=(t,e)=>ef(yt(t,e)),So=(t,e)=>{for(let n=0,o=t.length;n<o;++n)if(e(t[n],n)!==!0)return!1;return!0},os=t=>{const e=Fl.call(t,0);return e.reverse(),e},Ul=(t,e)=>mt(t,n=>!_t(e,n)),zl=(t,e)=>{const n={};for(let o=0,r=t.length;o<r;o++){const s=t[o];n[String(s)]=e(s,o)}return n},ur=(t,e)=>{const n=Fl.call(t,0);return n.sort(e),n},Na=(t,e)=>e>=0&&e<t.length?C.some(t[e]):C.none(),xe=t=>Na(t,0),Eo=t=>Na(t,t.length-1),Ae=wt(Array.from)?Array.from:t=>Fl.call(t),mr=(t,e)=>{for(let n=0;n<t.length;n++){const o=e(t[n],n);if(o.isSome())return o}return C.none()},Oe=Object.keys,cx=Object.hasOwnProperty,Nt=(t,e)=>{const n=Oe(t);for(let o=0,r=n.length;o<r;o++){const s=n[o];e(t[s],s)}},Ra=(t,e)=>ux(t,(n,o)=>({k:o,v:e(n,o)})),ux=(t,e)=>{const n={};return Nt(t,(o,r)=>{const s=e(o,r);n[s.k]=s.v}),n},jl=t=>(e,n)=>{t[n]=e},nf=(t,e,n,o)=>{Nt(t,(r,s)=>{(e(r,s)?n:o)(r,s)})},rs=(t,e)=>{const n={};return nf(t,e,jl(n),bt),n},Hl=(t,e)=>{const n=[];return Nt(t,(o,r)=>{n.push(e(o,r))}),n},$l=t=>Hl(t,ge),At=(t,e)=>pt(t,e)?C.from(t[e]):C.none(),pt=(t,e)=>cx.call(t,e),fr=(t,e)=>pt(t,e)&&t[e]!==void 0&&t[e]!==null,of=t=>{const e={};return H(t,n=>{e[n]={}}),Oe(e)},rf=t=>t.length!==void 0,Vl=Array.isArray,Aa=(t,e,n)=>{if(!t)return!1;if(n=n||t,rf(t)){for(let o=0,r=t.length;o<r;o++)if(e.call(n,t[o],o,t)===!1)return!1}else for(const o in t)if(pt(t,o)&&e.call(n,t[o],o,t)===!1)return!1;return!0},ql=(t,e)=>{const n=[];return Aa(t,(o,r)=>{n.push(e(o,r,t))}),n},ss=(t,e)=>{const n=[];return Aa(t,(o,r)=>{e&&!e(o,r,t)||n.push(o)}),n},Oa=(t,e,n,o)=>{let r=fe(n)?t[0]:n;for(let s=0;s<t.length;s++)r=e.call(o,r,t[s],s);return r},sf=(t,e,n)=>{for(let o=0,r=t.length;o<r;o++)if(e.call(n,t[o],o,t))return o;return-1},_o=t=>t[t.length-1],No=t=>{let e,n=!1;return(...o)=>(n||(n=!0,e=t.apply(null,o)),e)},af=()=>Wl(0,0),Wl=(t,e)=>({major:t,minor:e}),as={nu:Wl,detect:(t,e)=>{const n=String(e).toLowerCase();return t.length===0?af():((o,r)=>{const s=((i,l)=>{for(let d=0;d<i.length;d++){const c=i[d];if(c.test(l))return c}})(o,r);if(!s)return{major:0,minor:0};const a=i=>Number(r.replace(s,"$"+i));return Wl(a(1),a(2))})(t,n)},unknown:af},lf=(t,e)=>{const n=String(e).toLowerCase();return Wt(t,o=>o.search(n))},df=(t,e,n)=>e===""||t.length>=e.length&&t.substr(n,n+e.length)===e,se=(t,e,n=0,o)=>{const r=t.indexOf(e,n);return r!==-1&&(!!fe(o)||r+e.length<=o)},ee=(t,e)=>df(t,e,0),cf=(t,e)=>df(t,e,t.length-e.length),Kl=t=>e=>e.replace(t,""),gr=Kl(/^\s+|\s+$/g),mx=Kl(/^\s+/g),uf=Kl(/\s+$/g),pn=t=>t.length>0,is=t=>!pn(t),Ta=(t,e=10)=>{const n=parseInt(t,e);return isNaN(n)?C.none():C.some(n)},Gl=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Mn=t=>e=>se(e,t),fx=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:t=>se(t,"edge/")&&se(t,"chrome")&&se(t,"safari")&&se(t,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Gl],search:t=>se(t,"chrome")&&!se(t,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:t=>se(t,"msie")||se(t,"trident")},{name:"Opera",versionRegexes:[Gl,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Mn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Mn("firefox")},{name:"Safari",versionRegexes:[Gl,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:t=>(se(t,"safari")||se(t,"mobile/"))&&se(t,"applewebkit")}],gx=[{name:"Windows",search:Mn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:t=>se(t,"iphone")||se(t,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Mn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Mn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Mn("linux"),versionRegexes:[]},{name:"Solaris",search:Mn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Mn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Mn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],mf={browsers:Y(fx),oses:Y(gx)},ff="Edge",gf="Chromium",pf="Opera",hf="Firefox",bf="Safari",vf=t=>{const e=t.current,n=t.version,o=r=>()=>e===r;return{current:e,version:n,isEdge:o(ff),isChromium:o(gf),isIE:o("IE"),isOpera:o(pf),isFirefox:o(hf),isSafari:o(bf)}},px=()=>vf({current:void 0,version:as.unknown()}),hx=vf,yf=(Y(ff),Y(gf),Y("IE"),Y(pf),Y(hf),Y(bf),"Windows"),Cf="Android",wf="Linux",xf="macOS",kf="Solaris",Sf="FreeBSD",Ef="ChromeOS",_f=t=>{const e=t.current,n=t.version,o=r=>()=>e===r;return{current:e,version:n,isWindows:o(yf),isiOS:o("iOS"),isAndroid:o(Cf),isMacOS:o(xf),isLinux:o(wf),isSolaris:o(kf),isFreeBSD:o(Sf),isChromeOS:o(Ef)}},bx=()=>_f({current:void 0,version:as.unknown()}),vx=_f,yx=(Y(yf),Y("iOS"),Y(Cf),Y(wf),Y(xf),Y(kf),Y(Sf),Y(Ef),t=>window.matchMedia(t).matches);let Cx=No(()=>((t,e,n)=>{const o=mf.browsers(),r=mf.oses(),s=e.bind(l=>((d,c)=>mr(c.brands,u=>{const g=u.brand.toLowerCase();return Wt(d,p=>{var m;return g===((m=p.brand)===null||m===void 0?void 0:m.toLowerCase())}).map(p=>({current:p.name,version:as.nu(parseInt(u.version,10),0)}))}))(o,l)).orThunk(()=>((l,d)=>lf(l,d).map(c=>{const u=as.detect(c.versionRegexes,d);return{current:c.name,version:u}}))(o,t)).fold(px,hx),a=((l,d)=>lf(l,d).map(c=>{const u=as.detect(c.versionRegexes,d);return{current:c.name,version:u}}))(r,t).fold(bx,vx),i=((l,d,c,u)=>{const g=l.isiOS()&&/ipad/i.test(c)===!0,p=l.isiOS()&&!g,m=l.isiOS()||l.isAndroid(),h=m||u("(pointer:coarse)"),f=g||!p&&m&&u("(min-device-width:768px)"),b=p||m&&!f,v=d.isSafari()&&l.isiOS()&&/safari/i.test(c)===!1,y=!b&&!f&&!v;return{isiPad:Y(g),isiPhone:Y(p),isTablet:Y(f),isPhone:Y(b),isTouch:Y(h),isAndroid:l.isAndroid,isiOS:l.isiOS,isWebView:Y(v),isDesktop:Y(y)}})(a,s,t,n);return{browser:s,os:a,deviceType:i}})(navigator.userAgent,C.from(navigator.userAgentData),yx));const Ro=()=>Cx(),wx=navigator.userAgent,Yl=Ro(),hn=Yl.browser,bn=Yl.os,Ao=Yl.deviceType,xx=wx.indexOf("Windows Phone")!==-1,Ct={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:hn.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!hn.isIE(),windowsPhone:xx,browser:{current:hn.current,version:hn.version,isChromium:hn.isChromium,isEdge:hn.isEdge,isFirefox:hn.isFirefox,isIE:hn.isIE,isOpera:hn.isOpera,isSafari:hn.isSafari},os:{current:bn.current,version:bn.version,isAndroid:bn.isAndroid,isChromeOS:bn.isChromeOS,isFreeBSD:bn.isFreeBSD,isiOS:bn.isiOS,isLinux:bn.isLinux,isMacOS:bn.isMacOS,isSolaris:bn.isSolaris,isWindows:bn.isWindows},deviceType:{isDesktop:Ao.isDesktop,isiPad:Ao.isiPad,isiPhone:Ao.isiPhone,isPhone:Ao.isPhone,isTablet:Ao.isTablet,isTouch:Ao.isTouch,isWebView:Ao.isWebView}},kx=/^\s*|\s*$/g,Nf=t=>jt(t)?"":(""+t).replace(kx,""),Rf=function(t,e,n,o){o=o||this,t&&(n&&(t=t[n]),Aa(t,(r,s)=>e.call(o,r,s,n)!==!1&&(Rf(r,e,n,o),!0)))},$={trim:Nf,isArray:Vl,is:(t,e)=>e?!(e!=="array"||!Vl(t))||typeof t===e:t!==void 0,toArray:t=>{if(Vl(t))return t;{const e=[];for(let n=0,o=t.length;n<o;n++)e[n]=t[n];return e}},makeMap:(t,e,n={})=>{const o=it(t)?t.split(e||","):t||[];let r=o.length;for(;r--;)n[o[r]]={};return n},each:Aa,map:ql,grep:ss,inArray:(t,e)=>{if(t){for(let n=0,o=t.length;n<o;n++)if(t[n]===e)return n}return-1},hasOwn:pt,extend:(t,...e)=>{for(let n=0;n<e.length;n++){const o=e[n];for(const r in o)if(pt(o,r)){const s=o[r];s!==void 0&&(t[r]=s)}}return t},walk:Rf,resolve:(t,e=window)=>{const n=t.split(".");for(let o=0,r=n.length;o<r&&(e=e[n[o]]);o++);return e},explode:(t,e)=>$t(t)?t:t===""?[]:ql(t.split(e||","),Nf),_addCacheSuffix:t=>{const e=Ct.cacheSuffix;return e&&(t+=(t.indexOf("?")===-1?"?":"&")+e),t}},pr=(t,e,n=ix)=>t.exists(o=>n(o,e)),pe=(t,e,n)=>t.isSome()&&e.isSome()?C.some(n(t.getOrDie(),e.getOrDie())):C.none(),ls=(t,e)=>t?C.some(e):C.none();typeof window!="undefined"||Function("return this;")();const Ot=t=>t.dom.nodeName.toLowerCase(),Af=t=>t.dom.nodeType,Ba=t=>e=>Af(e)===t,Te=Ba(1),Le=Ba(3),Sx=Ba(9),Ex=Ba(11),Xl=t=>e=>Te(e)&&Ot(e)===t,Of=(t,e,n)=>{if(!(it(n)||xo(n)||Je(n)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")},Qt=(t,e,n)=>{Of(t.dom,e,n)},Xn=(t,e)=>{const n=t.dom;Nt(e,(o,r)=>{Of(n,r,o)})},Ge=(t,e)=>{const n=t.dom.getAttribute(e);return n===null?void 0:n},In=(t,e)=>C.from(Ge(t,e)),Da=(t,e)=>{const n=t.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},ne=(t,e)=>{t.dom.removeAttribute(e)},Tf=t=>Re(t.dom.attributes,(e,n)=>(e[n.name]=n.value,e),{}),Ql=(t,e)=>{const n=Ge(t,e);return n===void 0||n===""?[]:n.split(" ")},ds=t=>t.dom.classList!==void 0,Bf=t=>Ql(t,"class"),Df=(t,e)=>((n,o,r)=>{const s=Ql(n,o).concat([r]);return Qt(n,o,s.join(" ")),!0})(t,"class",e),Pf=(t,e)=>((n,o,r)=>{const s=mt(Ql(n,o),a=>a!==r);return s.length>0?Qt(n,o,s.join(" ")):ne(n,o),!1})(t,"class",e),cs=(t,e)=>{ds(t)?t.dom.classList.add(e):Df(t,e)},Lf=t=>{(ds(t)?t.dom.classList:Bf(t)).length===0&&ne(t,"class")},Pa=(t,e)=>{ds(t)?t.dom.classList.remove(e):Pf(t,e),Lf(t)},Jl=(t,e)=>ds(t)&&t.dom.classList.contains(e),us=t=>t.style!==void 0&&wt(t.style.getPropertyValue),ms=t=>{if(t==null)throw new Error("Node cannot be null or undefined");return{dom:t}},La=(t,e)=>{const n=(e||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||n.childNodes.length>1){const o="HTML does not have a single root node";throw console.error(o,t),new Error(o)}return ms(n.childNodes[0])},Jt=(t,e)=>{const n=(e||document).createElement(t);return ms(n)},hr=(t,e)=>{const n=(e||document).createTextNode(t);return ms(n)},N=ms,_x=(t,e,n)=>C.from(t.dom.elementFromPoint(e,n)).map(ms),Mf=(t,e)=>{const n=[],o=s=>(n.push(s),e(s));let r=e(t);do r=r.bind(o);while(r.isSome());return n},Ze=(t,e)=>{const n=t.dom;if(n.nodeType!==1)return!1;{const o=n;if(o.matches!==void 0)return o.matches(e);if(o.msMatchesSelector!==void 0)return o.msMatchesSelector(e);if(o.webkitMatchesSelector!==void 0)return o.webkitMatchesSelector(e);if(o.mozMatchesSelector!==void 0)return o.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}},If=t=>t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11||t.childElementCount===0,xt=(t,e)=>t.dom===e.dom,Fn=(t,e)=>{const n=t.dom,o=e.dom;return n!==o&&n.contains(o)},Ff=t=>N(t.dom.ownerDocument),Un=t=>Sx(t)?t:Ff(t),fs=t=>N(Un(t).dom.defaultView),tn=t=>C.from(t.dom.parentNode).map(N),Uf=t=>C.from(t.dom.parentElement).map(N),zf=(t,e)=>{const n=wt(e)?e:Dt;let o=t.dom;const r=[];for(;o.parentNode!==null&&o.parentNode!==void 0;){const s=o.parentNode,a=N(s);if(r.push(a),n(a)===!0)break;o=s}return r},Oo=t=>C.from(t.dom.previousSibling).map(N),gs=t=>C.from(t.dom.nextSibling).map(N),jf=t=>os(Mf(t,Oo)),Hf=t=>Mf(t,gs),oe=t=>yt(t.dom.childNodes,N),Ma=(t,e)=>{const n=t.dom.childNodes;return C.from(n[e]).map(N)},$f=t=>Ma(t,0),Zl=t=>Ma(t,t.dom.childNodes.length-1),Vf=t=>t.dom.childNodes.length,td=t=>Ex(t)&&Q(t.dom.host),qf=wt(Element.prototype.attachShadow)&&wt(Node.prototype.getRootNode),Nx=Y(qf),Qn=qf?t=>N(t.dom.getRootNode()):Un,ed=t=>td(t)?t:(e=>{const n=e.dom.head;if(n==null)throw new Error("Head is not available yet");return N(n)})(Un(t)),Rx=t=>N(t.dom.host),Wf=t=>{if(Nx()&&Q(t.target)){const e=N(t.target);if(Te(e)&&Ax(e)&&t.composed&&t.composedPath){const n=t.composedPath();if(n)return xe(n)}}return C.from(t.target)},Ax=t=>Q(t.dom.shadowRoot),br=t=>{const e=Le(t)?t.dom.parentNode:t.dom;if(e==null||e.ownerDocument===null)return!1;const n=e.ownerDocument;return(o=>{const r=Qn(o);return td(r)?C.some(r):C.none()})(N(e)).fold(()=>n.body.contains(e),Qm(br,Rx))},Kf=(t,e,n)=>{if(!it(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);us(t)&&t.style.setProperty(e,n)},Gf=(t,e,n)=>{const o=t.dom;Kf(o,e,n)},Ia=(t,e)=>{const n=t.dom;Nt(e,(o,r)=>{Kf(n,r,o)})},vn=(t,e)=>{const n=t.dom,o=window.getComputedStyle(n).getPropertyValue(e);return o!==""||br(t)?o:Yf(n,e)},Yf=(t,e)=>us(t)?t.style.getPropertyValue(e):"",Fa=(t,e)=>{const n=t.dom,o=Yf(n,e);return C.from(o).filter(r=>r.length>0)},Xf=t=>{const e={},n=t.dom;if(us(n))for(let o=0;o<n.style.length;o++){const r=n.style.item(o);e[r]=n.style[r]}return e},Qf=(t,e)=>{((n,o)=>{us(n)&&n.style.removeProperty(o)})(t.dom,e),pr(In(t,"style").map(gr),"")&&ne(t,"style")},Me=(t,e)=>{tn(t).each(n=>{n.dom.insertBefore(e.dom,t.dom)})},Jn=(t,e)=>{gs(t).fold(()=>{tn(t).each(n=>{Kt(n,e)})},n=>{Me(n,e)})},Jf=(t,e)=>{$f(t).fold(()=>{Kt(t,e)},n=>{t.dom.insertBefore(e.dom,n.dom)})},Kt=(t,e)=>{t.dom.appendChild(e.dom)},To=(t,e)=>{H(e,n=>{Kt(t,n)})},ps=t=>{t.dom.textContent="",H(oe(t),e=>{Tt(e)})},Tt=t=>{const e=t.dom;e.parentNode!==null&&e.parentNode.removeChild(e)},Zn=t=>{const e=oe(t);var n,o;e.length>0&&(n=t,H(o=e,(r,s)=>{const a=s===0?n:o[s-1];Jn(a,r)})),Tt(t)},Zf=t=>yt(t,N),tg=t=>t.dom.innerHTML,Ua=(t,e)=>{const n=Ff(t).dom,o=N(n.createDocumentFragment()),r=((s,a)=>{const i=(a||document).createElement("div");return i.innerHTML=s,oe(N(i))})(e,n);To(o,r),ps(t),Kt(t,o)},Ox=(t,e,n,o)=>((r,s,a,i,l)=>{const d=((c,u)=>g=>{c(g)&&u((p=>{const m=N(Wf(p).getOr(p.target)),h=()=>p.stopPropagation(),f=()=>p.preventDefault(),b=ko(f,h);return((v,y,w,k,x,E,S)=>({target:v,x:y,y:w,stop:k,prevent:x,kill:E,raw:S}))(m,p.clientX,p.clientY,h,f,b,p)})(g))})(a,i);return r.dom.addEventListener(s,d,!1),{unbind:tt(Tx,r,s,d,!1)}})(t,e,n,o),Tx=(t,e,n,o)=>{t.dom.removeEventListener(e,n,o)},eg=(t,e)=>({left:t,top:e,translate:(n,o)=>eg(t+n,e+o)}),vr=eg,za=(t,e)=>t!==void 0?t:e!==void 0?e:0,nd=t=>{const e=t.dom,n=e.ownerDocument.body;return n===e?vr(n.offsetLeft,n.offsetTop):br(t)?(o=>{const r=o.getBoundingClientRect();return vr(r.left,r.top)})(e):vr(0,0)},od=t=>{const e=t!==void 0?t.dom:document,n=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop;return vr(n,o)},ng=(t,e,n)=>{const o=(n!==void 0?n.dom:document).defaultView;o&&o.scrollTo(t,e)},og=(t,e)=>{Ro().browser.isSafari()&&wt(t.dom.scrollIntoViewIfNeeded)?t.dom.scrollIntoViewIfNeeded(!1):t.dom.scrollIntoView(e)},rg=(t,e,n,o)=>({x:t,y:e,width:n,height:o,right:t+n,bottom:e+o}),sg=t=>{const e=t===void 0?window:t,n=e.document,o=od(N(n));return(r=>{const s=r===void 0?window:r;return Ro().browser.isFirefox()?C.none():C.from(s.visualViewport)})(e).fold(()=>{const r=e.document.documentElement,s=r.clientWidth,a=r.clientHeight;return rg(o.left,o.top,s,a)},r=>rg(Math.max(r.pageLeft,o.left),Math.max(r.pageTop,o.top),r.width,r.height))},ag=(t,e)=>{let n=[];return H(oe(t),o=>{e(o)&&(n=n.concat([o])),n=n.concat(ag(o,e))}),n};var ig=(t,e,n,o,r)=>t(n,o)?C.some(n):wt(r)&&r(n)?C.none():e(n,o,r);const to=(t,e,n)=>{let o=t.dom;const r=wt(n)?n:Dt;for(;o.parentNode;){o=o.parentNode;const s=N(o);if(e(s))return C.some(s);if(r(s))break}return C.none()},Bo=(t,e,n)=>ig((o,r)=>r(o),to,t,e,n),hs=(t,e,n)=>to(t,o=>Ze(o,e),n),bs=(t,e)=>((n,o)=>{const r=o===void 0?document:o.dom;return If(r)?C.none():C.from(r.querySelector(n)).map(N)})(e,t),Do=(t,e,n)=>ig((o,r)=>Ze(o,r),hs,t,e,n),lg=(t,e,n)=>hs(t,e,n).isSome();class Vt{constructor(e,n){this.node=e,this.rootNode=n,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node}prev(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node}prev2(e){return this.node=this.findPreviousNode(this.node,e),this.node}findSibling(e,n,o,r){if(e){if(!r&&e[n])return e[n];if(e!==this.rootNode){let s=e[o];if(s)return s;for(let a=e.parentNode;a&&a!==this.rootNode;a=a.parentNode)if(s=a[o],s)return s}}}findPreviousNode(e,n){if(e){const o=e.previousSibling;if(this.rootNode&&o===this.rootNode)return;if(o){if(!n){for(let s=o.lastChild;s;s=s.lastChild)if(!s.lastChild)return s}return o}const r=e.parentNode;if(r&&r!==this.rootNode)return r}}}const Po=t=>e=>!!e&&e.nodeType===t,ja=t=>!!t&&!Object.getPrototypeOf(t),J=Po(1),rd=t=>{const e=t.toLowerCase();return n=>Q(n)&&n.nodeName.toLowerCase()===e},en=t=>{const e=t.map(n=>n.toLowerCase());return n=>{if(n&&n.nodeName){const o=n.nodeName.toLowerCase();return _t(e,o)}return!1}},Ha=(t,e)=>{const n=e.toLowerCase().split(" ");return o=>{if(J(o)){const r=o.ownerDocument.defaultView;if(r)for(let s=0;s<n.length;s++){const a=r.getComputedStyle(o,null);if((a?a.getPropertyValue(t):null)===n[s])return!0}}return!1}},dg=t=>e=>J(e)&&e.hasAttribute(t),Lo=t=>J(t)&&t.hasAttribute("data-mce-bogus"),zn=t=>J(t)&&t.tagName==="TABLE",cg=t=>e=>!!(J(e)&&(e.contentEditable===t||e.getAttribute("data-mce-contenteditable")===t)),sd=en(["textarea","input"]),j=Po(3),Bx=Po(4),Dx=Po(7),eo=Po(8),vs=Po(9),ad=Po(11),Ft=rd("br"),ug=rd("img"),nn=cg("true"),Rt=cg("false"),$a=en(["td","th"]),mg=en(["td","th","caption"]),yn=en(["video","audio","object","embed"]),Px=rd("li"),ys="\uFEFF",Zt="\xA0",fg=t=>t===ys,le=(t,e)=>((n,o)=>{const r=o===void 0?document:o.dom;return If(r)?[]:yt(r.querySelectorAll(n),N)})(e,t),gg=((t,e)=>{const n=o=>t(o)?C.from(o.dom.nodeValue):C.none();return{get:o=>{if(!t(o))throw new Error("Can only get text value of a text node");return n(o).getOr("")},getOption:n,set:(o,r)=>{if(!t(o))throw new Error("Can only set raw text value of a text node");o.dom.nodeValue=r}}})(Le),id=t=>gg.get(t),pg=t=>gg.getOption(t),Lx=["pre"].concat(["h1","h2","h3","h4","h5","h6"]),no=t=>{let e;return n=>(e=e||zl(t,Ht),pt(e,Ot(n)))},on=no(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),ld=t=>Te(t)&&!on(t),Mo=t=>Te(t)&&Ot(t)==="br",hg=no(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),dd=no(["ul","ol","dl"]),Cs=no(["li","dd","dt"]),Mx=no(["thead","tbody","tfoot"]),ws=no(["td","th"]),Va=no(["pre","script","textarea","style"]),Ix=no(Lx),Fx=t=>Ix(t)||ld(t),cd=()=>{const t=Jt("br");return Qt(t,"data-mce-bogus","1"),t},Io=t=>{ps(t),Kt(t,cd())},Ux=t=>{Zl(t).each(e=>{Oo(e).each(n=>{on(t)&&Mo(e)&&on(n)&&Tt(e)})})},ae=ys,qa=fg,jn=t=>t.replace(/\uFEFF/g,""),zx=J,yr=j,Cr=t=>(yr(t)&&(t=t.parentNode),zx(t)&&t.hasAttribute("data-mce-caret")),oo=t=>yr(t)&&qa(t.data),Ie=t=>Cr(t)||oo(t),bg=t=>t.firstChild!==t.lastChild||!Ft(t.firstChild),ud=t=>{const e=t.container();return!!j(e)&&(e.data.charAt(t.offset())===ae||t.isAtStart()&&oo(e.previousSibling))},md=t=>{const e=t.container();return!!j(e)&&(e.data.charAt(t.offset()-1)===ae||t.isAtEnd()&&oo(e.nextSibling))},Wa=t=>yr(t)&&t.data[0]===ae,Ka=t=>yr(t)&&t.data[t.data.length-1]===ae,fd=t=>t&&t.hasAttribute("data-mce-caret")?((e=>{var n;const o=e.getElementsByTagName("br"),r=o[o.length-1];Lo(r)&&((n=r.parentNode)===null||n===void 0||n.removeChild(r))})(t),t.removeAttribute("data-mce-caret"),t.removeAttribute("data-mce-bogus"),t.removeAttribute("style"),t.removeAttribute("data-mce-style"),t.removeAttribute("_moz_abspos"),t):null,vg=t=>Cr(t.startContainer),yg=nn,jx=Rt,Hx=Ft,$x=j,Vx=en(["script","style","textarea"]),Cg=en(["img","input","textarea","hr","iframe","video","audio","object","embed"]),qx=en(["table"]),Wx=Ie,Ye=t=>!Wx(t)&&($x(t)?!Vx(t.parentNode):Cg(t)||Hx(t)||qx(t)||gd(t)),gd=t=>!(e=>J(e)&&e.getAttribute("unselectable")==="true")(t)&&jx(t),wg=(t,e)=>Ye(t)&&((n,o)=>{for(let r=n.parentNode;r&&r!==o;r=r.parentNode){if(gd(r))return!1;if(yg(r))return!0}return!0})(t,e),Kx=/^[ \t\r\n]*$/,Fo=t=>Kx.test(t),xg=t=>t===`
`||t==="\r",kg=(t,e=4,n=!0,o=!0)=>{const r=((i,l)=>l<=0?"":new Array(l+1).join(" "))(0,e),s=t.replace(/\t/g,r);return Re(s,(i,l)=>(d=>" \f	\v".indexOf(d)!==-1)(l)||l===Zt?i.pcIsSpace||i.str===""&&n||i.str.length===s.length-1&&o||((d,c)=>c<d.length&&c>=0&&xg(d[c]))(s,i.str.length+1)?{pcIsSpace:!1,str:i.str+Zt}:{pcIsSpace:!0,str:i.str+" "}:{pcIsSpace:xg(l),str:i.str+l},{pcIsSpace:!1,str:""}).str},Ga=(t,e)=>Ye(t)&&!((n,o)=>j(n)&&Fo(n.data)&&!((r,s)=>{const a=N(s),i=N(r);return lg(i,"pre,code",tt(xt,a))})(n,o))(t,e)||(n=>J(n)&&n.nodeName==="A"&&!n.hasAttribute("href")&&(n.hasAttribute("name")||n.hasAttribute("id")))(t)||Gx(t),Gx=dg("data-mce-bookmark"),Yx=dg("data-mce-bogus"),Xx=t=>J(t)&&t.getAttribute("data-mce-bogus")==="all",Ut=(t,e=!0)=>((n,o)=>{let r=0;if(Ga(n,n))return!1;{let s=n.firstChild;if(!s)return!0;const a=new Vt(s,n);do{if(o){if(Xx(s)){s=a.next(!0);continue}if(Yx(s)){s=a.next();continue}}if(Ft(s))r++,s=a.next();else{if(Ga(s,n))return!1;s=a.next()}}while(s);return r<=1}})(t.dom,e),xs="data-mce-block",pd=t=>(e=>mt(Oe(e),n=>!/[A-Z]/.test(n)))(t).join(","),Sg=(t,e)=>Q(e.querySelector(t))?(e.setAttribute(xs,"true"),e.getAttribute("data-mce-selected")==="inline-boundary"&&e.removeAttribute("data-mce-selected"),!0):(e.removeAttribute(xs),!1),Eg=(t,e)=>{const n=pd(t.getTransparentElements()),o=pd(t.getBlockElements());return mt(e.querySelectorAll(n),r=>Sg(o,r))},_g=(t,e)=>{var n;const o=e?"lastChild":"firstChild";for(let r=t[o];r;r=r[o])if(Ut(N(r)))return void((n=r.parentNode)===null||n===void 0||n.removeChild(r))},Qx=(t,e,n)=>{const o=t.getBlockElements(),r=N(e),s=i=>Ot(i)in o,a=i=>xt(i,r);H(Zf(n),i=>{to(i,s,a).each(l=>{const d=((c,u)=>mt(oe(c),g=>s(g)&&!t.isValidChild(Ot(l),Ot(g))))(i);if(d.length>0){const c=Uf(l);H(d,u=>{to(u,s,a).each(g=>{((p,m)=>{const h=document.createRange(),f=p.parentNode;if(f){h.setStartBefore(p),h.setEndBefore(m);const b=h.extractContents();_g(b,!0),h.setStartAfter(m),h.setEndAfter(p);const v=h.extractContents();_g(v,!1),Ut(N(b))||f.insertBefore(b,p),Ut(N(m))||f.insertBefore(m,p),Ut(N(v))||f.insertBefore(v,p),f.removeChild(p)}})(g.dom,u.dom)})}),c.each(u=>Eg(t,u.dom))}})})},hd=(t,e)=>{const n=Eg(t,e);Qx(t,e,n)},Jx=(t,e)=>{if(Rg(t,e)){const n=pd(t.getBlockElements());Sg(n,e)}},Ng=t=>t.hasAttribute(xs),Ya=(t,e)=>pt(t.getTransparentElements(),e),Rg=(t,e)=>J(e)&&Ya(t,e.nodeName),ks=(t,e)=>Rg(t,e)&&Ng(e),Ag=(t,e)=>e.type===1&&Ya(t,e.name)&&fe(e.attr(xs)),Zx=Ro().browser,Og=t=>Wt(t,Te),Tg=(t,e)=>t.children&&_t(t.children,e),Bg=(t,e={})=>{let n=0;const o={},r=N(t),s=Un(r),a=l=>new Promise((d,c)=>{let u;const g=$._addCacheSuffix(l),p=(y=>At(o,y).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0})))(g);o[g]=p,p.count++;const m=(y,w)=>{H(y,ts),p.status=w,p.passed=[],p.failed=[],u&&(u.onload=null,u.onerror=null,u=null)},h=()=>m(p.passed,2),f=()=>m(p.failed,3);if(d&&p.passed.push(d),c&&p.failed.push(c),p.status===1)return;if(p.status===2)return void h();if(p.status===3)return void f();p.status=1;const b=Jt("link",s.dom);var v;Xn(b,{rel:"stylesheet",type:"text/css",id:p.id}),e.contentCssCors&&Qt(b,"crossOrigin","anonymous"),e.referrerPolicy&&Qt(b,"referrerpolicy",e.referrerPolicy),u=b.dom,u.onload=h,u.onerror=f,v=b,Kt(ed(r),v),Qt(b,"href",g)}),i=l=>{const d=$._addCacheSuffix(l);At(o,d).each(c=>{--c.count==0&&(delete o[d],(u=>{const g=ed(r);bs(g,"#"+u).each(Tt)})(c.id))})};return{load:a,loadAll:l=>Promise.allSettled(yt(l,d=>a(d).then(Y(d)))).then(d=>{const c=es(d,u=>u.status==="fulfilled");return c.fail.length>0?Promise.reject(yt(c.fail,u=>u.reason)):yt(c.pass,u=>u.value)}),unload:i,unloadAll:l=>{H(l,d=>{i(d)})},_setReferrerPolicy:l=>{e.referrerPolicy=l},_setContentCssCors:l=>{e.contentCssCors=l}}},Dg=(()=>{const t=new WeakMap;return{forElement:(e,n)=>{const o=Qn(e).dom;return C.from(t.get(o)).getOrThunk(()=>{const r=Bg(o,n);return t.set(o,r),r})}}})(),Pg=(t,e)=>Q(t)&&(Ga(t,e)||ld(N(t))),Lg=t=>(e=>e.nodeName.toLowerCase()==="span")(t)&&t.getAttribute("data-mce-type")==="bookmark",bd=(t,e,n)=>{var o;const r=n||e;if(J(e)&&Lg(e))return e;const s=e.childNodes;for(let a=s.length-1;a>=0;a--)bd(t,s[a],r);if(J(e)){const a=e.childNodes;a.length===1&&Lg(a[0])&&((o=e.parentNode)===null||o===void 0||o.insertBefore(a[0],e))}return(a=>ad(a)||vs(a))(e)||Ga(e,r)||(a=>!!J(a)&&a.childNodes.length>0)(e)||((a,i)=>j(a)&&a.data.length>0&&((l,d)=>{const c=new Vt(l,d).prev(!1),u=new Vt(l,d).next(!1),g=fe(c)||Pg(c,d),p=fe(u)||Pg(u,d);return g&&p})(a,i))(e,r)||t.remove(e),e},tk=$.makeMap,Xa=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Qa=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ek=/[<>&\"\']/g,nk=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,ok={128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"},Uo={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},rk={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},Mg=(t,e)=>{const n={};if(t){const o=t.split(",");e=e||10;for(let r=0;r<o.length;r+=2){const s=String.fromCharCode(parseInt(o[r],e));if(!Uo[s]){const a="&"+o[r+1]+";";n[s]=a,n[a]=s}}return n}},vd=Mg("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),Ig=(t,e)=>t.replace(e?Xa:Qa,n=>Uo[n]||n),Fg=(t,e)=>t.replace(e?Xa:Qa,n=>n.length>1?"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";":Uo[n]||"&#"+n.charCodeAt(0)+";"),yd=(t,e,n)=>{const o=n||vd;return t.replace(e?Xa:Qa,r=>Uo[r]||o[r]||r)},ro={encodeRaw:Ig,encodeAllRaw:t=>(""+t).replace(ek,e=>Uo[e]||e),encodeNumeric:Fg,encodeNamed:yd,getEncodeFunc:(t,e)=>{const n=Mg(e)||vd,o=tk(t.replace(/\+/g,","));return o.named&&o.numeric?(r,s)=>r.replace(s?Xa:Qa,a=>Uo[a]!==void 0?Uo[a]:n[a]!==void 0?n[a]:a.length>1?"&#"+(1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320)+65536)+";":"&#"+a.charCodeAt(0)+";"):o.named?e?(r,s)=>yd(r,s,n):yd:o.numeric?Fg:Ig},decode:t=>t.replace(nk,(e,n)=>n?(n=n.charAt(0).toLowerCase()==="x"?parseInt(n.substr(1),16):parseInt(n,10))>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(1023&n))):ok[n]||String.fromCharCode(n):rk[e]||vd[e]||(o=>{const r=Jt("div").dom;return r.innerHTML=o,r.textContent||r.innerText||o})(e))},Ja={},Za={},sk={},wr=$.makeMap,ie=$.each,Cd=$.extend,Ug=$.explode,ak=$.inArray,re=(t,e)=>(t=$.trim(t))?t.split(e||" "):[],zg=(t,e={})=>{const n=wr(t," ",wr(t.toUpperCase()," "));return Cd(n,e)},jg=t=>zg("td th li dt dd figcaption caption details summary",t.getTextBlockElements()),wd=(t,e)=>{if(t){const n={};return it(t)&&(t={"*":t}),ie(t,(o,r)=>{n[r]=n[r.toUpperCase()]=e==="map"?wr(o,/[, ]/):Ug(o,/[, ]/)}),n}},so=(t={})=>{var e;const n={},o={};let r=[];const s={},a={},i=(z,V,X)=>{const nt=t[z];if(nt)return wr(nt,/[, ]/,wr(nt.toUpperCase(),/[, ]/));{let dt=Za[z];return dt||(dt=zg(V,X),Za[z]=dt),dt}},l=(e=t.schema)!==null&&e!==void 0?e:"html5",d=(z=>{const V={};let X,nt,dt,ut;const G=(zt,Bt="",Ce="")=>{const we=re(Ce),mn=re(zt);let Qe=mn.length;for(;Qe--;){const te=re([X,Bt].join(" "));V[mn[Qe]]={attributes:zl(te,()=>({})),attributesOrder:te,children:zl(we,Y(sk))}}},gt=(zt,Bt)=>{const Ce=re(zt),we=re(Bt);let mn=Ce.length;for(;mn--;){const Qe=V[Ce[mn]];for(let te=0,_e=we.length;te<_e;te++)Qe.attributes[we[te]]={},Qe.attributesOrder.push(we[te])}};if(Ja[z])return Ja[z];if(X="id accesskey class dir lang style tabindex title role",nt="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",dt="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment",z!=="html4"&&(X+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",nt+=" article aside details dialog figure main header footer hgroup section nav a ins del canvas map",dt+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),z!=="html5-strict"){X+=" xml:lang";const zt="acronym applet basefont big font strike tt";dt=[dt,zt].join(" "),ie(re(zt),Ce=>{G(Ce,"",dt)});const Bt="center dir isindex noframes";nt=[nt,Bt].join(" "),ut=[nt,dt].join(" "),ie(re(Bt),Ce=>{G(Ce,"",ut)})}return ut=ut||[nt,dt].join(" "),G("html","manifest","head body"),G("head","","base command link meta noscript script style title"),G("title hr noscript br"),G("base","href target"),G("link","href rel media hreflang type sizes hreflang"),G("meta","name http-equiv content charset"),G("style","media type scoped"),G("script","src async defer type charset"),G("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",ut),G("address dt dd div caption","",ut),G("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",dt),G("blockquote","cite",ut),G("ol","reversed start type","li"),G("ul","","li"),G("li","value",ut),G("dl","","dt dd"),G("a","href target rel media hreflang type",ut),G("q","cite",dt),G("ins del","cite datetime",ut),G("img","src sizes srcset alt usemap ismap width height"),G("iframe","src name width height",ut),G("embed","src type width height"),G("object","data type typemustmatch name usemap form width height",[ut,"param"].join(" ")),G("param","name value"),G("map","name",[ut,"area"].join(" ")),G("area","alt coords shape href target rel media hreflang type"),G("table","border","caption colgroup thead tfoot tbody tr"+(z==="html4"?" col":"")),G("colgroup","span","col"),G("col","span"),G("tbody thead tfoot","","tr"),G("tr","","td th"),G("td","colspan rowspan headers",ut),G("th","colspan rowspan headers scope abbr",ut),G("form","accept-charset action autocomplete enctype method name novalidate target",ut),G("fieldset","disabled form name",[ut,"legend"].join(" ")),G("label","form for",dt),G("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),G("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",z==="html4"?ut:dt),G("select","disabled form multiple name required size","option optgroup"),G("optgroup","disabled label","option"),G("option","disabled label selected value"),G("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),G("menu","type label",[ut,"li"].join(" ")),G("noscript","",ut),z!=="html4"&&(G("wbr"),G("ruby","",[dt,"rt rp"].join(" ")),G("figcaption","",ut),G("mark rt rp summary bdi","",dt),G("canvas","width height",ut),G("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[ut,"track source"].join(" ")),G("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[ut,"track source"].join(" ")),G("picture","","img source"),G("source","src srcset type media sizes"),G("track","kind src srclang label default"),G("datalist","",[dt,"option"].join(" ")),G("article section nav aside main header footer","",ut),G("hgroup","","h1 h2 h3 h4 h5 h6"),G("figure","",[ut,"figcaption"].join(" ")),G("time","datetime",dt),G("dialog","open",ut),G("command","type label icon disabled checked radiogroup command"),G("output","for form name",dt),G("progress","value max",dt),G("meter","value min max low high optimum",dt),G("details","open",[ut,"summary"].join(" ")),G("keygen","autofocus challenge disabled form keytype name")),z!=="html5-strict"&&(gt("script","language xml:space"),gt("style","xml:space"),gt("object","declare classid code codebase codetype archive standby align border hspace vspace"),gt("embed","align name hspace vspace"),gt("param","valuetype type"),gt("a","charset name rev shape coords"),gt("br","clear"),gt("applet","codebase archive code object alt name width height align hspace vspace"),gt("img","name longdesc align border hspace vspace"),gt("iframe","longdesc frameborder marginwidth marginheight scrolling align"),gt("font basefont","size color face"),gt("input","usemap align"),gt("select"),gt("textarea"),gt("h1 h2 h3 h4 h5 h6 div p legend caption","align"),gt("ul","type compact"),gt("li","type"),gt("ol dl menu dir","compact"),gt("pre","width xml:space"),gt("hr","align noshade size width"),gt("isindex","prompt"),gt("table","summary width frame rules cellspacing cellpadding align bgcolor"),gt("col","width align char charoff valign"),gt("colgroup","width align char charoff valign"),gt("thead","align char charoff valign"),gt("tr","align char charoff valign bgcolor"),gt("th","axis align char charoff valign nowrap bgcolor width height"),gt("form","accept"),gt("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),gt("tfoot","align char charoff valign"),gt("tbody","align char charoff valign"),gt("area","nohref"),gt("body","background bgcolor text link vlink alink")),z!=="html4"&&(gt("input button select textarea","autofocus"),gt("input textarea","placeholder"),gt("a","download"),gt("link script img","crossorigin"),gt("img","loading"),gt("iframe","sandbox seamless allow allowfullscreen loading")),z!=="html4"&&H([V.video,V.audio],zt=>{delete zt.children.audio,delete zt.children.video}),ie(re("a form meter progress dfn"),zt=>{V[zt]&&delete V[zt].children[zt]}),delete V.caption.children.table,delete V.script,Ja[z]=V,V})(l);t.verify_html===!1&&(t.valid_elements="*[*]");const c=wd(t.valid_styles),u=wd(t.invalid_styles,"map"),g=wd(t.valid_classes,"map"),p=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),m=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),h=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),f=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),b="td th iframe video audio object script code",v=i("non_empty_elements",b+" pre",h),y=i("move_caret_before_on_enter_elements",b+" table",h),w=i("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),k=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",w),x=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),E=i("transparent_elements","a ins del canvas map");ie("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),z=>{a[z]=new RegExp("</"+z+"[^>]*>","gi")});const S=z=>new RegExp("^"+z.replace(/([?+*])/g,".$1")+"$"),_=z=>{const V=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,X=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,nt=/[*?+]/;if(z){const dt=re(z,",");let ut,G;n["@"]&&(ut=n["@"].attributes,G=n["@"].attributesOrder);for(let gt=0,zt=dt.length;gt<zt;gt++){let Bt=V.exec(dt[gt]);if(Bt){const Ce=Bt[1],we=Bt[2],mn=Bt[3],Qe=Bt[5],te={},_e=[],Lt={attributes:te,attributesOrder:_e};if(Ce==="#"&&(Lt.paddEmpty=!0),Ce==="-"&&(Lt.removeEmpty=!0),Bt[4]==="!"&&(Lt.removeEmptyAttrs=!0),ut&&(Nt(ut,(Bn,yo)=>{te[yo]=Bn}),G&&_e.push(...G)),Qe){const Bn=re(Qe,"|");for(let yo=0,Tl=Bn.length;yo<Tl;yo++)if(Bt=X.exec(Bn[yo]),Bt){const Dn={},wa=Bt[1],De=Bt[2].replace(/[\\:]:/g,":"),Co=Bt[3],Pe=Bt[4];if(wa==="!"&&(Lt.attributesRequired=Lt.attributesRequired||[],Lt.attributesRequired.push(De),Dn.required=!0),wa==="-"){delete te[De],_e.splice(ak(_e,De),1);continue}if(Co&&(Co==="="&&(Lt.attributesDefault=Lt.attributesDefault||[],Lt.attributesDefault.push({name:De,value:Pe}),Dn.defaultValue=Pe),Co==="~"&&(Lt.attributesForced=Lt.attributesForced||[],Lt.attributesForced.push({name:De,value:Pe}),Dn.forcedValue=Pe),Co==="<"&&(Dn.validValues=wr(Pe,"?"))),nt.test(De)){const dr=Dn;Lt.attributePatterns=Lt.attributePatterns||[],dr.pattern=S(De),Lt.attributePatterns.push(dr)}else te[De]||_e.push(De),te[De]=Dn}}if(ut||we!=="@"||(ut=te,G=_e),mn&&(Lt.outputName=we,n[mn]=Lt),nt.test(we)){const Bn=Lt;Bn.pattern=S(we),r.push(Bn)}else n[we]=Lt}}}},O=z=>{r=[],H(Oe(n),V=>{delete n[V]}),_(z),ie(d,(V,X)=>{o[X]=V.children})},T=z=>{const V=/^(~)?(.+)$/;z&&(delete Za.text_block_elements,delete Za.block_elements,ie(re(z,","),X=>{const nt=V.exec(X);if(nt){const dt=nt[1]==="~",ut=dt?"span":"div",G=nt[2];if(o[G]=o[ut],s[G]=ut,v[G.toUpperCase()]={},v[G]={},dt||(k[G.toUpperCase()]={},k[G]={}),!n[G]){let gt=n[ut];gt=Cd({},gt),delete gt.removeEmptyAttrs,delete gt.removeEmpty,n[G]=gt}ie(o,(gt,zt)=>{gt[ut]&&(o[zt]=gt=Cd({},o[zt]),gt[G]=gt[ut])})}}))},P=z=>{const V=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;delete Ja[l],z&&ie(re(z,","),X=>{const nt=V.exec(X);if(nt){const dt=nt[1];let ut;ut=dt?o[nt[2]]:o[nt[2]]={"#comment":{}},ut=o[nt[2]],ie(re(nt[3],"|"),G=>{dt==="-"?delete ut[G]:ut[G]={}})}})},D=z=>{const V=n[z];if(V)return V;let X=r.length;for(;X--;){const nt=r[X];if(nt.pattern.test(z))return nt}};t.valid_elements?O(t.valid_elements):(ie(d,(z,V)=>{n[V]={attributes:z.attributes,attributesOrder:z.attributesOrder},o[V]=z.children}),ie(re("strong/b em/i"),z=>{const V=re(z,"/");n[V[1]].outputName=V[0]}),ie(x,(z,V)=>{n[V]&&(t.padd_empty_block_inline_children&&(n[V].paddInEmptyBlock=!0),n[V].removeEmpty=!0)}),ie(re("ol ul blockquote a table tbody"),z=>{n[z]&&(n[z].removeEmpty=!0)}),ie(re("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),z=>{n[z].paddEmpty=!0}),ie(re("span"),z=>{n[z].removeEmptyAttrs=!0})),T(t.custom_elements),P(t.valid_children),_(t.extended_valid_elements),P("+ol[ul|ol],+ul[ul|ol]"),ie({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(z,V)=>{n[V]&&(n[V].parentsRequired=re(z))}),t.invalid_elements&&ie(Ug(t.invalid_elements),z=>{n[z]&&delete n[z]}),D("span")||_("span[!data-mce-type|*]");const I=Y(c),q=Y(u),W=Y(g),rt=Y(f),at=Y(k),vt=Y(w),St=Y(x),et=Y(Object.seal(h)),ft=Y(m),ct=Y(v),R=Y(y),A=Y(p),M=Y(E),U=Y(Object.seal(a)),F=Y(s);return{type:l,children:o,elements:n,getValidStyles:I,getValidClasses:W,getBlockElements:at,getInvalidStyles:q,getVoidElements:et,getTextBlockElements:vt,getTextInlineElements:St,getBoolAttrs:rt,getElementRule:D,getSelfClosingElements:ft,getNonEmptyElements:ct,getMoveCaretBeforeOnEnterElements:R,getWhitespaceElements:A,getTransparentElements:M,getSpecialElements:U,isValidChild:(z,V)=>{const X=o[z.toLowerCase()];return!(!X||!X[V.toLowerCase()])},isValid:(z,V)=>{const X=D(z);if(X){if(!V)return!0;{if(X.attributes[V])return!0;const nt=X.attributePatterns;if(nt){let dt=nt.length;for(;dt--;)if(nt[dt].pattern.test(V))return!0}}}return!1},getCustomElements:F,addValidElements:_,setValidElements:O,addCustomElements:T,addValidChildren:P}},xd=(t={},e)=>{const n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,o=/\s*([^:]+):\s*([^;]+);?/g,r=/\s+$/,s={};let a,i;e&&(a=e.getValidStyles(),i=e.getInvalidStyles());const l=`\\" \\' \\; \\: ; : \uFEFF`.split(" ");for(let c=0;c<l.length;c++)s[l[c]]="\uFEFF"+c,s["\uFEFF"+c]=l[c];const d={parse:c=>{const u={};let g=!1;const p=t.url_converter,m=t.url_converter_scope||d,h=(_,O,T)=>{const P=u[_+"-top"+O];if(!P)return;const D=u[_+"-right"+O];if(!D)return;const I=u[_+"-bottom"+O];if(!I)return;const q=u[_+"-left"+O];if(!q)return;const W=[P,D,I,q];let rt=W.length-1;for(;rt--&&W[rt]===W[rt+1];);rt>-1&&T||(u[_+O]=rt===-1?W[0]:W.join(" "),delete u[_+"-top"+O],delete u[_+"-right"+O],delete u[_+"-bottom"+O],delete u[_+"-left"+O])},f=_=>{const O=u[_];if(!O)return;const T=O.split(" ");let P=T.length;for(;P--;)if(T[P]!==T[0])return!1;return u[_]=T[0],!0},b=_=>(g=!0,s[_]),v=(_,O)=>(g&&(_=_.replace(/\uFEFF[0-9]/g,T=>s[T])),O||(_=_.replace(/\\([\'\";:])/g,"$1")),_),y=_=>String.fromCharCode(parseInt(_.slice(1),16)),w=_=>_.replace(/\\[0-9a-f]+/gi,y),k=(_,O,T,P,D,I)=>{if(D=D||I)return"'"+(D=v(D)).replace(/\'/g,"\\'")+"'";if(O=v(O||T||P||""),!t.allow_script_urls){const q=O.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(q)||!t.allow_svg_data_urls&&/^data:image\/svg/i.test(q))return""}return p&&(O=p.call(m,O,"style")),"url('"+O.replace(/\'/g,"\\'")+"')"};if(c){let _;for(c=(c=c.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,b).replace(/\"[^\"]+\"|\'[^\']+\'/g,O=>O.replace(/[;:]/g,b));_=o.exec(c);){o.lastIndex=_.index+_[0].length;let O=_[1].replace(r,"").toLowerCase(),T=_[2].replace(r,"");if(O&&T){if(O=w(O),T=w(T),O.indexOf("\uFEFF")!==-1||O.indexOf('"')!==-1||!t.allow_script_urls&&(O==="behavior"||/expression\s*\(|\/\*|\*\//.test(T)))continue;O==="font-weight"&&T==="700"?T="bold":O!=="color"&&O!=="background-color"||(T=T.toLowerCase()),T=T.replace(n,k),u[O]=g?v(T,!0):T}}h("border","",!0),h("border","-width"),h("border","-color"),h("border","-style"),h("padding",""),h("margin",""),E="border-style",S="border-color",f(x="border-width")&&f(E)&&f(S)&&(u.border=u[x]+" "+u[E]+" "+u[S],delete u[x],delete u[E],delete u[S]),u.border==="medium none"&&delete u.border,u["border-image"]==="none"&&delete u["border-image"]}var x,E,S;return u},serialize:(c,u)=>{let g="";const p=(m,h)=>{const f=h[m];if(f)for(let b=0,v=f.length;b<v;b++){const y=f[b],w=c[y];w&&(g+=(g.length>0?" ":"")+y+": "+w+";")}};return u&&a?(p("*",a),p(u,a)):Nt(c,(m,h)=>{m&&((f,b)=>{if(!i||!b)return!0;let v=i["*"];return!(v&&v[f]||(v=i[b],v&&v[f]))})(h,u)&&(g+=(g.length>0?" ":"")+h+": "+m+";")}),g}};return d},ik={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},Hg=(t,e)=>{const n=e!=null?e:{};for(const o in t)pt(ik,o)||(n[o]=t[o]);return Q(t.composedPath)&&(n.composedPath=()=>t.composedPath()),n},kd=(t,e,n,o)=>{var r;const s=Hg(e,o);return s.type=t,jt(s.target)&&(s.target=(r=s.srcElement)!==null&&r!==void 0?r:n),(a=>jt(a.preventDefault)||(i=>i instanceof Event||wt(i.initEvent))(a))(e)&&(s.preventDefault=()=>{s.defaultPrevented=!0,s.isDefaultPrevented=Ht,wt(e.preventDefault)&&e.preventDefault()},s.stopPropagation=()=>{s.cancelBubble=!0,s.isPropagationStopped=Ht,wt(e.stopPropagation)&&e.stopPropagation()},s.stopImmediatePropagation=()=>{s.isImmediatePropagationStopped=Ht,s.stopPropagation()},(a=>a.isDefaultPrevented===Ht||a.isDefaultPrevented===Dt)(s)||(s.isDefaultPrevented=s.defaultPrevented===!0?Ht:Dt,s.isPropagationStopped=s.cancelBubble===!0?Ht:Dt,s.isImmediatePropagationStopped=Dt)),s},lk=/^(?:mouse|contextmenu)|click/,Sd=(t,e,n,o)=>{t.addEventListener(e,n,o||!1)},ti=(t,e,n,o)=>{t.removeEventListener(e,n,o||!1)},Ss=(t,e)=>{const n=kd(t.type,t,document,e);if((o=>Q(o)&&lk.test(o.type))(t)&&fe(t.pageX)&&!fe(t.clientX)){const o=n.target.ownerDocument||document,r=o.documentElement,s=o.body,a=n;a.pageX=t.clientX+(r&&r.scrollLeft||s&&s.scrollLeft||0)-(r&&r.clientLeft||s&&s.clientLeft||0),a.pageY=t.clientY+(r&&r.scrollTop||s&&s.scrollTop||0)-(r&&r.clientTop||s&&s.clientTop||0)}return n},dk=(t,e,n)=>{const o=t.document,r={type:"ready"};if(n.domLoaded)return void e(r);const s=()=>{ti(t,"DOMContentLoaded",s),ti(t,"load",s),n.domLoaded||(n.domLoaded=!0,e(r)),t=null};o.readyState==="complete"||o.readyState==="interactive"&&o.body?s():Sd(t,"DOMContentLoaded",s),n.domLoaded||Sd(t,"load",s)};class zo{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(e,n,o,r){const s=this;let a;const i=window,l=g=>{s.executeHandlers(Ss(g||i.event),d)};if(!e||j(e)||eo(e))return o;let d;e[s.expando]?d=e[s.expando]:(d=s.count++,e[s.expando]=d,s.events[d]={}),r=r||e;const c=n.split(" ");let u=c.length;for(;u--;){let g=c[u],p=l,m=!1,h=!1;g==="DOMContentLoaded"&&(g="ready"),s.domLoaded&&g==="ready"&&e.readyState==="complete"?o.call(r,Ss({type:g})):(s.hasFocusIn||g!=="focusin"&&g!=="focusout"||(m=!0,h=g==="focusin"?"focus":"blur",p=f=>{const b=Ss(f||i.event);b.type=b.type==="focus"?"focusin":"focusout",s.executeHandlers(b,d)}),a=s.events[d][g],a?g==="ready"&&s.domLoaded?o(Ss({type:g})):a.push({func:o,scope:r}):(s.events[d][g]=a=[{func:o,scope:r}],a.fakeName=h,a.capture=m,a.nativeHandler=p,g==="ready"?dk(e,p,s):Sd(e,h||g,p,m)))}return e=a=null,o}unbind(e,n,o){if(!e||j(e)||eo(e))return this;const r=e[this.expando];if(r){let s=this.events[r];if(n){const a=n.split(" ");let i=a.length;for(;i--;){const l=a[i],d=s[l];if(d){if(o){let c=d.length;for(;c--;)if(d[c].func===o){const u=d.nativeHandler,g=d.fakeName,p=d.capture,m=d.slice(0,c).concat(d.slice(c+1));m.nativeHandler=u,m.fakeName=g,m.capture=p,s[l]=m}}o&&d.length!==0||(delete s[l],ti(e,d.fakeName||l,d.nativeHandler,d.capture))}}}else Nt(s,(a,i)=>{ti(e,a.fakeName||i,a.nativeHandler,a.capture)}),s={};for(const a in s)if(pt(s,a))return this;delete this.events[r];try{delete e[this.expando]}catch(a){e[this.expando]=null}}return this}fire(e,n,o){return this.dispatch(e,n,o)}dispatch(e,n,o){if(!e||j(e)||eo(e))return this;const r=Ss({type:n,target:e},o);do{const s=e[this.expando];s&&this.executeHandlers(r,s),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!r.isPropagationStopped());return this}clean(e){if(!e||j(e)||eo(e))return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName){this.unbind(e);const n=e.getElementsByTagName("*");let o=n.length;for(;o--;)(e=n[o])[this.expando]&&this.unbind(e)}return this}destroy(){this.events={}}cancel(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1}executeHandlers(e,n){const o=this.events[n],r=o&&o[e.type];if(r)for(let s=0,a=r.length;s<a;s++){const i=r[s];if(i&&i.func.call(i.scope,e)===!1&&e.preventDefault(),e.isImmediatePropagationStopped())return}}}zo.Event=new zo;const Ed=$.each,ck=$.grep,_d="data-mce-style",uk=$.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),Es=(t,e,n)=>{jt(n)||n===""?ne(t,e):Qt(t,e,n)},$g=t=>t.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),xr=(t,e)=>{let n=0;if(t)for(let o=t.nodeType,r=t.previousSibling;r;r=r.previousSibling){const s=r.nodeType;(!e||!j(r)||s!==o&&r.data.length)&&(n++,o=s)}return n},Vg=(t,e)=>{const n=Ge(e,"style"),o=t.serialize(t.parse(n),Ot(e));Es(e,_d,o)},qg=(t,e,n)=>{const o=$g(e);jt(n)||n===""?Qf(t,o):Gf(t,o,((r,s)=>Je(r)?pt(uk,s)?r+"":r+"px":r)(n,o))},Et=(t,e={})=>{const n={},o=window,r={};let s=0;const a=Dg.forElement(N(t),{contentCssCors:e.contentCssCors,referrerPolicy:e.referrerPolicy}),i=[],l=e.schema?e.schema:so({}),d=xd({url_converter:e.url_converter,url_converter_scope:e.url_converter_scope},e.schema),c=e.ownEvents?new zo:zo.Event,u=l.getBlockElements(),g=R=>R&&t&&it(R)?t.getElementById(R):R,p=R=>{const A=g(R);return Q(A)?N(A):null},m=(R,A,M="")=>{let U;const F=p(R);if(Q(F)&&Te(F)){const z=ct[A];U=z&&z.get?z.get(F.dom,A):Ge(F,A)}return Q(U)?U:M},h=R=>{const A=g(R);return jt(A)?[]:A.attributes},f=(R,A,M)=>{S(R,U=>{if(J(U)){const F=N(U),z=M===""?null:M,V=Ge(F,A),X=ct[A];X&&X.set?X.set(F.dom,z,A):Es(F,A,z),V!==z&&e.onSetAttrib&&e.onSetAttrib({attrElm:F.dom,attrName:A,attrValue:z})}})},b=()=>e.root_element||t.body,v=(R,A)=>((M,U,F)=>{let z=0,V=0;const X=M.ownerDocument;if(F=F||M,U){if(F===M&&U.getBoundingClientRect&&vn(N(M),"position")==="static"){const dt=U.getBoundingClientRect();return z=dt.left+(X.documentElement.scrollLeft||M.scrollLeft)-X.documentElement.clientLeft,V=dt.top+(X.documentElement.scrollTop||M.scrollTop)-X.documentElement.clientTop,{x:z,y:V}}let nt=U;for(;nt&&nt!==F&&nt.nodeType&&!Tg(nt,F);){const dt=nt;z+=dt.offsetLeft||0,V+=dt.offsetTop||0,nt=dt.offsetParent}for(nt=U.parentNode;nt&&nt!==F&&nt.nodeType&&!Tg(nt,F);)z-=nt.scrollLeft||0,V-=nt.scrollTop||0,nt=nt.parentNode;V+=(dt=>Zx.isFirefox()&&Ot(dt)==="table"?Og(oe(dt)).filter(ut=>Ot(ut)==="caption").bind(ut=>Og(Hf(ut)).map(G=>{const gt=G.dom.offsetTop,zt=ut.dom.offsetTop,Bt=ut.dom.offsetHeight;return gt<=zt?-Bt:0})).getOr(0):0)(N(U))}return{x:z,y:V}})(t.body,g(R),A),y=(R,A,M)=>{const U=g(R);if(!jt(U)&&J(U))return M?vn(N(U),$g(A)):((A=A.replace(/-(\D)/g,(F,z)=>z.toUpperCase()))==="float"&&(A="cssFloat"),U.style?U.style[A]:void 0)},w=R=>{const A=g(R);if(!A)return{w:0,h:0};let M=y(A,"width"),U=y(A,"height");return M&&M.indexOf("px")!==-1||(M="0"),U&&U.indexOf("px")!==-1||(U="0"),{w:parseInt(M,10)||A.offsetWidth||A.clientWidth,h:parseInt(U,10)||A.offsetHeight||A.clientHeight}},k=(R,A)=>{if(!R)return!1;const M=$t(R)?R:[R];return It(M,U=>Ze(N(U),A))},x=(R,A,M,U)=>{const F=[];let z=g(R);U=U===void 0;const V=M||(b().nodeName!=="BODY"?b().parentNode:null);if(it(A))if(A==="*")A=J;else{const X=A;A=nt=>k(nt,X)}for(;z&&!(z===V||jt(z.nodeType)||vs(z)||ad(z));){if(!A||A(z)){if(!U)return[z];F.push(z)}z=z.parentNode}return U?F:null},E=(R,A,M)=>{let U=A;if(R){it(A)&&(U=F=>k(F,A));for(let F=R[M];F;F=F[M])if(wt(U)&&U(F))return F}return null},S=function(R,A,M){const U=M!=null?M:this;if($t(R)){const F=[];return Ed(R,(z,V)=>{const X=g(z);X&&F.push(A.call(U,X,V))}),F}{const F=g(R);return!!F&&A.call(U,F)}},_=(R,A)=>{S(R,M=>{Nt(A,(U,F)=>{f(M,F,U)})})},O=(R,A)=>{S(R,M=>{const U=N(M);Ua(U,A)})},T=(R,A,M,U,F)=>S(R,z=>{const V=it(A)?t.createElement(A):A;return Q(M)&&_(V,M),U&&(!it(U)&&U.nodeType?V.appendChild(U):it(U)&&O(V,U)),F?V:z.appendChild(V)}),P=(R,A,M)=>T(t.createElement(R),R,A,M,!0),D=ro.encodeAllRaw,I=(R,A)=>S(R,M=>{const U=N(M);return A&&H(oe(U),F=>{Le(F)&&F.dom.length===0?Tt(F):Me(U,F)}),Tt(U),U.dom}),q=(R,A,M)=>{S(R,U=>{if(J(U)){const F=N(U),z=A.split(" ");H(z,V=>{Q(M)?(M?cs:Pa)(F,V):((X,nt)=>{const dt=ds(X)?X.dom.classList.toggle(nt):((ut,G)=>_t(Bf(ut),G)?Pf(ut,G):Df(ut,G))(X,nt);Lf(X)})(F,V)})}})},W=(R,A,M)=>S(A,U=>{var F;const z=$t(A)?R.cloneNode(!0):R;return M&&Ed(ck(U.childNodes),V=>{z.appendChild(V)}),(F=U.parentNode)===null||F===void 0||F.replaceChild(z,U),U}),rt=R=>{if(J(R)){const A=R.nodeName.toLowerCase()==="a"&&!m(R,"href")&&m(R,"id");if(m(R,"name")||m(R,"data-mce-bookmark")||A)return!0}return!1},at=()=>t.createRange(),vt=(R,A,M,U)=>{if($t(R)){let F=R.length;const z=[];for(;F--;)z[F]=vt(R[F],A,M,U);return z}return!e.collect||R!==t&&R!==o||i.push([R,A,M,U]),c.bind(R,A,M,U||ft)},St=(R,A,M)=>{if($t(R)){let U=R.length;const F=[];for(;U--;)F[U]=St(R[U],A,M);return F}if(i.length>0&&(R===t||R===o)){let U=i.length;for(;U--;){const[F,z,V]=i[U];R!==F||A&&A!==z||M&&M!==V||c.unbind(F,z,V)}}return c.unbind(R,A,M)},et=R=>{if(R&&J(R)){const A=R.getAttribute("data-mce-contenteditable");return A&&A!=="inherit"?A:R.contentEditable!=="inherit"?R.contentEditable:null}return null},ft={doc:t,settings:e,win:o,files:r,stdMode:!0,boxModel:!0,styleSheetLoader:a,boundEvents:i,styles:d,schema:l,events:c,isBlock:R=>it(R)?pt(u,R):J(R)&&(pt(u,R.nodeName)||ks(l,R)),root:null,clone:(R,A)=>R.cloneNode(A),getRoot:b,getViewPort:R=>{const A=sg(R);return{x:A.x,y:A.y,w:A.width,h:A.height}},getRect:R=>{const A=g(R),M=v(A),U=w(A);return{x:M.x,y:M.y,w:U.w,h:U.h}},getSize:w,getParent:(R,A,M)=>{const U=x(R,A,M,!1);return U&&U.length>0?U[0]:null},getParents:x,get:g,getNext:(R,A)=>E(R,A,"nextSibling"),getPrev:(R,A)=>E(R,A,"previousSibling"),select:(R,A)=>{var M,U;const F=(U=(M=g(A))!==null&&M!==void 0?M:e.root_element)!==null&&U!==void 0?U:t;return wt(F.querySelectorAll)?Ae(F.querySelectorAll(R)):[]},is:k,add:T,create:P,createHTML:(R,A,M="")=>{let U="<"+R;for(const F in A)fr(A,F)&&(U+=" "+F+'="'+D(A[F])+'"');return is(M)&&pt(l.getVoidElements(),R)?U+" />":U+">"+M+"</"+R+">"},createFragment:R=>{const A=t.createElement("div"),M=t.createDocumentFragment();let U;for(M.appendChild(A),R&&(A.innerHTML=R);U=A.firstChild;)M.appendChild(U);return M.removeChild(A),M},remove:I,setStyle:(R,A,M)=>{S(R,U=>{const F=N(U);qg(F,A,M),e.update_styles&&Vg(d,F)})},getStyle:y,setStyles:(R,A)=>{S(R,M=>{const U=N(M);Nt(A,(F,z)=>{qg(U,z,F)}),e.update_styles&&Vg(d,U)})},removeAllAttribs:R=>S(R,A=>{const M=A.attributes;for(let U=M.length-1;U>=0;U--)A.removeAttributeNode(M.item(U))}),setAttrib:f,setAttribs:_,getAttrib:m,getPos:v,parseStyle:R=>d.parse(R),serializeStyle:(R,A)=>d.serialize(R,A),addStyle:R=>{if(ft!==Et.DOM&&t===document){if(n[R])return;n[R]=!0}let A=t.getElementById("mceDefaultStyles");if(!A){A=t.createElement("style"),A.id="mceDefaultStyles",A.type="text/css";const M=t.head;M.firstChild?M.insertBefore(A,M.firstChild):M.appendChild(A)}A.styleSheet?A.styleSheet.cssText+=R:A.appendChild(t.createTextNode(R))},loadCSS:R=>{R||(R=""),H(R.split(","),A=>{r[A]=!0,a.load(A).catch(bt)})},addClass:(R,A)=>{q(R,A,!0)},removeClass:(R,A)=>{q(R,A,!1)},hasClass:(R,A)=>{const M=p(R),U=A.split(" ");return Q(M)&&So(U,F=>Jl(M,F))},toggleClass:q,show:R=>{S(R,A=>Qf(N(A),"display"))},hide:R=>{S(R,A=>Gf(N(A),"display","none"))},isHidden:R=>{const A=p(R);return Q(A)&&pr(Fa(A,"display"),"none")},uniqueId:R=>(R||"mce_")+s++,setHTML:O,getOuterHTML:R=>{const A=p(R);return Q(A)?J(A.dom)?A.dom.outerHTML:(M=>{const U=Jt("div"),F=N(M.dom.cloneNode(!0));return Kt(U,F),tg(U)})(A):""},setOuterHTML:(R,A)=>{S(R,M=>{J(M)&&(M.outerHTML=A)})},decode:ro.decode,encode:D,insertAfter:(R,A)=>{const M=g(A);return S(R,U=>{const F=M==null?void 0:M.parentNode,z=M==null?void 0:M.nextSibling;return F&&(z?F.insertBefore(U,z):F.appendChild(U)),U})},replace:W,rename:(R,A)=>{if(R.nodeName!==A.toUpperCase()){const M=P(A);return Ed(h(R),U=>{f(M,U.nodeName,m(R,U.nodeName))}),W(M,R,!0),M}return R},findCommonAncestor:(R,A)=>{let M=R;for(;M;){let U=A;for(;U&&M!==U;)U=U.parentNode;if(M===U)break;M=M.parentNode}return!M&&R.ownerDocument?R.ownerDocument.documentElement:M},run:S,getAttribs:h,isEmpty:(R,A)=>{let M=0;if(rt(R))return!1;const U=R.firstChild;if(U){const F=new Vt(U,R),z=l?l.getWhitespaceElements():{},V=A||(l?l.getNonEmptyElements():null);let X=U;do{if(J(X)){const nt=X.getAttribute("data-mce-bogus");if(nt){X=F.next(nt==="all");continue}const dt=X.nodeName.toLowerCase();if(V&&V[dt]){if(dt==="br"){M++,X=F.next();continue}return!1}if(rt(X))return!1}if(eo(X)||j(X)&&!Fo(X.data)||j(X)&&X.parentNode&&z[X.parentNode.nodeName]&&Fo(X.data))return!1;X=F.next()}while(X)}return M<=1},createRng:at,nodeIndex:xr,split:(R,A,M)=>{let U,F,z=at();if(R&&A&&R.parentNode&&A.parentNode){const V=R.parentNode;return z.setStart(V,xr(R)),z.setEnd(A.parentNode,xr(A)),U=z.extractContents(),z=at(),z.setStart(A.parentNode,xr(A)+1),z.setEnd(V,xr(R)+1),F=z.extractContents(),V.insertBefore(bd(ft,U),R),M?V.insertBefore(M,R):V.insertBefore(A,R),V.insertBefore(bd(ft,F),R),I(R),M||A}},bind:vt,unbind:St,fire:(R,A,M)=>c.dispatch(R,A,M),dispatch:(R,A,M)=>c.dispatch(R,A,M),getContentEditable:et,getContentEditableParent:R=>{const A=b();let M=null;for(let U=R;U&&U!==A&&(M=et(U),M===null);U=U.parentNode);return M},destroy:()=>{if(i.length>0){let R=i.length;for(;R--;){const[A,M,U]=i[R];c.unbind(A,M,U)}}Nt(r,(R,A)=>{a.unload(A),delete r[A]})},isChildOf:(R,A)=>R===A||A.contains(R),dumpRng:R=>"startContainer: "+R.startContainer.nodeName+", startOffset: "+R.startOffset+", endContainer: "+R.endContainer.nodeName+", endOffset: "+R.endOffset},ct=((R,A,M)=>{const U=A.keep_values,F={set:(V,X,nt)=>{const dt=N(V);wt(A.url_converter)&&Q(X)&&(X=A.url_converter.call(A.url_converter_scope||M(),String(X),nt,V)),Es(dt,"data-mce-"+nt,X),Es(dt,nt,X)},get:(V,X)=>{const nt=N(V);return Ge(nt,"data-mce-"+X)||Ge(nt,X)}},z={style:{set:(V,X)=>{const nt=N(V);U&&Es(nt,_d,X),ne(nt,"style"),it(X)&&Ia(nt,R.parse(X))},get:V=>{const X=N(V),nt=Ge(X,_d)||Ge(X,"style");return R.serialize(R.parse(nt),Ot(X))}}};return U&&(z.href=z.src=F),z})(d,e,Y(ft));return ft};Et.DOM=Et(document),Et.nodeIndex=xr;const mk=Et.DOM;class Hn{constructor(e={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=e}_setReferrerPolicy(e){this.settings.referrerPolicy=e}loadScript(e){return new Promise((n,o)=>{const r=mk;let s;const a=()=>{r.remove(i),s&&(s.onerror=s.onload=s=null)},i=r.uniqueId();s=document.createElement("script"),s.id=i,s.type="text/javascript",s.src=$._addCacheSuffix(e),this.settings.referrerPolicy&&r.setAttrib(s,"referrerpolicy",this.settings.referrerPolicy),s.onload=()=>{a(),n()},s.onerror=()=>{a(),o("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(s)})}isDone(e){return this.states[e]===2}markDone(e){this.states[e]=2}add(e){const n=this;return n.queue.push(e),n.states[e]===void 0&&(n.states[e]=0),new Promise((o,r)=>{n.scriptLoadedCallbacks[e]||(n.scriptLoadedCallbacks[e]=[]),n.scriptLoadedCallbacks[e].push({resolve:o,reject:r})})}load(e){return this.add(e)}remove(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]}loadQueue(){const e=this.queue;return this.queue=[],this.loadScripts(e)}loadScripts(e){const n=this,o=(l,d)=>{At(n.scriptLoadedCallbacks,d).each(c=>{H(c,u=>u[l](d))}),delete n.scriptLoadedCallbacks[d]},r=l=>{const d=mt(l,c=>c.status==="rejected");return d.length>0?Promise.reject(Ln(d,({reason:c})=>$t(c)?c:[c])):Promise.resolve()},s=l=>Promise.allSettled(yt(l,d=>n.states[d]===2?(o("resolve",d),Promise.resolve()):n.states[d]===3?(o("reject",d),Promise.reject(d)):(n.states[d]=1,n.loadScript(d).then(()=>{n.states[d]=2,o("resolve",d);const c=n.queue;return c.length>0?(n.queue=[],s(c).then(r)):Promise.resolve()},()=>(n.states[d]=3,o("reject",d),Promise.reject(d)))))),a=l=>(n.loading=!0,s(l).then(d=>{n.loading=!1;const c=n.queueLoadedCallbacks.shift();return C.from(c).each(ts),r(d)})),i=of(e);return n.loading?new Promise((l,d)=>{n.queueLoadedCallbacks.push(()=>a(i).then(l,d))}):a(i)}}Hn.ScriptLoader=new Hn;const Gt=t=>{let e=t;return{get:()=>e,set:n=>{e=n}}},_s={},Nd=Gt("en"),Wg=()=>At(_s,Nd.get()),rn={getData:()=>Ra(_s,t=>K({},t)),setCode:t=>{t&&Nd.set(t)},getCode:()=>Nd.get(),add:(t,e)=>{let n=_s[t];n||(_s[t]=n={}),Nt(e,(o,r)=>{n[r.toLowerCase()]=o})},translate:t=>{const e=Wg().getOr({}),n=i=>wt(i)?Object.prototype.toString.call(i):o(i)?"":""+i,o=i=>i===""||i==null,r=i=>{const l=n(i);return At(e,l.toLowerCase()).map(n).getOr(l)},s=i=>i.replace(/{context:\w+}$/,"");if(o(t))return"";if(me(a=t)&&pt(a,"raw"))return n(t.raw);var a;if((i=>$t(i)&&i.length>1)(t)){const i=t.slice(1);return s(r(t[0]).replace(/\{([0-9]+)\}/g,(l,d)=>pt(i,d)?n(i[d]):l))}return s(r(t))},isRtl:()=>Wg().bind(t=>At(t,"_dir")).exists(t=>t==="rtl"),hasCode:t=>pt(_s,t)},de=()=>{const t=[],e={},n={},o=[],r=(l,d)=>{const c=mt(o,u=>u.name===l&&u.state===d);H(c,u=>u.resolve())},s=l=>pt(e,l),a=(l,d)=>{const c=rn.getCode();!c||d&&(","+(d||"")+",").indexOf(","+c+",")===-1||Hn.ScriptLoader.add(e[l]+"/langs/"+c+".js")},i=(l,d="added")=>d==="added"&&(c=>pt(n,c))(l)||d==="loaded"&&s(l)?Promise.resolve():new Promise(c=>{o.push({name:l,state:d,resolve:c})});return{items:t,urls:e,lookup:n,get:l=>{if(n[l])return n[l].instance},requireLangPack:(l,d)=>{de.languageLoad!==!1&&(s(l)?a(l,d):i(l,"loaded").then(()=>a(l,d)))},add:(l,d)=>(t.push(d),n[l]={instance:d},r(l,"added"),d),remove:l=>{delete e[l],delete n[l]},createUrl:(l,d)=>it(d)?it(l)?{prefix:"",resource:d,suffix:""}:{prefix:l.prefix,resource:d,suffix:l.suffix}:d,load:(l,d)=>{if(e[l])return Promise.resolve();let c=it(d)?d:d.prefix+d.resource+d.suffix;c.indexOf("/")!==0&&c.indexOf("://")===-1&&(c=de.baseURL+"/"+c),e[l]=c.substring(0,c.lastIndexOf("/"));const u=()=>(r(l,"loaded"),Promise.resolve());return n[l]?u():Hn.ScriptLoader.add(c).then(u)},waitFor:i}};de.languageLoad=!0,de.baseURL="",de.PluginManager=de(),de.ThemeManager=de(),de.ModelManager=de();const fk=t=>{const e=Gt(C.none()),n=()=>e.get().each(o=>clearInterval(o));return{clear:()=>{n(),e.set(C.none())},isSet:()=>e.get().isSome(),get:()=>e.get(),set:o=>{n(),e.set(C.some(setInterval(o,t)))}}},ao=()=>{const t=(e=>{const n=Gt(C.none()),o=()=>n.get().each(e);return{clear:()=>{o(),n.set(C.none())},isSet:()=>n.get().isSome(),get:()=>n.get(),set:r=>{o(),n.set(C.some(r))}}})(bt);return K(K({},t),{on:e=>t.get().each(e)})},ei=(t,e)=>{let n=null;return{cancel:()=>{wo(n)||(clearTimeout(n),n=null)},throttle:(...o)=>{wo(n)&&(n=setTimeout(()=>{n=null,t.apply(null,o)},e))}}},Rd=(t,e)=>{let n=null;const o=()=>{wo(n)||(clearTimeout(n),n=null)};return{cancel:o,throttle:(...r)=>{o(),n=setTimeout(()=>{n=null,t.apply(null,r)},e)}}},Ns=Y("mce-annotation"),jo=Y("data-mce-annotation"),kr=Y("data-mce-annotation-uid"),Rs=Y("data-mce-annotation-active"),As=Y("data-mce-annotation-classes"),Os=Y("data-mce-annotation-attrs"),Kg=t=>e=>xt(e,t),Gg=(t,e)=>{const n=t.selection.getRng(),o=N(n.startContainer),r=N(t.getBody()),s=e.fold(()=>"."+Ns(),i=>`[${jo()}="${i}"]`),a=Ma(o,n.startOffset).getOr(o);return Do(a,s,Kg(r)).bind(i=>In(i,`${kr()}`).bind(l=>In(i,`${jo()}`).map(d=>{const c=Xg(t,l);return{uid:l,name:d,elements:c}})))},Yg=(t,e)=>Da(t,"data-mce-bogus")||lg(t,'[data-mce-bogus="all"]',Kg(e)),Xg=(t,e)=>{const n=N(t.getBody()),o=le(n,`[${kr()}="${e}"]`);return mt(o,r=>!Yg(r,n))},Qg=(t,e)=>{const n=N(t.getBody()),o=le(n,`[${jo()}="${e}"]`),r={};return H(o,s=>{if(!Yg(s,n)){const a=Ge(s,kr()),i=At(r,a).getOr([]);r[a]=i.concat([s])}}),r};let Jg=0;const Zg=t=>{const e=new Date().getTime(),n=Math.floor(1e9*Math.random());return Jg++,t+"_"+n+Jg+String(e)},tp=(t,e)=>N(t.dom.cloneNode(e)),Sr=t=>tp(t,!1),ep=t=>tp(t,!0),np=(t,e,n=Dt)=>{const o=new Vt(t,e),r=s=>{let a;do a=o[s]();while(a&&!j(a)&&!n(a));return C.from(a).filter(j)};return{current:()=>C.from(o.current()).filter(j),next:()=>r("next"),prev:()=>r("prev"),prev2:()=>r("prev2")}},Ho=(t,e)=>{const n=e||(r=>t.isBlock(r)||Ft(r)||Rt(r)),o=(r,s,a,i)=>{if(j(r)){const l=i(r,s,r.data);if(l!==-1)return C.some({container:r,offset:l})}return a().bind(l=>o(l.container,l.offset,a,i))};return{backwards:(r,s,a,i)=>{const l=np(r,i!=null?i:t.getRoot(),n);return o(r,s,()=>l.prev().map(d=>({container:d,offset:d.length})),a).getOrNull()},forwards:(r,s,a,i)=>{const l=np(r,i!=null?i:t.getRoot(),n);return o(r,s,()=>l.next().map(d=>({container:d,offset:0})),a).getOrNull()}}},Er=Math.round,$o=t=>t?{left:Er(t.left),top:Er(t.top),bottom:Er(t.bottom),right:Er(t.right),width:Er(t.width),height:Er(t.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},op=(t,e)=>(t=$o(t),e||(t.left=t.left+t.width),t.right=t.left,t.width=0,t),rp=(t,e,n)=>t>=0&&t<=Math.min(e.height,n.height)/2,Ts=(t,e)=>{const n=Math.min(e.height/2,t.height/2);return t.bottom-n<e.top||!(t.top>e.bottom)&&rp(e.top-t.bottom,t,e)},Bs=(t,e)=>t.top>e.bottom||!(t.bottom<e.top)&&rp(e.bottom-t.top,t,e),sp=(t,e,n)=>{const o=Math.max(Math.min(e,t.left+t.width),t.left),r=Math.max(Math.min(n,t.top+t.height),t.top);return Math.sqrt((e-o)*(e-o)+(n-r)*(n-r))},ni=t=>{const e=t.startContainer,n=t.startOffset;return e===t.endContainer&&e.hasChildNodes()&&t.endOffset===n+1?e.childNodes[n]:null},io=(t,e)=>{if(J(t)&&t.hasChildNodes()){const n=t.childNodes,o=((r,s,a)=>Math.min(Math.max(r,0),a))(e,0,n.length-1);return n[o]}return t},gk=new RegExp("[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962-\u0963\u0981\u09BC\u09BE\u09C1-\u09C4\u09CD\u09D7\u09E2-\u09E3\u0A01-\u0A02\u0A3C\u0A41-\u0A42\u0A47-\u0A48\u0A4B-\u0A4D\u0A51\u0A70-\u0A71\u0A75\u0A81-\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7-\u0AC8\u0ACD\u0AE2-\u0AE3\u0B01\u0B3C\u0B3E\u0B3F\u0B41-\u0B44\u0B4D\u0B56\u0B57\u0B62-\u0B63\u0B82\u0BBE\u0BC0\u0BCD\u0BD7\u0C00\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55-\u0C56\u0C62-\u0C63\u0C81\u0CBC\u0CBF\u0CC2\u0CC6\u0CCC-\u0CCD\u0CD5-\u0CD6\u0CE2-\u0CE3\u0D01\u0D3E\u0D41-\u0D44\u0D4D\u0D57\u0D62-\u0D63\u0DCA\u0DCF\u0DD2-\u0DD4\u0DD6\u0DDF\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB-\u0EBC\u0EC8-\u0ECD\u0F18-\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86-\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039-\u103A\u103D-\u103E\u1058-\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085-\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17B4-\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193B\u1A17-\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1ABE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80-\u1B81\u1BA2-\u1BA5\u1BA8-\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8-\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8-\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u200C-\u200D\u20D0-\u20DC\u20DD-\u20E0\u20E1\u20E2-\u20E4\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u302E-\u302F\u3099-\u309A\uA66F\uA670-\uA672\uA674-\uA67D\uA69E-\uA69F\uA6F0-\uA6F1\uA802\uA806\uA80B\uA825-\uA826\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9E5\uAA29-\uAA2E\uAA31-\uAA32\uAA35-\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7-\uAAB8\uAABE-\uAABF\uAAC1\uAAEC-\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFF9E-\uFF9F]"),ap=t=>it(t)&&t.charCodeAt(0)>=768&&gk.test(t),ip=J,pk=Ye,lp=Ha("display","block table"),hk=Ha("float","left right"),Ds=((...t)=>e=>{for(let n=0;n<t.length;n++)if(!t[n](e))return!1;return!0})(ip,pk,Ea(hk)),bk=Ea(Ha("white-space","pre pre-line pre-wrap")),Ps=j,Ad=Ft,dp=Et.nodeIndex,oi=(t,e)=>e<0&&J(t)&&t.hasChildNodes()?void 0:io(t,e),Od=t=>t?t.createRange():Et.DOM.createRng(),Td=t=>it(t)&&/[\r\n\t ]/.test(t),cp=t=>!!t.setStart&&!!t.setEnd,Bd=t=>{const e=t.startContainer,n=t.startOffset;if(Td(t.toString())&&bk(e.parentNode)&&j(e)){const o=e.data;if(Td(o[n-1])||Td(o[n+1]))return!0}return!1},up=t=>t.left===0&&t.right===0&&t.top===0&&t.bottom===0,lo=t=>{var e;let n;const o=t.getClientRects();return n=o.length>0?$o(o[0]):$o(t.getBoundingClientRect()),!cp(t)&&Ad(t)&&up(n)?(r=>{const s=r.ownerDocument,a=Od(s),i=s.createTextNode(Zt),l=r.parentNode;l.insertBefore(i,r),a.setStart(i,0),a.setEnd(i,1);const d=$o(a.getBoundingClientRect());return l.removeChild(i),d})(t):up(n)&&cp(t)&&(e=(r=>{const s=r.startContainer,a=r.endContainer,i=r.startOffset,l=r.endOffset;if(s===a&&j(a)&&i===0&&l===1){const d=r.cloneRange();return d.setEndAfter(a),lo(d)}return null})(t))!==null&&e!==void 0?e:n},Vo=(t,e)=>{const n=op(t,e);return n.width=1,n.right=n.left+1,n},L=(t,e,n)=>{const o=()=>(n||(n=(r=>{const s=[],a=c=>{var u,g;c.height!==0&&(s.length>0&&(u=c,g=s[s.length-1],u.left===g.left&&u.top===g.top&&u.bottom===g.bottom&&u.right===g.right)||s.push(c))},i=(c,u)=>{const g=Od(c.ownerDocument);if(u<c.data.length){if(ap(c.data[u]))return;if(ap(c.data[u-1])&&(g.setStart(c,u),g.setEnd(c,u+1),!Bd(g)))return void a(Vo(lo(g),!1))}u>0&&(g.setStart(c,u-1),g.setEnd(c,u),Bd(g)||a(Vo(lo(g),!1))),u<c.data.length&&(g.setStart(c,u),g.setEnd(c,u+1),Bd(g)||a(Vo(lo(g),!0)))},l=r.container(),d=r.offset();if(Ps(l))return i(l,d),s;if(ip(l))if(r.isAtEnd()){const c=oi(l,d);Ps(c)&&i(c,c.data.length),Ds(c)&&!Ad(c)&&a(Vo(lo(c),!1))}else{const c=oi(l,d);if(Ps(c)&&i(c,0),Ds(c)&&r.isAtEnd())return a(Vo(lo(c),!1)),s;const u=oi(r.container(),r.offset()-1);Ds(u)&&!Ad(u)&&(lp(u)||lp(c)||!Ds(c))&&a(Vo(lo(u),!1)),Ds(c)&&a(Vo(lo(c),!0))}return s})(L(t,e))),n);return{container:Y(t),offset:Y(e),toRange:()=>{const r=Od(t.ownerDocument);return r.setStart(t,e),r.setEnd(t,e),r},getClientRects:o,isVisible:()=>o().length>0,isAtStart:()=>(Ps(t),e===0),isAtEnd:()=>Ps(t)?e>=t.data.length:e>=t.childNodes.length,isEqual:r=>r&&t===r.container()&&e===r.offset(),getNode:r=>oi(t,r?e-1:e)}};L.fromRangeStart=t=>L(t.startContainer,t.startOffset),L.fromRangeEnd=t=>L(t.endContainer,t.endOffset),L.after=t=>L(t.parentNode,dp(t)+1),L.before=t=>L(t.parentNode,dp(t)),L.isAbove=(t,e)=>pe(xe(e.getClientRects()),Eo(t.getClientRects()),Ts).getOr(!1),L.isBelow=(t,e)=>pe(Eo(e.getClientRects()),xe(t.getClientRects()),Bs).getOr(!1),L.isAtStart=t=>!!t&&t.isAtStart(),L.isAtEnd=t=>!!t&&t.isAtEnd(),L.isTextPosition=t=>!!t&&j(t.container()),L.isElementPosition=t=>!L.isTextPosition(t);const ri=(t,e)=>{j(e)&&e.data.length===0&&t.remove(e)},Dd=(t,e,n)=>{ad(n)?((o,r,s)=>{const a=C.from(s.firstChild),i=C.from(s.lastChild);r.insertNode(s),a.each(l=>ri(o,l.previousSibling)),i.each(l=>ri(o,l.nextSibling))})(t,e,n):((o,r,s)=>{r.insertNode(s),ri(o,s.previousSibling),ri(o,s.nextSibling)})(t,e,n)},sn=j,mp=Lo,fp=Et.nodeIndex,gp=t=>{const e=t.parentNode;return mp(e)?gp(e):e},Pd=t=>t?Oa(t.childNodes,(e,n)=>(mp(n)&&n.nodeName!=="BR"?e=e.concat(Pd(n)):e.push(n),e),[]):[],pp=t=>e=>t===e,hp=t=>(sn(t)?"text()":t.nodeName.toLowerCase())+"["+(e=>{let n,o;n=Pd(gp(e)),o=sf(n,pp(e),e),n=n.slice(0,o+1);const r=Oa(n,(s,a,i)=>(sn(a)&&sn(n[i-1])&&s++,s),0);return n=ss(n,en([e.nodeName])),o=sf(n,pp(e),e),o-r})(t)+"]",bp=(t,e)=>{let n,o=[],r=e.container(),s=e.offset();if(sn(r))n=((i,l)=>{let d=i;for(;(d=d.previousSibling)&&sn(d);)l+=d.data.length;return l})(r,s);else{const i=r.childNodes;s>=i.length?(n="after",s=i.length-1):n="before",r=i[s]}o.push(hp(r));let a=((i,l,d)=>{const c=[];for(let u=l.parentNode;u&&u!==i;u=u.parentNode)c.push(u);return c})(t,r);return a=ss(a,Ea(Lo)),o=o.concat(ql(a,i=>hp(i))),o.reverse().join("/")+","+n},vp=(t,e)=>{if(!e)return null;const n=e.split(","),o=n[0].split("/"),r=n.length>1?n[1]:"before",s=Oa(o,(a,i)=>{const l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(i);return l?(l[1]==="text()"&&(l[1]="#text"),((d,c,u)=>{let g=Pd(d);return g=ss(g,(p,m)=>!sn(p)||!sn(g[m-1])),g=ss(g,en([c])),g[u]})(a,l[1],parseInt(l[2],10))):null},t);if(!s)return null;if(!sn(s)&&s.parentNode){let a;return a=r==="after"?fp(s)+1:fp(s),L(s.parentNode,a)}return((a,i)=>{let l=a,d=0;for(;sn(l);){const c=l.data.length;if(i>=d&&i<=d+c){a=l,i-=d;break}if(!sn(l.nextSibling)){a=l,i=c;break}d+=c,l=l.nextSibling}return sn(a)&&i>a.data.length&&(i=a.data.length),L(a,i)})(s,parseInt(r,10))},si=Rt,yp=(t,e,n,o,r)=>{const s=r?o.startContainer:o.endContainer;let a=r?o.startOffset:o.endOffset;const i=[],l=t.getRoot();if(j(s))i.push(n?((d,c,u)=>{let g=d(c.data.slice(0,u)).length;for(let p=c.previousSibling;p&&j(p);p=p.previousSibling)g+=d(p.data).length;return g})(e,s,a):a);else{let d=0;const c=s.childNodes;a>=c.length&&c.length&&(d=1,a=Math.max(0,c.length-1)),i.push(t.nodeIndex(c[a],n)+d)}for(let d=s;d&&d!==l;d=d.parentNode)i.push(t.nodeIndex(d,n));return i},Ld=(t,e,n)=>{let o=0;return $.each(t.select(e),r=>r.getAttribute("data-mce-bogus")==="all"?void 0:r!==n&&void o++),o},Cp=(t,e)=>{let n=e?t.startContainer:t.endContainer,o=e?t.startOffset:t.endOffset;if(J(n)&&n.nodeName==="TR"){const r=n.childNodes;n=r[Math.min(e?o:o-1,r.length-1)],n&&(o=e?0:n.childNodes.length,e?t.setStart(n,o):t.setEnd(n,o))}},wp=t=>(Cp(t,!0),Cp(t,!1),t),xp=(t,e)=>{if(J(t)&&(t=io(t,e),si(t)))return t;if(Ie(t)){j(t)&&Cr(t)&&(t=t.parentNode);let n=t.previousSibling;if(si(n)||(n=t.nextSibling,si(n)))return n}},kp=(t,e,n)=>{const o=n.getNode(),r=n.getRng();if(o.nodeName==="IMG"||si(o)){const a=o.nodeName;return{name:a,index:Ld(n.dom,a,o)}}const s=(a=>xp(a.startContainer,a.startOffset)||xp(a.endContainer,a.endOffset))(r);if(s){const a=s.tagName;return{name:a,index:Ld(n.dom,a,s)}}return((a,i,l,d)=>{const c=i.dom,u=yp(c,a,l,d,!0),g=i.isForward(),p=vg(d)?{isFakeCaret:!0}:{};return i.isCollapsed()?K({start:u,forward:g},p):K({start:u,end:yp(c,a,l,d,!1),forward:g},p)})(t,n,e,r)},Sp=(t,e,n)=>{const o={"data-mce-type":"bookmark",id:e,style:"overflow:hidden;line-height:0px"};return n?t.create("span",o,"&#xFEFF;"):t.create("span",o)},Ep=(t,e)=>{const n=t.dom;let o=t.getRng();const r=n.uniqueId(),s=t.isCollapsed(),a=t.getNode(),i=a.nodeName,l=t.isForward();if(i==="IMG")return{name:i,index:Ld(n,i,a)};const d=wp(o.cloneRange());if(!s){d.collapse(!1);const u=Sp(n,r+"_end",e);Dd(n,d,u)}o=wp(o),o.collapse(!0);const c=Sp(n,r+"_start",e);return Dd(n,o,c),t.moveToBookmark({id:r,keep:!0,forward:l}),{id:r,forward:l}},Md=tt(kp,ge,!0),_p=t=>{const e=s=>s(t),n=Y(t),o=()=>r,r={tag:!0,inner:t,fold:(s,a)=>a(t),isValue:Ht,isError:Dt,map:s=>he.value(s(t)),mapError:o,bind:e,exists:e,forall:e,getOr:n,or:o,getOrThunk:n,orThunk:o,getOrDie:n,each:s=>{s(t)},toOptional:()=>C.some(t)};return r},Np=t=>{const e=()=>n,n={tag:!1,inner:t,fold:(r,s)=>r(t),isValue:Dt,isError:Ht,map:e,mapError:r=>he.error(r(t)),bind:e,exists:Dt,forall:Ht,getOr:ge,or:ge,getOrThunk:Il,orThunk:Il,getOrDie:(o=String(t),()=>{throw new Error(o)}),each:bt,toOptional:C.none};var o;return n},he={value:_p,error:Np,fromOption:(t,e)=>t.fold(()=>Np(e),_p)},Cn=t=>{if(!$t(t))throw new Error("cases must be an array");if(t.length===0)throw new Error("there must be at least one case");const e=[],n={};return H(t,(o,r)=>{const s=Oe(o);if(s.length!==1)throw new Error("one and only one name per case");const a=s[0],i=o[a];if(n[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!$t(i))throw new Error("case arguments must be an array");e.push(a),n[a]=(...l)=>{const d=l.length;if(d!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+d);return{fold:(...c)=>{if(c.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+c.length);return c[r].apply(null,l)},match:c=>{const u=Oe(c);if(e.length!==u.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+`
Actual: `+u.join(","));if(!So(e,g=>_t(u,g)))throw new Error("Not all branches were specified when using match. Specified: "+u.join(", ")+`
Required: `+e.join(", "));return c[a].apply(null,l)},log:c=>{console.log(c,{constructors:e,constructor:a,params:l})}}}}),n};Cn([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const vk=t=>t.type==="inline-command"||t.type==="inline-format",yk=t=>t.type==="block-command"||t.type==="block-format",Ck=t=>{const e=o=>he.error({message:o,pattern:t}),n=(o,r,s)=>{if(t.format!==void 0){let a;if($t(t.format)){if(!So(t.format,it))return e(o+" pattern has non-string items in the `format` array");a=t.format}else{if(!it(t.format))return e(o+" pattern has non-string `format` parameter");a=[t.format]}return he.value(r(a))}return t.cmd!==void 0?it(t.cmd)?he.value(s(t.cmd,t.value)):e(o+" pattern has non-string `cmd` parameter"):e(o+" pattern is missing both `format` and `cmd` parameters")};if(!me(t))return e("Raw pattern is not an object");if(!it(t.start))return e("Raw pattern is missing `start` parameter");if(t.end!==void 0){if(!it(t.end))return e("Inline pattern has non-string `end` parameter");if(t.start.length===0&&t.end.length===0)return e("Inline pattern has empty `start` and `end` parameters");let o=t.start,r=t.end;return r.length===0&&(r=o,o=""),n("Inline",s=>({type:"inline-format",start:o,end:r,format:s}),(s,a)=>({type:"inline-command",start:o,end:r,cmd:s,value:a}))}return t.replacement!==void 0?it(t.replacement)?t.start.length===0?e("Replacement pattern has empty `start` parameter"):he.value({type:"inline-command",start:"",end:t.start,cmd:"mceInsertContent",value:t.replacement}):e("Replacement pattern has non-string `replacement` parameter"):t.start.length===0?e("Block pattern has empty `start` parameter"):n("Block",o=>({type:"block-format",start:t.start,format:o[0]}),(o,r)=>({type:"block-command",start:t.start,cmd:o,value:r}))},Rp=t=>mt(t,yk),Ap=t=>mt(t,vk),Op=t=>{const e=(n=>{const o=[],r=[];return H(n,s=>{s.fold(a=>{o.push(a)},a=>{r.push(a)})}),{errors:o,values:r}})(yt(t,Ck));return H(e.errors,n=>console.error(n.message,n.pattern)),e.values},Id=Ro().deviceType,wk=Id.isTouch(),xk=Et.DOM,Tp=t=>Sa(t,RegExp),Z=t=>e=>e.options.get(t),Fd=t=>it(t)||me(t),Bp=(t,e="")=>n=>{const o=it(n);if(o){if(n.indexOf("=")!==-1){const r=(s=>{const a=s.indexOf("=")>0?s.split(/[;,](?![^=;,]*(?:[;,]|$))/):s.split(",");return Re(a,(i,l)=>{const d=l.split("="),c=d[0],u=d.length>1?d[1]:c;return i[gr(c)]=gr(u),i},{})})(n);return{value:At(r,t.id).getOr(e),valid:o}}return{value:n,valid:o}}return{valid:!1,message:"Must be a string."}},kk=Z("iframe_attrs"),Sk=Z("doctype"),Dp=Z("document_base_url"),Ek=Z("body_id"),_k=Z("body_class"),Pp=Z("content_security_policy"),Nk=Z("br_in_pre"),Be=Z("forced_root_block"),Ls=Z("forced_root_block_attrs"),Rk=Z("newline_behavior"),Ak=Z("br_newline_selector"),Ok=Z("no_newline_selector"),Tk=Z("keep_styles"),Bk=Z("end_container_on_empty_block"),Lp=Z("automatic_uploads"),Mp=Z("images_reuse_filename"),Dk=Z("images_replace_blob_uris"),Ip=Z("icons"),Pk=Z("icons_url"),Lk=Z("images_upload_url"),Mk=Z("images_upload_base_path"),Ik=Z("images_upload_credentials"),Fk=Z("images_upload_handler"),Uk=Z("content_css_cors"),Ud=Z("referrer_policy"),Fp=Z("language"),zk=Z("language_url"),Up=Z("indent_use_margin"),jk=Z("indentation"),Hk=Z("content_css"),$k=Z("content_style"),zp=Z("font_css"),Vk=Z("directionality"),qk=Z("inline_boundaries_selector"),jp=Z("object_resizing"),Wk=Z("resize_img_proportional"),Kk=Z("placeholder"),Hp=Z("event_root"),Gk=Z("service_message"),_r=Z("theme"),Yk=Z("theme_url"),zd=Z("model"),Xk=Z("model_url"),Ms=Z("inline_boundaries"),Qk=Z("formats"),Jk=Z("preview_styles"),Zk=Z("format_empty_lines"),tS=Z("format_noneditable_selector"),eS=Z("custom_ui_selector"),jd=Z("inline"),nS=Z("hidden_input"),oS=Z("submit_patch"),rS=Z("add_form_submit_trigger"),sS=Z("add_unload_trigger"),aS=Z("custom_undo_redo_levels"),iS=Z("disable_nodechange"),$p=Z("readonly"),Vp=Z("content_css_cors"),ai=Z("plugins"),lS=Z("external_plugins"),dS=Z("block_unsupported_drop"),cS=Z("visual"),uS=Z("visual_table_class"),qp=Z("visual_anchor_class"),mS=Z("iframe_aria_text"),fS=Z("setup"),gS=Z("init_instance_callback"),pS=Z("urlconverter_callback"),hS=Z("auto_focus"),bS=Z("browser_spellcheck"),vS=Z("protect"),yS=Z("paste_block_drop"),ii=Z("paste_data_images"),CS=Z("paste_preprocess"),wS=Z("paste_postprocess"),xS=Z("paste_webkit_styles"),kS=Z("paste_remove_styles_if_webkit"),SS=Z("paste_merge_formats"),ES=Z("smart_paste"),_S=Z("paste_as_text"),NS=Z("paste_tab_spaces"),RS=Z("allow_html_data_urls"),AS=Z("text_patterns"),OS=Z("text_patterns_lookup"),Wp=Z("noneditable_class"),TS=Z("editable_class"),BS=Z("noneditable_regexp"),DS=Z("preserve_cdata"),Kp=t=>$.explode(t.options.get("images_file_types")),PS=Z("table_tab_navigation"),LS=J,Gp=j,Yp=t=>{const e=t.parentNode;e&&e.removeChild(t)},Xp=t=>{const e=jn(t);return{count:t.length-e.length,text:e}},Qp=t=>{let e;for(;(e=t.data.lastIndexOf(ae))!==-1;)t.deleteData(e,1)},Jp=(t,e)=>(qo(t),e),MS=(t,e)=>L.isTextPosition(e)?((n,o)=>Gp(n)&&o.container()===n?((r,s)=>{const a=Xp(r.data.substr(0,s.offset())),i=Xp(r.data.substr(s.offset()));return(a.text+i.text).length>0?(Qp(r),L(r,s.offset()-a.count)):s})(n,o):Jp(n,o))(t,e):((n,o)=>o.container()===n.parentNode?((r,s)=>{const a=s.container(),i=((l,d)=>{const c=Jm(l,d);return c===-1?C.none():C.some(c)})(Ae(a.childNodes),r).map(l=>l<s.offset()?L(a,s.offset()-1):s).getOr(s);return qo(r),i})(n,o):Jp(n,o))(t,e),qo=t=>{LS(t)&&Ie(t)&&(bg(t)?t.removeAttribute("data-mce-caret"):Yp(t)),Gp(t)&&(Qp(t),t.data.length===0&&Yp(t))},IS=Rt,FS=yn,US=$a,Zp=(t,e,n)=>{const o=op(e.getBoundingClientRect(),n);let r,s;if(t.tagName==="BODY"){const i=t.ownerDocument.documentElement;r=t.scrollLeft||i.scrollLeft,s=t.scrollTop||i.scrollTop}else{const i=t.getBoundingClientRect();r=t.scrollLeft-i.left,s=t.scrollTop-i.top}o.left+=r,o.right+=r,o.top+=s,o.bottom+=s,o.width=1;let a=e.offsetWidth-e.clientWidth;return a>0&&(n&&(a*=-1),o.left+=a,o.right+=a),o},zS=(t,e,n,o)=>{const r=ao();let s,a;const i=Be(t),l=t.dom,d=()=>{(c=>{var u,g;const p=le(N(c),"*[contentEditable=false],video,audio,embed,object");for(let m=0;m<p.length;m++){const h=p[m].dom;let f=h.previousSibling;if(Ka(f)){const b=f.data;b.length===1?(u=f.parentNode)===null||u===void 0||u.removeChild(f):f.deleteData(b.length-1,1)}f=h.nextSibling,Wa(f)&&(f.data.length===1?(g=f.parentNode)===null||g===void 0||g.removeChild(f):f.deleteData(0,1))}})(e),a&&(qo(a),a=null),r.on(c=>{l.remove(c.caret),r.clear()}),s&&(clearInterval(s),s=void 0)};return{show:(c,u)=>{let g;if(d(),US(u))return null;if(!n(u))return a=((p,m)=>{var h;const f=((h=p.ownerDocument)!==null&&h!==void 0?h:document).createTextNode(ae),b=p.parentNode;if(m){const v=p.previousSibling;if(yr(v)){if(Ie(v))return v;if(Ka(v))return v.splitText(v.data.length-1)}b==null||b.insertBefore(f,p)}else{const v=p.nextSibling;if(yr(v)){if(Ie(v))return v;if(Wa(v))return v.splitText(1),v}p.nextSibling?b==null||b.insertBefore(f,p.nextSibling):b==null||b.appendChild(f)}return f})(u,c),g=u.ownerDocument.createRange(),Is(a.nextSibling)?(g.setStart(a,0),g.setEnd(a,0)):(g.setStart(a,1),g.setEnd(a,1)),g;{const p=((f,b,v)=>{var y;const w=((y=b.ownerDocument)!==null&&y!==void 0?y:document).createElement(f);w.setAttribute("data-mce-caret",v?"before":"after"),w.setAttribute("data-mce-bogus","all"),w.appendChild(cd().dom);const k=b.parentNode;return v?k==null||k.insertBefore(w,b):b.nextSibling?k==null||k.insertBefore(w,b.nextSibling):k==null||k.appendChild(w),w})(i,u,c),m=Zp(e,u,c);l.setStyle(p,"top",m.top),a=p;const h=l.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});l.setStyles(h,K({},m)),l.add(e,h),r.set({caret:h,element:u,before:c}),c&&l.addClass(h,"mce-visual-caret-before"),s=setInterval(()=>{r.on(f=>{o()?l.toggleClass(f.caret,"mce-visual-caret-hidden"):l.addClass(f.caret,"mce-visual-caret-hidden")})},500),g=u.ownerDocument.createRange(),g.setStart(p,0),g.setEnd(p,0)}return g},hide:d,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{r.on(c=>{const u=Zp(e,c.element,c.before);l.setStyles(c.caret,K({},u))})},destroy:()=>clearInterval(s)}},th=()=>Ct.browser.isFirefox(),Is=t=>IS(t)||FS(t),Fs=t=>Is(t)||zn(t)&&th(),jS=nn,Hd=Rt,HS=yn,eh=Ha("display","block table table-cell table-caption list-item"),nh=Ie,oh=Cr,$S=J,VS=j,qS=Ye,Nr=t=>t>0,Wo=t=>t<0,li=(t,e)=>{let n;for(;n=t(e);)if(!oh(n))return n;return null},Us=(t,e,n,o,r)=>{const s=new Vt(t,o),a=Hd(t)||oh(t);let i;if(Wo(e)){if(a&&(i=li(s.prev.bind(s),!0),n(i)))return i;for(;i=li(s.prev.bind(s),r);)if(n(i))return i}if(Nr(e)){if(a&&(i=li(s.next.bind(s),!0),n(i)))return i;for(;i=li(s.next.bind(s),r);)if(n(i))return i}return null},co=(t,e)=>{for(;t&&t!==e;){if(eh(t))return t;t=t.parentNode}return null},wn=(t,e,n)=>co(t.container(),n)===co(e.container(),n),$d=(t,e)=>{if(!e)return C.none();const n=e.container(),o=e.offset();return $S(n)?C.from(n.childNodes[o+t]):C.none()},rh=(t,e)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createRange();return t?(o.setStartBefore(e),o.setEndBefore(e)):(o.setStartAfter(e),o.setEndAfter(e)),o},WS=(t,e,n)=>co(e,t)===co(n,t),sh=(t,e,n)=>{const o=t?"previousSibling":"nextSibling";let r=n;for(;r&&r!==e;){let s=r[o];if(s&&nh(s)&&(s=s[o]),Hd(s)||HS(s)){if(WS(e,s,r))return s;break}if(qS(s))break;r=r.parentNode}return null},zs=tt(rh,!0),js=tt(rh,!1),Vd=(t,e,n)=>{let o;const r=tt(sh,!0,e),s=tt(sh,!1,e),a=n.startContainer,i=n.startOffset;if(Cr(a)){const l=VS(a)?a.parentNode:a,d=l.getAttribute("data-mce-caret");if(d==="before"&&(o=l.nextSibling,Fs(o)))return zs(o);if(d==="after"&&(o=l.previousSibling,Fs(o)))return js(o)}if(!n.collapsed)return n;if(j(a)){if(nh(a)){if(t===1){if(o=s(a),o)return zs(o);if(o=r(a),o)return js(o)}if(t===-1){if(o=r(a),o)return js(o);if(o=s(a),o)return zs(o)}return n}if(Ka(a)&&i>=a.data.length-1)return t===1&&(o=s(a),o)?zs(o):n;if(Wa(a)&&i<=1)return t===-1&&(o=r(a),o)?js(o):n;if(i===a.data.length)return o=s(a),o?zs(o):n;if(i===0)return o=r(a),o?js(o):n}return n},ah=(t,e)=>$d(t?0:-1,e).filter(Hd),Hs=(t,e,n)=>{const o=Vd(t,e,n);return t===-1?L.fromRangeStart(o):L.fromRangeEnd(o)},di=t=>C.from(t.getNode()).map(N),qd=(t,e)=>{let n=e;for(;n=t(n);)if(n.isVisible())return n;return n},ci=(t,e)=>{const n=wn(t,e);return!(n||!Ft(t.getNode()))||n};var Yt;(function(t){t[t.Backwards=-1]="Backwards",t[t.Forwards=1]="Forwards"})(Yt||(Yt={}));const KS=Rt,xn=j,ih=J,Wd=Ft,Rr=Ye,lh=t=>Cg(t)||(e=>!!gd(e)&&!Re(Ae(e.getElementsByTagName("*")),(n,o)=>n||yg(o),!1))(t),ui=wg,dh=(t,e)=>t.hasChildNodes()&&e<t.childNodes.length?t.childNodes[e]:null,ch=(t,e)=>{if(Nr(t)){if(Rr(e.previousSibling)&&!xn(e.previousSibling))return L.before(e);if(xn(e))return L(e,0)}if(Wo(t)){if(Rr(e.nextSibling)&&!xn(e.nextSibling))return L.after(e);if(xn(e))return L(e,e.data.length)}return Wo(t)?Wd(e)?L.before(e):L.after(e):L.before(e)},Kd=(t,e,n)=>{let o,r,s,a;if(!ih(n)||!e)return null;if(e.isEqual(L.after(n))&&n.lastChild){if(a=L.after(n.lastChild),Wo(t)&&Rr(n.lastChild)&&ih(n.lastChild))return Wd(n.lastChild)?L.before(n.lastChild):a}else a=e;const i=a.container();let l=a.offset();if(xn(i)){if(Wo(t)&&l>0)return L(i,--l);if(Nr(t)&&l<i.length)return L(i,++l);o=i}else{if(Wo(t)&&l>0&&(r=dh(i,l-1),Rr(r)))return!lh(r)&&(s=Us(r,t,ui,r),s)?xn(s)?L(s,s.data.length):L.after(s):xn(r)?L(r,r.data.length):L.before(r);if(Nr(t)&&l<i.childNodes.length&&(r=dh(i,l),Rr(r)))return Wd(r)?((c,u)=>{const g=u.nextSibling;return g&&Rr(g)?xn(g)?L(g,0):L.before(g):Kd(Yt.Forwards,L.after(u),c)})(n,r):!lh(r)&&(s=Us(r,t,ui,r),s)?xn(s)?L(s,0):L.before(s):xn(r)?L(r,0):L.after(r);o=r||a.getNode()}if(o&&(Nr(t)&&a.isAtEnd()||Wo(t)&&a.isAtStart())&&(o=Us(o,t,Ht,n,!0),ui(o,n)))return ch(t,o);r=o&&Us(o,t,ui,n);const d=_o(mt(((c,u)=>{const g=[];let p=c;for(;p&&p!==u;)g.push(p),p=p.parentNode;return g})(i,n),KS));return!d||r&&d.contains(r)?r?ch(t,r):null:(a=Nr(t)?L.after(d):L.before(d),a)},kn=t=>({next:e=>Kd(Yt.Forwards,e,t),prev:e=>Kd(Yt.Backwards,e,t)}),uh=t=>L.isTextPosition(t)?t.offset()===0:Ye(t.getNode()),mh=t=>{if(L.isTextPosition(t)){const e=t.container();return t.offset()===e.data.length}return Ye(t.getNode(!0))},fh=(t,e)=>!L.isTextPosition(t)&&!L.isTextPosition(e)&&t.getNode()===e.getNode(!0),Fe=(t,e,n)=>{const o=kn(e);return C.from(t?o.next(n):o.prev(n))},mi=(t,e,n)=>Fe(t,e,n).bind(o=>wn(n,o,e)&&((r,s,a)=>{return r?!fh(s,a)&&(i=s,!(!L.isTextPosition(i)&&Ft(i.getNode())))&&mh(s)&&uh(a):!fh(a,s)&&uh(s)&&mh(a);var i})(t,n,o)?Fe(t,e,o):C.some(o)),gh=(t,e,n,o)=>mi(t,e,n).bind(r=>o(r)?gh(t,e,r,o):C.some(r)),Ar=(t,e)=>{const n=t?e.firstChild:e.lastChild;return j(n)?C.some(L(n,t?0:n.data.length)):n?Ye(n)?C.some(t?L.before(n):Ft(o=n)?L.before(o):L.after(o)):((r,s,a)=>{const i=r?L.before(a):L.after(a);return Fe(r,s,i)})(t,e,n):C.none();var o},ke=tt(Fe,!0),Ue=tt(Fe,!1),be=tt(Ar,!0),Sn=tt(Ar,!1),Gd="_mce_caret",an=t=>J(t)&&t.id===Gd,Ko=(t,e)=>{let n=e;for(;n&&n!==t;){if(an(n))return n;n=n.parentNode}return null},ph=t=>pt(t,"name"),hh=t=>$.isArray(t.start),fi=t=>!(!ph(t)&&xo(t.forward))||t.forward,bh=(t,e)=>(J(e)&&t.isBlock(e)&&!e.innerHTML&&(e.innerHTML='<br data-mce-bogus="1" />'),e),GS=(t,e)=>Sn(t).fold(Dt,n=>(e.setStart(n.container(),n.offset()),e.setEnd(n.container(),n.offset()),!0)),vh=(t,e,n)=>!(!(o=>!o.hasChildNodes())(e)||!Ko(t,e)||(((o,r)=>{var s;const a=((s=o.ownerDocument)!==null&&s!==void 0?s:document).createTextNode(ae);o.appendChild(a),r.setStart(a,0),r.setEnd(a,0)})(e,n),0)),yh=(t,e,n,o)=>{const r=n[e?"start":"end"],s=t.getRoot();if(r){let a=s,i=r[0];for(let l=r.length-1;a&&l>=1;l--){const d=a.childNodes;if(vh(s,a,o))return!0;if(r[l]>d.length-1)return!!vh(s,a,o)||GS(a,o);a=d[r[l]]}j(a)&&(i=Math.min(r[0],a.data.length)),J(a)&&(i=Math.min(r[0],a.childNodes.length)),e?o.setStart(a,i):o.setEnd(a,i)}return!0},Yd=t=>j(t)&&t.data.length>0,Ch=(t,e,n)=>{const o=t.get(n.id+"_"+e),r=o==null?void 0:o.parentNode,s=n.keep;if(o&&r){let a,i;if(e==="start"?s?o.hasChildNodes()?(a=o.firstChild,i=1):Yd(o.nextSibling)?(a=o.nextSibling,i=0):Yd(o.previousSibling)?(a=o.previousSibling,i=o.previousSibling.data.length):(a=r,i=t.nodeIndex(o)+1):(a=r,i=t.nodeIndex(o)):s?o.hasChildNodes()?(a=o.firstChild,i=1):Yd(o.previousSibling)?(a=o.previousSibling,i=o.previousSibling.data.length):(a=r,i=t.nodeIndex(o)):(a=r,i=t.nodeIndex(o)),!s){const l=o.previousSibling,d=o.nextSibling;let c;for($.each($.grep(o.childNodes),u=>{j(u)&&(u.data=u.data.replace(/\uFEFF/g,""))});c=t.get(n.id+"_"+e);)t.remove(c,!0);if(j(d)&&j(l)&&!Ct.browser.isOpera()){const u=l.data.length;l.appendData(d.data),t.remove(d),a=l,i=u}}return C.some(L(a,i))}return C.none()},YS=(t,e,n)=>((o,r,s=!1)=>r===2?kp(jn,s,o):r===3?(a=>{const i=a.getRng();return{start:bp(a.dom.getRoot(),L.fromRangeStart(i)),end:bp(a.dom.getRoot(),L.fromRangeEnd(i)),forward:a.isForward()}})(o):r?(a=>({rng:a.getRng(),forward:a.isForward()}))(o):Ep(o,!1))(t,e,n),XS=(t,e)=>{((n,o)=>{const r=n.dom;if(o){if(hh(o))return((s,a)=>{const i=s.createRng();return yh(s,!0,a,i)&&yh(s,!1,a,i)?C.some({range:i,forward:fi(a)}):C.none()})(r,o);if((s=>it(s.start))(o))return((s,a)=>{const i=C.from(vp(s.getRoot(),a.start)),l=C.from(vp(s.getRoot(),a.end));return pe(i,l,(d,c)=>{const u=s.createRng();return u.setStart(d.container(),d.offset()),u.setEnd(c.container(),c.offset()),{range:u,forward:fi(a)}})})(r,o);if((s=>pt(s,"id"))(o))return((s,a)=>{const i=Ch(s,"start",a),l=Ch(s,"end",a);return pe(i,l.or(i),(d,c)=>{const u=s.createRng();return u.setStart(bh(s,d.container()),d.offset()),u.setEnd(bh(s,c.container()),c.offset()),{range:u,forward:fi(a)}})})(r,o);if(ph(o))return((s,a)=>C.from(s.select(a.name)[a.index]).map(i=>{const l=s.createRng();return l.selectNode(i),{range:l,forward:!0}}))(r,o);if((s=>pt(s,"rng"))(o))return C.some({range:o.rng,forward:fi(o)})}return C.none()})(t,e).each(({range:n,forward:o})=>{t.setRng(n,o)})},ze=t=>J(t)&&t.tagName==="SPAN"&&t.getAttribute("data-mce-type")==="bookmark",gi=t=>t==="\xA0",Or=t=>t!==""&&` \f
\r	\v`.indexOf(t)!==-1,Xd=t=>!Or(t)&&!gi(t)&&!fg(t),Qd=t=>{const e=t.toString(16);return(e.length===1?"0"+e:e).toUpperCase()},QS=t=>(e=>({value:e}))(Qd(t.red)+Qd(t.green)+Qd(t.blue)),JS=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,ZS=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,wh=(t,e,n,o)=>({red:t,green:e,blue:n,alpha:o}),xh=(t,e,n,o)=>{const r=parseInt(t,10),s=parseInt(e,10),a=parseInt(n,10),i=parseFloat(o);return wh(r,s,a,i)},pi=t=>(e=>{if(e==="transparent")return C.some(wh(0,0,0,0));const n=JS.exec(e);if(n!==null)return C.some(xh(n[1],n[2],n[3],"1"));const o=ZS.exec(e);return o!==null?C.some(xh(o[1],o[2],o[3],o[4])):C.none()})(t).map(QS).map(e=>"#"+e.value).getOr(t),Jd=t=>{const e=[];if(t)for(let n=0;n<t.rangeCount;n++)e.push(t.getRangeAt(n));return e},kh=(t,e)=>{const n=le(e,"td[data-mce-selected],th[data-mce-selected]");return n.length>0?n:(o=>mt((r=>Ln(r,s=>{const a=ni(s);return a?[N(a)]:[]}))(o),ws))(t)},Tr=t=>kh(Jd(t.selection.getSel()),N(t.getBody())),$s=(t,e)=>hs(t,"table",e),Sh=t=>$f(t).fold(Y([t]),e=>[t].concat(Sh(e))),Zd=t=>Zl(t).fold(Y([t]),e=>Ot(e)==="br"?Oo(e).map(n=>[t].concat(Zd(n))).getOr([]):[t].concat(Zd(e))),tc=(t,e)=>pe((n=>{const o=n.startContainer,r=n.startOffset;return j(o)?r===0?C.some(N(o)):C.none():C.from(o.childNodes[r]).map(N)})(e),(n=>{const o=n.endContainer,r=n.endOffset;return j(o)?r===o.data.length?C.some(N(o)):C.none():C.from(o.childNodes[r-1]).map(N)})(e),(n,o)=>{const r=Wt(Sh(t),tt(xt,n)),s=Wt(Zd(t),tt(xt,o));return r.isSome()&&s.isSome()}).getOr(!1),ec=(t,e,n,o)=>{const r=n,s=new Vt(n,r),a=rs(t.schema.getMoveCaretBeforeOnEnterElements(),(l,d)=>!_t(["td","th","table"],d.toLowerCase()));let i=n;do{if(j(i)&&$.trim(i.data).length!==0)return void(o?e.setStart(i,0):e.setEnd(i,i.data.length));if(a[i.nodeName])return void(o?e.setStartBefore(i):i.nodeName==="BR"?e.setEndBefore(i):e.setEndAfter(i))}while(i=o?s.next():s.prev());r.nodeName==="BODY"&&(o?e.setStart(r,0):e.setEnd(r,r.childNodes.length))},hi=t=>{const e=t.selection.getSel();return Q(e)&&e.rangeCount>0},nc=(t,e)=>{const n=Tr(t);n.length>0?H(n,o=>{const r=o.dom,s=t.dom.createRng();s.setStartBefore(r),s.setEndAfter(r),e(s,!0)}):e(t.selection.getRng(),!1)},Eh=(t,e,n)=>{const o=Ep(t,e);n(o),t.moveToBookmark(o)},bi=t=>Je(t==null?void 0:t.nodeType),oc=t=>J(t)&&!ze(t)&&!an(t)&&!Lo(t),Go=t=>t.isContentEditable===!0,_h=(t,e,n)=>{const{selection:o,dom:r}=t,s=o.getNode(),a=Rt(s);Eh(o,!0,()=>{e()}),a&&Rt(s)&&r.isChildOf(s,t.getBody())?t.selection.select(s):n(o.getStart())&&tE(r,o)},tE=(t,e)=>{var n,o;const r=e.getRng(),{startContainer:s,startOffset:a}=r;if(!((i,l)=>{if(oc(l)&&!/^(TD|TH)$/.test(l.nodeName)){const d=i.getAttrib(l,"data-mce-selected"),c=parseInt(d,10);return!isNaN(c)&&c>0}return!1})(t,e.getNode())&&J(s)){const i=s.childNodes,l=t.getRoot();let d;if(a<i.length){const c=i[a];d=new Vt(c,(n=t.getParent(c,t.isBlock))!==null&&n!==void 0?n:l)}else{const c=i[i.length-1];d=new Vt(c,(o=t.getParent(c,t.isBlock))!==null&&o!==void 0?o:l),d.next(!0)}for(let c=d.current();c;c=d.next()){if(t.getContentEditable(c)==="false")return;if(j(c)&&!sc(c))return r.setStart(c,0),void e.setRng(r)}}},Nh=(t,e,n)=>{if(t){const o=e?"nextSibling":"previousSibling";for(t=n?t:t[o];t;t=t[o])if(J(t)||!sc(t))return t}},rc=(t,e)=>!!t.getTextBlockElements()[e.nodeName.toLowerCase()]||ks(t,e),Br=(t,e,n)=>t.schema.isValidChild(e,n),sc=(t,e=!1)=>{if(Q(t)&&j(t)){const n=e?t.data.replace(/ /g,"\xA0"):t.data;return Fo(n)}return!1},Rh=(t,e)=>{const n=t.dom;return oc(e)&&n.getContentEditable(e)==="false"&&((o,r)=>{const s="[data-mce-cef-wrappable]",a=tS(o),i=is(a)?s:`${s},${a}`;return Ze(N(r),i)})(t,e)&&n.select('[contenteditable="true"]',e).length===0},uo=(t,e)=>wt(t)?t(e):(Q(e)&&(t=t.replace(/%(\w+)/g,(n,o)=>e[o]||n)),t),ac=(t,e)=>(e=e||"",t=""+((t=t||"").nodeName||t),e=""+(e.nodeName||e),t.toLowerCase()===e.toLowerCase()),ic=(t,e)=>{if(jt(t))return null;{let n=String(t);return e!=="color"&&e!=="backgroundColor"||(n=pi(n)),e==="fontWeight"&&t===700&&(n="bold"),e==="fontFamily"&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},vi=(t,e,n)=>{const o=t.getStyle(e,n);return ic(o,n)},Ah=(t,e)=>{let n;return t.getParent(e,o=>!!J(o)&&(n=t.getStyle(o,"text-decoration"),!!n&&n!=="none")),n},yi=(t,e,n)=>t.getParents(e,n,t.getRoot()),lc=(t,e,n)=>{const o=t.formatter.get(e);return Q(o)&&It(o,n)},En=t=>fr(t,"block"),je=t=>fr(t,"selector"),qt=t=>fr(t,"inline"),dc=t=>je(t)&&t.expand!==!1&&!qt(t),Dr=ze,Oh=yi,Th=sc,eE=rc,Bh=(t,e)=>{let n=e;for(;n;){if(J(n)&&t.getContentEditable(n))return t.getContentEditable(n)==="false"?n:e;n=n.parentNode}return e},Dh=(t,e,n,o)=>{const r=e.data;if(t){for(let s=n;s>0;s--)if(o(r.charAt(s-1)))return s}else for(let s=n;s<r.length;s++)if(o(r.charAt(s)))return s;return-1},nE=(t,e,n)=>Dh(t,e,n,o=>gi(o)||Or(o)),oE=(t,e,n)=>Dh(t,e,n,Xd),Ph=(t,e,n,o,r,s)=>{let a;const i=t.getParent(n,t.isBlock)||e,l=(d,c,u)=>{const g=Ho(t),p=r?g.backwards:g.forwards;return C.from(p(d,c,(m,h)=>Dr(m.parentNode)?-1:(a=m,u(r,m,h)),i))};return l(n,o,nE).bind(d=>s?l(d.container,d.offset+(r?-1:0),oE):C.some(d)).orThunk(()=>a?C.some({container:a,offset:r?0:a.length}):C.none())},Lh=(t,e,n,o,r)=>{const s=o[r];j(o)&&is(o.data)&&s&&(o=s);const a=Oh(t,o);for(let i=0;i<a.length;i++)for(let l=0;l<e.length;l++){const d=e[l];if((!Q(d.collapsed)||d.collapsed===n.collapsed)&&je(d)&&t.is(a[i],d.selector))return a[i]}return o},Mh=(t,e,n,o)=>{var r;let s=n;const a=t.getRoot(),i=e[0];if(En(i)&&(s=i.wrapper?null:t.getParent(n,i.block,a)),!s){const l=(r=t.getParent(n,"LI,TD,TH"))!==null&&r!==void 0?r:a;s=t.getParent(j(n)?n.parentNode:n,d=>d!==a&&eE(t.schema,d),l)}if(s&&En(i)&&i.wrapper&&(s=Oh(t,s,"ul,ol").reverse()[0]||s),!s)for(s=n;s&&s[o]&&!t.isBlock(s[o])&&(s=s[o],!ac(s,"br")););return s||n},Ih=(t,e,n,o)=>{const r=n.parentNode;return!Q(n[o])&&(!(r!==e&&!jt(r)&&!t.isBlock(r))||Ih(t,e,r,o))},Ci=(t,e,n,o,r)=>{let s=n;const a=r?"previousSibling":"nextSibling",i=t.getRoot();if(j(n)&&!Th(n)&&(r?o>0:o<n.data.length))return n;for(;s;){if(!e[0].block_expand&&t.isBlock(s))return s;for(let d=s[a];d;d=d[a]){const c=j(d)&&!Ih(t,i,d,a);if(!Dr(d)&&(!Ft(l=d)||!l.getAttribute("data-mce-bogus")||l.nextSibling)&&!Th(d,c))return s}if(s===i||s.parentNode===i){n=s;break}s=s.parentNode}var l;return n},Fh=t=>Dr(t.parentNode)||Dr(t),Yo=(t,e,n,o=!1)=>{let{startContainer:r,startOffset:s,endContainer:a,endOffset:i}=e;const l=n[0];return J(r)&&r.hasChildNodes()&&(r=io(r,s),j(r)&&(s=0)),J(a)&&a.hasChildNodes()&&(a=io(a,e.collapsed?i:i-1),j(a)&&(i=a.data.length)),r=Bh(t,r),a=Bh(t,a),Fh(r)&&(r=Dr(r)?r:r.parentNode,r=e.collapsed?r.previousSibling||r:r.nextSibling||r,j(r)&&(s=e.collapsed?r.length:0)),Fh(a)&&(a=Dr(a)?a:a.parentNode,a=e.collapsed?a.nextSibling||a:a.previousSibling||a,j(a)&&(i=e.collapsed?0:a.length)),e.collapsed&&(Ph(t,t.getRoot(),r,s,!0,o).each(({container:d,offset:c})=>{r=d,s=c}),Ph(t,t.getRoot(),a,i,!1,o).each(({container:d,offset:c})=>{a=d,i=c})),(qt(l)||l.block_expand)&&(qt(l)&&j(r)&&s!==0||(r=Ci(t,n,r,s,!0)),qt(l)&&j(a)&&i!==a.data.length||(a=Ci(t,n,a,i,!1))),dc(l)&&(r=Lh(t,n,e,r,"previousSibling"),a=Lh(t,n,e,a,"nextSibling")),(En(l)||je(l))&&(r=Mh(t,n,r,"previousSibling"),a=Mh(t,n,a,"nextSibling"),En(l)&&(t.isBlock(r)||(r=Ci(t,n,r,s,!0)),t.isBlock(a)||(a=Ci(t,n,a,i,!1)))),J(r)&&r.parentNode&&(s=t.nodeIndex(r),r=r.parentNode),J(a)&&a.parentNode&&(i=t.nodeIndex(a)+1,a=a.parentNode),{startContainer:r,startOffset:s,endContainer:a,endOffset:i}},Vs=(t,e,n)=>{var o;const r=e.startOffset,s=io(e.startContainer,r),a=e.endOffset,i=io(e.endContainer,a-1),l=f=>{const b=f[0];j(b)&&b===s&&r>=b.data.length&&f.splice(0,1);const v=f[f.length-1];return a===0&&f.length>0&&v===i&&j(v)&&f.splice(f.length-1,1),f},d=(f,b,v)=>{const y=[];for(;f&&f!==v;f=f[b])y.push(f);return y},c=(f,b)=>t.getParent(f,v=>v.parentNode===b,b),u=(f,b,v)=>{const y=v?"nextSibling":"previousSibling";for(let w=f,k=w.parentNode;w&&w!==b;w=k){k=w.parentNode;const x=d(w===f?w:w[y],y);x.length&&(v||x.reverse(),n(l(x)))}};if(s===i)return n(l([s]));const g=(o=t.findCommonAncestor(s,i))!==null&&o!==void 0?o:t.getRoot();if(t.isChildOf(s,i))return u(s,g,!0);if(t.isChildOf(i,s))return u(i,g);const p=c(s,g)||s,m=c(i,g)||i;u(s,p,!0);const h=d(p===s?p:p.nextSibling,"nextSibling",m===i?m.nextSibling:m);h.length&&n(l(h)),u(i,m)},rE=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],Uh=(t,e,n,o,r,s)=>{const{uid:a=e}=n,i=sx(n,["uid"]);cs(t,Ns()),Qt(t,`${kr()}`,a),Qt(t,`${jo()}`,o);const{attributes:l={},classes:d=[]}=r(a,i);if(Xn(t,l),((c,u)=>{H(u,g=>{cs(c,g)})})(t,d),s){d.length>0&&Qt(t,`${As()}`,d.join(","));const c=Oe(l);c.length>0&&Qt(t,`${Os()}`,c.join(","))}},zh=(t,e,n,o,r)=>{const s=Jt("span",t);return Uh(s,e,n,o,r,!1),s},sE=(t,e,n,o,r,s)=>{const a=[],i=zh(t.getDoc(),n,s,o,r),l=ao(),d=()=>{l.clear()},c=g=>{H(g,u)},u=g=>{switch(((p,m,h,f)=>tn(m).fold(()=>"skipping",b=>f==="br"||(v=>Le(v)&&id(v)===ae)(m)?"valid":(v=>Te(v)&&Jl(v,Ns()))(m)?"existing":an(m.dom)?"caret":It(rE,v=>Ze(m,v))?"valid-block":Br(p,h,f)&&Br(p,Ot(b),h)?"valid":"invalid-child"))(t,g,"span",Ot(g))){case"invalid-child":{d();const p=oe(g);c(p),d();break}case"valid-block":d(),Uh(g,n,s,o,r,!0);break;case"valid":{const p=l.get().getOrThunk(()=>{const m=Sr(i);return a.push(m),l.set(m),m});((m,h)=>{Me(m,h),Kt(h,m)})(g,p);break}}};return Vs(t.dom,e,g=>{d(),(p=>{const m=yt(p,N);c(m)})(g)}),a},jh=t=>{const e=(()=>{const s={};return{register:(a,i)=>{s[a]={name:a,settings:i}},lookup:a=>At(s,a).map(i=>i.settings),getNames:()=>Oe(s)}})();((s,a)=>{const i=jo(),l=c=>C.from(c.attr(i)).bind(a.lookup),d=c=>{var u,g;c.attr(kr(),null),c.attr(jo(),null),c.attr(Rs(),null);const p=C.from(c.attr(Os())).map(b=>b.split(",")).getOr([]),m=C.from(c.attr(As())).map(b=>b.split(",")).getOr([]);H(p,b=>c.attr(b,null));const h=(g=(u=c.attr("class"))===null||u===void 0?void 0:u.split(" "))!==null&&g!==void 0?g:[],f=Ul(h,[Ns()].concat(m));c.attr("class",f.length>0?f.join(" "):null),c.attr(As(),null),c.attr(Os(),null)};s.serializer.addTempAttr(Rs()),s.serializer.addAttributeFilter(i,c=>{for(const u of c)l(u).each(g=>{g.persistent===!1&&(u.name==="span"?u.unwrap():d(u))})})})(t,e);const n=((s,a)=>{const i=Gt({}),l=()=>({listeners:[],previous:ao()}),d=(p,m)=>{c(p,h=>(m(h),h))},c=(p,m)=>{const h=i.get(),f=m(At(h,p).getOrThunk(l));h[p]=f,i.set(h)},u=(p,m)=>{H(Xg(s,p),h=>{m?Qt(h,Rs(),"true"):ne(h,Rs())})},g=Rd(()=>{const p=ur(a.getNames());H(p,m=>{c(m,h=>{const f=h.previous.get();return Gg(s,C.some(m)).fold(()=>{f.each(b=>{(v=>{d(v,y=>{H(y.listeners,w=>w(!1,v))})})(m),h.previous.clear(),u(b,!1)})},({uid:b,name:v,elements:y})=>{pr(f,b)||(f.each(w=>u(w,!1)),((w,k,x)=>{d(w,E=>{H(E.listeners,S=>S(!0,w,{uid:k,nodes:yt(x,_=>_.dom)}))})})(v,b,y),h.previous.set(b),u(b,!0))}),{previous:h.previous,listeners:h.listeners}})})},30);return s.on("remove",()=>{g.cancel()}),s.on("NodeChange",()=>{g.throttle()}),{addListener:(p,m)=>{c(p,h=>({previous:h.previous,listeners:h.listeners.concat([m])}))}}})(t,e),o=Xl("span"),r=s=>{H(s,a=>{o(a)?Zn(a):(i=>{Pa(i,Ns()),ne(i,`${kr()}`),ne(i,`${jo()}`),ne(i,`${Rs()}`);const l=In(i,`${Os()}`).map(u=>u.split(",")).getOr([]),d=In(i,`${As()}`).map(u=>u.split(",")).getOr([]);var c;H(l,u=>ne(i,u)),c=i,H(d,u=>{Pa(c,u)}),ne(i,`${As()}`),ne(i,`${Os()}`)})(a)})};return{register:(s,a)=>{e.register(s,a)},annotate:(s,a)=>{e.lookup(s).each(i=>{((l,d,c,u)=>{l.undoManager.transact(()=>{const g=l.selection,p=g.getRng(),m=Tr(l).length>0,h=Zg("mce-annotation");if(p.collapsed&&!m&&((f,b)=>{const v=Yo(f.dom,b,[{inline:"span"}]);b.setStart(v.startContainer,v.startOffset),b.setEnd(v.endContainer,v.endOffset),f.selection.setRng(b)})(l,p),g.getRng().collapsed&&!m){const f=zh(l.getDoc(),h,u,d,c.decorate);Ua(f,Zt),g.getRng().insertNode(f.dom),g.select(f.dom)}else Eh(g,!1,()=>{nc(l,f=>{sE(l,f,h,d,c.decorate,u)})})})})(t,s,i,a)})},annotationChanged:(s,a)=>{n.addListener(s,a)},remove:s=>{const a=t.selection.getBookmark();Gg(t,C.some(s)).each(({elements:i})=>{r(i)}),t.selection.moveToBookmark(a)},removeAll:s=>{const a=t.selection.getBookmark();Nt(Qg(t,s),(i,l)=>{r(i)}),t.selection.moveToBookmark(a)},getAll:s=>{const a=Qg(t,s);return Ra(a,i=>yt(i,l=>l.dom))}}},qs=t=>({getBookmark:tt(YS,t),moveToBookmark:tt(XS,t)});qs.isBookmarkNode=ze;const Hh=(t,e,n)=>!n.collapsed&&It(n.getClientRects(),o=>((r,s,a)=>s>=r.left&&s<=r.right&&a>=r.top&&a<=r.bottom)(o,t,e)),$h=(t,e,n)=>{t.dispatch(e,n)},Vh=(t,e,n,o)=>{t.dispatch("FormatApply",{format:e,node:n,vars:o})},qh=(t,e,n,o)=>{t.dispatch("FormatRemove",{format:e,node:n,vars:o})},Wh=(t,e)=>t.dispatch("SetContent",e),Kh=(t,e)=>t.dispatch("GetContent",e),Gh=(t,e)=>t.dispatch("PastePlainTextToggle",{state:e}),ot={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:t=>t.shiftKey||t.ctrlKey||t.altKey||ot.metaKeyPressed(t),metaKeyPressed:t=>Ct.os.isMacOS()||Ct.os.isiOS()?t.metaKey:t.ctrlKey&&!t.altKey},Ws="data-mce-selected",Yh=Math.abs,wi=Math.round,cc={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},Xh=(t,e)=>{const n=e.dom,o=e.getDoc(),r=document,s=e.getBody();let a,i,l,d,c,u,g,p,m,h,f,b,v,y,w;const k=et=>Q(et)&&(ug(et)||n.is(et,"figure.image")),x=et=>yn(et)||n.hasClass(et,"mce-preview-object"),E=et=>{const ft=et.target;((ct,R)=>{if((A=>A.type==="longpress"||A.type.indexOf("touch")===0)(ct)){const A=ct.touches[0];return k(ct.target)&&!Hh(A.clientX,A.clientY,R)}return k(ct.target)&&!Hh(ct.clientX,ct.clientY,R)})(et,e.selection.getRng())&&!et.isDefaultPrevented()&&e.selection.select(ft)},S=et=>n.hasClass(et,"mce-preview-object")&&Q(et.firstElementChild)?[et,et.firstElementChild]:n.is(et,"figure.image")?[et.querySelector("img")]:[et],_=et=>{const ft=jp(e);return!!ft&&et.getAttribute("data-mce-resize")!=="false"&&et!==e.getBody()&&(n.hasClass(et,"mce-preview-object")&&Q(et.firstElementChild)?Ze(N(et.firstElementChild),ft):Ze(N(et),ft))},O=(et,ft,ct)=>{if(Q(ct)){const R=S(et);H(R,A=>{A.style[ft]||!e.schema.isValid(A.nodeName.toLowerCase(),ft)?n.setStyle(A,ft,ct):n.setAttrib(A,ft,""+ct)})}},T=(et,ft,ct)=>{O(et,"width",ft),O(et,"height",ct)},P=et=>{let ft,ct,R,A,M;ft=et.screenX-u,ct=et.screenY-g,b=ft*d[2]+p,v=ct*d[3]+m,b=b<5?5:b,v=v<5?5:v,R=(k(a)||x(a))&&Wk(e)!==!1?!ot.modifierPressed(et):ot.modifierPressed(et),R&&(Yh(ft)>Yh(ct)?(v=wi(b*h),b=wi(v/h)):(b=wi(v/h),v=wi(b*h))),T(i,b,v),A=d.startPos.x+ft,M=d.startPos.y+ct,A=A>0?A:0,M=M>0?M:0,n.setStyles(l,{left:A,top:M,display:"block"}),l.innerHTML=b+" &times; "+v,d[2]<0&&i.clientWidth<=b&&n.setStyle(i,"left",void 0+(p-b)),d[3]<0&&i.clientHeight<=v&&n.setStyle(i,"top",void 0+(m-v)),ft=s.scrollWidth-y,ct=s.scrollHeight-w,ft+ct!==0&&n.setStyles(l,{left:A-ft,top:M-ct}),f||(((U,F,z,V,X)=>{U.dispatch("ObjectResizeStart",{target:F,width:z,height:V,origin:X})})(e,a,p,m,"corner-"+d.name),f=!0)},D=()=>{const et=f;f=!1,et&&(O(a,"width",b),O(a,"height",v)),n.unbind(o,"mousemove",P),n.unbind(o,"mouseup",D),r!==o&&(n.unbind(r,"mousemove",P),n.unbind(r,"mouseup",D)),n.remove(i),n.remove(l),n.remove(c),I(a),et&&(((ft,ct,R,A,M)=>{ft.dispatch("ObjectResized",{target:ct,width:R,height:A,origin:M})})(e,a,b,v,"corner-"+d.name),n.setAttrib(a,"style",n.getAttrib(a,"style"))),e.nodeChanged()},I=et=>{vt();const ft=n.getPos(et,s),ct=ft.x,R=ft.y,A=et.getBoundingClientRect(),M=A.width||A.right-A.left,U=A.height||A.bottom-A.top;a!==et&&(W(),a=et,b=v=0);const F=e.dispatch("ObjectSelected",{target:et});_(et)&&!F.isDefaultPrevented()?Nt(cc,(z,V)=>{let X=n.get("mceResizeHandle"+V);X&&n.remove(X),X=n.add(s,"div",{id:"mceResizeHandle"+V,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+V+"-resize; margin:0; padding:0"}),n.bind(X,"mousedown",nt=>{nt.stopImmediatePropagation(),nt.preventDefault(),(dt=>{const ut=S(a)[0];var G;u=dt.screenX,g=dt.screenY,p=ut.clientWidth,m=ut.clientHeight,h=m/p,d=z,d.name=V,d.startPos={x:M*z[0]+ct,y:U*z[1]+R},y=s.scrollWidth,w=s.scrollHeight,c=n.add(s,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(c,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=x(G=a)?n.create("img",{src:Ct.transparentSrc}):G.cloneNode(!0),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:ct,top:R,margin:0}),T(i,M,U),i.removeAttribute(Ws),s.appendChild(i),n.bind(o,"mousemove",P),n.bind(o,"mouseup",D),r!==o&&(n.bind(r,"mousemove",P),n.bind(r,"mouseup",D)),l=n.add(s,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},p+" &times; "+m)})(nt)}),z.elm=X,n.setStyles(X,{left:M*z[0]+ct-X.offsetWidth/2,top:U*z[1]+R-X.offsetHeight/2})}):W(!1)},q=ei(I,0),W=(et=!0)=>{q.cancel(),vt(),a&&et&&a.removeAttribute(Ws),Nt(cc,(ft,ct)=>{const R=n.get("mceResizeHandle"+ct);R&&(n.unbind(R),n.remove(R))})},rt=(et,ft)=>n.isChildOf(et,ft),at=et=>{if(f||e.removed||e.composing)return;const ft=et.type==="mousedown"?et.target:t.getNode(),ct=Do(N(ft),"table,img,figure.image,hr,video,span.mce-preview-object").map(A=>A.dom).getOrUndefined(),R=Q(ct)?n.getAttrib(ct,Ws,"1"):"1";if(H(n.select("img[data-mce-selected],hr[data-mce-selected]"),A=>{A.removeAttribute(Ws)}),Q(ct)&&rt(ct,s)){St();const A=t.getStart(!0);if(rt(A,ct)&&rt(t.getEnd(!0),ct))return n.setAttrib(ct,Ws,R),void q.throttle(ct)}W()},vt=()=>{Nt(cc,et=>{et.elm&&(n.unbind(et.elm),delete et.elm)})},St=()=>{try{e.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(et){}};return e.on("init",()=>{St(),e.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",at),e.on("keyup compositionend",et=>{a&&a.nodeName==="TABLE"&&at(et)}),e.on("hide blur",W),e.on("contextmenu longpress",E,!0)}),e.on("remove",vt),{isResizable:_,showResizeRect:I,hideResizeRect:W,updateResizeRect:at,destroy:()=>{q.cancel(),a=i=c=null}}},Qh=(t,e,n)=>{const o=t.document.createRange();var r;return r=o,e.fold(s=>{r.setStartBefore(s.dom)},(s,a)=>{r.setStart(s.dom,a)},s=>{r.setStartAfter(s.dom)}),((s,a)=>{a.fold(i=>{s.setEndBefore(i.dom)},(i,l)=>{s.setEnd(i.dom,l)},i=>{s.setEndAfter(i.dom)})})(o,n),o},uc=(t,e,n,o,r)=>{const s=t.document.createRange();return s.setStart(e.dom,n),s.setEnd(o.dom,r),s},Ks=Cn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Jh=(t,e,n)=>e(N(n.startContainer),n.startOffset,N(n.endContainer),n.endOffset);Ks.ltr,Ks.rtl;const Zh=(t,e,n,o)=>({start:t,soffset:e,finish:n,foffset:o}),aE=document.caretPositionFromPoint?(t,e,n)=>{var o,r;return C.from((r=(o=t.dom).caretPositionFromPoint)===null||r===void 0?void 0:r.call(o,e,n)).bind(s=>{if(s.offsetNode===null)return C.none();const a=t.dom.createRange();return a.setStart(s.offsetNode,s.offset),a.collapse(),C.some(a)})}:document.caretRangeFromPoint?(t,e,n)=>{var o,r;return C.from((r=(o=t.dom).caretRangeFromPoint)===null||r===void 0?void 0:r.call(o,e,n))}:C.none,mc=Cn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),$n={before:mc.before,on:mc.on,after:mc.after,cata:(t,e,n,o)=>t.fold(e,n,o),getStart:t=>t.fold(ge,ge,ge)},xi=Cn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Pr={domRange:xi.domRange,relative:xi.relative,exact:xi.exact,exactFromRange:t=>xi.exact(t.start,t.soffset,t.finish,t.foffset),getWin:t=>{const e=(n=>n.match({domRange:o=>N(o.startContainer),relative:(o,r)=>$n.getStart(o),exact:(o,r,s,a)=>o}))(t);return fs(e)},range:Zh},ki=(t,e)=>{const n=Ot(t);return n==="input"?$n.after(t):_t(["br","img"],n)?e===0?$n.before(t):$n.after(t):$n.on(t,e)},iE=(t,e)=>{const n=t.fold($n.before,ki,$n.after),o=e.fold($n.before,ki,$n.after);return Pr.relative(n,o)},tb=(t,e,n,o)=>{const r=ki(t,e),s=ki(n,o);return Pr.relative(r,s)},fc=(t,e)=>{const n=(e||document).createDocumentFragment();return H(t,o=>{n.appendChild(o.dom)}),N(n)},lE=t=>{const e=Pr.getWin(t).dom,n=(r,s,a,i)=>uc(e,r,s,a,i),o=(r=>r.match({domRange:s=>{const a=N(s.startContainer),i=N(s.endContainer);return tb(a,s.startOffset,i,s.endOffset)},relative:iE,exact:tb}))(t);return((r,s)=>{const a=((i,l)=>l.match({domRange:d=>({ltr:Y(d),rtl:C.none}),relative:(d,c)=>({ltr:No(()=>Qh(i,d,c)),rtl:No(()=>C.some(Qh(i,c,d)))}),exact:(d,c,u,g)=>({ltr:No(()=>uc(i,d,c,u,g)),rtl:No(()=>C.some(uc(i,u,g,d,c)))})}))(r,s);return((i,l)=>{const d=l.ltr();return d.collapsed?l.rtl().filter(c=>c.collapsed===!1).map(c=>Ks.rtl(N(c.endContainer),c.endOffset,N(c.startContainer),c.startOffset)).getOrThunk(()=>Jh(0,Ks.ltr,d)):Jh(0,Ks.ltr,d)})(0,a)})(e,o).match({ltr:n,rtl:n})},eb=(t,e,n)=>((o,r,s)=>((a,i,l)=>{const d=N(a.document);return aE(d,i,l).map(c=>Zh(N(c.startContainer),c.startOffset,N(c.endContainer),c.endOffset))})(o,r,s))(fs(N(n)).dom,t,e).map(o=>{const r=n.createRange();return r.setStart(o.start.dom,o.soffset),r.setEnd(o.finish.dom,o.foffset),r}).getOrUndefined(),gc=(t,e)=>Q(t)&&Q(e)&&t.startContainer===e.startContainer&&t.startOffset===e.startOffset&&t.endContainer===e.endContainer&&t.endOffset===e.endOffset,nb=(t,e,n)=>((o,r,s)=>{let a=o;for(;a&&a!==r;){if(s(a))return a;a=a.parentNode}return null})(t,e,n)!==null,dE=(t,e,n)=>nb(t,e,o=>o.nodeName===n),cE=(t,e)=>Ie(t)&&!nb(t,e,an),ob=(t,e,n)=>{const o=e.parentNode;if(o){const r=new Vt(e,t.getParent(o,t.isBlock)||t.getRoot());let s;for(;s=r[n?"prev":"next"]();)if(Ft(s))return!0}return!1},pc=(t,e,n,o,r)=>{const s=t.getRoot(),a=t.schema.getNonEmptyElements(),i=r.parentNode;let l,d;if(!i)return C.none();const c=t.getParent(i,t.isBlock)||s;if(o&&Ft(r)&&e&&t.isEmpty(c))return C.some(L(i,t.nodeIndex(r)));const u=new Vt(r,c);for(;d=u[o?"prev":"next"]();){if(t.getContentEditableParent(d)==="false"||cE(d,s))return C.none();if(j(d)&&d.data.length>0)return dE(d,s,"A")?C.none():C.some(L(d,o?d.data.length:0));if(t.isBlock(d)||a[d.nodeName.toLowerCase()])return C.none();l=d}return eo(l)?C.none():n&&l?C.some(L(l,0)):C.none()},rb=(t,e,n,o)=>{const r=t.getRoot();let s,a=!1,i=n?o.startContainer:o.endContainer,l=n?o.startOffset:o.endOffset;const d=J(i)&&l===i.childNodes.length,c=t.schema.getNonEmptyElements();let u=n;if(Ie(i))return C.none();if(J(i)&&l>i.childNodes.length-1&&(u=!1),vs(i)&&(i=r,l=0),i===r){if(u&&(s=i.childNodes[l>0?l-1:0],s)&&(Ie(s)||c[s.nodeName]||zn(s)))return C.none();if(i.hasChildNodes()){if(l=Math.min(!u&&l>0?l-1:l,i.childNodes.length-1),i=i.childNodes[l],l=j(i)&&d?i.data.length:0,!e&&i===r.lastChild&&zn(i)||((g,p)=>{let m=p;for(;m&&m!==g;){if(Rt(m))return!0;m=m.parentNode}return!1})(r,i)||Ie(i))return C.none();if(i.hasChildNodes()&&!zn(i)){s=i;const g=new Vt(i,r);do{if(Rt(s)||Ie(s)){a=!1;break}if(j(s)&&s.data.length>0){l=u?0:s.data.length,i=s,a=!0;break}if(c[s.nodeName.toLowerCase()]&&!mg(s)){l=t.nodeIndex(s),i=s.parentNode,u||l++,a=!0;break}}while(s=u?g.next():g.prev())}}}return e&&(j(i)&&l===0&&pc(t,d,e,!0,i).each(g=>{i=g.container(),l=g.offset(),a=!0}),J(i)&&(s=i.childNodes[l],s||(s=i.childNodes[l-1]),!s||!Ft(s)||((g,p)=>{var m;return((m=g.previousSibling)===null||m===void 0?void 0:m.nodeName)==="A"})(s)||ob(t,s,!1)||ob(t,s,!0)||pc(t,d,e,!0,s).each(g=>{i=g.container(),l=g.offset(),a=!0}))),u&&!e&&j(i)&&l===i.data.length&&pc(t,d,e,!1,i).each(g=>{i=g.container(),l=g.offset(),a=!0}),a&&i?C.some(L(i,l)):C.none()},Si=(t,e)=>{const n=e.collapsed,o=e.cloneRange(),r=L.fromRangeStart(e);return rb(t,n,!0,o).each(s=>{n&&L.isAbove(r,s)||o.setStart(s.container(),s.offset())}),n||rb(t,n,!1,o).each(s=>{o.setEnd(s.container(),s.offset())}),n&&o.collapse(!0),gc(e,o)?C.none():C.some(o)},Ei=(t,e)=>t.splitText(e),_i=t=>{let e=t.startContainer,n=t.startOffset,o=t.endContainer,r=t.endOffset;if(e===o&&j(e)){if(n>0&&n<e.data.length)if(o=Ei(e,n),e=o.previousSibling,r>n){r-=n;const s=Ei(o,r).previousSibling;e=o=s,r=s.data.length,n=0}else r=0}else if(j(e)&&n>0&&n<e.data.length&&(e=Ei(e,n),n=0),j(o)&&r>0&&r<o.data.length){const s=Ei(o,r).previousSibling;o=s,r=s.data.length}return{startContainer:e,startOffset:n,endContainer:o,endOffset:r}},Xo=t=>({walk:(e,n)=>Vs(t,e,n),split:_i,expand:(e,n={type:"word"})=>{if(n.type==="word"){const o=Yo(t,e,[{inline:"span"}]),r=t.createRng();return r.setStart(o.startContainer,o.startOffset),r.setEnd(o.endContainer,o.endOffset),r}return e},normalize:e=>Si(t,e).fold(Dt,n=>(e.setStart(n.startContainer,n.startOffset),e.setEnd(n.endContainer,n.endOffset),!0))});Xo.compareRanges=gc,Xo.getCaretRangeFromPoint=eb,Xo.getSelectedNode=ni,Xo.getNode=io;const uE=((t,e)=>{const n=r=>{const s=(a=>{const i=a.dom;return br(a)?i.getBoundingClientRect().height:i.offsetHeight})(r);if(s<=0||s===null){const a=vn(r,t);return parseFloat(a)||0}return s},o=(r,s)=>Re(s,(a,i)=>{const l=vn(r,i),d=l===void 0?0:parseInt(l,10);return isNaN(d)?a:a+d},0);return{set:(r,s)=>{if(!Je(s)&&!s.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+s);const a=r.dom;us(a)&&(a.style[t]=s+"px")},get:n,getOuter:n,aggregate:o,max:(r,s,a)=>{const i=o(r,a);return s>i?s-i:0}}})("height"),sb=()=>N(document),ab=(t,e)=>t.view(e).fold(Y([]),n=>{const o=t.owner(n),r=ab(t,o);return[n].concat(r)});var mE=Object.freeze({__proto__:null,view:t=>{var e;return(t.dom===document?C.none():C.from((e=t.dom.defaultView)===null||e===void 0?void 0:e.frameElement)).map(N)},owner:t=>Un(t)});const hc=t=>Ot(t)==="textarea",ib=(t,e)=>{const n=(r=>{const s=r.dom.ownerDocument,a=s.body,i=s.defaultView,l=s.documentElement;if(a===r.dom)return vr(a.offsetLeft,a.offsetTop);const d=za(i==null?void 0:i.pageYOffset,l.scrollTop),c=za(i==null?void 0:i.pageXOffset,l.scrollLeft),u=za(l.clientTop,a.clientTop),g=za(l.clientLeft,a.clientLeft);return nd(r).translate(c-g,d-u)})(t),o=(r=>uE.get(r))(t);return{element:t,bottom:n.top+o,height:o,pos:n,cleanup:e}},lb=(t,e,n,o)=>{gE(t,(r,s)=>fE(t,e,n,o),n)},db=(t,e,n,o,r)=>{const s={elm:o.element.dom,alignToTop:r};((a,i)=>a.dispatch("ScrollIntoView",i).isDefaultPrevented())(t,s)||(n(e,od(e).top,o,r),((a,i)=>{a.dispatch("AfterScrollIntoView",i)})(t,s))},fE=(t,e,n,o)=>{const r=N(t.getBody()),s=N(t.getDoc());r.dom.offsetWidth;const a=((i,l)=>{const d=((u,g)=>{const p=oe(u);if(p.length===0||hc(u))return{element:u,offset:g};if(g<p.length&&!hc(p[g]))return{element:p[g],offset:0};{const m=p[p.length-1];return hc(m)?{element:u,offset:g}:Ot(m)==="img"?{element:m,offset:1}:Le(m)?{element:m,offset:id(m).length}:{element:m,offset:oe(m).length}}})(i,l),c=La('<span data-mce-bogus="all" style="display: inline-block;">\uFEFF</span>');return Me(d.element,c),ib(c,()=>Tt(c))})(N(n.startContainer),n.startOffset);db(t,s,e,a,o),a.cleanup()},cb=(t,e,n,o)=>{const r=N(t.getDoc());db(t,r,n,(s=>ib(N(s),bt))(e),o)},gE=(t,e,n)=>{const o=n.startContainer,r=n.startOffset,s=n.endContainer,a=n.endOffset;e(N(o),N(s));const i=t.dom.createRng();i.setStart(o,r),i.setEnd(s,a),t.selection.setRng(n)},bc=(t,e,n,o)=>{const r=t.pos;if(n)ng(r.left,r.top,o);else{const s=r.top-e+t.height;ng(r.left,s,o)}},ub=(t,e,n,o,r)=>{const s=n+e,a=o.pos.top,i=o.bottom,l=i-a>=n;a<e?bc(o,n,r!==!1,t):a>s?bc(o,n,l?r!==!1:r===!0,t):i>s&&!l&&bc(o,n,r===!0,t)},mb=(t,e,n,o)=>{const r=fs(t).dom.innerHeight;ub(t,e,r,n,o)},fb=(t,e,n,o)=>{const r=fs(t).dom.innerHeight;ub(t,e,r,n,o);const s=(i=>{const l=sb(),d=od(l),c=((p,m)=>{const h=m.owner(p);return ab(m,h)})(i,mE),u=nd(i),g=_a(c,(p,m)=>{const h=nd(m);return{left:p.left+h.left,top:p.top+h.top}},{left:0,top:0});return vr(g.left+u.left+d.left,g.top+u.top+d.top)})(n.element),a=sg(window);s.top<a.y?og(n.element,o!==!1):s.top>a.bottom&&og(n.element,o===!0)},pE=(t,e,n)=>lb(t,mb,e,n),hE=(t,e,n)=>cb(t,e,mb,n),bE=(t,e,n)=>lb(t,fb,e,n),vE=(t,e,n)=>cb(t,e,fb,n),Gs=(t,e,n)=>{(t.inline?pE:bE)(t,e,n)},gb=t=>t.dom.focus(),pb=t=>{const e=Qn(t).dom;return t.dom===e.activeElement},vc=(t=sb())=>C.from(t.dom.activeElement).map(N),hb=(t,e)=>{const n=Le(e)?id(e).length:oe(e).length+1;return t>n?n:t<0?0:t},yE=t=>Pr.range(t.start,hb(t.soffset,t.start),t.finish,hb(t.foffset,t.finish)),bb=(t,e)=>!ja(e.dom)&&(Fn(t,e)||xt(t,e)),vb=t=>e=>bb(t,e.start)&&bb(t,e.finish),CE=t=>Pr.range(N(t.startContainer),t.startOffset,N(t.endContainer),t.endOffset),wE=t=>{const e=document.createRange();try{return e.setStart(t.start.dom,t.soffset),e.setEnd(t.finish.dom,t.foffset),C.some(e)}catch(n){return C.none()}},yc=t=>{const e=(o=>o.inline||Ct.browser.isFirefox())(t)?(n=N(t.getBody()),(o=>{const r=o.getSelection();return(r&&r.rangeCount!==0?C.from(r.getRangeAt(0)):C.none()).map(CE)})(fs(n).dom).filter(vb(n))):C.none();var n;t.bookmark=e.isSome()?e:t.bookmark},Cc=t=>(t.bookmark?t.bookmark:C.none()).bind(e=>{return n=N(t.getBody()),o=e,C.from(o).filter(vb(n)).map(yE);var n,o}).bind(wE),yb={isEditorUIElement:t=>{const e=t.className.toString();return e.indexOf("tox-")!==-1||e.indexOf("mce-")!==-1}},He={setEditorTimeout:(t,e,n)=>((o,r)=>(Je(r)||(r=0),setTimeout(o,r)))(()=>{t.removed||e()},n),setEditorInterval:(t,e,n)=>{const o=((r,s)=>(Je(s)||(s=0),setInterval(r,s)))(()=>{t.removed?clearInterval(o):e()},n);return o}};let Lr;const wc=Et.DOM,Ni=(t,e)=>{const n=eS(t);return wc.getParent(e,r=>(s=>J(s)&&yb.isEditorUIElement(s))(r)||!!n&&t.dom.is(r,n))!==null},xE=(t,e)=>{const n=e.editor;(o=>{const r=ei(()=>{yc(o)},0);o.on("init",()=>{o.inline&&((s,a)=>{const i=()=>{a.throttle()};Et.DOM.bind(document,"mouseup",i),s.on("remove",()=>{Et.DOM.unbind(document,"mouseup",i)})})(o,r),((s,a)=>{((i,l)=>{i.on("mouseup touchend",d=>{l.throttle()})})(s,a),s.on("keyup NodeChange AfterSetSelectionRange",i=>{(l=>l.type==="nodechange"&&l.selectionChange)(i)||yc(s)})})(o,r)}),o.on("remove",()=>{r.cancel()})})(n),n.on("focusin",()=>{const o=t.focusedEditor;o!==n&&(o&&o.dispatch("blur",{focusedEditor:n}),t.setActive(n),t.focusedEditor=n,n.dispatch("focus",{blurredEditor:o}),n.focus(!0))}),n.on("focusout",()=>{He.setEditorTimeout(n,()=>{const o=t.focusedEditor;Ni(n,(r=>{try{const s=Qn(N(r.getElement()));return vc(s).fold(()=>document.body,a=>a.dom)}catch(s){return document.body}})(n))||o!==n||(n.dispatch("blur",{focusedEditor:null}),t.focusedEditor=null)})}),Lr||(Lr=o=>{const r=t.activeEditor;r&&Wf(o).each(s=>{const a=s;a.ownerDocument===document&&(a===document.body||Ni(r,a)||t.focusedEditor!==r||(r.dispatch("blur",{focusedEditor:null}),t.focusedEditor=null))})},wc.bind(document,"focusin",Lr))},kE=(t,e)=>{t.focusedEditor===e.editor&&(t.focusedEditor=null),!t.activeEditor&&Lr&&(wc.unbind(document,"focusin",Lr),Lr=null)},Cb=(t,e)=>{((n,o)=>(r=>r.collapsed?C.from(io(r.startContainer,r.startOffset)).map(N):C.none())(o).bind(r=>Mx(r)?C.some(r):Fn(n,r)?C.none():C.some(n)))(N(t.getBody()),e).bind(n=>be(n.dom)).fold(()=>{t.selection.normalize()},n=>t.selection.setRng(n.toRange()))},xc=t=>{if(t.setActive)try{t.setActive()}catch(e){t.focus()}else t.focus()},Qo=t=>t.inline?(e=>{const n=e.getBody();return n&&(o=N(n),pb(o)||(r=o,vc(Qn(r)).filter(s=>r.dom.contains(s.dom))).isSome());var o,r})(t):(e=>Q(e.iframeElement)&&pb(N(e.iframeElement)))(t),kc=t=>t.editorManager.setActive(t),wb=(t,e,n,o,r)=>{const s=n?e.startContainer:e.endContainer,a=n?e.startOffset:e.endOffset;return C.from(s).map(N).map(i=>o&&e.collapsed?i:Ma(i,r(i,a)).getOr(i)).bind(i=>Te(i)?C.some(i):tn(i).filter(Te)).map(i=>i.dom).getOr(t)},xb=(t,e,n=!1)=>wb(t,e,!0,n,(o,r)=>Math.min(Vf(o),r)),kb=(t,e,n=!1)=>wb(t,e,!1,n,(o,r)=>r>0?r-1:r),Sb=(t,e)=>{const n=t;for(;t&&j(t)&&t.length===0;)t=e?t.nextSibling:t.previousSibling;return t||n},Sc=(t,e)=>yt(e,n=>{const o=t.dispatch("GetSelectionRange",{range:n});return o.range!==n?o.range:n}),SE=["img","br"],Eb=t=>pg(t).filter(n=>n.trim().length!==0||n.indexOf(Zt)>-1).isSome()||_t(SE,Ot(t)),_b="[data-mce-autocompleter]",EE=(t,e)=>{if(Nb(N(t.getBody())).isNone()){const o=La('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());Kt(o,N(e.extractContents())),e.insertNode(o.dom),tn(o).each(r=>r.dom.normalize()),(n=o,((r,s)=>{const a=i=>{const l=oe(i);for(let d=l.length-1;d>=0;d--){const c=l[d];if(s(c))return C.some(c);const u=a(c);if(u.isSome())return u}return C.none()};return a(r)})(n,Eb)).map(r=>{t.selection.setCursorLocation(r.dom,(s=>Ot(s)==="img"?1:pg(s).fold(()=>oe(s).length,a=>a.length))(r))})}var n},Nb=t=>bs(t,_b),_E={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},Ri=(t,e,n)=>{const o=n?"lastChild":"firstChild",r=n?"prev":"next";if(t[o])return t[o];if(t!==e){let s=t[r];if(s)return s;for(let a=t.parent;a&&a!==e;a=a.parent)if(s=a[r],s)return s}},NE=t=>{var e;const n=(e=t.value)!==null&&e!==void 0?e:"";if(!Fo(n))return!1;const o=t.parent;return!o||o.name==="span"&&!o.attr("style")||!/^[ ]+$/.test(n)},Rb=t=>{const e=t.name==="a"&&!t.attr("href")&&t.attr("id");return t.attr("name")||t.attr("id")&&!t.firstChild||t.attr("data-mce-bookmark")||e};class ve{constructor(e,n){this.name=e,this.type=n,n===1&&(this.attributes=[],this.attributes.map={})}static create(e,n){const o=new ve(e,_E[e]||1);return n&&Nt(n,(r,s)=>{o.attr(s,r)}),o}replace(e){const n=this;return e.parent&&e.remove(),n.insert(e,n),n.remove(),n}attr(e,n){const o=this;if(!it(e))return Q(e)&&Nt(e,(s,a)=>{o.attr(a,s)}),o;const r=o.attributes;if(r){if(n!==void 0){if(n===null){if(e in r.map){delete r.map[e];let s=r.length;for(;s--;)if(r[s].name===e)return r.splice(s,1),o}return o}if(e in r.map){let s=r.length;for(;s--;)if(r[s].name===e){r[s].value=n;break}}else r.push({name:e,value:n});return r.map[e]=n,o}return r.map[e]}}clone(){const e=this,n=new ve(e.name,e.type),o=e.attributes;if(o){const r=[];r.map={};for(let s=0,a=o.length;s<a;s++){const i=o[s];i.name!=="id"&&(r[r.length]={name:i.name,value:i.value},r.map[i.name]=i.value)}n.attributes=r}return n.value=e.value,n}wrap(e){const n=this;return n.parent&&(n.parent.insert(e,n),e.append(n)),n}unwrap(){const e=this;for(let n=e.firstChild;n;){const o=n.next;e.insert(n,e,!0),n=o}e.remove()}remove(){const e=this,n=e.parent,o=e.next,r=e.prev;return n&&(n.firstChild===e?(n.firstChild=o,o&&(o.prev=null)):r&&(r.next=o),n.lastChild===e?(n.lastChild=r,r&&(r.next=null)):o&&(o.prev=r),e.parent=e.next=e.prev=null),e}append(e){const n=this;e.parent&&e.remove();const o=n.lastChild;return o?(o.next=e,e.prev=o,n.lastChild=e):n.lastChild=n.firstChild=e,e.parent=n,e}insert(e,n,o){e.parent&&e.remove();const r=n.parent||this;return o?(n===r.firstChild?r.firstChild=e:n.prev&&(n.prev.next=e),e.prev=n.prev,e.next=n,n.prev=e):(n===r.lastChild?r.lastChild=e:n.next&&(n.next.prev=e),e.next=n.next,e.prev=n,n.next=e),e.parent=r,e}getAll(e){const n=this,o=[];for(let r=n.firstChild;r;r=Ri(r,n))r.name===e&&o.push(r);return o}children(){const e=[];for(let n=this.firstChild;n;n=n.next)e.push(n);return e}empty(){const e=this;if(e.firstChild){const n=[];for(let r=e.firstChild;r;r=Ri(r,e))n.push(r);let o=n.length;for(;o--;){const r=n[o];r.parent=r.firstChild=r.lastChild=r.next=r.prev=null}}return e.firstChild=e.lastChild=null,e}isEmpty(e,n={},o){var r;const s=this;let a=s.firstChild;if(Rb(s))return!1;if(a)do{if(a.type===1){if(a.attr("data-mce-bogus"))continue;if(e[a.name]||Rb(a))return!1}if(a.type===8||a.type===3&&!NE(a)||a.type===3&&a.parent&&n[a.parent.name]&&Fo((r=a.value)!==null&&r!==void 0?r:"")||o&&o(a))return!1}while(a=Ri(a,s));return!0}walk(e){return Ri(this,null,e)}}const Ab=(t,e,n=0)=>{const o=t.toLowerCase();if(o.indexOf("[if ",n)!==-1&&((r,s)=>/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(r.substr(s)))(o,n)){const r=o.indexOf("[endif]",n);return o.indexOf(">",r)}if(e){const r=o.indexOf(">",n);return r!==-1?r:o.length}{const r=/--!?>/g;r.lastIndex=n;const s=r.exec(t);return s?s.index+s[0].length:o.length}},RE=(t,e,n)=>{const o=/<([!?\/])?([A-Za-z0-9\-_:.]+)/g,r=/(?:\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g,s=t.getVoidElements();let a=1,i=n;for(;a!==0;)for(o.lastIndex=i;;){const l=o.exec(e);if(l===null)return i;if(l[1]==="!"){i=ee(l[2],"--")?Ab(e,!1,l.index+"!--".length):Ab(e,!0,l.index+1);break}{r.lastIndex=o.lastIndex;const d=r.exec(e);if(wo(d)||d.index!==o.lastIndex)continue;l[1]==="/"?a-=1:pt(s,l[2])||(a+=1),i=o.lastIndex+d[0].length;break}}return i},Ob=(t,e)=>{const n=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,o=t.schema;let r=((i,l)=>{const d=new RegExp(["\\s?("+i.join("|")+')="[^"]+"'].join("|"),"gi");return l.replace(d,"")})(t.getTempAttrs(),e);const s=o.getVoidElements();let a;for(;a=n.exec(r);){const i=n.lastIndex,l=a[0].length;let d;d=s[a[1]]?i:RE(o,r,i),r=r.substring(0,i-l)+r.substring(d),n.lastIndex=i-l}return jn(r)},AE=Ob,Tb=t=>{const e=le(t,"[data-mce-bogus]");H(e,n=>{Ge(n,"data-mce-bogus")==="all"?Tt(n):Mo(n)?(Me(n,hr(ys)),Tt(n)):Zn(n)})},Bb=t=>{const e=le(t,"input");H(e,n=>{ne(n,"name")})},OE=(t,e,n)=>{let o;return o=e.format==="raw"?$.trim(AE(t.serializer,n.innerHTML)):e.format==="text"?((r,s)=>{const a=r.getDoc(),i=Qn(N(r.getBody())),l=Jt("div",a);Qt(l,"data-mce-bogus","all"),Ia(l,{position:"fixed",left:"-9999999px",top:"0"}),Ua(l,s.innerHTML),Tb(l),Bb(l);const d=(u=>td(u)?u:N(Un(u).dom.body))(i);Kt(d,l);const c=jn(l.dom.innerText);return Tt(l),c})(t,n):e.format==="tree"?t.serializer.serialize(n,e):((r,s)=>{const a=Be(r),i=new RegExp(`^(<${a}[^>]*>(&nbsp;|&#160;|\\s|\xA0|<br \\/>|)<\\/${a}>[\r
]*|<br \\/>[\r
]*)$`);return s.replace(i,"")})(t,t.serializer.serialize(n,e)),e.format!=="text"&&!Va(N(n))&&it(o)?$.trim(o):o},Db=$.makeMap,Pb=t=>{const e=[],n=(t=t||{}).indent,o=Db(t.indent_before||""),r=Db(t.indent_after||""),s=ro.getEncodeFunc(t.entity_encoding||"raw",t.entities),a=t.element_format!=="xhtml";return{start:(i,l,d)=>{if(n&&o[i]&&e.length>0){const c=e[e.length-1];c.length>0&&c!==`
`&&e.push(`
`)}if(e.push("<",i),l)for(let c=0,u=l.length;c<u;c++){const g=l[c];e.push(" ",g.name,'="',s(g.value,!0),'"')}if(e[e.length]=!d||a?">":" />",d&&n&&r[i]&&e.length>0){const c=e[e.length-1];c.length>0&&c!==`
`&&e.push(`
`)}},end:i=>{let l;e.push("</",i,">"),n&&r[i]&&e.length>0&&(l=e[e.length-1],l.length>0&&l!==`
`&&e.push(`
`))},text:(i,l)=>{i.length>0&&(e[e.length]=l?i:s(i))},cdata:i=>{e.push("<![CDATA[",i,"]]>")},comment:i=>{e.push("<!--",i,"-->")},pi:(i,l)=>{l?e.push("<?",i," ",s(l),"?>"):e.push("<?",i,"?>"),n&&e.push(`
`)},doctype:i=>{e.push("<!DOCTYPE",i,">",n?`
`:"")},reset:()=>{e.length=0},getContent:()=>e.join("").replace(/\n$/,"")}},mo=(t={},e=so())=>{const n=Pb(t);return t.validate=!("validate"in t)||t.validate,{serialize:o=>{const r=t.validate,s={3:i=>{var l;n.text((l=i.value)!==null&&l!==void 0?l:"",i.raw)},8:i=>{var l;n.comment((l=i.value)!==null&&l!==void 0?l:"")},7:i=>{n.pi(i.name,i.value)},10:i=>{var l;n.doctype((l=i.value)!==null&&l!==void 0?l:"")},4:i=>{var l;n.cdata((l=i.value)!==null&&l!==void 0?l:"")},11:i=>{let l=i;if(l=l.firstChild)do a(l);while(l=l.next)}};n.reset();const a=i=>{var l;const d=s[i.type];if(d)d(i);else{const c=i.name,u=c in e.getVoidElements();let g=i.attributes;if(r&&g&&g.length>1){const p=[];p.map={};const m=e.getElementRule(i.name);if(m){for(let h=0,f=m.attributesOrder.length;h<f;h++){const b=m.attributesOrder[h];if(b in g.map){const v=g.map[b];p.map[b]=v,p.push({name:b,value:v})}}for(let h=0,f=g.length;h<f;h++){const b=g[h].name;if(!(b in p.map)){const v=g.map[b];p.map[b]=v,p.push({name:b,value:v})}}g=p}}if(n.start(c,g,u),!u){let p=i.firstChild;if(p){c!=="pre"&&c!=="textarea"||p.type!==3||((l=p.value)===null||l===void 0?void 0:l[0])!==`
`||n.text(`
`,!0);do a(p);while(p=p.next)}n.end(c)}}};return o.type!==1||t.inner?o.type===3?s[3](o):s[11](o):a(o),n.getContent()}}},Lb=new Set;H(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{Lb.add(t)});const Mb=["font","text-decoration","text-emphasis"],Ec=(t,e)=>Oe(t.parseStyle(t.getAttrib(e,"style"))),TE=(t,e,n)=>{const o=Ec(t,e),r=Ec(t,n),s=a=>{var i,l;const d=(i=t.getStyle(e,a))!==null&&i!==void 0?i:"",c=(l=t.getStyle(n,a))!==null&&l!==void 0?l:"";return pn(d)&&pn(c)&&d!==c};return It(o,a=>{const i=l=>It(l,d=>d===a);if(!i(r)&&i(Mb)){const l=mt(r,d=>It(Mb,c=>ee(d,c)));return It(l,s)}return s(a)})},Ib=(t,e,n)=>C.from(n.container()).filter(j).exists(o=>{const r=t?0:-1;return e(o.data.charAt(n.offset()+r))}),_c=tt(Ib,!0,Or),Nc=tt(Ib,!1,Or),BE=t=>{const e=t.container();return j(e)&&(e.data.length===0||qa(e.data)&&qs.isBookmarkNode(e.parentNode))},fo=(t,e)=>n=>$d(t?0:-1,n).filter(e).isSome(),Fb=t=>ug(t)&&vn(N(t),"display")==="block",Ub=t=>Rt(t)&&!(e=>J(e)&&e.getAttribute("data-mce-bogus")==="all")(t),DE=fo(!0,Fb),PE=fo(!1,Fb),Ys=fo(!0,yn),Xs=fo(!1,yn),zb=fo(!0,zn),jb=fo(!1,zn),go=fo(!0,Ub),po=fo(!1,Ub),Hb=(t,e)=>((n,o,r)=>Fn(o,n)?zf(n,s=>r(s)||xt(s,o)).slice(0,-1):[])(t,e,Dt),Vn=(t,e)=>[t].concat(Hb(t,e)),Rc=(t,e,n)=>gh(t,e,n,BE),$b=(t,e)=>Wt(Vn(N(e.container()),t),on),Vb=(t,e,n)=>Rc(t,e.dom,n).forall(o=>$b(e,n).fold(()=>!wn(o,n,e.dom),r=>!wn(o,n,e.dom)&&Fn(r,N(o.container())))),qb=(t,e,n)=>$b(e,n).fold(()=>Rc(t,e.dom,n).forall(o=>!wn(o,n,e.dom)),o=>Rc(t,o.dom,n).isNone()),Ac=tt(qb,!1),Wb=tt(qb,!0),LE=tt(Vb,!1),ME=tt(Vb,!0),IE=t=>di(t).exists(Mo),Ai=(t,e,n)=>{const o=mt(Vn(N(n.container()),e),on),r=xe(o).getOr(e);return Fe(t,r.dom,n).filter(IE)},Oc=(t,e)=>di(e).exists(Mo)||Ai(!0,t,e).isSome(),Tc=(t,e)=>(n=>C.from(n.getNode(!0)).map(N))(e).exists(Mo)||Ai(!1,t,e).isSome(),FE=tt(Ai,!1),UE=tt(Ai,!0),Kb=t=>L.isTextPosition(t)&&!t.isAtStart()&&!t.isAtEnd(),Gb=(t,e)=>{const n=mt(Vn(N(e.container()),t),on);return xe(n).getOr(t)},Yb=(t,e)=>Kb(e)?Nc(e):Nc(e)||Ue(Gb(t,e).dom,e).exists(Nc),Xb=(t,e)=>Kb(e)?_c(e):_c(e)||ke(Gb(t,e).dom,e).exists(_c),Bc=t=>di(t).bind(e=>Bo(e,Te)).exists(e=>(n=>_t(["pre","pre-wrap"],n))(vn(e,"white-space"))),Qb=(t,e)=>n=>{return o=new Vt(n,t)[e](),Q(o)&&Rt(o)&&eh(o);var o},Qs=(t,e)=>!Bc(e)&&(Ac(t,e)||LE(t,e)||Tc(t,e)||Yb(t,e)||((n,o)=>{const r=Ue(n.dom,o).getOr(o),s=Qb(n.dom,"prev");return o.isAtStart()&&(s(o.container())||s(r.container()))})(t,e)),Js=(t,e)=>!Bc(e)&&(Wb(t,e)||ME(t,e)||Oc(t,e)||Xb(t,e)||((n,o)=>{const r=ke(n.dom,o).getOr(o),s=Qb(n.dom,"next");return o.isAtEnd()&&(s(o.container())||s(r.container()))})(t,e)),Dc=(t,e)=>Qs(t,e)||Js(t,(n=>{const o=n.container(),r=n.offset();return j(o)&&r<o.data.length?L(o,r+1):n})(e)),Jb=(t,e)=>gi(t.charAt(e)),Zb=(t,e)=>Or(t.charAt(e)),t0=(t,e,n)=>{const o=e.data,r=L(e,0);return n||!Jb(o,0)||Dc(t,r)?!!(n&&Zb(o,0)&&Qs(t,r))&&(e.data=Zt+o.slice(1),!0):(e.data=" "+o.slice(1),!0)},e0=(t,e,n)=>{const o=e.data,r=L(e,o.length-1);return n||!Jb(o,o.length-1)||Dc(t,r)?!!(n&&Zb(o,o.length-1)&&Js(t,r))&&(e.data=o.slice(0,-1)+Zt,!0):(e.data=o.slice(0,-1)+" ",!0)},zE=(t,e)=>{const n=e.container();if(!j(n))return C.none();if((o=>{const r=o.container();return j(r)&&se(r.data,Zt)})(e)){const o=t0(t,n,!1)||(r=>{const s=r.data,a=(i=>{const l=i.split("");return yt(l,(d,c)=>gi(d)&&c>0&&c<l.length-1&&Xd(l[c-1])&&Xd(l[c+1])?" ":d).join("")})(s);return a!==s&&(r.data=a,!0)})(n)||e0(t,n,!1);return ls(o,e)}if(Dc(t,e)){const o=t0(t,n,!0)||e0(t,n,!0);return ls(o,e)}return C.none()},n0=(t,e,n)=>{if(n===0)return;const o=N(t),r=to(o,on).getOr(o),s=t.data.slice(e,e+n),a=e+n>=t.data.length&&Js(r,L(t,t.data.length)),i=e===0&&Qs(r,L(t,0));t.replaceData(e,n,kg(s,4,i,a))},Oi=(t,e)=>{const n=t.data.slice(e),o=n.length-mx(n).length;n0(t,e,o)},Pc=(t,e)=>{const n=t.data.slice(0,e),o=n.length-uf(n).length;n0(t,e-o,o)},Lc=(t,e,n,o=!0)=>{const r=uf(t.data).length,s=o?t:e,a=o?e:t;return o?s.appendData(a.data):s.insertData(0,a.data),Tt(N(a)),n&&Oi(s,r),s},jE=(t,e)=>((n,o)=>{const r=n.container(),s=n.offset();return!L.isTextPosition(n)&&r===o.parentNode&&s>L.before(o).offset()})(e,t)?L(e.container(),e.offset()-1):e,o0=t=>{return Ye(t.previousSibling)?C.some((e=t.previousSibling,j(e)?L(e,e.data.length):L.after(e))):t.previousSibling?Sn(t.previousSibling):C.none();var e},r0=t=>{return Ye(t.nextSibling)?C.some((e=t.nextSibling,j(e)?L(e,0):L.before(e))):t.nextSibling?be(t.nextSibling):C.none();var e},HE=(t,e,n)=>((o,r,s)=>o?((a,i)=>r0(i).orThunk(()=>o0(i)).orThunk(()=>((l,d)=>ke(l,L.after(d)).orThunk(()=>Ue(l,L.before(d))))(a,i)))(r,s):((a,i)=>o0(i).orThunk(()=>r0(i)).orThunk(()=>((l,d)=>C.from(d.previousSibling?d.previousSibling:d.parentNode).bind(c=>Ue(l,L.before(c))).orThunk(()=>ke(l,L.after(d))))(a,i)))(r,s))(t,e,n).map(tt(jE,n)),s0=(t,e,n)=>{n.fold(()=>{t.focus()},o=>{t.selection.setRng(o.toRange(),e)})},$E=(t,e)=>e&&pt(t.schema.getBlockElements(),Ot(e)),VE=t=>{if(Ut(t)){const e=La('<br data-mce-bogus="1">');return ps(t),Kt(t,e),C.some(L.before(e.dom))}return C.none()},Jo=(t,e,n,o=!0)=>{const r=HE(e,t.getBody(),n.dom),s=to(n,tt($E,t),(a=t.getBody(),l=>l.dom===a));var a;const i=((l,d,c)=>{const u=Oo(l).filter(Le),g=gs(l).filter(Le);return Tt(l),(p=u,m=g,h=d,f=(b,v,y)=>{const w=b.dom,k=v.dom,x=w.data.length;return Lc(w,k,c),y.container()===k?L(w,x):y},p.isSome()&&m.isSome()&&h.isSome()?C.some(f(p.getOrDie(),m.getOrDie(),h.getOrDie())):C.none()).orThunk(()=>(c&&(u.each(b=>Pc(b.dom,b.dom.length)),g.each(b=>Oi(b.dom,0))),d));var p,m,h,f})(n,r,((l,d)=>pt(l.schema.getTextInlineElements(),Ot(d)))(t,n));t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):s.bind(VE).fold(()=>{o&&s0(t,e,i)},l=>{o&&s0(t,e,C.some(l))})},qE=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,Zo=(t,e)=>Ze(N(e),qk(t))&&!ks(t.schema,e),ho=(t,e,n)=>{const o=((r,s,a)=>mt(Et.DOM.getParents(a.container(),"*",s),r))(t,e,n);return C.from(o[o.length-1])},$e=(t,e)=>{const n=e.container(),o=e.offset();return t?oo(n)?j(n.nextSibling)?L(n.nextSibling,0):L.after(n):ud(e)?L(n,o+1):e:oo(n)?j(n.previousSibling)?L(n.previousSibling,n.previousSibling.data.length):L.before(n):md(e)?L(n,o-1):e},a0=tt($e,!0),i0=tt($e,!1),l0=(t,e)=>{const n=o=>o.stopImmediatePropagation();t.on("beforeinput input",n,!0),t.getDoc().execCommand(e),t.off("beforeinput input",n)},d0=t=>l0(t,"Delete"),WE=t=>hg(t)||Cs(t),Ti=(t,e)=>Fn(t,e)?Bo(e,WE,(n=>o=>pr(tn(o),n,xt))(t)):C.none(),Mc=(t,e=!0)=>{t.dom.isEmpty(t.getBody())&&t.setContent("",{no_selection:!e})},c0=t=>{var e;return(Af(e=t)===8||Ot(e)==="#comment"?Oo(t):Zl(t)).bind(c0).orThunk(()=>C.some(t))},u0=(t,e,n,o=!0)=>{var r;e.deleteContents();const s=c0(n).getOr(n),a=N((r=t.dom.getParent(s.dom,t.dom.isBlock))!==null&&r!==void 0?r:n.dom);if(a.dom===t.getBody()?Mc(t,o):Ut(a)&&(Io(a),o&&t.selection.setCursorLocation(a.dom,0)),!xt(n,a)){const l=pr(tn(a),n)?[]:tn(i=a).map(oe).map(d=>mt(d,c=>!xt(i,c))).getOr([]);H(l.concat(oe(n)),d=>{xt(d,a)||Fn(d,a)||!Ut(d)||Tt(d)})}var i},Ic=t=>le(t,"td,th"),Fc=(t,e)=>({start:t,end:e}),Zs=Cn([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),Bi=(t,e)=>Do(N(t),"td,th",e),m0=t=>!xt(t.start,t.end),f0=(t,e)=>$s(t.start,e).bind(n=>$s(t.end,e).bind(o=>ls(xt(n,o),n))),Uc=t=>e=>f0(e,t).map(n=>((o,r,s)=>({rng:o,table:r,cells:s}))(e,n,Ic(n))),g0=(t,e,n,o)=>{if(n.collapsed||!t.forall(m0))return C.none();if(e.isSameTable){const r=t.bind(Uc(o));return C.some({start:r,end:r})}{const r=Bi(n.startContainer,o),s=Bi(n.endContainer,o),a=r.bind((l=>d=>$s(d,l).bind(c=>Eo(Ic(c)).map(u=>Fc(d,u))))(o)).bind(Uc(o)),i=s.bind((l=>d=>$s(d,l).bind(c=>xe(Ic(c)).map(u=>Fc(u,d))))(o)).bind(Uc(o));return C.some({start:a,end:i})}},p0=(t,e)=>ns(t,n=>xt(n,e)),zc=t=>pe(p0(t.cells,t.rng.start),p0(t.cells,t.rng.end),(e,n)=>t.cells.slice(e,n+1)),h0=(t,e)=>{const{startTable:n,endTable:o}=e,r=t.cloneRange();return n.each(s=>r.setStartAfter(s.dom)),o.each(s=>r.setEndBefore(s.dom)),r},KE=(t,e)=>{const n=(s=>a=>xt(s,a))(t),o=((s,a)=>{const i=Bi(s.startContainer,a),l=Bi(s.endContainer,a);return pe(i,l,Fc)})(e,n),r=((s,a)=>{const i=p=>$s(N(p),a),l=i(s.startContainer),d=i(s.endContainer),c=l.isSome(),u=d.isSome(),g=pe(l,d,xt).getOr(!1);return{startTable:l,endTable:d,isStartInTable:c,isEndInTable:u,isSameTable:g,isMultiTable:!g&&c&&u}})(e,n);return((s,a,i)=>s.exists(l=>((d,c)=>!m0(d)&&f0(d,c).exists(u=>{const g=u.dom.rows;return g.length===1&&g[0].cells.length===1}))(l,i)&&tc(l.start,a)))(o,e,n)?o.map(s=>Zs.singleCellTable(e,s.start)):r.isMultiTable?((s,a,i,l)=>g0(s,a,i,l).bind(({start:d,end:c})=>{const u=d.bind(zc).getOr([]),g=c.bind(zc).getOr([]);if(u.length>0&&g.length>0){const p=h0(i,a);return C.some(Zs.multiTable(u,g,p))}return C.none()}))(o,r,e,n):((s,a,i,l)=>g0(s,a,i,l).bind(({start:d,end:c})=>d.or(c)).bind(d=>{const{isSameTable:c}=a,u=zc(d).getOr([]);if(c&&d.cells.length===u.length)return C.some(Zs.fullTable(d.table));if(u.length>0){if(c)return C.some(Zs.partialTable(u,C.none()));{const g=h0(i,a);return C.some(Zs.partialTable(u,C.some(K(K({},a),{rng:g}))))}}return C.none()}))(o,r,e,n)},b0=t=>H(t,e=>{ne(e,"contenteditable"),Io(e)}),jc=(t,e,n,o)=>{const r=n.cloneRange();o?(r.setStart(n.startContainer,n.startOffset),r.setEndAfter(e.dom.lastChild)):(r.setStartBefore(e.dom.firstChild),r.setEnd(n.endContainer,n.endOffset)),Hc(t,r,e,!1).each(s=>s())},v0=t=>{const e=Tr(t),n=N(t.selection.getNode());$a(n.dom)&&Ut(n)?t.selection.setCursorLocation(n.dom,0):t.selection.collapse(!0),e.length>1&&It(e,o=>xt(o,n))&&Qt(n,"data-mce-selected","1")},y0=(t,e,n)=>C.some(()=>{const o=t.selection.getRng(),r=n.bind(({rng:s,isStartInTable:a})=>{const i=((d,c)=>C.from(d.dom.getParent(c,d.dom.isBlock)).map(N))(t,a?s.endContainer:s.startContainer);s.deleteContents(),((d,c,u)=>{u.each(g=>{c?Tt(g):(Io(g),d.selection.setCursorLocation(g.dom,0))})})(t,a,i.filter(Ut));const l=a?e[0]:e[e.length-1];return jc(t,l,o,a),Ut(l)?C.none():C.some(a?e.slice(1):e.slice(0,-1))}).getOr(e);b0(r),v0(t)}),GE=(t,e,n,o)=>C.some(()=>{const r=t.selection.getRng(),s=e[0],a=n[n.length-1];jc(t,s,r,!0),jc(t,a,r,!1);const i=Ut(s)?e:e.slice(1),l=Ut(a)?n:n.slice(0,-1);b0(i.concat(l)),o.deleteContents(),v0(t)}),Hc=(t,e,n,o=!0)=>C.some(()=>{u0(t,e,n,o)}),YE=(t,e)=>C.some(()=>Jo(t,!1,e)),C0=(t,e)=>Wt(Vn(e,t),ws),$c=(t,e)=>Wt(Vn(e,t),Xl("caption")),Di=(t,e)=>C.some(()=>{Io(e),t.selection.setCursorLocation(e.dom,0)}),w0=(t,e)=>t?zb(e):jb(e),XE=(t,e,n)=>{const o=N(t.getBody());return $c(o,n).fold(()=>((r,s,a,i)=>{const l=L.fromRangeStart(r.selection.getRng());return C0(a,i).bind(d=>Ut(d)?Di(r,d):((c,u,g,p,m)=>mi(g,c.getBody(),m).bind(h=>C0(u,N(h.getNode())).bind(f=>xt(f,p)?C.none():C.some(bt))))(r,a,s,d,l))})(t,e,o,n).orThunk(()=>ls(((r,s)=>{const a=L.fromRangeStart(r.selection.getRng());return w0(s,a)||Fe(s,r.getBody(),a).exists(i=>w0(s,i))})(t,e),bt)),r=>((s,a,i,l)=>{const d=L.fromRangeStart(s.selection.getRng());return Ut(l)?Di(s,l):((c,u,g,p,m)=>mi(g,c.getBody(),m).fold(()=>C.some(bt),h=>((f,b,v,y)=>be(f.dom).bind(w=>Sn(f.dom).map(k=>b?v.isEqual(w)&&y.isEqual(k):v.isEqual(k)&&y.isEqual(w))).getOr(!0))(p,g,m,h)?((f,b)=>Di(f,b))(c,p):((f,b,v)=>$c(f,N(v.getNode())).fold(()=>C.some(bt),y=>ls(!xt(y,b),bt)))(u,p,h)))(s,i,a,l,d)})(t,e,o,r))},Vc=(t,e)=>{const n=N(t.selection.getStart(!0)),o=Tr(t);return t.selection.isCollapsed()&&o.length===0?XE(t,e,n):((r,s,a)=>{const i=N(r.getBody()),l=r.selection.getRng();return a.length!==0?y0(r,a,C.none()):((d,c,u,g)=>$c(c,g).fold(()=>((p,m,h)=>KE(m,h).bind(f=>f.fold(tt(Hc,p),tt(YE,p),tt(y0,p),tt(GE,p))))(d,c,u),p=>((m,h)=>Di(m,h))(d,p)))(r,i,l,s)})(t,n,o)},tr=(t,e)=>{let n=e;for(;n&&n!==t;){if(nn(n)||Rt(n))return n;n=n.parentNode}return null},QE=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],JE=$.each,qc=t=>{const e=t.dom,n=new Set(t.serializer.getTempAttrs()),o=r=>It(QE,s=>ee(r,s))||n.has(r);return{compare:(r,s)=>{if(r.nodeName!==s.nodeName||r.nodeType!==s.nodeType)return!1;const a=l=>{const d={};return JE(e.getAttribs(l),c=>{const u=c.nodeName.toLowerCase();u==="style"||o(u)||(d[u]=e.getAttrib(l,u))}),d},i=(l,d)=>{for(const c in l)if(pt(l,c)){const u=d[c];if(fe(u)||l[c]!==u)return!1;delete d[c]}for(const c in d)if(pt(d,c))return!1;return!0};return J(r)&&J(s)&&(!i(a(r),a(s))||!i(e.parseStyle(e.getAttrib(r,"style")),e.parseStyle(e.getAttrib(s,"style"))))?!1:!ze(r)&&!ze(s)},isAttributeInternal:o}},x0=(t,e,n,o)=>{const r=n.name;for(let s=0,a=t.length;s<a;s++){const i=t[s];if(i.name===r){const l=o.nodes[r];l?l.nodes.push(n):o.nodes[r]={filter:i,nodes:[n]}}}if(n.attributes)for(let s=0,a=e.length;s<a;s++){const i=e[s],l=i.name;if(l in n.attributes.map){const d=o.attributes[l];d?d.nodes.push(n):o.attributes[l]={filter:i,nodes:[n]}}}},k0=(t,e)=>{const n=(o,r)=>{Nt(o,s=>{const a=Ae(s.nodes);H(s.filter.callbacks,i=>{for(let l=a.length-1;l>=0;l--){const d=a[l];(r?d.attr(s.filter.name)!==void 0:d.name===s.filter.name)&&!jt(d.parent)||a.splice(l,1)}a.length>0&&i(a,s.filter.name,e)})})};n(t.nodes,!1),n(t.attributes,!0)},S0=(t,e,n,o={})=>{const r=((s,a,i)=>{const l={nodes:{},attributes:{}};return i.firstChild&&((d,c)=>{let u=d;for(;u=u.walk();)x0(s,a,u,l)})(i),l})(t,e,n);k0(r,o)},Wc=(t,e,n)=>{if(t.insert&&e(n)){const o=new ve("br",1);o.attr("data-mce-bogus","1"),n.empty().append(o)}else n.empty().append(new ve("#text",3)).value=Zt},E0=(t,e)=>{const n=t==null?void 0:t.firstChild;return Q(n)&&n===t.lastChild&&n.name===e},ta=(t,e,n,o)=>o.isEmpty(e,n,r=>((s,a)=>{const i=s.getElementRule(a.name);return(i==null?void 0:i.paddEmpty)===!0})(t,r)),Kc=(t,e,n=t.parent)=>{if(e.getSpecialElements()[t.name])t.empty().remove();else{const o=t.children();for(const r of o)n&&!e.isValidChild(n.name,r.name)&&Kc(r,e,n);t.unwrap()}},Gc=(t,e,n=bt)=>{const o=e.getTextBlockElements(),r=e.getNonEmptyElements(),s=e.getWhitespaceElements(),a=$.makeMap("tr,td,th,tbody,thead,tfoot,table"),i=new Set;for(let l=0;l<t.length;l++){const d=t[l];let c,u,g;if(!d.parent||i.has(d))continue;if(o[d.name]&&d.parent.name==="li"){let m=d.next;for(;m&&o[m.name];)m.name="li",i.add(m),d.parent.insert(m,d.parent),m=m.next;d.unwrap();continue}const p=[d];for(c=d.parent;c&&!e.isValidChild(c.name,d.name)&&!a[c.name];c=c.parent)p.push(c);if(c&&p.length>1)if(e.isValidChild(c.name,d.name)){p.reverse(),u=p[0].clone(),n(u);let m=u;for(let h=0;h<p.length-1;h++){e.isValidChild(m.name,p[h].name)?(g=p[h].clone(),n(g),m.append(g)):g=m;for(let f=p[h].firstChild;f&&f!==p[h+1];){const b=f.next;g.append(f),f=b}m=g}ta(e,r,s,u)?c.insert(d,p[0],!0):(c.insert(u,p[0],!0),c.insert(d,u)),c=p[0],(ta(e,r,s,c)||E0(c,"br"))&&c.empty().remove()}else Kc(d,e);else if(d.parent){if(d.name==="li"){let m=d.prev;if(m&&(m.name==="ul"||m.name==="ol")){m.append(d);continue}if(m=d.next,m&&(m.name==="ul"||m.name==="ol")&&m.firstChild){m.insert(d,m.firstChild,!0);continue}const h=new ve("ul",1);n(h),d.wrap(h);continue}if(e.isValidChild(d.parent.name,"div")&&e.isValidChild("div",d.name)){const m=new ve("div",1);n(m),d.wrap(m)}else Kc(d,e)}}},_0=(t,e,n=e.parent)=>!(!n||!t.children[e.name]||t.isValidChild(n.name,e.name))||!(!n||e.name!=="a"||!((o,r)=>{let s=o;for(;s;){if(s.name==="a")return!0;s=s.parent}return!1})(n)),Yc=t=>t.collapsed?t:(e=>{const n=L.fromRangeStart(e),o=L.fromRangeEnd(e),r=e.commonAncestorContainer;return Fe(!1,r,o).map(s=>!wn(n,o,r)&&wn(n,s,r)?((a,i,l,d)=>{const c=document.createRange();return c.setStart(a,i),c.setEnd(l,d),c})(n.container(),n.offset(),s.container(),s.offset()):e).getOr(e)})(t),ZE=(t,e)=>{let n=e.firstChild,o=e.lastChild;return n&&n.name==="meta"&&(n=n.next),o&&o.attr("id")==="mce_marker"&&(o=o.prev),((r,s)=>{const a=r.getNonEmptyElements();return Q(s)&&(s.isEmpty(a)||((i,l)=>i.getBlockElements()[l.name]&&(d=>Q(d.firstChild)&&d.firstChild===d.lastChild)(l)&&(d=>d.name==="br"||d.value===Zt)(l.firstChild))(r,s))})(t,o)&&(o=o==null?void 0:o.prev),!(!n||n!==o||n.name!=="ul"&&n.name!=="ol")},t_=t=>{return t.length>0&&(!(n=t[t.length-1]).firstChild||Q((e=n)==null?void 0:e.firstChild)&&e.firstChild===e.lastChild&&(o=>o.data===Zt||Ft(o))(e.firstChild))?t.slice(0,-1):t;var e,n},Xc=(t,e)=>{const n=t.getParent(e,t.isBlock);return n&&n.nodeName==="LI"?n:null},N0=(t,e)=>{const n=L.after(t),o=kn(e).prev(n);return o?o.toRange():null},e_=(t,e,n,o)=>{const r=((u,g,p)=>{const m=g.serialize(p);return(h=>{var f,b;const v=h.firstChild,y=h.lastChild;return v&&v.nodeName==="META"&&((f=v.parentNode)===null||f===void 0||f.removeChild(v)),y&&y.id==="mce_marker"&&((b=y.parentNode)===null||b===void 0||b.removeChild(y)),h})(u.createFragment(m))})(e,t,o),s=Xc(e,n.startContainer),a=t_((i=r.firstChild,mt((l=i==null?void 0:i.childNodes)!==null&&l!==void 0?l:[],u=>u.nodeName==="LI")));var i,l;const d=e.getRoot(),c=u=>{const g=L.fromRangeStart(n),p=kn(e.getRoot()),m=u===1?p.prev(g):p.next(g),h=m==null?void 0:m.getNode();return!h||Xc(e,h)!==s};return s?c(1)?((u,g,p)=>{const m=u.parentNode;return m&&$.each(g,h=>{m.insertBefore(h,u)}),((h,f)=>{const b=L.before(h),v=kn(f).next(b);return v?v.toRange():null})(u,p)})(s,a,d):c(2)?((u,g,p,m)=>(m.insertAfter(g.reverse(),u),N0(g[0],p)))(s,a,d,e):((u,g,p,m)=>{const h=((b,v)=>{const y=v.cloneRange(),w=v.cloneRange();return y.setStartBefore(b),w.setEndAfter(b),[y.cloneContents(),w.cloneContents()]})(u,m),f=u.parentNode;return f&&(f.insertBefore(h[0],u),$.each(g,b=>{f.insertBefore(b,u)}),f.insertBefore(h[1],u),f.removeChild(u)),N0(g[g.length-1],p)})(s,a,d,n):null},n_=["pre"],Qc=$a,o_=(t,e,n)=>{var o,r;const s=t.selection,a=t.dom,i=t.parser,l=n.merge,d=mo({validate:!0},t.schema),c='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';e.indexOf("{$caret}")===-1&&(e+="{$caret}"),e=e.replace(/\{\$caret\}/,c);let u=s.getRng();const g=u.startContainer,p=t.getBody();g===p&&s.isCollapsed()&&a.isBlock(p.firstChild)&&((y,w)=>Q(w)&&!y.schema.getVoidElements()[w.nodeName])(t,p.firstChild)&&a.isEmpty(p.firstChild)&&(u=a.createRng(),u.setStart(p.firstChild,0),u.setEnd(p.firstChild,0),s.setRng(u)),s.isCollapsed()||(y=>{const w=y.dom,k=Yc(y.selection.getRng());y.selection.setRng(k);const x=w.getParent(k.startContainer,Qc);((E,S,_)=>!!Q(_)&&_===E.getParent(S.endContainer,Qc)&&tc(N(_),S))(w,k,x)?Hc(y,k,N(x)):k.startContainer===k.endContainer&&k.endOffset-k.startOffset==1&&j(k.startContainer.childNodes[k.startOffset])?k.deleteContents():y.getDoc().execCommand("Delete",!1)})(t);const m=s.getNode(),h={context:m.nodeName.toLowerCase(),data:n.data,insert:!0},f=i.parse(e,h);if(n.paste===!0&&ZE(t.schema,f)&&((y,w)=>!!Xc(y,w))(a,m))return u=e_(d,a,s.getRng(),f),u&&s.setRng(u),e;n.paste===!0&&((y,w,k,x)=>{var E;const S=w.firstChild,_=w.lastChild,O=S===(_.attr("data-mce-type")==="bookmark"?_.prev:_),T=_t(n_,S.name);if(O&&T){const P=S.attr("contenteditable")!=="false",D=((E=y.getParent(k,y.isBlock))===null||E===void 0?void 0:E.nodeName.toLowerCase())===S.name,I=C.from(tr(x,k)).forall(nn);return P&&D&&I}return!1})(a,f,m,t.getBody())&&((o=f.firstChild)===null||o===void 0||o.unwrap()),(y=>{let w=y;for(;w=w.walk();)w.type===1&&w.attr("data-mce-fragment","1")})(f);let b=f.lastChild;if(b&&b.attr("id")==="mce_marker"){const y=b;for(b=b.prev;b;b=b.walk(!0))if(b.type===3||!a.isBlock(b.name)){b.parent&&t.schema.isValidChild(b.parent.name,"span")&&b.parent.insert(y,b,b.name==="br");break}}if(t._selectionOverrides.showBlockCaretContainer(m),h.invalid){t.selection.setContent(c);let y,w=s.getNode();const k=t.getBody();for(vs(w)?w=y=k:y=w;y&&y!==k;)w=y,y=y.parentNode;e=w===k?k.innerHTML:a.getOuterHTML(w);const x=i.parse(e);for(let O=x;O;O=O.walk())if(O.attr("id")==="mce_marker"){O.replace(f);break}const E=f.children(),S=(r=f.parent)!==null&&r!==void 0?r:x;f.unwrap();const _=mt(E,O=>_0(t.schema,O,S));Gc(_,t.schema),S0(i.getNodeFilters(),i.getAttributeFilters(),x),e=d.serialize(x),w===k?a.setHTML(k,e):a.setOuterHTML(w,e)}else e=d.serialize(f),((y,w,k)=>{var x;if(k.getAttribute("data-mce-bogus")==="all")(x=k.parentNode)===null||x===void 0||x.insertBefore(y.dom.createFragment(w),k);else{const E=k.firstChild,S=k.lastChild;!E||E===S&&E.nodeName==="BR"?y.dom.setHTML(k,w):y.selection.setContent(w,{no_events:!0})}})(t,e,m);var v;return((y,w)=>{const k=y.schema.getTextInlineElements(),x=y.dom;if(w){const E=y.getBody(),S=qc(y);$.each(x.select("*[data-mce-fragment]"),_=>{if(Q(k[_.nodeName.toLowerCase()])&&((O,T)=>So(Ec(O,T),P=>!(D=>Lb.has(D))(P)))(x,_)){for(let O=_.parentElement;Q(O)&&O!==E&&!TE(x,_,O);O=O.parentElement)if(S.compare(O,_)){x.remove(_,!0);break}}})}})(t,l),((y,w)=>{var k,x,E;let S;const _=y.dom,O=y.selection;if(!w)return;O.scrollIntoView(w);const T=tr(y.getBody(),w);if(T&&_.getContentEditable(T)==="false")return _.remove(w),void O.select(T);let P=_.createRng();const D=w.previousSibling;if(j(D)){P.setStart(D,(x=(k=D.nodeValue)===null||k===void 0?void 0:k.length)!==null&&x!==void 0?x:0);const q=w.nextSibling;j(q)&&(D.appendData(q.data),(E=q.parentNode)===null||E===void 0||E.removeChild(q))}else P.setStartBefore(w),P.setEndBefore(w);const I=_.getParent(w,_.isBlock);_.remove(w),I&&_.isEmpty(I)&&(ps(N(I)),P.setStart(I,0),P.setEnd(I,0),Qc(I)||(q=>!!q.getAttribute("data-mce-fragment"))(I)||!(S=(q=>{let W=L.fromRangeStart(q);return W=kn(y.getBody()).next(W),W==null?void 0:W.toRange()})(P))?_.add(I,_.create("br",{"data-mce-bogus":"1"})):(P=S,_.remove(I))),O.setRng(P)})(t,a.get("mce_marker")),v=t.getBody(),$.each(v.getElementsByTagName("*"),y=>{y.removeAttribute("data-mce-fragment")}),((y,w)=>{C.from(y.getParent(w,"td,th")).map(N).each(Ux)})(a,s.getStart()),((y,w,k)=>{const x=zf(N(k),E=>xt(E,N(w)));Na(x,x.length-2).filter(Te).fold(()=>hd(y,w),E=>hd(y,E.dom))})(t.schema,t.getBody(),s.getStart()),e},Pi=t=>t instanceof ve,Jc=(t,e,n)=>{t.dom.setHTML(t.getBody(),e),n!==!0&&(o=>{Qo(o)&&be(o.getBody()).each(r=>{const s=r.getNode(),a=zn(s)?be(s).getOr(r):r;o.selection.setRng(a.toRange())})})(t)},r_=(t,e)=>((n,o)=>{const r=n.dom;return r.parentNode?((s,a)=>Wt(s.dom.childNodes,i=>a(N(i))).map(N))(N(r.parentNode),s=>!xt(n,s)&&o(s)):C.none()})(t,e).isSome(),R0=t=>wt(t)?t:Dt,Zc=(t,e,n)=>{const o=e(t),r=R0(n);return o.orThunk(()=>r(t)?C.none():((s,a,i)=>{let l=s.dom;const d=R0(i);for(;l.parentNode;){l=l.parentNode;const c=N(l),u=a(c);if(u.isSome())return u;if(d(c))break}return C.none()})(t,e,r))},tu=ac,A0=(t,e,n)=>{const o=t.formatter.get(n);if(o)for(let r=0;r<o.length;r++){const s=o[r];if(je(s)&&s.inherit===!1&&t.dom.is(e,s.selector))return!0}return!1},eu=(t,e,n,o,r)=>{const s=t.dom.getRoot();if(e===s)return!1;const a=t.dom.getParent(e,i=>!!A0(t,i,n)||i.parentNode===s||!!_n(t,i,n,o,!0));return!!_n(t,a,n,o,r)},Li=(t,e,n)=>!(!qt(n)||!tu(e,n.inline))||!(!En(n)||!tu(e,n.block))||!!je(n)&&J(e)&&t.is(e,n.selector),O0=(t,e,n,o,r,s)=>{const a=n[o],i=o==="attributes";if(wt(n.onmatch))return n.onmatch(e,n,o);if(a){if(rf(a)){for(let l=0;l<a.length;l++)if(i?t.getAttrib(e,a[l]):vi(t,e,a[l]))return!0}else for(const l in a)if(pt(a,l)){const d=i?t.getAttrib(e,l):vi(t,e,l),c=uo(a[l],s),u=jt(d)||is(d);if(u&&jt(c))continue;if(r&&u&&!n.exact||(!r||n.exact)&&!tu(d,ic(c,l)))return!1}}return!0},_n=(t,e,n,o,r)=>{const s=t.formatter.get(n),a=t.dom;if(s&&J(e))for(let i=0;i<s.length;i++){const l=s[i];if(Li(t.dom,e,l)&&O0(a,e,l,"attributes",r,o)&&O0(a,e,l,"styles",r,o)){const d=l.classes;if(d){for(let c=0;c<d.length;c++)if(!t.dom.hasClass(e,uo(d[c],o)))return}return l}}},nu=(t,e,n,o,r)=>{if(o)return eu(t,o,e,n,r);if(o=t.selection.getNode(),eu(t,o,e,n,r))return!0;const s=t.selection.getStart();return!(s===o||!eu(t,s,e,n,r))},Mr=ae,T0=t=>(e=>{const n=[];let o=e;for(;o;){if(j(o)&&o.data!==Mr||o.childNodes.length>1)return[];J(o)&&n.push(o),o=o.firstChild}return n})(t).length>0,B0=t=>{if(t){const e=new Vt(t,t);for(let n=e.current();n;n=e.next())if(j(n))return n}return null},ou=t=>{const e=Jt("span");return Xn(e,{id:Gd,"data-mce-bogus":"1","data-mce-type":"format-caret"}),t&&Kt(e,hr(Mr)),e},ru=(t,e,n=!0)=>{const o=t.dom,r=t.selection;if(T0(e))Jo(t,!1,N(e),n);else{const s=r.getRng(),a=o.getParent(e,o.isBlock),i=s.startContainer,l=s.startOffset,d=s.endContainer,c=s.endOffset,u=(g=>{const p=B0(g);return p&&p.data.charAt(0)===Mr&&p.deleteData(0,1),p})(e);o.remove(e,!0),i===u&&l>0&&s.setStart(u,l-1),d===u&&c>0&&s.setEnd(u,c-1),a&&o.isEmpty(a)&&Io(N(a)),r.setRng(s)}},su=(t,e,n=!0)=>{const o=t.dom,r=t.selection;if(e)ru(t,e,n);else if(!(e=Ko(t.getBody(),r.getStart())))for(;e=o.get(Gd);)ru(t,e,!1)},D0=(t,e)=>(t.appendChild(e),e),P0=(t,e)=>{var n;const o=_a(t,(s,a)=>D0(s,a.cloneNode(!1)),e),r=(n=o.ownerDocument)!==null&&n!==void 0?n:document;return D0(o,r.createTextNode(Mr))},s_=(t,e,n,o)=>{const r=t.dom,s=t.selection;let a=!1;const i=t.formatter.get(e);if(!i)return;const l=s.getRng(),d=l.startContainer,c=l.startOffset;let u=d;j(d)&&(c!==d.data.length&&(a=!0),u=u.parentNode);const g=[];let p;for(;u;){if(_n(t,u,e,n,o)){p=u;break}u.nextSibling&&(a=!0),g.push(u),u=u.parentNode}if(p)if(a){const m=s.getBookmark();l.collapse(!0);let h=Yo(r,l,i,!0);h=_i(h),t.formatter.remove(e,n,h,o),s.moveToBookmark(m)}else{const m=Ko(t.getBody(),p),h=ou(!1).dom;((v,y,w)=>{var k,x;const E=v.dom,S=E.getParent(w,tt(rc,v.schema));S&&E.isEmpty(S)?(k=w.parentNode)===null||k===void 0||k.replaceChild(y,w):((_=>{const O=le(_,"br"),T=mt((P=>{const D=[];let I=P.dom;for(;I;)D.push(N(I)),I=I.lastChild;return D})(_).slice(-1),Mo);O.length===T.length&&H(T,Tt)})(N(w)),E.isEmpty(w)?(x=w.parentNode)===null||x===void 0||x.replaceChild(y,w):E.insertAfter(y,w))})(t,h,m!=null?m:p);const f=((v,y,w,k,x,E)=>{const S=v.formatter,_=v.dom,O=mt(Oe(S.get()),P=>P!==k&&!se(P,"removeformat")),T=((P,D,I)=>Re(I,(q,W)=>{const rt=((at,vt)=>lc(at,vt,St=>{const et=ft=>wt(ft)||ft.length>1&&ft.charAt(0)==="%";return It(["styles","attributes"],ft=>At(St,ft).exists(ct=>{const R=$t(ct)?ct:$l(ct);return It(R,et)}))}))(P,W);return P.formatter.matchNode(D,W,{},rt)?q.concat([W]):q},[]))(v,w,O);if(mt(T,P=>!((D,I,q)=>{const W=["inline","block","selector","attributes","styles","classes"],rt=at=>rs(at,(vt,St)=>It(W,et=>et===St));return lc(D,I,at=>{const vt=rt(at);return lc(D,q,St=>{const et=rt(St);return((ft,ct,R=Pl)=>Km(R).eq(ft,ct))(vt,et)})})})(v,P,k)).length>0){const P=w.cloneNode(!1);return _.add(y,P),S.remove(k,x,P,E),_.remove(P),C.some(P)}return C.none()})(t,h,p,e,n,o),b=P0(g.concat(f.toArray()),h);m&&ru(t,m,!1),s.setCursorLocation(b,1),r.isEmpty(p)&&r.remove(p)}},a_=(t,e)=>{const n=t.schema.getTextInlineElements();return pt(n,Ot(e))&&!an(e.dom)&&!Lo(e.dom)},ea={},L0=en(["pre"]);ea.pre||(ea.pre=[]),ea.pre.push(t=>{if(!t.selection.getRng().collapsed){const e=t.selection.getSelectedBlocks(),n=mt(mt(e,L0),(o=>r=>{const s=r.previousSibling;return L0(s)&&_t(o,s)})(e));H(n,o=>{((r,s)=>{const a=N(s),i=Un(a).dom;Tt(a),To(N(r),[Jt("br",i),Jt("br",i),...oe(a)])})(o.previousSibling,o)})}});const M0=["fontWeight","fontStyle","color","fontSize","fontFamily"],I0=(t,e)=>{const n=t.get(e);return $t(n)?Wt(n,o=>qt(o)&&o.inline==="span"&&(r=>me(r.styles)&&It(Oe(r.styles),s=>_t(M0,s)))(o)):C.none()},F0=(t,e)=>Ue(e,L.fromRangeStart(t)).isNone(),U0=(t,e)=>ke(e,L.fromRangeEnd(t)).exists(n=>!Ft(n.getNode())||ke(e,n).isSome())===!1,z0=t=>e=>Px(e)&&t.getContentEditableParent(e)!=="false",j0=t=>mt(t.getSelectedBlocks(),z0(t.dom)),au=$.each,iu=t=>J(t)&&!ze(t)&&!an(t)&&!Lo(t),H0=(t,e)=>{for(let n=t;n;n=n[e]){if(j(n)&&pn(n.data))return t;if(J(n)&&!ze(n))return n}return t},$0=(t,e,n)=>{const o=qc(t),r=J(e)&&Go(e),s=J(n)&&Go(n);if(r&&s){const a=H0(e,"previousSibling"),i=H0(n,"nextSibling");if(o.compare(a,i)){for(let l=a.nextSibling;l&&l!==i;){const d=l;l=l.nextSibling,a.appendChild(d)}return t.dom.remove(i),$.each($.grep(i.childNodes),l=>{a.appendChild(l)}),a}}return n},V0=(t,e,n,o)=>{var r;if(o&&e.merge_siblings!==!1){const s=(r=$0(t,Nh(o),o))!==null&&r!==void 0?r:o;$0(t,s,Nh(s,!0))}},lu=(t,e,n)=>{au(t.childNodes,o=>{iu(o)&&(e(o)&&n(o),o.hasChildNodes()&&lu(o,e,n))})},q0=(t,e)=>n=>!(!n||!vi(t,n,e)),W0=(t,e,n)=>o=>{t.setStyle(o,e,n),o.getAttribute("style")===""&&o.removeAttribute("style"),((r,s)=>{s.nodeName==="SPAN"&&r.getAttribs(s).length===0&&r.remove(s,!0)})(t,o)},er=Cn([{keep:[]},{rename:["name"]},{removed:[]}]),i_=/^(src|href|style)$/,du=$.each,Mi=ac,K0=(t,e,n)=>t.isChildOf(e,n)&&e!==n&&!t.isBlock(n),G0=(t,e,n)=>{let o=e[n?"startContainer":"endContainer"],r=e[n?"startOffset":"endOffset"];if(J(o)){const s=o.childNodes.length-1;!n&&r&&r--,o=o.childNodes[r>s?s:r]}return j(o)&&n&&r>=o.data.length&&(o=new Vt(o,t.getBody()).next()||o),j(o)&&!n&&r===0&&(o=new Vt(o,t.getBody()).prev()||o),o},Y0=(t,e)=>{const n=e?"firstChild":"lastChild",o=t[n];return(r=>/^(TR|TH|TD)$/.test(r.nodeName))(t)&&o?t.nodeName==="TR"&&o[n]||o:t},cu=(t,e,n,o)=>{var r;const s=t.create(n,o);return(r=e.parentNode)===null||r===void 0||r.insertBefore(s,e),s.appendChild(e),s},X0=(t,e,n,o,r)=>{const s=N(e),a=N(t.create(o,r)),i=n?Hf(s):jf(s);return To(a,i),n?(Me(s,a),Jf(a,s)):(Jn(s,a),Kt(a,s)),a.dom},Q0=(t,e,n)=>{const o=e.parentNode;let r;const s=t.dom,a=Be(t);En(n)&&o===s.getRoot()&&(n.list_block&&Mi(e,n.list_block)||H(Ae(e.childNodes),i=>{Br(t,a,i.nodeName.toLowerCase())?r?r.appendChild(i):(r=cu(s,i,a),s.setAttribs(r,Ls(t))):r=null})),(i=>je(i)&&qt(i)&&pr(At(i,"mixed"),!0))(n)&&!Mi(n.inline,e)||s.remove(e,!0)},J0=(t,e,n)=>Je(t)?{name:e,value:null}:{name:t,value:uo(e,n)},Z0=(t,e)=>{t.getAttrib(e,"style")===""&&(e.removeAttribute("style"),e.removeAttribute("data-mce-style"))},tv=(t,e,n,o,r)=>{let s=!1;du(n.styles,(a,i)=>{const{name:l,value:d}=J0(i,a,o),c=ic(d,l);(n.remove_similar||wo(d)||!J(r)||Mi(vi(t,r,l),c))&&t.setStyle(e,l,""),s=!0}),s&&Z0(t,e)},ev=(t,e,n,o,r)=>{const s=t.dom,a=qc(t),i=t.schema;if(qt(e)&&Ya(i,e.inline)&&ks(i,o)&&o.parentElement===t.getBody())return Q0(t,o,e),er.removed();if(!e.ceFalseOverride&&o&&s.getContentEditableParent(o)==="false"||o&&!Li(s,o,e)&&!((c,u)=>u.links&&c.nodeName==="A")(o,e))return er.keep();const l=o,d=e.preserve_attributes;if(qt(e)&&e.remove==="all"&&$t(d)){const c=mt(s.getAttribs(l),u=>_t(d,u.name.toLowerCase()));if(s.removeAllAttribs(l),H(c,u=>s.setAttrib(l,u.name,u.value)),c.length>0)return er.rename("span")}if(e.remove!=="all"){tv(s,l,e,n,r),du(e.attributes,(u,g)=>{const{name:p,value:m}=J0(g,u,n);if(e.remove_similar||wo(m)||!J(r)||Mi(s.getAttrib(r,p),m)){if(p==="class"){const h=s.getAttrib(l,p);if(h){let f="";if(H(h.split(/\s+/),b=>{/mce\-\w+/.test(b)&&(f+=(f?" ":"")+b)}),f)return void s.setAttrib(l,p,f)}}if(i_.test(p)&&l.removeAttribute("data-mce-"+p),p==="style"&&en(["li"])(l)&&s.getStyle(l,"list-style-type")==="none")return l.removeAttribute(p),void s.setStyle(l,"list-style-type","none");p==="class"&&l.removeAttribute("className"),l.removeAttribute(p)}}),du(e.classes,u=>{u=uo(u,n),J(r)&&!s.hasClass(r,u)||s.removeClass(l,u)});const c=s.getAttribs(l);for(let u=0;u<c.length;u++){const g=c[u].nodeName;if(!a.isAttributeInternal(g))return er.keep()}}return e.remove!=="none"?(Q0(t,l,e),er.removed()):er.keep()},na=(t,e,n,o,r)=>ev(t,e,n,o,r).fold(Dt,s=>(t.dom.rename(o,s),!0),Ht),l_=(t,e,n,o)=>ev(t,e,n,o,o).fold(Y(o),r=>(t.dom.createFragment().appendChild(o),t.dom.rename(o,r)),Y(null)),nv=(t,e,n,o,r)=>{const s=t.formatter.get(e),a=s[0],i=t.dom,l=t.selection,d=m=>{const h=((f,b,v,y,w)=>{let k;return b.parentNode&&H(yi(f.dom,b.parentNode).reverse(),x=>{if(!k&&J(x)&&x.id!=="_start"&&x.id!=="_end"){const E=_n(f,x,v,y,w);E&&E.split!==!1&&(k=x)}}),k})(t,m,e,n,r);return((f,b,v,y,w,k,x,E)=>{var S,_;let O,T;const P=f.dom;if(v){const D=v.parentNode;for(let I=y.parentNode;I&&I!==D;I=I.parentNode){let q=P.clone(I,!1);for(let W=0;W<b.length&&(q=l_(f,b[W],E,q),q!==null);W++);q&&(O&&q.appendChild(O),T||(T=q),O=q)}x.mixed&&P.isBlock(v)||(y=(S=P.split(v,y))!==null&&S!==void 0?S:y),O&&T&&((_=w.parentNode)===null||_===void 0||_.insertBefore(O,w),T.appendChild(w),qt(x)&&V0(f,x,0,O))}return y})(t,s,h,m,m,0,a,n)},c=m=>It(s,h=>na(t,h,n,m,m)),u=m=>{const h=Ae(m.childNodes),f=c(m)||It(s,v=>Li(i,m,v)),b=m.parentNode;if(!f&&Q(b)&&dc(a)&&c(b),a.deep&&h.length)for(let v=0;v<h.length;v++)u(h[v]);H(["underline","line-through","overline"],v=>{J(m)&&t.dom.getStyle(m,"text-decoration")===v&&m.parentNode&&Ah(i,m.parentNode)===v&&na(t,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:v}},void 0,m)})},g=m=>{const h=i.get(m?"_start":"_end");if(h){let f=h[m?"firstChild":"lastChild"];return(b=>ze(b)&&J(b)&&(b.id==="_start"||b.id==="_end"))(f)&&(f=f[m?"firstChild":"lastChild"]),j(f)&&f.data.length===0&&(f=m?h.previousSibling||h.nextSibling:h.nextSibling||h.previousSibling),i.remove(h,!0),f}return null},p=m=>{let h,f,b=Yo(i,m,s,m.collapsed);if(a.split){if(b=_i(b),h=G0(t,b,!0),f=G0(t,b),h!==f){if(h=Y0(h,!0),f=Y0(f,!1),K0(i,h,f)){const y=C.from(h.firstChild).getOr(h);return d(X0(i,y,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void g(!0)}if(K0(i,f,h)){const y=C.from(f.lastChild).getOr(f);return d(X0(i,y,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void g(!1)}h=cu(i,h,"span",{id:"_start","data-mce-type":"bookmark"}),f=cu(i,f,"span",{id:"_end","data-mce-type":"bookmark"});const v=i.createRng();v.setStartAfter(h),v.setEndBefore(f),Vs(i,v,y=>{H(y,w=>{ze(w)||ze(w.parentNode)||d(w)})}),d(h),d(f),h=g(!0),f=g()}else h=f=d(h);b.startContainer=h.parentNode?h.parentNode:h,b.startOffset=i.nodeIndex(h),b.endContainer=f.parentNode?f.parentNode:f,b.endOffset=i.nodeIndex(f)+1}Vs(i,b,v=>{H(v,u)})};if(o){if(bi(o)){const m=i.createRng();m.setStartBefore(o),m.setEndAfter(o),p(m)}else p(o);qh(t,e,o,n)}else l.isCollapsed()&&qt(a)&&!Tr(t).length?s_(t,e,n,r):(_h(t,()=>nc(t,p),m=>qt(a)&&nu(t,e,n,m)),t.nodeChanged()),((m,h,f)=>{h==="removeformat"?H(j0(m.selection),b=>{H(M0,v=>m.dom.setStyle(b,v,"")),Z0(m.dom,b)}):I0(m.formatter,h).each(b=>{H(j0(m.selection),v=>tv(m.dom,v,b,f,null))})})(t,e,n),qh(t,e,o,n)},ov=$.each,Ii=$.each,rv=(t,e,n,o)=>{if(Ii(n.styles,(r,s)=>{t.setStyle(e,s,uo(r,o))}),n.styles){const r=t.getAttrib(e,"style");r&&t.setAttrib(e,"data-mce-style",r)}},sv=(t,e,n,o)=>{const r=t.formatter.get(e),s=r[0],a=!o&&t.selection.isCollapsed(),i=t.dom,l=t.selection,d=(m,h=s)=>{wt(h.onformat)&&h.onformat(m,h,n,o),rv(i,m,h,n),Ii(h.attributes,(f,b)=>{i.setAttrib(m,b,uo(f,n))}),Ii(h.classes,f=>{const b=uo(f,n);i.hasClass(m,b)||i.addClass(m,b)})},c=(m,h)=>{let f=!1;return Ii(m,b=>!(!je(b)||(i.getContentEditable(h)!=="false"||b.ceFalseOverride)&&(!Q(b.collapsed)||b.collapsed===a)&&i.is(h,b.selector)&&!an(h)&&(d(h,b),f=!0,1))),f},u=m=>{if(it(m)){const h=i.create(m);return d(h),h}return null},g=(m,h,f)=>{const b=[];let v=!0;const y=s.inline||s.block,w=u(y);Vs(m,h,k=>{let x;const E=S=>{let _=!1,O=v,T=!1;const P=S.parentNode,D=P.nodeName.toLowerCase(),I=m.getContentEditable(S);Q(I)&&(O=v,v=I==="true",_=!0,T=Rh(t,S));const q=v&&!_;if(Ft(S)&&!((W,rt,at,vt)=>{if(Zk(W)&&qt(rt)&&at.parentNode){const St=jg(W.schema),et=r_(N(at),ft=>an(ft.dom));return fr(St,vt)&&Ut(N(at.parentNode),!1)&&!et}return!1})(t,s,S,D))return x=null,void(En(s)&&m.remove(S));if((W=>(rt=>En(rt)&&rt.wrapper===!0)(s)&&_n(t,W,e,n))(S))x=null;else{if(((W,rt,at)=>{const vt=(St=>En(St)&&St.wrapper!==!0)(s)&&rc(t.schema,W)&&Br(t,rt,y);return at&&vt})(S,D,q)){const W=m.rename(S,y);return d(W),b.push(W),void(x=null)}if(je(s)){let W=c(r,S);if(!W&&Q(P)&&dc(s)&&(W=c(r,P)),!qt(s)||W)return void(x=null)}Q(w)&&((W,rt,at,vt)=>{const St=W.nodeName.toLowerCase(),et=Br(t,y,St)&&Br(t,rt,y),ft=!f&&j(W)&&qa(W.data),ct=an(W),R=!qt(s)||!m.isBlock(W);return(at||vt)&&et&&!ft&&!ct&&R})(S,D,q,T)?(x||(x=m.clone(w,!1),P.insertBefore(x,S),b.push(x)),T&&_&&(v=O),x.appendChild(S)):(x=null,H(Ae(S.childNodes),E),_&&(v=O),x=null)}};H(k,E)}),s.links===!0&&H(b,k=>{const x=E=>{E.nodeName==="A"&&d(E,s),H(Ae(E.childNodes),x)};x(k)}),H(b,k=>{const x=(E=>{let S=0;return H(E.childNodes,_=>{(O=>Q(O)&&j(O)&&O.length===0)(_)||ze(_)||S++}),S})(k);!(b.length>1)&&m.isBlock(k)||x!==0?(qt(s)||En(s)&&s.wrapper)&&(s.exact||x!==1||(k=(E=>Wt(E.childNodes,oc).filter(_=>m.getContentEditable(_)!=="false"&&Li(m,_,s)).map(_=>{const O=m.clone(_,!1);return d(O),m.replace(O,E,!0),m.remove(_,!0),O}).getOr(E))(k)),((E,S,_,O)=>{ov(S,T=>{qt(T)&&ov(E.dom.select(T.inline,O),P=>{iu(P)&&na(E,T,_,P,T.exact?P:null)}),((P,D,I)=>{if(D.clear_child_styles){const q=D.links?"*:not(a)":"*";au(P.select(q,I),W=>{iu(W)&&Go(W)&&au(D.styles,(rt,at)=>{P.setStyle(W,at,"")})})}})(E.dom,T,O)})})(t,r,n,k),((E,S,_,O,T)=>{const P=T.parentNode;_n(E,P,_,O)&&na(E,S,O,T)||S.merge_with_parents&&P&&E.dom.getParent(P,D=>!!_n(E,D,_,O)&&(na(E,S,O,T),!0))})(t,s,e,n,k),((E,S,_,O)=>{if(S.styles&&S.styles.backgroundColor){const T=q0(E,"fontSize");lu(O,P=>T(P)&&Go(P),W0(E,"backgroundColor",uo(S.styles.backgroundColor,_)))}})(m,s,n,k),((E,S,_,O)=>{const T=P=>{if(J(P)&&J(P.parentNode)&&Go(P)){const D=Ah(E,P.parentNode);E.getStyle(P,"color")&&D?E.setStyle(P,"text-decoration",D):E.getStyle(P,"text-decoration")===D&&E.setStyle(P,"text-decoration",null)}};S.styles&&(S.styles.color||S.styles.textDecoration)&&($.walk(O,T,"childNodes"),T(O))})(m,s,0,k),((E,S,_,O)=>{if(qt(S)&&(S.inline==="sub"||S.inline==="sup")){const T=q0(E,"fontSize");lu(O,D=>T(D)&&Go(D),W0(E,"fontSize",""));const P=mt(E.select(S.inline==="sup"?"sub":"sup",O),Go);E.remove(P,!0)}})(m,s,0,k),V0(t,s,0,k)):m.remove(k,!0)})},p=bi(o)?o:l.getNode();if(i.getContentEditable(p)==="false"&&!Rh(t,p))return c(r,o=p),void Vh(t,e,o,n);if(s){if(o)if(bi(o)){if(!c(r,o)){const m=i.createRng();m.setStartBefore(o),m.setEndAfter(o),g(i,Yo(i,m,r),!0)}}else g(i,o,!0);else a&&qt(s)&&!Tr(t).length?((m,h,f)=>{let b;const v=m.selection,y=m.formatter.get(h);if(!y)return;const w=v.getRng();let k=w.startOffset;const x=w.startContainer.nodeValue;b=Ko(m.getBody(),v.getStart());const E=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(x&&k>0&&k<x.length&&E.test(x.charAt(k))&&E.test(x.charAt(k-1))){const O=v.getBookmark();w.collapse(!0);let T=Yo(m.dom,w,y);T=_i(T),m.formatter.apply(h,f,T),v.moveToBookmark(O)}else{let O=b?B0(b):null;b&&(O==null?void 0:O.data)===Mr||(S=m.getDoc(),_=ou(!0).dom,b=S.importNode(_,!0),O=b.firstChild,w.insertNode(b),k=1),m.formatter.apply(h,f,b),v.setCursorLocation(O,k)}var S,_})(t,e,n):(l.setRng(Yc(l.getRng())),_h(t,()=>{nc(t,(m,h)=>{const f=h?m:Yo(i,m,r);g(i,f,!1)})},Ht),t.nodeChanged()),I0(t.formatter,e).each(m=>{H((h=>mt((f=>{const b=f.getSelectedBlocks(),v=f.getRng();if(f.isCollapsed())return[];if(b.length===1)return F0(v,b[0])&&U0(v,b[0])?b:[];{const y=xe(b).filter(x=>F0(v,x)).toArray(),w=Eo(b).filter(x=>U0(v,x)).toArray(),k=b.slice(1,-1);return y.concat(k).concat(w)}})(h),z0(h.dom)))(t.selection),h=>rv(i,h,m,n))});((m,h)=>{pt(ea,m)&&H(ea[m],f=>{f(h)})})(e,t)}Vh(t,e,o,n)},av=t=>pt(t,"vars"),iv=t=>t.selection.getStart(),lv=(t,e,n,o,r)=>tf(e,s=>{const a=t.formatter.matchNode(s,n,r!=null?r:{},o);return!fe(a)},s=>!!A0(t,s,n)||!o&&Q(t.formatter.matchNode(s,n,r,!0))),dv=(t,e)=>{const n=e!=null?e:iv(t);return mt(yi(t.dom,n),o=>J(o)&&!Lo(o))},cv=(t,e,n)=>{const o=dv(t,e);Nt(n,(r,s)=>{const a=i=>{const l=lv(t,o,s,i.similar,av(i)?i.vars:void 0),d=l.isSome();if(i.state.get()!==d){i.state.set(d);const c=l.getOr(e);av(i)?i.callback(d,{node:c,format:s,parents:o}):H(i.callbacks,u=>u(d,{node:c,format:s,parents:o}))}};H([r.withSimilar,r.withoutSimilar],a),H(r.withVars,a)})};function nr(t){return nr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nr(t)}function uu(t,e){return uu=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},uu(t,e)}function d_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function mu(t,e,n){return mu=d_()?Reflect.construct:function(o,r,s){var a=[null];a.push.apply(a,r);var i=new(Function.bind.apply(o,a));return s&&uu(i,s.prototype),i},mu.apply(null,arguments)}function ln(t){return function(e){if(Array.isArray(e))return fu(e)}(t)||function(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(t)||function(e,n){if(e){if(typeof e=="string")return fu(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);return o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set"?Array.from(e):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?fu(e,n):void 0}}(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function fu(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var c_=Object.hasOwnProperty,uv=Object.setPrototypeOf,u_=Object.isFrozen,m_=Object.getPrototypeOf,f_=Object.getOwnPropertyDescriptor,Se=Object.freeze,Nn=Object.seal,g_=Object.create,mv=typeof Reflect!="undefined"&&Reflect,Fi=mv.apply,gu=mv.construct;Fi||(Fi=function(t,e,n){return t.apply(e,n)}),Se||(Se=function(t){return t}),Nn||(Nn=function(t){return t}),gu||(gu=function(t,e){return mu(t,ln(e))});var fv,p_=dn(Array.prototype.forEach),h_=dn(Array.prototype.pop),oa=dn(Array.prototype.push),Ui=dn(String.prototype.toLowerCase),b_=dn(String.prototype.match),bo=dn(String.prototype.replace),v_=dn(String.prototype.indexOf),y_=dn(String.prototype.trim),Ee=dn(RegExp.prototype.test),pu=(fv=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return gu(fv,e)});function dn(t){return function(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return Fi(t,e,o)}}function kt(t,e){uv&&uv(t,null);for(var n=e.length;n--;){var o=e[n];if(typeof o=="string"){var r=Ui(o);r!==o&&(u_(e)||(e[n]=r),o=r)}t[o]=!0}return t}function or(t){var e,n=g_(null);for(e in t)Fi(c_,t,[e])&&(n[e]=t[e]);return n}function zi(t,e){for(;t!==null;){var n=f_(t,e);if(n){if(n.get)return dn(n.get);if(typeof n.value=="function")return dn(n.value)}t=m_(t)}return function(o){return console.warn("fallback value for",o),null}}var gv=Se(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),hu=Se(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),bu=Se(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),C_=Se(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),vu=Se(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),w_=Se(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),pv=Se(["#text"]),hv=Se(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),yu=Se(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),bv=Se(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ji=Se(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),x_=Nn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),k_=Nn(/<%[\w\W]*|[\w\W]*%>/gm),S_=Nn(/^data-[\-\w.\u00B7-\uFFFF]/),E_=Nn(/^aria-[\-\w]+$/),__=Nn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),N_=Nn(/^(?:\w+script|data):/i),R_=Nn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),A_=Nn(/^html$/i),O_=function(){return typeof window=="undefined"?null:window},T_=function(t,e){if(nr(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";e.currentScript&&e.currentScript.hasAttribute(o)&&(n=e.currentScript.getAttribute(o));var r="dompurify"+(n?"#"+n:"");try{return t.createPolicy(r,{createHTML:function(s){return s}})}catch(s){return console.warn("TrustedTypes policy "+r+" could not be created."),null}},B_=function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:O_(),n=function(B){return t(B)};if(n.version="2.3.8",n.removed=[],!e||!e.document||e.document.nodeType!==9)return n.isSupported=!1,n;var o=e.document,r=e.document,s=e.DocumentFragment,a=e.HTMLTemplateElement,i=e.Node,l=e.Element,d=e.NodeFilter,c=e.NamedNodeMap,u=c===void 0?e.NamedNodeMap||e.MozNamedAttrMap:c,g=e.HTMLFormElement,p=e.DOMParser,m=e.trustedTypes,h=l.prototype,f=zi(h,"cloneNode"),b=zi(h,"nextSibling"),v=zi(h,"childNodes"),y=zi(h,"parentNode");if(typeof a=="function"){var w=r.createElement("template");w.content&&w.content.ownerDocument&&(r=w.content.ownerDocument)}var k=T_(m,o),x=k?k.createHTML(""):"",E=r,S=E.implementation,_=E.createNodeIterator,O=E.createDocumentFragment,T=E.getElementsByTagName,P=o.importNode,D={};try{D=or(r).documentMode?r.documentMode:{}}catch(B){}var I={};n.isSupported=typeof y=="function"&&S&&S.createHTMLDocument!==void 0&&D!==9;var q,W,rt=x_,at=k_,vt=S_,St=E_,et=N_,ft=R_,ct=__,R=null,A=kt({},[].concat(ln(gv),ln(hu),ln(bu),ln(vu),ln(pv))),M=null,U=kt({},[].concat(ln(hv),ln(yu),ln(bv),ln(ji))),F=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),z=null,V=null,X=!0,nt=!0,dt=!1,ut=!1,G=!1,gt=!1,zt=!1,Bt=!1,Ce=!1,we=!1,mn=!0,Qe=!0,te=!1,_e={},Lt=null,Bn=kt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),yo=null,Tl=kt({},["audio","video","img","source","image","track"]),Dn=null,wa=kt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),De="http://www.w3.org/1998/Math/MathML",Co="http://www.w3.org/2000/svg",Pe="http://www.w3.org/1999/xhtml",dr=Pe,Gw=!1,oO=["application/xhtml+xml","text/html"],rO="text/html",Jr=null,sO=r.createElement("form"),Yw=function(B){return B instanceof RegExp||B instanceof Function},qm=function(B){Jr&&Jr===B||(B&&nr(B)==="object"||(B={}),B=or(B),R="ALLOWED_TAGS"in B?kt({},B.ALLOWED_TAGS):A,M="ALLOWED_ATTR"in B?kt({},B.ALLOWED_ATTR):U,Dn="ADD_URI_SAFE_ATTR"in B?kt(or(wa),B.ADD_URI_SAFE_ATTR):wa,yo="ADD_DATA_URI_TAGS"in B?kt(or(Tl),B.ADD_DATA_URI_TAGS):Tl,Lt="FORBID_CONTENTS"in B?kt({},B.FORBID_CONTENTS):Bn,z="FORBID_TAGS"in B?kt({},B.FORBID_TAGS):{},V="FORBID_ATTR"in B?kt({},B.FORBID_ATTR):{},_e="USE_PROFILES"in B&&B.USE_PROFILES,X=B.ALLOW_ARIA_ATTR!==!1,nt=B.ALLOW_DATA_ATTR!==!1,dt=B.ALLOW_UNKNOWN_PROTOCOLS||!1,ut=B.SAFE_FOR_TEMPLATES||!1,G=B.WHOLE_DOCUMENT||!1,Bt=B.RETURN_DOM||!1,Ce=B.RETURN_DOM_FRAGMENT||!1,we=B.RETURN_TRUSTED_TYPE||!1,zt=B.FORCE_BODY||!1,mn=B.SANITIZE_DOM!==!1,Qe=B.KEEP_CONTENT!==!1,te=B.IN_PLACE||!1,ct=B.ALLOWED_URI_REGEXP||ct,dr=B.NAMESPACE||Pe,B.CUSTOM_ELEMENT_HANDLING&&Yw(B.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(F.tagNameCheck=B.CUSTOM_ELEMENT_HANDLING.tagNameCheck),B.CUSTOM_ELEMENT_HANDLING&&Yw(B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(F.attributeNameCheck=B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),B.CUSTOM_ELEMENT_HANDLING&&typeof B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(F.allowCustomizedBuiltInElements=B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),q=q=oO.indexOf(B.PARSER_MEDIA_TYPE)===-1?rO:B.PARSER_MEDIA_TYPE,W=q==="application/xhtml+xml"?function(lt){return lt}:Ui,ut&&(nt=!1),Ce&&(Bt=!0),_e&&(R=kt({},ln(pv)),M=[],_e.html===!0&&(kt(R,gv),kt(M,hv)),_e.svg===!0&&(kt(R,hu),kt(M,yu),kt(M,ji)),_e.svgFilters===!0&&(kt(R,bu),kt(M,yu),kt(M,ji)),_e.mathMl===!0&&(kt(R,vu),kt(M,bv),kt(M,ji))),B.ADD_TAGS&&(R===A&&(R=or(R)),kt(R,B.ADD_TAGS)),B.ADD_ATTR&&(M===U&&(M=or(M)),kt(M,B.ADD_ATTR)),B.ADD_URI_SAFE_ATTR&&kt(Dn,B.ADD_URI_SAFE_ATTR),B.FORBID_CONTENTS&&(Lt===Bn&&(Lt=or(Lt)),kt(Lt,B.FORBID_CONTENTS)),Qe&&(R["#text"]=!0),G&&kt(R,["html","head","body"]),R.table&&(kt(R,["tbody"]),delete z.tbody),Se&&Se(B),Jr=B)},Xw=kt({},["mi","mo","mn","ms","mtext"]),Qw=kt({},["foreignobject","desc","title","annotation-xml"]),aO=kt({},["title","style","font","a","script"]),Bl=kt({},hu);kt(Bl,bu),kt(Bl,C_);var Wm=kt({},vu);kt(Wm,w_);var iO=function(B){var lt=y(B);lt&&lt.tagName||(lt={namespaceURI:Pe,tagName:"template"});var st=Ui(B.tagName),Pt=Ui(lt.tagName);return B.namespaceURI===Co?lt.namespaceURI===Pe?st==="svg":lt.namespaceURI===De?st==="svg"&&(Pt==="annotation-xml"||Xw[Pt]):Boolean(Bl[st]):B.namespaceURI===De?lt.namespaceURI===Pe?st==="math":lt.namespaceURI===Co?st==="math"&&Qw[Pt]:Boolean(Wm[st]):B.namespaceURI===Pe&&!(lt.namespaceURI===Co&&!Qw[Pt])&&!(lt.namespaceURI===De&&!Xw[Pt])&&!Wm[st]&&(aO[st]||!Bl[st])},Kn=function(B){oa(n.removed,{element:B});try{B.parentNode.removeChild(B)}catch(lt){try{B.outerHTML=x}catch(st){B.remove()}}},Dl=function(B,lt){try{oa(n.removed,{attribute:lt.getAttributeNode(B),from:lt})}catch(st){oa(n.removed,{attribute:null,from:lt})}if(lt.removeAttribute(B),B==="is"&&!M[B])if(Bt||Ce)try{Kn(lt)}catch(st){}else try{lt.setAttribute(B,"")}catch(st){}},Jw=function(B){var lt,st;if(zt)B="<remove></remove>"+B;else{var Pt=b_(B,/^[\r\n\t ]+/);st=Pt&&Pt[0]}q==="application/xhtml+xml"&&(B='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+B+"</body></html>");var Xt=k?k.createHTML(B):B;if(dr===Pe)try{lt=new p().parseFromString(Xt,q)}catch(ue){}if(!lt||!lt.documentElement){lt=S.createDocument(dr,"template",null);try{lt.documentElement.innerHTML=Gw?"":Xt}catch(ue){}}var Ne=lt.body||lt.documentElement;return B&&st&&Ne.insertBefore(r.createTextNode(st),Ne.childNodes[0]||null),dr===Pe?T.call(lt,G?"html":"body")[0]:G?lt.documentElement:Ne},Zw=function(B){return _.call(B.ownerDocument||B,B,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},lO=function(B){return B instanceof g&&(typeof B.nodeName!="string"||typeof B.textContent!="string"||typeof B.removeChild!="function"||!(B.attributes instanceof u)||typeof B.removeAttribute!="function"||typeof B.setAttribute!="function"||typeof B.namespaceURI!="string"||typeof B.insertBefore!="function")},xa=function(B){return nr(i)==="object"?B instanceof i:B&&nr(B)==="object"&&typeof B.nodeType=="number"&&typeof B.nodeName=="string"},Gn=function(B,lt,st){I[B]&&p_(I[B],function(Pt){Pt.call(n,lt,st,Jr)})},tx=function(B){var lt;if(Gn("beforeSanitizeElements",B,null),lO(B)||Ee(/[\u0080-\uFFFF]/,B.nodeName))return Kn(B),!0;var st=W(B.nodeName);if(Gn("uponSanitizeElement",B,{tagName:st,allowedTags:R}),B.hasChildNodes()&&!xa(B.firstElementChild)&&(!xa(B.content)||!xa(B.content.firstElementChild))&&Ee(/<[/\w]/g,B.innerHTML)&&Ee(/<[/\w]/g,B.textContent)||st==="select"&&Ee(/<template/i,B.innerHTML))return Kn(B),!0;if(!R[st]||z[st]){if(!z[st]&&nx(st)&&(F.tagNameCheck instanceof RegExp&&Ee(F.tagNameCheck,st)||F.tagNameCheck instanceof Function&&F.tagNameCheck(st)))return!1;if(Qe&&!Lt[st]){var Pt=y(B)||B.parentNode,Xt=v(B)||B.childNodes;if(Xt&&Pt)for(var Ne=Xt.length-1;Ne>=0;--Ne)Pt.insertBefore(f(Xt[Ne],!0),b(B))}return Kn(B),!0}return B instanceof l&&!iO(B)?(Kn(B),!0):st!=="noscript"&&st!=="noembed"||!Ee(/<\/no(script|embed)/i,B.innerHTML)?(ut&&B.nodeType===3&&(lt=B.textContent,lt=bo(lt,rt," "),lt=bo(lt,at," "),B.textContent!==lt&&(oa(n.removed,{element:B.cloneNode()}),B.textContent=lt)),Gn("afterSanitizeElements",B,null),!1):(Kn(B),!0)},ex=function(B,lt,st){if(mn&&(lt==="id"||lt==="name")&&(st in r||st in sO))return!1;if(!(nt&&!V[lt]&&Ee(vt,lt))){if(!(X&&Ee(St,lt))){if(!M[lt]||V[lt]){if(!(nx(B)&&(F.tagNameCheck instanceof RegExp&&Ee(F.tagNameCheck,B)||F.tagNameCheck instanceof Function&&F.tagNameCheck(B))&&(F.attributeNameCheck instanceof RegExp&&Ee(F.attributeNameCheck,lt)||F.attributeNameCheck instanceof Function&&F.attributeNameCheck(lt))||lt==="is"&&F.allowCustomizedBuiltInElements&&(F.tagNameCheck instanceof RegExp&&Ee(F.tagNameCheck,st)||F.tagNameCheck instanceof Function&&F.tagNameCheck(st))))return!1}else if(!Dn[lt]){if(!Ee(ct,bo(st,ft,""))){if((lt!=="src"&&lt!=="xlink:href"&&lt!=="href"||B==="script"||v_(st,"data:")!==0||!yo[B])&&!(dt&&!Ee(et,bo(st,ft,"")))){if(st)return!1}}}}}return!0},nx=function(B){return B.indexOf("-")>0},ox=function(B){var lt,st,Pt,Xt;Gn("beforeSanitizeAttributes",B,null);var Ne=B.attributes;if(Ne){var ue={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:M};for(Xt=Ne.length;Xt--;){var ka=lt=Ne[Xt],Pn=ka.name,fn=ka.namespaceURI;st=Pn==="value"?lt.value:y_(lt.value),Pt=W(Pn);var cO=st;if(ue.attrName=Pt,ue.attrValue=st,ue.keepAttr=!0,ue.forceKeepAttr=void 0,Gn("uponSanitizeAttribute",B,ue),st=ue.attrValue,!ue.forceKeepAttr)if(ue.keepAttr)if(Ee(/\/>/i,st))Dl(Pn,B);else{ut&&(st=bo(st,rt," "),st=bo(st,at," "));var uO=W(B.nodeName);if(ex(uO,Pt,st)){if(st!==cO)try{fn?B.setAttributeNS(fn,Pn,st):B.setAttribute(Pn,st)}catch(gO){Dl(Pn,B)}}else Dl(Pn,B)}else Dl(Pn,B)}Gn("afterSanitizeAttributes",B,null)}},dO=function B(lt){var st,Pt=Zw(lt);for(Gn("beforeSanitizeShadowDOM",lt,null);st=Pt.nextNode();)Gn("uponSanitizeShadowNode",st,null),tx(st)||(st.content instanceof s&&B(st.content),ox(st));Gn("afterSanitizeShadowDOM",lt,null)};return n.sanitize=function(B,lt){var st,Pt,Xt,Ne,ue;if((Gw=!B)&&(B="<!-->"),typeof B!="string"&&!xa(B)){if(typeof B.toString!="function")throw pu("toString is not a function");if(typeof(B=B.toString())!="string")throw pu("dirty is not a string, aborting")}if(!n.isSupported){if(nr(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof B=="string")return e.toStaticHTML(B);if(xa(B))return e.toStaticHTML(B.outerHTML)}return B}if(gt||qm(lt),n.removed=[],typeof B=="string"&&(te=!1),te){if(B.nodeName){var ka=W(B.nodeName);if(!R[ka]||z[ka])throw pu("root node is forbidden and cannot be sanitized in-place")}}else if(B instanceof i)(Pt=(st=Jw("<!---->")).ownerDocument.importNode(B,!0)).nodeType===1&&Pt.nodeName==="BODY"||Pt.nodeName==="HTML"?st=Pt:st.appendChild(Pt);else{if(!Bt&&!ut&&!G&&B.indexOf("<")===-1)return k&&we?k.createHTML(B):B;if(!(st=Jw(B)))return Bt?null:we?x:""}st&&zt&&Kn(st.firstChild);for(var Pn=Zw(te?B:st);Xt=Pn.nextNode();)Xt.nodeType===3&&Xt===Ne||tx(Xt)||(Xt.content instanceof s&&dO(Xt.content),ox(Xt),Ne=Xt);if(Ne=null,te)return B;if(Bt){if(Ce)for(ue=O.call(st.ownerDocument);st.firstChild;)ue.appendChild(st.firstChild);else ue=st;return M.shadowroot&&(ue=P.call(o,ue,!0)),ue}var fn=G?st.outerHTML:st.innerHTML;return G&&R["!doctype"]&&st.ownerDocument&&st.ownerDocument.doctype&&st.ownerDocument.doctype.name&&Ee(A_,st.ownerDocument.doctype.name)&&(fn="<!DOCTYPE "+st.ownerDocument.doctype.name+`>
`+fn),ut&&(fn=bo(fn,rt," "),fn=bo(fn,at," ")),k&&we?k.createHTML(fn):fn},n.setConfig=function(B){qm(B),gt=!0},n.clearConfig=function(){Jr=null,gt=!1},n.isValidAttribute=function(B,lt,st){Jr||qm({});var Pt=W(B),Xt=W(lt);return ex(Pt,Xt,st)},n.addHook=function(B,lt){typeof lt=="function"&&(I[B]=I[B]||[],oa(I[B],lt))},n.removeHook=function(B){if(I[B])return h_(I[B])},n.removeHooks=function(B){I[B]&&(I[B]=[])},n.removeAllHooks=function(){I={}},n}();const vv=$.explode,yv=()=>{const t={};return{addFilter:(e,n)=>{H(vv(e),o=>{pt(t,o)||(t[o]={name:o,callbacks:[]}),t[o].callbacks.push(n)})},getFilters:()=>$l(t),removeFilter:(e,n)=>{H(vv(e),o=>{if(pt(t,o))if(Q(n)){const r=t[o],s=mt(r.callbacks,a=>a!==n);s.length>0?r.callbacks=s:delete t[o]}else delete t[o]})}}},D_=(t,e,n)=>{var o;const r=xd();e.convert_fonts_to_spans&&((s,a,i)=>{s.addNodeFilter("font",l=>{H(l,d=>{const c=a.parse(d.attr("style")),u=d.attr("color"),g=d.attr("face"),p=d.attr("size");u&&(c.color=u),g&&(c["font-family"]=g),p&&Ta(p).each(m=>{c["font-size"]=i[m-1]}),d.name="span",d.attr("style",a.serialize(c)),((m,h)=>{H(["color","face","size"],f=>{m.attr(f,null)})})(d)})})})(t,r,$.explode((o=e.font_size_legacy_values)!==null&&o!==void 0?o:"")),((s,a,i)=>{s.addNodeFilter("strike",l=>{const d=a.type!=="html4";H(l,c=>{if(d)c.name="s";else{const u=i.parse(c.attr("style"));u["text-decoration"]="line-through",c.name="span",c.attr("style",i.serialize(u))}})})})(t,n,r)},Cu=t=>{const[e,...n]=t.split(","),o=n.join(","),r=/data:([^/]+\/[^;]+)(;.+)?/.exec(e);if(r){const s=r[2]===";base64",a=s?(i=>{const l=/([a-z0-9+\/=\s]+)/i.exec(i);return l?l[1]:""})(o):decodeURIComponent(o);return C.some({type:r[1],data:a,base64Encoded:s})}return C.none()},Cv=(t,e,n=!0)=>{let o=e;if(n)try{o=atob(e)}catch(s){return C.none()}const r=new Uint8Array(o.length);for(let s=0;s<r.length;s++)r[s]=o.charCodeAt(s);return C.some(new Blob([r],{type:t}))},wv=t=>new Promise((e,n)=>{const o=new FileReader;o.onloadend=()=>{e(o.result)},o.onerror=()=>{var r;n((r=o.error)===null||r===void 0?void 0:r.message)},o.readAsDataURL(t)});let P_=0;const xv=(t,e,n)=>Cu(t).bind(({data:o,type:r,base64Encoded:s})=>{if(e&&!s)return C.none();{const a=s?o:btoa(o);return n(a,r)}}),kv=(t,e,n)=>{const o=t.create("blobid"+P_++,e,n);return t.add(o),o},Sv=(t,e,n=!1)=>xv(e,n,(o,r)=>C.from(t.getByData(o,r)).orThunk(()=>Cv(r,o).map(s=>kv(t,s,o)))),Ev=$.each,L_=$.trim,M_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],I_={ftp:21,http:80,https:443,mailto:25},F_=["img","video"],_v=(t,e,n)=>{const o=(r=>{try{return decodeURIComponent(r)}catch(s){return unescape(r)}})(e);return!t.allow_script_urls&&(!!/((java|vb)script|mhtml):/i.test(o)||!t.allow_html_data_urls&&(/^data:image\//i.test(o)?((r,s)=>Q(r)?!r:!Q(s)||!_t(F_,s))(t.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(o):/^data:/i.test(o)))};class cn{constructor(e,n={}){this.path="",this.directory="",e=L_(e),this.settings=n;const o=n.base_uri,r=this;if(/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e))return void(r.source=e);const s=e.indexOf("//")===0;if(e.indexOf("/")!==0||s||(e=(o&&o.protocol||"http")+"://mce_host"+e),!/^[\w\-]*:?\/\//.test(e)){const i=o?o.path:new cn(document.location.href).directory;if((o==null?void 0:o.protocol)==="")e="//mce_host"+r.toAbsPath(i,e);else{const l=/([^#?]*)([#?]?.*)/.exec(e);l&&(e=(o&&o.protocol||"http")+"://mce_host"+r.toAbsPath(i,l[1])+l[2])}}e=e.replace(/@@/g,"(mce_at)");const a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e);a&&Ev(M_,(i,l)=>{let d=a[l];d&&(d=d.replace(/\(mce_at\)/g,"@@")),r[i]=d}),o&&(r.protocol||(r.protocol=o.protocol),r.userInfo||(r.userInfo=o.userInfo),r.port||r.host!=="mce_host"||(r.port=o.port),r.host&&r.host!=="mce_host"||(r.host=o.host),r.source=""),s&&(r.protocol="")}static parseDataUri(e){let n;const o=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(o[0]);return r&&(n=r[1]),{type:n,data:o[1]}}static isDomSafe(e,n,o={}){if(o.allow_script_urls)return!0;{const r=ro.decode(e).replace(/[\s\u0000-\u001F]+/g,"");return!_v(o,r,n)}}static getDocumentBaseUrl(e){var n;let o;return o=e.protocol.indexOf("http")!==0&&e.protocol!=="file:"?(n=e.href)!==null&&n!==void 0?n:"":e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(o)&&(o=o.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(o)||(o+="/")),o}setPath(e){const n=/^(.*?)\/?(\w+)?$/.exec(e);n&&(this.path=n[0],this.directory=n[1],this.file=n[2]),this.source="",this.getURI()}toRelative(e){if(e==="./")return e;const n=new cn(e,{base_uri:this});if(n.host!=="mce_host"&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&n.protocol!=="")return n.getURI();const o=this.getURI(),r=n.getURI();if(o===r||o.charAt(o.length-1)==="/"&&o.substr(0,o.length-1)===r)return o;let s=this.toRelPath(this.path,n.path);return n.query&&(s+="?"+n.query),n.anchor&&(s+="#"+n.anchor),s}toAbsolute(e,n){const o=new cn(e,{base_uri:this});return o.getURI(n&&this.isSameOrigin(o))}isSameOrigin(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;const n=this.protocol?I_[this.protocol]:null;if(n&&(this.port||n)==(e.port||n))return!0}return!1}toRelPath(e,n){let o,r,s=0,a="";const i=e.substring(0,e.lastIndexOf("/")).split("/"),l=n.split("/");if(i.length>=l.length){for(o=0,r=i.length;o<r;o++)if(o>=l.length||i[o]!==l[o]){s=o+1;break}}if(i.length<l.length){for(o=0,r=l.length;o<r;o++)if(o>=i.length||i[o]!==l[o]){s=o+1;break}}if(s===1)return n;for(o=0,r=i.length-(s-1);o<r;o++)a+="../";for(o=s-1,r=l.length;o<r;o++)a+=o!==s-1?"/"+l[o]:l[o];return a}toAbsPath(e,n){let o=0;const r=/\/$/.test(n)?"/":"",s=e.split("/"),a=n.split("/"),i=[];Ev(s,u=>{u&&i.push(u)});const l=[];for(let u=a.length-1;u>=0;u--)a[u].length!==0&&a[u]!=="."&&(a[u]!==".."?o>0?o--:l.push(a[u]):o++);const d=i.length-o;let c;return c=d<=0?os(l).join("/"):i.slice(0,d).join("/")+"/"+os(l).join("/"),c.indexOf("/")!==0&&(c="/"+c),r&&c.lastIndexOf("/")!==c.length-1&&(c+=r),c}getURI(e=!1){let n;return this.source&&!e||(n="",e||(this.protocol?n+=this.protocol+"://":n+="//",this.userInfo&&(n+=this.userInfo+"@"),this.host&&(n+=this.host),this.port&&(n+=":"+this.port)),this.path&&(n+=this.path),this.query&&(n+="?"+this.query),this.anchor&&(n+="#"+this.anchor),this.source=n),this.source}}const Nv=$.makeMap,Rv=$.extend,U_={IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]},z_=$.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),wu="data-mce-type",j_=(t,e)=>{const n=B_(),o=e.getSpecialElements(),r=t.validate;let s=0;return n.addHook("uponSanitizeElement",(a,i)=>{var l,d,c;a.nodeType===8&&!t.allow_conditional_comments&&/^\[if/i.test((l=a.nodeValue)!==null&&l!==void 0?l:"")&&(a.nodeValue=" "+a.nodeValue);const u=i.tagName;if(a.nodeType!==1||u==="body")return;const g=N(a),p=u.toLowerCase(),m=Da(g,wu),h=Ge(g,"data-mce-bogus");if(!m&&it(h))return void(h==="all"?Tt(g):Zn(g));const f=e.getElementRule(p);if(!r||f){if(i.allowedTags[u]=!0,r&&f&&!m){if(H((d=f.attributesForced)!==null&&d!==void 0?d:[],b=>{Qt(g,b.name,b.value==="{$uid}"?"mce_"+s++:b.value)}),H((c=f.attributesDefault)!==null&&c!==void 0?c:[],b=>{Da(g,b.name)||Qt(g,b.name,b.value==="{$uid}"?"mce_"+s++:b.value)}),f.attributesRequired&&!It(f.attributesRequired,b=>Da(g,b))||f.removeEmptyAttrs&&(b=>{const v=b.dom.attributes;return v==null||v.length===0})(g))return void Zn(g);f.outputName&&f.outputName!==p&&((b,v)=>{const y=((k,x)=>{const E=Jt(x),S=Tf(k);return Xn(E,S),E})(b,v);Jn(b,y);const w=oe(b);To(y,w),Tt(b)})(g,f.outputName)}}else pt(o,p)?Tt(g):Zn(g)}),n.addHook("uponSanitizeAttribute",(a,i)=>{const l=a.tagName.toLowerCase(),{attrName:d,attrValue:c}=i;i.keepAttr=!r||e.isValid(l,d)||ee(d,"data-")||ee(d,"aria-"),d in z_&&_v(t,c,l)&&(i.keepAttr=!1),i.keepAttr?(i.allowedAttributes[d]=!0,d in e.getBoolAttrs()&&(i.attrValue=d),t.allow_svg_data_urls&&ee(c,"data:image/svg+xml")&&(i.forceKeepAttr=!0)):!a.hasAttribute(wu)||d!=="id"&&d!=="class"&&d!=="style"||(i.forceKeepAttr=!0)}),n},Av=(t,e,n)=>{const o=t.name,r=o in n&&o!=="title"&&o!=="textarea",s=e.childNodes;for(let a=0,i=s.length;a<i;a++){const l=s[a],d=new ve(l.nodeName.toLowerCase(),l.nodeType);if(J(l)){const c=l.attributes;for(let u=0,g=c.length;u<g;u++){const p=c[u];d.attr(p.name,p.value)}}else j(l)?(d.value=l.data,r&&(d.raw=!0)):(eo(l)||Bx(l)||Dx(l))&&(d.value=l.data);Av(d,l,n),t.append(d)}},Ir=(t={},e=so())=>{const n=yv(),o=yv(),r=K({validate:!0,root_name:"body"},t),s=new DOMParser,a=j_(r,e),i=n.addFilter,l=n.getFilters,d=n.removeFilter,c=o.addFilter,u=o.getFilters,g=o.removeFilter,p=(h,f)=>{const b=it(f.attr(wu)),v=f.type===1&&!pt(h,f.name)&&!((y,w)=>w.type===1&&Ya(y,w.name)&&it(w.attr(xs)))(e,f);return f.type===3||v&&!b},m={schema:e,addAttributeFilter:c,getAttributeFilters:u,removeAttributeFilter:g,addNodeFilter:i,getNodeFilters:l,removeNodeFilter:d,parse:(h,f={})=>{var b;const v=r.validate,y=(b=f.context)!==null&&b!==void 0?b:r.root_name,w=((D,I,q="html")=>{const W=q==="xhtml"?"application/xhtml+xml":"text/html",rt=pt(e.getSpecialElements(),I.toLowerCase()),at=rt?`<${I}>${D}</${I}>`:D,vt=q==="xhtml"?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${at}</body></html>`:`<body>${at}</body>`,St=s.parseFromString(vt,W).body;return a.sanitize(St,((et,ft)=>{const ct=K({},U_);return ct.PARSER_MEDIA_TYPE=ft,et.allow_script_urls?ct.ALLOWED_URI_REGEXP=/.*/:et.allow_html_data_urls&&(ct.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),ct})(r,W)),a.removed=[],rt?St.firstChild:St})(h,y,f.format);hd(e,w);const k=new ve(y,11);Av(k,w,e.getSpecialElements()),w.innerHTML="";const[x,E]=((D,I,q,W)=>{const rt=q.validate,at=I.getNonEmptyElements(),vt=I.getWhitespaceElements(),St=Rv(Nv("script,style,head,html,body,title,meta,param"),I.getBlockElements()),et=jg(I),ft=/[ \t\r\n]+/g,ct=/^[ \t\r\n]+/,R=/[ \t\r\n]+$/,A=F=>{let z=F.parent;for(;Q(z);){if(z.name in vt)return!0;z=z.parent}return!1},M=F=>F.name in St&&!Ag(I,F),U=(F,z)=>{const V=z?F.prev:F.next;return!Q(V)&&!jt(F.parent)&&M(F.parent)&&(F.parent!==D||W.isRootContent===!0)};return[F=>{var z;if(F.type===3&&!A(F)){let V=(z=F.value)!==null&&z!==void 0?z:"";V=V.replace(ft," "),(((X,nt)=>Q(X)&&(nt(X)||X.name==="br"))(F.prev,M)||U(F,!0))&&(V=V.replace(ct,"")),V.length===0?F.remove():F.value=V}},F=>{var z;if(F.type===1){const V=I.getElementRule(F.name);if(rt&&V){const X=ta(I,at,vt,F);V.paddInEmptyBlock&&X&&(nt=>{let dt=nt;for(;Q(dt);){if(dt.name in et)return ta(I,at,vt,dt);dt=dt.parent}return!1})(F)?Wc(W,M,F):V.removeEmpty&&X?M(F)?F.remove():F.unwrap():V.paddEmpty&&(X||(nt=>{var dt;return E0(nt,"#text")&&((dt=nt==null?void 0:nt.firstChild)===null||dt===void 0?void 0:dt.value)===Zt})(F))&&Wc(W,M,F)}}else if(F.type===3&&!A(F)){let V=(z=F.value)!==null&&z!==void 0?z:"";(F.next&&M(F.next)||U(F,!1))&&(V=V.replace(R,"")),V.length===0?F.remove():F.value=V}}]})(k,e,r,f),S=[],_=v?D=>((I,q)=>{_0(e,I)&&q.push(I)})(D,S):bt,O={nodes:{},attributes:{}},T=D=>x0(l(),u(),D,O);if(((D,I,q)=>{const W=[];for(let rt=D,at=rt;rt;at=rt,rt=rt.walk()){const vt=rt;H(I,St=>St(vt)),jt(vt.parent)&&vt!==D?rt=at:W.push(vt)}for(let rt=W.length-1;rt>=0;rt--){const at=W[rt];H(q,vt=>vt(at))}})(k,[x,T],[E,_]),S.reverse(),v&&S.length>0)if(f.context){const{pass:D,fail:I}=es(S,q=>q.parent===k);Gc(I,e,T),f.invalid=D.length>0}else Gc(S,e,T);const P=((D,I)=>{var q;const W=(q=I.forced_root_block)!==null&&q!==void 0?q:D.forced_root_block;return W===!1?"":W===!0?"p":W})(r,f);return P&&(k.name==="body"||f.isRootContent)&&((D,I)=>{const q=Rv(Nv("script,style,head,html,body,title,meta,param"),e.getBlockElements()),W=/^[ \t\r\n]+/,rt=/[ \t\r\n]+$/;let at=D.firstChild,vt=null;const St=et=>{var ft,ct;et&&(at=et.firstChild,at&&at.type===3&&(at.value=(ft=at.value)===null||ft===void 0?void 0:ft.replace(W,"")),at=et.lastChild,at&&at.type===3&&(at.value=(ct=at.value)===null||ct===void 0?void 0:ct.replace(rt,"")))};if(e.isValidChild(D.name,I.toLowerCase())){for(;at;){const et=at.next;p(q,at)?(vt||(vt=new ve(I,1),vt.attr(r.forced_root_block_attrs),D.insert(vt,at)),vt.append(at)):(St(vt),vt=null),at=et}St(vt)}})(k,P),f.invalid||k0(O,f),k}};return((h,f)=>{const b=h.schema;f.remove_trailing_brs&&h.addNodeFilter("br",(y,w,k)=>{const x=$.extend({},b.getBlockElements()),E=b.getNonEmptyElements(),S=b.getWhitespaceElements();x.body=1;const _=O=>O.name in x&&Ag(b,O);for(let O=0,T=y.length;O<T;O++){let P=y[O],D=P.parent;if(D&&x[D.name]&&P===D.lastChild){let I=P.prev;for(;I;){const q=I.name;if(q!=="span"||I.attr("data-mce-type")!=="bookmark"){q==="br"&&(P=null);break}I=I.prev}if(P&&(P.remove(),ta(b,E,S,D))){const q=b.getElementRule(D.name);q&&(q.removeEmpty?D.remove():q.paddEmpty&&Wc(k,_,D))}}else{let I=P;for(;D&&D.firstChild===I&&D.lastChild===I&&(I=D,!x[D.name]);)D=D.parent;if(I===D){const q=new ve("#text",3);q.value=Zt,P.replace(q)}}}}),h.addAttributeFilter("href",y=>{let w=y.length;const k=x=>{const E=x?$.trim(x):"";return/\b(noopener)\b/g.test(E)?E:(S=>S.split(" ").filter(_=>_.length>0).concat(["noopener"]).sort().join(" "))(E)};if(!f.allow_unsafe_link_target)for(;w--;){const x=y[w];x.name==="a"&&x.attr("target")==="_blank"&&x.attr("rel",k(x.attr("rel")))}}),f.allow_html_in_named_anchor||h.addAttributeFilter("id,name",y=>{let w,k,x,E,S=y.length;for(;S--;)if(E=y[S],E.name==="a"&&E.firstChild&&!E.attr("href"))for(x=E.parent,w=E.lastChild;w&&x;)k=w.prev,x.insert(w,E),w=k}),f.fix_list_elements&&h.addNodeFilter("ul,ol",y=>{let w,k,x=y.length;for(;x--;)if(w=y[x],k=w.parent,k&&(k.name==="ul"||k.name==="ol"))if(w.prev&&w.prev.name==="li")w.prev.append(w);else{const E=new ve("li",1);E.attr("style","list-style-type: none"),w.wrap(E)}});const v=b.getValidClasses();f.validate&&v&&h.addAttributeFilter("class",y=>{var w;let k=y.length;for(;k--;){const x=y[k],E=(w=x.attr("class"))!==null&&w!==void 0?w:"",S=$.explode(E," ");let _="";for(let O=0;O<S.length;O++){const T=S[O];let P=!1,D=v["*"];D&&D[T]&&(P=!0),D=v[x.name],!P&&D&&D[T]&&(P=!0),P&&(_&&(_+=" "),_+=T)}_.length||(_=null),x.attr("class",_)}}),((y,w)=>{const{blob_cache:k}=w;if(k){const x=E=>{const S=E.attr("src");(_=>_.attr("src")===Ct.transparentSrc||Q(_.attr("data-mce-placeholder")))(E)||(_=>Q(_.attr("data-mce-bogus")))(E)||jt(S)||Sv(k,S,!0).each(_=>{E.attr("src",_.blobUri())})};y.addAttributeFilter("src",E=>H(E,x))}})(h,f)})(m,r),((h,f,b)=>{f.inline_styles&&D_(h,f,b)})(m,r,e),m},Ov=(t,e)=>{const n=(r=>Pi(r)?mo({validate:!1}).serialize(r):r)(t),o=e(n);if(o.isDefaultPrevented())return o;if(Pi(t)){if(o.content!==n){const r=Ir({validate:!1,forced_root_block:!1}).parse(o.content,{context:t.name});return K(K({},o),{content:r})}return K(K({},o),{content:t})}return o},Tv=(t,e)=>{if(e.no_events)return he.value(e);{const n=((o,r)=>o.dispatch("BeforeGetContent",r))(t,e);return n.isDefaultPrevented()?he.error(Kh(t,K({content:""},n)).content):he.value(n)}},Bv=(t,e,n)=>n.no_events?e:Ov(e,o=>Kh(t,K(K({},n),{content:o}))).content,xu=(t,e)=>{if(e.no_events)return he.value(e);{const n=Ov(e.content,o=>((r,s)=>r.dispatch("BeforeSetContent",s))(t,K(K({},e),{content:o})));return n.isDefaultPrevented()?(Wh(t,n),he.error(void 0)):he.value(n)}},ku=(t,e,n)=>{n.no_events||Wh(t,K(K({},n),{content:e}))},Su=(t,e,n)=>({element:t,width:e,rows:n}),Dv=(t,e)=>({element:t,cells:e}),H_=(t,e)=>({x:t,y:e}),Pv=(t,e)=>In(t,e).bind(Ta).getOr(1),$_=(t,e,n)=>{const o=t.rows;return!!(o[n]?o[n].cells:[])[e]},Lv=t=>Re(t,(e,n)=>n.cells.length>e?n.cells.length:e,0),Mv=(t,e)=>{const n=t.rows;for(let o=0;o<n.length;o++){const r=n[o].cells;for(let s=0;s<r.length;s++)if(xt(r[s],e))return C.some(H_(s,o))}return C.none()},Iv=(t,e,n,o,r)=>{const s=[],a=t.rows;for(let i=n;i<=r;i++){const l=a[i].cells,d=e<o?l.slice(e,o+1):l.slice(o,e+1);s.push(Dv(a[i].element,d))}return s},V_=t=>((e,n)=>{const o=Sr(e.element),r=Jt("tbody");return To(r,n),Kt(o,r),o})(t,(e=>yt(e.rows,n=>{const o=yt(n.cells,s=>{const a=ep(s);return ne(a,"colspan"),ne(a,"rowspan"),a}),r=Sr(n.element);return To(r,o),r}))(t)),q_=(t,e)=>{const n=N(e.commonAncestorContainer),o=Vn(n,t),r=mt(o,Fx),s=((i,l)=>Wt(i,d=>Ot(d)==="li"&&tc(d,l)).fold(Y([]),d=>(c=>Wt(c,u=>Ot(u)==="ul"||Ot(u)==="ol"))(i).map(c=>{const u=Jt(Ot(c)),g=rs(Xf(c),(p,m)=>ee(m,"list-style"));return Ia(u,g),[Jt("li"),u]}).getOr([])))(o,e),a=r.concat(s.length?s:(i=>Cs(i)?tn(i).filter(dd).fold(Y([]),l=>[i,l]):dd(i)?[i]:[])(n));return yt(a,Sr)},Fv=()=>fc([]),W_=(t,e)=>((n,o)=>hs(o,"table",tt(xt,n)))(t,e[0]).bind(n=>{const o=e[0],r=e[e.length-1],s=(a=>{const i=Su(Sr(a),0,[]);return H(le(a,"tr"),(l,d)=>{H(le(l,"td,th"),(c,u)=>{((g,p,m,h,f)=>{const b=Pv(f,"rowspan"),v=Pv(f,"colspan"),y=g.rows;for(let w=m;w<m+b;w++){y[w]||(y[w]=Dv(ep(h),[]));for(let k=p;k<p+v;k++)y[w].cells[k]=w===m&&k===p?f:Sr(f)}})(i,((g,p,m)=>{for(;$_(g,p,m);)p++;return p})(i,u,d),d,l,c)})}),Su(i.element,Lv(i.rows),i.rows)})(n);return((a,i,l)=>Mv(a,i).bind(d=>Mv(a,l).map(c=>((u,g,p)=>{const m=g.x,h=g.y,f=p.x,b=p.y,v=h<b?Iv(u,m,h,f,b):Iv(u,m,b,f,h);return Su(u.element,Lv(v),v)})(a,d,c))))(s,o,r).map(a=>fc([V_(a)]))}).getOrThunk(Fv),K_=(t,e)=>{const n=kh(e,t);return n.length>0?W_(t,n):((o,r)=>r.length>0&&r[0].collapsed?Fv():((s,a)=>((i,l)=>{const d=Re(l,(c,u)=>(Kt(u,c),u),i);return l.length>0?fc([d]):d})(N(a.cloneContents()),q_(s,a)))(o,r[0]))(t,e)},Hi=(t,e)=>e>=0&&e<t.length&&Or(t.charAt(e)),Uv=t=>jn(t.innerText),zv=t=>J(t)?t.outerHTML:j(t)?ro.encodeRaw(t.data,!1):eo(t)?"<!--"+t.data+"-->":"",G_=(t,e)=>(((n,o)=>{let r=0;H(n,s=>{s[0]===0?r++:s[0]===1?(((a,i,l)=>{const d=(c=>{let u;const g=document.createElement("div"),p=document.createDocumentFragment();for(c&&(g.innerHTML=c);u=g.firstChild;)p.appendChild(u);return p})(i);if(a.hasChildNodes()&&l<a.childNodes.length){const c=a.childNodes[l];a.insertBefore(d,c)}else a.appendChild(d)})(o,s[1],r),r++):s[0]===2&&((a,i)=>{if(a.hasChildNodes()&&i<a.childNodes.length){const l=a.childNodes[i];a.removeChild(l)}})(o,r)})})(((n,o)=>{const r=n.length+o.length+2,s=new Array(r),a=new Array(r),i=(u,g,p,m,h)=>{const f=d(u,g,p,m);if(f===null||f.start===g&&f.diag===g-m||f.end===u&&f.diag===u-p){let b=u,v=p;for(;b<g||v<m;)b<g&&v<m&&n[b]===o[v]?(h.push([0,n[b]]),++b,++v):g-u>m-p?(h.push([2,n[b]]),++b):(h.push([1,o[v]]),++v)}else{i(u,f.start,p,f.start-f.diag,h);for(let b=f.start;b<f.end;++b)h.push([0,n[b]]);i(f.end,g,f.end-f.diag,m,h)}},l=(u,g,p,m)=>{let h=u;for(;h-g<m&&h<p&&n[h]===o[h-g];)++h;return((f,b,v)=>({start:f,end:b,diag:v}))(u,h,g)},d=(u,g,p,m)=>{const h=g-u,f=m-p;if(h===0||f===0)return null;const b=h-f,v=f+h,y=(v%2==0?v:v+1)/2;let w,k,x,E,S;for(s[1+y]=u,a[1+y]=g+1,w=0;w<=y;++w){for(k=-w;k<=w;k+=2){for(x=k+y,k===-w||k!==w&&s[x-1]<s[x+1]?s[x]=s[x+1]:s[x]=s[x-1]+1,E=s[x],S=E-u+p-k;E<g&&S<m&&n[E]===o[S];)s[x]=++E,++S;if(b%2!=0&&b-w<=k&&k<=b+w&&a[x-b]<=s[x])return l(a[x-b],k+u-p,g,m)}for(k=b-w;k<=b+w;k+=2){for(x=k+y-b,k===b-w||k!==b+w&&a[x+1]<=a[x-1]?a[x]=a[x+1]-1:a[x]=a[x-1],E=a[x]-1,S=E-u+p-k;E>=u&&S>=p&&n[E]===o[S];)a[x]=E--,S--;if(b%2==0&&-w<=k&&k<=w&&a[x]<=s[x+b])return l(a[x],k+u-p,g,m)}}return null},c=[];return i(0,n.length,0,o.length,c),c})(yt(Ae(e.childNodes),zv),t),e),e),Y_=No(()=>document.implementation.createHTMLDocument("undo")),$i=t=>{const e=(n=t.getBody(),mt(yt(Ae(n.childNodes),zv),s=>s.length>0));var n;const o=Ln(e,s=>{const a=Ob(t.serializer,s);return a.length>0?[a]:[]}),r=o.join("");return(s=>s.indexOf("</iframe>")!==-1)(r)?(s=>({type:"fragmented",fragments:s,content:"",bookmark:null,beforeBookmark:null}))(o):(s=>({type:"complete",fragments:null,content:s,bookmark:null,beforeBookmark:null}))(r)},Eu=(t,e,n)=>{const o=n?e.beforeBookmark:e.bookmark;e.type==="fragmented"?G_(e.fragments,t.getBody()):t.setContent(e.content,{format:"raw",no_selection:!Q(o)||!hh(o)||!o.isFakeCaret}),o&&(t.selection.moveToBookmark(o),t.selection.scrollIntoView())},_u=t=>t.type==="fragmented"?t.fragments.join(""):t.content,jv=t=>{const e=Jt("body",Y_());return Ua(e,_u(t)),H(le(e,"*[data-mce-bogus]"),Zn),tg(e)},Nu=(t,e)=>!(!t||!e)&&(!!((n,o)=>_u(n)===_u(o))(t,e)||((n,o)=>jv(n)===jv(o))(t,e)),Ru=t=>t.get()===0,Vi=(t,e,n)=>{Ru(n)&&(t.typing=e)},Hv=(t,e)=>{t.typing&&(Vi(t,!1,e),t.add())},$v=t=>({init:{bindEvents:bt},undoManager:{beforeChange:(e,n)=>((o,r,s)=>{Ru(r)&&s.set(Md(o.selection))})(t,e,n),add:(e,n,o,r,s,a)=>((i,l,d,c,u,g,p)=>{const m=$i(i),h=$.extend(g||{},m);if(!Ru(c)||i.removed)return null;const f=l.data[d.get()];if(i.dispatch("BeforeAddUndo",{level:h,lastLevel:f,originalEvent:p}).isDefaultPrevented()||f&&Nu(f,h))return null;l.data[d.get()]&&u.get().each(y=>{l.data[d.get()].beforeBookmark=y});const b=aS(i);if(b&&l.data.length>b){for(let y=0;y<l.data.length-1;y++)l.data[y]=l.data[y+1];l.data.length--,d.set(l.data.length)}h.bookmark=Md(i.selection),d.get()<l.data.length-1&&(l.data.length=d.get()+1),l.data.push(h),d.set(l.data.length-1);const v={level:h,lastLevel:f,originalEvent:p};return d.get()>0?(i.setDirty(!0),i.dispatch("AddUndo",v),i.dispatch("change",v)):i.dispatch("AddUndo",v),h})(t,e,n,o,r,s,a),undo:(e,n,o)=>((r,s,a,i)=>{let l;return s.typing&&(s.add(),s.typing=!1,Vi(s,!1,a)),i.get()>0&&(i.set(i.get()-1),l=s.data[i.get()],Eu(r,l,!0),r.setDirty(!0),r.dispatch("Undo",{level:l})),l})(t,e,n,o),redo:(e,n)=>((o,r,s)=>{let a;return r.get()<s.length-1&&(r.set(r.get()+1),a=s[r.get()],Eu(o,a,!1),o.setDirty(!0),o.dispatch("Redo",{level:a})),a})(t,e,n),clear:(e,n)=>((o,r,s)=>{r.data=[],s.set(0),r.typing=!1,o.dispatch("ClearUndos")})(t,e,n),reset:e=>(n=>{n.clear(),n.add()})(e),hasUndo:(e,n)=>((o,r,s)=>s.get()>0||r.typing&&r.data[0]&&!Nu($i(o),r.data[0]))(t,e,n),hasRedo:(e,n)=>((o,r)=>r.get()<o.data.length-1&&!o.typing)(e,n),transact:(e,n,o)=>((r,s,a)=>(Hv(r,s),r.beforeChange(),r.ignore(a),r.add()))(e,n,o),ignore:(e,n)=>((o,r)=>{try{o.set(o.get()+1),r()}finally{o.set(o.get()-1)}})(e,n),extra:(e,n,o,r)=>((s,a,i,l,d)=>{if(a.transact(l)){const c=a.data[i.get()].bookmark,u=a.data[i.get()-1];Eu(s,u,!0),a.transact(d)&&(a.data[i.get()-1].beforeBookmark=c)}})(t,e,n,o,r)},formatter:{match:(e,n,o,r)=>nu(t,e,n,o,r),matchAll:(e,n)=>((o,r,s)=>{const a=[],i={},l=o.selection.getStart();return o.dom.getParent(l,d=>{for(let c=0;c<r.length;c++){const u=r[c];!i[u]&&_n(o,d,u,s)&&(i[u]=!0,a.push(u))}},o.dom.getRoot()),a})(t,e,n),matchNode:(e,n,o,r)=>_n(t,e,n,o,r),canApply:e=>((n,o)=>{const r=n.formatter.get(o),s=n.dom;if(r){const a=n.selection.getStart(),i=yi(s,a);for(let l=r.length-1;l>=0;l--){const d=r[l];if(!je(d))return!0;for(let c=i.length-1;c>=0;c--)if(s.is(i[c],d.selector))return!0}}return!1})(t,e),closest:e=>((n,o)=>{const r=s=>xt(s,N(n.getBody()));return C.from(n.selection.getStart(!0)).bind(s=>Zc(N(s),a=>mr(o,i=>((l,d)=>_n(n,l.dom,d)?C.some(d):C.none())(a,i)),r)).getOrNull()})(t,e),apply:(e,n,o)=>sv(t,e,n,o),remove:(e,n,o,r)=>nv(t,e,n,o,r),toggle:(e,n,o)=>((r,s,a,i)=>{const l=r.formatter.get(s);l&&(!nu(r,s,a,i)||"toggle"in l[0]&&!l[0].toggle?sv(r,s,a,i):nv(r,s,a,i))})(t,e,n,o),formatChanged:(e,n,o,r,s)=>((a,i,l,d,c,u)=>(((g,p,m,h,f,b)=>{const v=p.get();H(m.split(","),y=>{const w=At(v,y).getOrThunk(()=>{const x={withSimilar:{state:Gt(!1),similar:!0,callbacks:[]},withoutSimilar:{state:Gt(!1),similar:!1,callbacks:[]},withVars:[]};return v[y]=x,x}),k=()=>{const x=dv(g);return lv(g,x,y,f,b).isSome()};if(fe(b)){const x=f?w.withSimilar:w.withoutSimilar;x.callbacks.push(h),x.callbacks.length===1&&x.state.set(k())}else w.withVars.push({state:Gt(k()),similar:f,vars:b,callback:h})}),p.set(v)})(a,i,l,d,c,u),{unbind:()=>((g,p,m)=>{const h=g.get();H(p.split(","),f=>At(h,f).each(b=>{h[f]={withSimilar:K(K({},b.withSimilar),{callbacks:mt(b.withSimilar.callbacks,v=>v!==m)}),withoutSimilar:K(K({},b.withoutSimilar),{callbacks:mt(b.withoutSimilar.callbacks,v=>v!==m)}),withVars:mt(b.withVars,v=>v.callback!==m)}})),g.set(h)})(i,l,d)}))(t,e,n,o,r,s)},editor:{getContent:e=>((n,o)=>C.from(n.getBody()).fold(Y(o.format==="tree"?new ve("body",11):""),r=>OE(n,o,r)))(t,e),setContent:(e,n)=>((o,r,s)=>C.from(o.getBody()).map(a=>Pi(r)?((i,l,d,c)=>{S0(i.parser.getNodeFilters(),i.parser.getAttributeFilters(),d);const u=mo({validate:!1},i.schema).serialize(d),g=Va(N(l))?u:$.trim(u);return Jc(i,g,c.no_selection),{content:d,html:g}})(o,a,r,s):((i,l,d,c)=>{if(d.length===0||/^\s+$/.test(d)){const u='<br data-mce-bogus="1">';l.nodeName==="TABLE"?d="<tr><td>"+u+"</td></tr>":/^(UL|OL)$/.test(l.nodeName)&&(d="<li>"+u+"</li>");const g=Be(i);return i.schema.isValidChild(l.nodeName.toLowerCase(),g.toLowerCase())?(d=u,d=i.dom.createHTML(g,Ls(i),d)):d||(d=u),Jc(i,d,c.no_selection),{content:d,html:d}}{c.format!=="raw"&&(d=mo({validate:!1},i.schema).serialize(i.parser.parse(d,{isRootContent:!0,insert:!0})));const u=Va(N(l))?d:$.trim(d);return Jc(i,u,c.no_selection),{content:u,html:u}}})(o,a,r,s)).getOr({content:r,html:Pi(s.content)?"":s.content}))(t,e,n),insertContent:(e,n)=>o_(t,e,n),addVisual:e=>((n,o)=>{const r=n.dom,s=Q(o)?o:n.getBody();H(r.select("table,a",s),a=>{switch(a.nodeName){case"TABLE":const i=uS(n),l=r.getAttrib(a,"border");l&&l!=="0"||!n.hasVisual?r.removeClass(a,i):r.addClass(a,i);break;case"A":if(!r.getAttrib(a,"href")){const d=r.getAttrib(a,"name")||a.id,c=qp(n);d&&n.hasVisual?r.addClass(a,c):r.removeClass(a,c)}}}),n.dispatch("VisualAid",{element:o,hasVisual:n.hasVisual})})(t,e)},selection:{getContent:(e,n)=>((o,r,s={})=>{const a=((i,l)=>K(K({},i),{format:l,get:!0,selection:!0,getInner:!0}))(s,r);return Tv(o,a).fold(ge,i=>{const l=((d,c)=>{if(c.format==="text")return(u=>C.from(u.selection.getRng()).map(g=>{var p;const m=C.from(u.dom.getParent(g.commonAncestorContainer,u.dom.isBlock)),h=u.getBody(),f=(k=>k.map(x=>x.nodeName).getOr("div").toLowerCase())(m),b=N(g.cloneContents());Tb(b),Bb(b);const v=u.dom.add(h,f,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},b.dom),y=Uv(v),w=jn((p=v.textContent)!==null&&p!==void 0?p:"");if(u.dom.remove(v),Hi(w,0)||Hi(w,w.length-1)){const k=m.getOr(h),x=Uv(k),E=x.indexOf(y);return E===-1?y:(Hi(x,E-1)?" ":"")+y+(Hi(x,E+y.length)?" ":"")}return y}).getOr(""))(d);{const u=((g,p)=>{const m=g.selection.getRng(),h=g.dom.create("body"),f=g.selection.getSel(),b=Sc(g,Jd(f)),v=p.contextual?K_(N(g.getBody()),b).dom:m.cloneContents();return v&&h.appendChild(v),g.selection.serializer.serialize(h,p)})(d,c);return c.format==="tree"?u:d.selection.isCollapsed()?"":u}})(o,i);return Bv(o,l,i)})})(t,e,n)},autocompleter:{addDecoration:e=>EE(t,e),removeDecoration:()=>((e,n)=>Nb(n).each(o=>{const r=e.selection.getBookmark();Zn(o),e.selection.moveToBookmark(r)}))(t,N(t.getBody()))},raw:{getModel:()=>C.none()}}),Rn=t=>pt(t.plugins,"rtc"),Au=t=>t.rtcInstance?t.rtcInstance:$v(t),Mt=t=>{const e=t.rtcInstance;if(e)return e;throw new Error("Failed to get RTC instance not yet initialized.")},Vv=t=>Mt(t).init.bindEvents(),qv=t=>t.dom.length===0?(Tt(t),C.none()):C.some(t),Wv=(t,e,n,o)=>{t.bind(r=>((o?Pc:Oi)(r.dom,o?r.dom.length:0),e.filter(Le).map(s=>((a,i,l,d)=>{const c=a.dom,u=i.dom,g=d?c.length:u.length;d?(Lc(c,u,!1,!d),l.setStart(u,g)):(Lc(u,c,!1,!d),l.setEnd(u,g))})(r,s,n,o)))).orThunk(()=>((s,a)=>s.filter(i=>qs.isBookmarkNode(i.dom)).bind(a?gs:Oo))(e,o).or(e).filter(Le).map(s=>((a,i)=>{tn(a).each(l=>{const d=a.dom;i&&Qs(l,L(d,0))?Oi(d,0):!i&&Js(l,L(d,d.length))&&Pc(d,d.length)})})(s,o)))},Kv=(t,e,n)=>{if(pt(t,e)){const o=mt(t[e],r=>r!==n);o.length===0?delete t[e]:t[e]=o}},Gv=t=>!(!t||!t.ownerDocument)&&Fn(N(t.ownerDocument),N(t)),Yv=(t,e,n,o)=>{let r,s;const{selectorChangedWithUnbind:a}=((f,b)=>{let v,y;const w=(x,E)=>Wt(E,S=>f.is(S,x)),k=x=>f.getParents(x,void 0,f.getRoot());return{selectorChangedWithUnbind:(x,E)=>(v||(v={},y={},b.on("NodeChange",S=>{const _=S.element,O=k(_),T={};Nt(v,(P,D)=>{w(D,O).each(I=>{y[D]||(H(P,q=>{q(!0,{node:I,selector:D,parents:O})}),y[D]=P),T[D]=P})}),Nt(y,(P,D)=>{T[D]||(delete y[D],H(P,I=>{I(!1,{node:_,selector:D,parents:O})}))})})),v[x]||(v[x]=[]),v[x].push(E),w(x,k(b.selection.getStart())).each(()=>{y[x]=v[x]}),{unbind:()=>{Kv(v,x,E),Kv(y,x,E)}})}})(t,o),i=(f,b)=>((v,y,w={})=>{const k=((x,E)=>K(K({format:"html"},x),{set:!0,selection:!0,content:E}))(w,y);xu(v,k).each(x=>{const E=((_,O)=>{if(O.format!=="raw"){const T=_.selection.getRng(),P=_.dom.getParent(T.commonAncestorContainer,_.dom.isBlock),D=P?{context:P.nodeName.toLowerCase()}:{},I=_.parser.parse(O.content,K(K({forced_root_block:!1},D),O));return mo({validate:!1},_.schema).serialize(I)}return O.content})(v,x),S=v.selection.getRng();((_,O)=>{const T=C.from(O.firstChild).map(N),P=C.from(O.lastChild).map(N);_.deleteContents(),_.insertNode(O);const D=T.bind(Oo).filter(Le).bind(qv),I=P.bind(gs).filter(Le).bind(qv);Wv(D,T,_,!0),Wv(I,P,_,!1),_.collapse(!1)})(S,S.createContextualFragment(E)),v.selection.setRng(S),Gs(v,S),ku(v,E,x)})})(o,f,b),l=f=>{const b=c();b.collapse(!!f),u(b)},d=()=>e.getSelection?e.getSelection():e.document.selection,c=()=>{let f;const b=(y,w,k)=>{try{return w.compareBoundaryPoints(y,k)}catch(x){return-1}},v=e.document;if(Q(o.bookmark)&&!Qo(o)){const y=Cc(o);if(y.isSome())return y.map(w=>Sc(o,[w])[0]).getOr(v.createRange())}try{const y=d();y&&!ja(y.anchorNode)&&(f=y.rangeCount>0?y.getRangeAt(0):v.createRange(),f=Sc(o,[f])[0])}catch(y){}if(f||(f=v.createRange()),vs(f.startContainer)&&f.collapsed){const y=t.getRoot();f.setStart(y,0),f.setEnd(y,0)}return r&&s&&(b(f.START_TO_START,f,r)===0&&b(f.END_TO_END,f,r)===0?f=s:(r=null,s=null)),f},u=(f,b)=>{if(!(y=>!!y&&Gv(y.startContainer)&&Gv(y.endContainer))(f))return;const v=d();if(f=o.dispatch("SetSelectionRange",{range:f,forward:b}).range,v){s=f;try{v.removeAllRanges(),v.addRange(f)}catch(y){}b===!1&&v.extend&&(v.collapse(f.endContainer,f.endOffset),v.extend(f.startContainer,f.startOffset)),r=v.rangeCount>0?v.getRangeAt(0):null}if(!f.collapsed&&f.startContainer===f.endContainer&&(v==null?void 0:v.setBaseAndExtent)&&f.endOffset-f.startOffset<2&&f.startContainer.hasChildNodes()){const y=f.startContainer.childNodes[f.startOffset];y&&y.nodeName==="IMG"&&(v.setBaseAndExtent(f.startContainer,f.startOffset,f.endContainer,f.endOffset),v.anchorNode===f.startContainer&&v.focusNode===f.endContainer||v.setBaseAndExtent(y,0,y,1))}o.dispatch("AfterSetSelectionRange",{range:f,forward:b})},g=()=>{const f=d(),b=f==null?void 0:f.anchorNode,v=f==null?void 0:f.focusNode;if(!f||!b||!v||ja(b)||ja(v))return!0;const y=t.createRng(),w=t.createRng();try{y.setStart(b,f.anchorOffset),y.collapse(!0),w.setStart(v,f.focusOffset),w.collapse(!0)}catch(k){return!0}return y.compareBoundaryPoints(y.START_TO_START,w)<=0},p={dom:t,win:e,serializer:n,editor:o,expand:(f={type:"word"})=>u(Xo(t).expand(c(),f)),collapse:l,setCursorLocation:(f,b)=>{const v=t.createRng();Q(f)&&Q(b)?(v.setStart(f,b),v.setEnd(f,b),u(v),l(!1)):(ec(t,v,o.getBody(),!0),u(v))},getContent:f=>((b,v={})=>((y,w,k)=>Mt(y).selection.getContent(w,k))(b,v.format?v.format:"html",v))(o,f),setContent:i,getBookmark:(f,b)=>m.getBookmark(f,b),moveToBookmark:f=>m.moveToBookmark(f),select:(f,b)=>(((v,y,w)=>C.from(y).bind(k=>C.from(k.parentNode).map(x=>{const E=v.nodeIndex(k),S=v.createRng();return S.setStart(x,E),S.setEnd(x,E+1),w&&(ec(v,S,k,!0),ec(v,S,k,!1)),S})))(t,f,b).each(u),f),isCollapsed:()=>{const f=c(),b=d();return!(!f||f.item)&&(f.compareEndPoints?f.compareEndPoints("StartToEnd",f)===0:!b||f.collapsed)},isForward:g,setNode:f=>(i(t.getOuterHTML(f)),f),getNode:()=>((f,b)=>{if(!b)return f;let v=b.startContainer,y=b.endContainer;const w=b.startOffset,k=b.endOffset;let x=b.commonAncestorContainer;b.collapsed||(v===y&&k-w<2&&v.hasChildNodes()&&(x=v.childNodes[w]),j(v)&&j(y)&&(v=v.length===w?Sb(v.nextSibling,!0):v.parentNode,y=k===0?Sb(y.previousSibling,!1):y.parentNode,v&&v===y&&(x=v)));const E=j(x)?x.parentNode:x;return J(E)?E:f})(o.getBody(),c()),getSel:d,setRng:u,getRng:c,getStart:f=>xb(o.getBody(),c(),f),getEnd:f=>kb(o.getBody(),c(),f),getSelectedBlocks:(f,b)=>((v,y,w,k)=>{const x=[],E=v.getRoot(),S=v.getParent(w||xb(E,y,y.collapsed),v.isBlock),_=v.getParent(k||kb(E,y,y.collapsed),v.isBlock);if(S&&S!==E&&x.push(S),S&&_&&S!==_){let O=S;const T=new Vt(S,E);for(;(O=T.next())&&O!==_;)v.isBlock(O)&&x.push(O)}return _&&S!==_&&_!==E&&x.push(_),x})(t,c(),f,b),normalize:()=>{const f=c(),b=d();if(!(Jd(b).length>1)&&hi(o)){const v=Si(t,f);return v.each(y=>{u(y,g())}),v.getOr(f)}return f},selectorChanged:(f,b)=>(a(f,b),p),selectorChangedWithUnbind:a,getScrollContainer:()=>{let f,b=t.getRoot();for(;b&&b.nodeName!=="BODY";){if(b.scrollHeight>b.clientHeight){f=b;break}b=b.parentNode}return f},scrollIntoView:(f,b)=>{Q(f)?((v,y,w)=>{(v.inline?hE:vE)(v,y,w)})(o,f,b):Gs(o,c(),b)},placeCaretAt:(f,b)=>u(eb(f,b,o.getDoc())),getBoundingClientRect:()=>{const f=c();return f.collapsed?L.fromRangeStart(f).getClientRects()[0]:f.getBoundingClientRect()},destroy:()=>{e=r=s=null,h.destroy()}},m=qs(p),h=Xh(p,o);return p.bookmarkManager=m,p.controlSelection=h,p},X_=(t,e,n)=>{$.inArray(e,n)===-1&&(t.addAttributeFilter(n,(o,r)=>{let s=o.length;for(;s--;)o[s].attr(r,null)}),e.push(n))},Q_=(t,e)=>{const n=["data-mce-selected"],o=e&&e.dom?e.dom:Et.DOM,r=e&&e.schema?e.schema:so(t);t.entity_encoding=t.entity_encoding||"named",t.remove_trailing_brs=!("remove_trailing_brs"in t)||t.remove_trailing_brs;const s=Ir(t,r);return((a,i,l)=>{a.addAttributeFilter("data-mce-tabindex",(d,c)=>{let u=d.length;for(;u--;){const g=d[u];g.attr("tabindex",g.attr("data-mce-tabindex")),g.attr(c,null)}}),a.addAttributeFilter("src,href,style",(d,c)=>{const u="data-mce-"+c,g=i.url_converter,p=i.url_converter_scope;let m=d.length;for(;m--;){const h=d[m];let f=h.attr(u);f!==void 0?(h.attr(c,f.length>0?f:null),h.attr(u,null)):(f=h.attr(c),c==="style"?f=l.serializeStyle(l.parseStyle(f),h.name):g&&(f=g.call(p,f,c,h.name)),h.attr(c,f.length>0?f:null))}}),a.addAttributeFilter("class",d=>{let c=d.length;for(;c--;){const u=d[c];let g=u.attr("class");g&&(g=g.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),u.attr("class",g.length>0?g:null))}}),a.addAttributeFilter("data-mce-type",(d,c,u)=>{let g=d.length;for(;g--;){const p=d[g];p.attr("data-mce-type")==="bookmark"&&!u.cleanup&&(C.from(p.firstChild).exists(h=>{var f;return!qa((f=h.value)!==null&&f!==void 0?f:"")})?p.unwrap():p.remove())}}),a.addNodeFilter("noscript",d=>{var c;let u=d.length;for(;u--;){const g=d[u].firstChild;g&&(g.value=ro.decode((c=g.value)!==null&&c!==void 0?c:""))}}),a.addNodeFilter("script,style",(d,c)=>{var u;const g=m=>m.replace(/(<!--\[CDATA\[|\]\]-->)/g,`
`).replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"");let p=d.length;for(;p--;){const m=d[p],h=m.firstChild,f=(u=h==null?void 0:h.value)!==null&&u!==void 0?u:"";if(c==="script"){const b=m.attr("type");b&&m.attr("type",b==="mce-no/type"?null:b.replace(/^mce\-/,"")),i.element_format==="xhtml"&&h&&f.length>0&&(h.value=`// <![CDATA[
`+g(f)+`
// ]]>`)}else i.element_format==="xhtml"&&h&&f.length>0&&(h.value=`<!--
`+g(f)+`
-->`)}}),a.addNodeFilter("#comment",d=>{let c=d.length;for(;c--;){const u=d[c],g=u.value;i.preserve_cdata&&(g==null?void 0:g.indexOf("[CDATA["))===0?(u.name="#cdata",u.type=4,u.value=l.decode(g.replace(/^\[CDATA\[|\]\]$/g,""))):(g==null?void 0:g.indexOf("mce:protected "))===0&&(u.name="#text",u.type=3,u.raw=!0,u.value=unescape(g).substr(14))}}),a.addNodeFilter("xml:namespace,input",(d,c)=>{let u=d.length;for(;u--;){const g=d[u];g.type===7?g.remove():g.type===1&&(c!=="input"||g.attr("type")||g.attr("type","text"))}}),a.addAttributeFilter("data-mce-type",d=>{H(d,c=>{c.attr("data-mce-type")==="format-caret"&&(c.isEmpty(a.schema.getNonEmptyElements())?c.remove():c.unwrap())})}),a.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(d,c)=>{let u=d.length;for(;u--;)d[u].attr(c,null)})})(s,t,o),{schema:r,addNodeFilter:s.addNodeFilter,addAttributeFilter:s.addAttributeFilter,serialize:(a,i={})=>{const l=K({format:"html"},i),d=((g,p,m)=>((h,f)=>Q(h)&&h.hasEventListeners("PreProcess")&&!f.no_events)(g,m)?((h,f,b)=>{let v;const y=h.dom;let w=f.cloneNode(!0);const k=document.implementation;if(k.createHTMLDocument){const x=k.createHTMLDocument("");$.each(w.nodeName==="BODY"?w.childNodes:[w],E=>{x.body.appendChild(x.importNode(E,!0))}),w=w.nodeName!=="BODY"?x.body.firstChild:x.body,v=y.doc,y.doc=x}return((x,E)=>{x.dispatch("PreProcess",E)})(h,K(K({},b),{node:w})),v&&(y.doc=v),w})(g,p,m):p)(e,a,l),c=((g,p,m)=>{const h=jn(m.getInner?p.innerHTML:g.getOuterHTML(p));return m.selection||Va(N(p))?h:$.trim(h)})(o,d,l),u=((g,p,m)=>{const h=m.selection?K({forced_root_block:!1},m):m,f=g.parse(p,h);return(b=>{const v=w=>(w==null?void 0:w.name)==="br",y=b.lastChild;if(v(y)){const w=y.prev;v(w)&&(y.remove(),w.remove())}})(f),f})(s,c,l);return l.format==="tree"?u:((g,p,m,h,f)=>{const b=((v,y,w)=>mo(v,y).serialize(w))(p,m,h);return((v,y,w)=>!y.no_events&&v?((x,E)=>x.dispatch("PostProcess",E))(v,K(K({},y),{content:w})).content:w)(g,f,b)})(e,t,r,u,l)},addRules:r.addValidElements,setRules:r.setValidElements,addTempAttr:tt(X_,s,n),getTempAttrs:Y(n),getNodeFilters:s.getNodeFilters,getAttributeFilters:s.getAttributeFilters,removeNodeFilter:s.removeNodeFilter,removeAttributeFilter:s.removeAttributeFilter}},Xv=(t,e)=>{const n=Q_(t,e);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},Ou=(t,e,n={})=>{const o=((r,s)=>K(K({format:"html"},r),{set:!0,content:s}))(n,e);return xu(t,o).map(r=>{const s=((a,i,l)=>Au(a).editor.setContent(i,l))(t,r.content,r);return ku(t,s.html,r),s.content}).getOr(e)},J_="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),Z_="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),tN=t=>{const e=mt(J_,o=>pt(t,o)),n=t.forced_root_block;return n!==!1&&n!==""||e.push("forced_root_block (false only)"),ur(e)},eN=t=>{const e=$.makeMap(t.plugins," "),n=mt(Z_,o=>pt(e,o));return ur(n)},qi=Et.DOM,Wi=t=>C.from(t).each(e=>e.destroy()),Ki=(()=>{const t={};return{add:(e,n)=>{t[e]=n},get:e=>t[e]?t[e]:{icons:{}},has:e=>pt(t,e)}})(),Fr=de.ModelManager,Qv=(t,e)=>e.dom[t],Jv=(t,e)=>parseInt(vn(e,t),10),nN=tt(Qv,"clientWidth"),oN=tt(Qv,"clientHeight"),rN=tt(Jv,"margin-top"),sN=tt(Jv,"margin-left"),Zv=t=>{const e=[],n=()=>{const l=t.theme;return l&&l.getNotificationManagerImpl?l.getNotificationManagerImpl():(()=>{const d=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:d,close:d,getArgs:d}})()},o=()=>C.from(e[0]),r=()=>{H(e,l=>{l.reposition()})},s=l=>{ns(e,d=>d===l).each(d=>{e.splice(d,1)})},a=(l,d=!0)=>t.removed||!(c=>{return(u=c.inline?c.getBody():c.getContentAreaContainer(),C.from(u).map(N)).map(br).getOr(!1);var u})(t)?{}:(d&&t.dispatch("BeforeOpenNotification",{notification:l}),Wt(e,c=>{return u=n().getArgs(c),g=l,!(u.type!==g.type||u.text!==g.text||u.progressBar||u.timeout||g.progressBar||g.timeout);var u,g}).getOrThunk(()=>{t.editorManager.setActive(t);const c=n().open(l,()=>{s(c),r(),o().fold(()=>t.focus(),u=>gb(N(u.getEl())))});return(u=>{e.push(u)})(c),r(),t.dispatch("OpenNotification",{notification:K({},c)}),c})),i=Y(e);return(l=>{l.on("SkinLoaded",()=>{const d=Gk(l);d&&a({text:d,type:"warning",timeout:0},!1),r()}),l.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(r)}),l.on("remove",()=>{H(e.slice(),d=>{n().close(d)})})})(t),{open:a,close:()=>{o().each(l=>{n().close(l),s(l),r()})},getNotifications:i}},Ur=de.PluginManager,rr=de.ThemeManager,ty=t=>{let e=[];const n=()=>{const a=t.theme;return a&&a.getWindowManagerImpl?a.getWindowManagerImpl():(()=>{const i=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:i,openUrl:i,alert:i,confirm:i,close:i}})()},o=(a,i)=>(...l)=>i?i.apply(a,l):void 0,r=a=>{(i=>{t.dispatch("CloseWindow",{dialog:i})})(a),e=mt(e,i=>i!==a),e.length===0&&t.focus()},s=a=>{t.editorManager.setActive(t),yc(t),t.ui.show();const i=a();return(l=>{e.push(l),(d=>{t.dispatch("OpenWindow",{dialog:d})})(l)})(i),i};return t.on("remove",()=>{H(e,a=>{n().close(a)})}),{open:(a,i)=>s(()=>n().open(a,i,r)),openUrl:a=>s(()=>n().openUrl(a,r)),alert:(a,i,l)=>{const d=n();d.alert(a,o(l||d,i))},confirm:(a,i,l)=>{const d=n();d.confirm(a,o(l||d,i))},close:()=>{C.from(e[e.length-1]).each(a=>{n().close(a),r(a)})}}},ey=(t,e)=>{t.notificationManager.open({type:"error",text:e})},Gi=(t,e)=>{t._skinLoaded?ey(t,e):t.on("SkinLoaded",()=>{ey(t,e)})},ra=(t,e,n)=>{$h(t,e,{message:n}),console.error(n)},sa=(t,e,n)=>n?`Failed to load ${t}: ${n} from url ${e}`:`Failed to load ${t} url: ${e}`,Yi=(t,...e)=>{const n=window.console;n&&(n.error?n.error(t,...e):n.log(t,...e))},ny=(t,e)=>{const n=t.editorManager.baseURL+"/skins/content",o=`content${t.editorManager.suffix}.css`;return yt(e,r=>(s=>/^[a-z0-9\-]+$/i.test(s))(r)&&!t.inline?`${n}/${r}/${o}`:t.documentBaseURI.toAbsolute(r))},aN=Ht,iN=(t,e)=>{const n={};return{findAll:(o,r=Ht)=>{const s=mt((i=>i?Ae(i.getElementsByTagName("img")):[])(o),i=>{const l=i.src;return!i.hasAttribute("data-mce-bogus")&&!i.hasAttribute("data-mce-placeholder")&&!(!l||l===Ct.transparentSrc)&&(ee(l,"blob:")?!t.isUploaded(l)&&r(i):!!ee(l,"data:")&&r(i))}),a=yt(s,i=>{const l=i.src;if(pt(n,l))return n[l].then(d=>it(d)?d:{image:i,blobInfo:d.blobInfo});{const d=((c,u)=>{const g=()=>Promise.reject("Invalid data URI");if(ee(u,"blob:")){const h=c.getByUri(u);return Q(h)?Promise.resolve(h):(p=u,ee(p,"blob:")?(f=>fetch(f).then(b=>b.ok?b.blob():Promise.reject()).catch(()=>Promise.reject(`Cannot convert ${f} to Blob. Resource might not exist or is inaccessible.`)))(p):ee(p,"data:")?(m=p,new Promise((f,b)=>{Cu(m).bind(({type:v,data:y,base64Encoded:w})=>Cv(v,y,w)).fold(()=>b("Invalid data URI"),f)})):Promise.reject("Unknown URI format")).then(f=>wv(f).then(b=>xv(b,!1,v=>C.some(kv(c,f,v))).getOrThunk(g)))}var p,m;return ee(u,"data:")?Sv(c,u).fold(g,h=>Promise.resolve(h)):Promise.reject("Unknown image data format")})(e,l).then(c=>(delete n[l],{image:i,blobInfo:c})).catch(c=>(delete n[l],c));return n[l]=d,d}});return Promise.all(a)}}},oy=()=>{let t={};const e=(o,r)=>({status:o,resultUri:r}),n=o=>o in t;return{hasBlobUri:n,getResultUri:o=>{const r=t[o];return r?r.resultUri:null},isPending:o=>!!n(o)&&t[o].status===1,isUploaded:o=>!!n(o)&&t[o].status===2,markPending:o=>{t[o]=e(1,null)},markUploaded:(o,r)=>{t[o]=e(2,r)},removeFailed:o=>{delete t[o]},destroy:()=>{t={}}}};let lN=0;const dN=(t,e)=>{const n={},o=(l,d)=>new Promise((c,u)=>{const g=new XMLHttpRequest;g.open("POST",e.url),g.withCredentials=e.credentials,g.upload.onprogress=m=>{d(m.loaded/m.total*100)},g.onerror=()=>{u("Image upload failed due to a XHR Transport error. Code: "+g.status)},g.onload=()=>{if(g.status<200||g.status>=300)return void u("HTTP Error: "+g.status);const m=JSON.parse(g.responseText);var h,f;m&&it(m.location)?c((h=e.basePath,f=m.location,h?h.replace(/\/$/,"")+"/"+f.replace(/^\//,""):f)):u("Invalid JSON: "+g.responseText)};const p=new FormData;p.append("file",l.blob(),l.filename()),g.send(p)}),r=wt(e.handler)?e.handler:o,s=(l,d)=>({url:d,blobInfo:l,status:!0}),a=(l,d)=>({url:"",blobInfo:l,status:!1,error:d}),i=(l,d)=>{$.each(n[l],c=>{c(d)}),delete n[l]};return{upload:(l,d)=>e.url||r!==o?((c,u)=>(c=$.grep(c,g=>!t.isUploaded(g.blobUri())),Promise.all($.map(c,g=>t.isPending(g.blobUri())?(p=>{const m=p.blobUri();return new Promise(h=>{n[m]=n[m]||[],n[m].push(h)})})(g):((p,m,h)=>(t.markPending(p.blobUri()),new Promise(f=>{let b,v;try{const y=()=>{b&&(b.close(),v=bt)},w=x=>{y(),t.markUploaded(p.blobUri(),x),i(p.blobUri(),s(p,x)),f(s(p,x))},k=x=>{y(),t.removeFailed(p.blobUri()),i(p.blobUri(),a(p,x)),f(a(p,x))};v=x=>{x<0||x>100||C.from(b).orThunk(()=>C.from(h).map(Il)).each(E=>{b=E,E.progressBar.value(x)})},m(p,v).then(w,x=>{k(it(x)?{message:x}:x)})}catch(y){f(a(p,y))}})))(g,r,u)))))(l,d):new Promise(c=>{c([])})}},ry=t=>()=>t.notificationManager.open({text:t.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),sy=(t,e)=>dN(e,{url:Lk(t),basePath:Mk(t),credentials:Ik(t),handler:Fk(t)}),cN=t=>{const e=(()=>{let h=[];const f=y=>{if(!y.blob||!y.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");const w=y.id||"blobid"+lN+++(()=>{const S=()=>Math.round(4294967295*Math.random()).toString(36);return"s"+new Date().getTime().toString(36)+S()+S()+S()})(),k=y.name||w,x=y.blob;var E;return{id:Y(w),name:Y(k),filename:Y(y.filename||k+"."+(E=x.type,{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[E.toLowerCase()]||"dat")),blob:Y(x),base64:Y(y.base64),blobUri:Y(y.blobUri||URL.createObjectURL(x)),uri:Y(y.uri)}},b=y=>Wt(h,y).getOrUndefined(),v=y=>b(w=>w.id()===y);return{create:(y,w,k,x,E)=>{if(it(y))return f({id:y,name:x,filename:E,blob:w,base64:k});if(me(y))return f(y);throw new Error("Unknown input type")},add:y=>{v(y.id())||h.push(y)},get:v,getByUri:y=>b(w=>w.blobUri()===y),getByData:(y,w)=>b(k=>k.base64()===y&&k.blob().type===w),findFirst:b,removeByUri:y=>{h=mt(h,w=>w.blobUri()!==y||(URL.revokeObjectURL(w.blobUri()),!1))},destroy:()=>{H(h,y=>{URL.revokeObjectURL(y.blobUri())}),h=[]}}})();let n,o;const r=oy(),s=[],a=h=>f=>t.selection?h(f):[],i=(h,f,b)=>{let v=0;do v=h.indexOf(f,v),v!==-1&&(h=h.substring(0,v)+b+h.substr(v+f.length),v+=b.length-f.length+1);while(v!==-1);return h},l=(h,f,b)=>{const v=`src="${b}"${b===Ct.transparentSrc?' data-mce-placeholder="1"':""}`;return h=i(h,`src="${f}"`,v),i(h,'data-mce-src="'+f+'"','data-mce-src="'+b+'"')},d=(h,f)=>{H(t.undoManager.data,b=>{b.type==="fragmented"?b.fragments=yt(b.fragments,v=>l(v,h,f)):b.content=l(b.content,h,f)})},c=()=>(n||(n=sy(t,r)),p().then(a(h=>{const f=yt(h,b=>b.blobInfo);return n.upload(f,ry(t)).then(a(b=>{const v=[];let y=!1;const w=yt(b,(k,x)=>{const{blobInfo:E,image:S}=h[x];let _=!1;return k.status&&Dk(t)?(k.url&&!se(S.src,k.url)&&(y=!0),e.removeByUri(S.src),Rn(t)||((O,T)=>{const P=t.convertURL(T,"src");var D;d(O.src,T),Xn(N(O),{src:Mp(t)?(D=T,D+(D.indexOf("?")===-1?"?":"&")+new Date().getTime()):T,"data-mce-src":P})})(S,k.url)):k.error&&(k.error.remove&&(d(S.src,Ct.transparentSrc),v.push(S),_=!0),((O,T)=>{Gi(O,rn.translate(["Failed to upload image: {0}",T]))})(t,k.error.message)),{element:S,status:k.status,uploadUri:k.url,blobInfo:E,removed:_}});return v.length>0&&!Rn(t)?t.undoManager.transact(()=>{H(v,k=>{t.dom.remove(k),e.removeByUri(k.src)})}):y&&t.undoManager.dispatchChange(),w}))}))),u=()=>Lp(t)?c():Promise.resolve([]),g=h=>So(s,f=>f(h)),p=()=>(o||(o=iN(r,e)),o.findAll(t.getBody(),g).then(a(h=>{const f=mt(h,b=>!it(b)||(Gi(t,b),!1));return Rn(t)||H(f,b=>{d(b.image.src,b.blobInfo.blobUri()),b.image.src=b.blobInfo.blobUri(),b.image.removeAttribute("data-mce-src")}),f}))),m=h=>h.replace(/src="(blob:[^"]+)"/g,(f,b)=>{const v=r.getResultUri(b);if(v)return'src="'+v+'"';let y=e.getByUri(b);return y||(y=Re(t.editorManager.get(),(w,k)=>w||k.editorUpload&&k.editorUpload.blobCache.getByUri(b),void 0)),y?'src="data:'+y.blob().type+";base64,"+y.base64()+'"':f});return t.on("SetContent",()=>{Lp(t)?u():p()}),t.on("RawSaveContent",h=>{h.content=m(h.content)}),t.on("GetContent",h=>{h.source_view||h.format==="raw"||h.format==="tree"||(h.content=m(h.content))}),t.on("PostRender",()=>{t.parser.addNodeFilter("img",h=>{H(h,f=>{const b=f.attr("src");if(!b||e.getByUri(b))return;const v=r.getResultUri(b);v&&f.attr("src",v)})})}),{blobCache:e,addFilter:h=>{s.push(h)},uploadImages:c,uploadImagesAuto:u,scanForImages:p,destroy:()=>{e.destroy(),r.destroy(),o=n=null}}},ay={remove_similar:!0,inherit:!1},zr=K({selector:"td,th"},ay),uN={tablecellbackgroundcolor:K({styles:{backgroundColor:"%value"}},zr),tablecellverticalalign:K({styles:{"vertical-align":"%value"}},zr),tablecellbordercolor:K({styles:{borderColor:"%value"}},zr),tablecellclass:K({classes:["%value"]},zr),tableclass:K({selector:"table",classes:["%value"]},ay),tablecellborderstyle:K({styles:{borderStyle:"%value"}},zr),tablecellborderwidth:K({styles:{borderWidth:"%value"}},zr)},mN=Y(uN),Xi=$.each,Ve=Et.DOM,Tu=t=>Q(t)&&me(t),iy=(t,e)=>{const n=e&&e.schema||so({}),o=a=>{const i=it(a)?{name:a,classes:[],attrs:{}}:a,l=Ve.create(i.name);return((d,c)=>{c.classes.length>0&&Ve.addClass(d,c.classes.join(" ")),Ve.setAttribs(d,c.attrs)})(l,i),l},r=(a,i,l)=>{let d;const c=i[0],u=Tu(c)?c.name:void 0,g=((h,f)=>{const b=n.getElementRule(h.nodeName.toLowerCase()),v=b==null?void 0:b.parentsRequired;return!(!v||!v.length)&&(f&&_t(v,f)?f:v[0])})(a,u);if(g)u===g?(d=c,i=i.slice(1)):d=g;else if(c)d=c,i=i.slice(1);else if(!l)return a;const p=d?o(d):Ve.create("div");p.appendChild(a),l&&$.each(l,h=>{const f=o(h);p.insertBefore(f,a)});const m=Tu(d)?d.siblings:void 0;return r(p,i,m)},s=Ve.create("div");if(t.length>0){const a=t[0],i=o(a),l=Tu(a)?a.siblings:void 0;s.appendChild(r(i,t.slice(1),l))}return s},fN=t=>{let e="div";const n={name:e,classes:[],attrs:{},selector:t=$.trim(t)};return t!=="*"&&(e=t.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(o,r,s,a,i)=>{switch(r){case"#":n.attrs.id=s;break;case".":n.classes.push(s);break;case":":$.inArray("checked disabled enabled read-only required".split(" "),s)!==-1&&(n.attrs[s]=s)}if(a==="["){const l=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);l&&(n.attrs[l[1]]=l[2])}return""})),n.name=e||"div",n},gN=(t,e)=>{let n="",o=Jk(t);if(o==="")return"";const r=p=>it(p)?p.replace(/%(\w+)/g,""):"",s=(p,m)=>Ve.getStyle(m!=null?m:t.getBody(),p,!0);if(it(e)){const p=t.formatter.get(e);if(!p)return"";e=p[0]}if("preview"in e){const p=e.preview;if(p===!1)return"";o=p||o}let a,i=e.block||e.inline||"span";const l=(d=e.selector,it(d)?(d=(d=d.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),$.map(d.split(/(?:>|\s+(?![^\[\]]+\]))/),p=>{const m=$.map(p.split(/(?:~\+|~|\+)/),fN),h=m.pop();return m.length&&(h.siblings=m),h}).reverse()):[]);var d;l.length>0?(l[0].name||(l[0].name=i),i=e.selector,a=iy(l,t)):a=iy([i],t);const c=Ve.select(i,a)[0]||a.firstChild;Xi(e.styles,(p,m)=>{const h=r(p);h&&Ve.setStyle(c,m,h)}),Xi(e.attributes,(p,m)=>{const h=r(p);h&&Ve.setAttrib(c,m,h)}),Xi(e.classes,p=>{const m=r(p);Ve.hasClass(c,m)||Ve.addClass(c,m)}),t.dispatch("PreviewFormats"),Ve.setStyles(a,{position:"absolute",left:-65535}),t.getBody().appendChild(a);const u=s("fontSize"),g=/px$/.test(u)?parseInt(u,10):0;return Xi(o.split(" "),p=>{let m=s(p,c);if(!(p==="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(m)&&(m=s(p),pi(m).toLowerCase()==="#ffffff")||p==="color"&&pi(m).toLowerCase()==="#000000")){if(p==="font-size"&&/em|%$/.test(m)){if(g===0)return;m=parseFloat(m)/(/%$/.test(m)?100:1)*g+"px"}p==="border"&&m&&(n+="padding:0 2px;"),n+=p+":"+m+";"}}),t.dispatch("AfterPreviewFormats"),Ve.remove(a),n},ly=t=>{const e=(o=>{const r={},s=(a,i)=>{a&&(it(a)?($t(i)||(i=[i]),H(i,l=>{fe(l.deep)&&(l.deep=!je(l)),fe(l.split)&&(l.split=!je(l)||qt(l)),fe(l.remove)&&je(l)&&!qt(l)&&(l.remove="none"),je(l)&&qt(l)&&(l.mixed=!0,l.block_expand=!0),it(l.classes)&&(l.classes=l.classes.split(/\s+/))}),r[a]=i):Nt(a,(l,d)=>{s(d,l)}))};return s((a=>{const i=a.dom,l=a.schema.type,d={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:c=>{i.setStyle(c,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:c=>{i.setStyle(c,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{const c={inline:"span",styles:{textDecoration:"line-through"},exact:!0},u={inline:"strike",remove:"all",preserve_attributes:["class","style"]},g={inline:"s",remove:"all",preserve_attributes:["class","style"]};return l!=="html4"?[g,c,u]:[c,g,u]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(c,u,g)=>J(c)&&c.hasAttribute("href"),onformat:(c,u,g)=>{$.each(g,(p,m)=>{i.setAttrib(c,m,p)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":c=>{var u;return(u=c==null?void 0:c.customValue)!==null&&u!==void 0?u:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return $.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),c=>{d[c]={block:c,remove:"all"}}),d})(o)),s(mN()),s(Qk(o)),{get:a=>Q(a)?r[a]:r,has:a=>pt(r,a),register:s,unregister:a=>(a&&r[a]&&delete r[a],r)}})(t),n=Gt({});return(o=>{o.addShortcut("meta+b","","Bold"),o.addShortcut("meta+i","","Italic"),o.addShortcut("meta+u","","Underline");for(let r=1;r<=6;r++)o.addShortcut("access+"+r,"",["FormatBlock",!1,"h"+r]);o.addShortcut("access+7","",["FormatBlock",!1,"p"]),o.addShortcut("access+8","",["FormatBlock",!1,"div"]),o.addShortcut("access+9","",["FormatBlock",!1,"address"])})(t),(o=>{o.on("mouseup keydown",r=>{((s,a)=>{const i=s.selection,l=s.getBody();su(s,null,!1),a!==8&&a!==46||!i.isCollapsed()||i.getStart().innerHTML!==Mr||su(s,Ko(l,i.getStart())),a!==37&&a!==39||su(s,Ko(l,i.getStart()))})(o,r.keyCode)})})(t),Rn(t)||((o,r)=>{o.set({}),r.on("NodeChange",s=>{cv(r,s.element,o.get())}),r.on("FormatApply FormatRemove",s=>{const a=C.from(s.node).map(i=>bi(i)?i:i.startContainer).bind(i=>J(i)?C.some(i):C.from(i.parentElement)).getOrThunk(()=>iv(r));cv(r,a,o.get())})})(n,t),{get:e.get,has:e.has,register:e.register,unregister:e.unregister,apply:(o,r,s)=>{((a,i,l,d)=>{Mt(a).formatter.apply(i,l,d)})(t,o,r,s)},remove:(o,r,s,a)=>{((i,l,d,c,u)=>{Mt(i).formatter.remove(l,d,c,u)})(t,o,r,s,a)},toggle:(o,r,s)=>{((a,i,l,d)=>{Mt(a).formatter.toggle(i,l,d)})(t,o,r,s)},match:(o,r,s,a)=>((i,l,d,c,u)=>Mt(i).formatter.match(l,d,c,u))(t,o,r,s,a),closest:o=>((r,s)=>Mt(r).formatter.closest(s))(t,o),matchAll:(o,r)=>((s,a,i)=>Mt(s).formatter.matchAll(a,i))(t,o,r),matchNode:(o,r,s,a)=>((i,l,d,c,u)=>Mt(i).formatter.matchNode(l,d,c,u))(t,o,r,s,a),canApply:o=>((r,s)=>Mt(r).formatter.canApply(s))(t,o),formatChanged:(o,r,s,a)=>((i,l,d,c,u,g)=>Mt(i).formatter.formatChanged(l,d,c,u,g))(t,n,o,r,s,a),getCssText:tt(gN,t)}},dy=t=>{switch(t.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},cy=t=>{const e=ao(),n=Gt(0),o=Gt(0),r={data:[],typing:!1,beforeChange:()=>{((s,a,i)=>{Mt(s).undoManager.beforeChange(a,i)})(t,n,e)},add:(s,a)=>((i,l,d,c,u,g,p)=>Mt(i).undoManager.add(l,d,c,u,g,p))(t,r,o,n,e,s,a),dispatchChange:()=>{t.setDirty(!0);const s=$i(t);s.bookmark=Md(t.selection),t.dispatch("change",{level:s,lastLevel:Na(r.data,o.get()).getOrUndefined()})},undo:()=>((s,a,i,l)=>Mt(s).undoManager.undo(a,i,l))(t,r,n,o),redo:()=>((s,a,i)=>Mt(s).undoManager.redo(a,i))(t,o,r.data),clear:()=>{((s,a,i)=>{Mt(s).undoManager.clear(a,i)})(t,r,o)},reset:()=>{((s,a)=>{Mt(s).undoManager.reset(a)})(t,r)},hasUndo:()=>((s,a,i)=>Mt(s).undoManager.hasUndo(a,i))(t,r,o),hasRedo:()=>((s,a,i)=>Mt(s).undoManager.hasRedo(a,i))(t,r,o),transact:s=>((a,i,l,d)=>Mt(a).undoManager.transact(i,l,d))(t,r,n,s),ignore:s=>{((a,i,l)=>{Mt(a).undoManager.ignore(i,l)})(t,n,s)},extra:(s,a)=>{((i,l,d,c,u)=>{Mt(i).undoManager.extra(l,d,c,u)})(t,r,o,s,a)}};return Rn(t)||((s,a,i)=>{const l=Gt(!1),d=c=>{Vi(a,!1,i),a.add({},c)};s.on("init",()=>{a.add()}),s.on("BeforeExecCommand",c=>{const u=c.command;dy(u)||(Hv(a,i),a.beforeChange())}),s.on("ExecCommand",c=>{const u=c.command;dy(u)||d(c)}),s.on("ObjectResizeStart cut",()=>{a.beforeChange()}),s.on("SaveContent ObjectResized blur",d),s.on("dragend",d),s.on("keyup",c=>{const u=c.keyCode;c.isDefaultPrevented()||((u>=33&&u<=36||u>=37&&u<=40||u===45||c.ctrlKey)&&(d(),s.nodeChanged()),u!==46&&u!==8||s.nodeChanged(),l.get()&&a.typing&&!Nu($i(s),a.data[0])&&(s.isDirty()||s.setDirty(!0),s.dispatch("TypingUndo"),l.set(!1),s.nodeChanged()))}),s.on("keydown",c=>{const u=c.keyCode;if(c.isDefaultPrevented())return;if(u>=33&&u<=36||u>=37&&u<=40||u===45)return void(a.typing&&d(c));const g=c.ctrlKey&&!c.altKey||c.metaKey;!(u<16||u>20)||u===224||u===91||a.typing||g||(a.beforeChange(),Vi(a,!0,i),a.add({},c),l.set(!0))}),s.on("mousedown",c=>{a.typing&&d(c)}),s.on("input",c=>{var u;c.inputType&&(c.inputType==="insertReplacementText"||(u=c).inputType==="insertText"&&u.data===null||(g=>g.inputType==="insertFromPaste"||g.inputType==="insertFromDrop")(c))&&d(c)}),s.on("AddUndo Undo Redo ClearUndos",c=>{c.isDefaultPrevented()||s.nodeChanged()})})(t,r,n),(s=>{s.addShortcut("meta+z","","Undo"),s.addShortcut("meta+y,meta+shift+z","","Redo")})(t),r},pN=[9,27,ot.HOME,ot.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,ot.DOWN,ot.UP,ot.LEFT,ot.RIGHT].concat(Ct.browser.isFirefox()?[224]:[]),uy="data-mce-placeholder",my=t=>t.type==="keydown"||t.type==="keyup",fy=t=>{const e=t.keyCode;return e===ot.BACKSPACE||e===ot.DELETE},hN=(t,e)=>({from:t,to:e}),Bu=(t,e)=>{const n=N(t),o=N(e.container());return Ti(n,o).map(r=>((s,a)=>({block:s,position:a}))(r,e))},gy=(t,e)=>Bo(e,n=>ws(n)||nn(n.dom),n=>xt(n,t)).filter(Te).getOr(t),py=t=>{const e=(n=>{const o=oe(n);return ns(o,on).fold(Y(o),r=>o.slice(0,r))})(t);return H(e,Tt),e},hy=(t,e)=>{const n=Vn(e,t);return Wt(n.reverse(),o=>Ut(o)).each(Tt)},bN=(t,e,n,o)=>{if(Ut(n))return Io(n),be(n.dom);mt(jf(o),s=>!Ut(s)).length===0&&Ut(e)&&Me(o,Jt("br"));const r=Ue(n.dom,L.before(o.dom));return H(py(e),s=>{Me(o,s)}),hy(t,e),r},vN=(t,e,n)=>{if(Ut(n))return Tt(n),Ut(e)&&Io(e),be(e.dom);const o=Sn(n.dom);return H(py(e),r=>{Kt(n,r)}),hy(t,e),o},by=(t,e)=>{Ar(t,e.dom).bind(n=>C.from(n.getNode())).map(N).filter(Mo).each(Tt)},vy=(t,e,n)=>(by(!0,e),by(!1,n),((o,r)=>Fn(r,o)?((s,a)=>{const i=Vn(a,s);return C.from(i[i.length-1])})(r,o):C.none())(e,n).fold(tt(vN,t,e,n),tt(bN,t,e,n))),yy=(t,e,n,o)=>e?vy(t,o,n):vy(t,n,o),Du=(t,e)=>{const n=N(t.getBody());return((r,s,a)=>a.collapsed?((i,l,d)=>{const c=Bu(i,L.fromRangeStart(d)),u=c.bind(g=>Fe(l,i,g.position).bind(p=>Bu(i,p).map(m=>((h,f,b)=>Ft(b.position.getNode())&&!Ut(b.block)?Ar(!1,b.block.dom).bind(v=>v.isEqual(b.position)?Fe(f,h,v).bind(y=>Bu(h,y)):C.some(b)).getOr(b):b)(i,l,m))));return pe(c,u,hN).filter(g=>(p=>!xt(p.from.block,p.to.block))(g)&&((p,m)=>{const h=N(p);return xt(gy(h,m.from.block),gy(h,m.to.block))})(i,g)&&(p=>Rt(p.from.block.dom)===!1&&Rt(p.to.block.dom)===!1)(g)&&(p=>{const m=h=>hg(h)||Ng(h.dom);return m(p.from.block)&&m(p.to.block)})(g))})(r,s,a):C.none())(n.dom,e,t.selection.getRng()).map(r=>()=>{yy(n,e,r.from.block,r.to.block).each(s=>{t.selection.setRng(s.toRange())})})},Cy=(t,e)=>{const n=N(e),o=tt(xt,t);return to(n,ws,o).isSome()},yN=t=>{const e=N(t.getBody());return((n,o)=>{const r=Ue(n.dom,L.fromRangeStart(o)).isNone(),s=ke(n.dom,L.fromRangeEnd(o)).isNone();return!((a,i)=>Cy(a,i.startContainer)||Cy(a,i.endContainer))(n,o)&&r&&s})(e,t.selection.getRng())?(n=>C.some(()=>{n.setContent(""),n.selection.setCursorLocation()}))(t):((n,o)=>{const r=o.getRng();return pe(Ti(n,N(r.startContainer)),Ti(n,N(r.endContainer)),(s,a)=>xt(s,a)?C.none():C.some(()=>{r.deleteContents(),yy(n,!0,s,a).each(i=>{o.setRng(i.toRange())})})).getOr(C.none())})(e,t.selection)},Pu=(t,e)=>t.selection.isCollapsed()?C.none():yN(t),qn=(t,e,n,o,r)=>C.from(e._selectionOverrides.showCaret(t,n,o,r)),aa=(t,e)=>t.dispatch("BeforeObjectSelected",{target:e}).isDefaultPrevented()?C.none():C.some((n=>{const o=n.ownerDocument.createRange();return o.selectNode(n),o})(e)),Lu=(t,e,n)=>e.collapsed?((o,r,s)=>{const a=Vd(1,o.getBody(),r),i=L.fromRangeStart(a),l=i.getNode();if(Is(l))return qn(1,o,l,!i.isAtEnd(),!1);const d=i.getNode(!0);if(Is(d))return qn(1,o,d,!1,!1);const c=tr(o.dom.getRoot(),i.getNode());return Is(c)?qn(1,o,c,!1,s):C.none()})(t,e,n).getOr(e):e,CN=t=>go(t)||Ys(t),wN=t=>po(t)||Xs(t),wy=(t,e,n,o,r,s)=>{qn(o,t,s.getNode(!r),r,!0).each(a=>{if(e.collapsed){const i=e.cloneRange();r?i.setEnd(a.startContainer,a.startOffset):i.setStart(a.endContainer,a.endOffset),i.deleteContents()}else e.deleteContents();t.selection.setRng(a)}),((a,i)=>{j(i)&&i.data.length===0&&a.remove(i)})(t.dom,n)},Mu=(t,e)=>((n,o)=>{const r=n.selection.getRng();if(!j(r.commonAncestorContainer))return C.none();const s=o?Yt.Forwards:Yt.Backwards,a=kn(n.getBody()),i=tt(qd,o?a.next:a.prev),l=o?CN:wN,d=Hs(s,n.getBody(),r),c=i(d),u=c&&$e(o,c);if(!u||!ci(d,u))return C.none();if(l(u))return C.some(()=>wy(n,r,d.getNode(),s,o,u));const g=i(u);return g&&l(g)&&ci(u,g)?C.some(()=>wy(n,r,d.getNode(),s,o,g)):C.none()})(t,e),Iu=(t,e)=>{const n=t.getBody();return e?be(n).filter(go):Sn(n).filter(po)},Fu=t=>{const e=t.selection.getRng();return!e.collapsed&&(Iu(t,!0).exists(n=>n.isEqual(L.fromRangeStart(e)))||Iu(t,!1).exists(n=>n.isEqual(L.fromRangeEnd(e))))},qe=Cn([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),xy=(t,e,n)=>Fe(e,t,n).bind(o=>{return r=o.getNode(),Q(r)&&(ws(N(r))||Cs(N(r)))||((s,a,i,l)=>{const d=c=>ld(N(c))&&!wn(i,l,s);return ah(!a,i).fold(()=>ah(a,l).fold(Dt,d),d)})(t,e,n,o)?C.none():e&&Rt(o.getNode())||!e&&Rt(o.getNode(!0))?((s,a,i,l)=>{const d=l.getNode(!a);return Ti(N(s),N(i.getNode())).map(c=>Ut(c)?qe.remove(c.dom):qe.moveToElement(d)).orThunk(()=>C.some(qe.moveToElement(d)))})(t,e,n,o):e&&po(n)||!e&&go(n)?C.some(qe.moveToPosition(o)):C.none();var r}),ky=(t,e)=>C.from(tr(t.getBody(),e)),xN=(t,e)=>{const n=t.selection.getNode();return ky(t,n).filter(Rt).fold(()=>((o,r,s)=>{const a=Vd(r?1:-1,o,s),i=L.fromRangeStart(a),l=N(o);return!r&&po(i)?C.some(qe.remove(i.getNode(!0))):r&&go(i)?C.some(qe.remove(i.getNode())):!r&&go(i)&&Tc(l,i)?FE(l,i).map(d=>qe.remove(d.getNode())):r&&po(i)&&Oc(l,i)?UE(l,i).map(d=>qe.remove(d.getNode())):((d,c,u)=>((g,p)=>{const m=p.getNode(!g),h=g?"after":"before";return J(m)&&m.getAttribute("data-mce-caret")===h})(c,u)?((g,p)=>jt(p)?C.none():g&&Rt(p.nextSibling)?C.some(qe.moveToElement(p.nextSibling)):!g&&Rt(p.previousSibling)?C.some(qe.moveToElement(p.previousSibling)):C.none())(c,u.getNode(!c)).orThunk(()=>xy(d,c,u)):xy(d,c,u).bind(g=>((p,m,h)=>h.fold(f=>C.some(qe.remove(f)),f=>C.some(qe.moveToElement(f)),f=>wn(m,f,p)?C.none():C.some(qe.moveToPosition(f))))(d,u,g)))(o,r,i)})(t.getBody(),e,t.selection.getRng()).map(o=>()=>o.fold(((r,s)=>a=>(r._selectionOverrides.hideFakeCaret(),Jo(r,s,N(a)),!0))(t,e),((r,s)=>a=>{const i=s?L.before(a):L.after(a);return r.selection.setRng(i.toRange()),!0})(t,e),(r=>s=>(r.selection.setRng(s.toRange()),!0))(t))),()=>C.some(bt))},Sy=t=>{const e=t.dom,n=t.selection,o=tr(t.getBody(),n.getNode());if(nn(o)&&e.isBlock(o)&&e.isEmpty(o)){const r=e.create("br",{"data-mce-bogus":"1"});e.setHTML(o,""),o.appendChild(r),n.setRng(L.before(r).toRange())}return!0},Uu=(t,e)=>t.selection.isCollapsed()?xN(t,e):((n,o)=>{const r=n.selection.getNode();return Rt(r)&&!$a(r)?ky(n,r.parentNode).filter(Rt).fold(()=>C.some(()=>{var s;s=N(n.getBody()),H(le(s,".mce-offscreen-selection"),Tt),Jo(n,o,N(n.selection.getNode())),Mc(n)}),()=>C.some(bt)):Fu(n)?C.some(()=>{u0(n,n.selection.getRng(),N(n.getBody()))}):C.none()})(t,e),zu=(t,e)=>t.selection.isCollapsed()?((n,o)=>{const r=L.fromRangeStart(n.selection.getRng());return Fe(o,n.getBody(),r).filter(s=>o?DE(s):PE(s)).bind(s=>$d(o?0:-1,s)).map(s=>()=>n.selection.select(s))})(t,e):C.none(),jr=j,Ey=t=>jr(t)&&t.data[0]===ae,_y=t=>jr(t)&&t.data[t.data.length-1]===ae,Ny=t=>{var e;return((e=t.ownerDocument)!==null&&e!==void 0?e:document).createTextNode(ae)},Qi=(t,e)=>t?(n=>{var o;if(jr(n.previousSibling))return _y(n.previousSibling)||n.previousSibling.appendData(ae),n.previousSibling;if(jr(n))return Ey(n)||n.insertData(0,ae),n;{const r=Ny(n);return(o=n.parentNode)===null||o===void 0||o.insertBefore(r,n),r}})(e):(n=>{var o,r;if(jr(n.nextSibling))return Ey(n.nextSibling)||n.nextSibling.insertData(0,ae),n.nextSibling;if(jr(n))return _y(n)||n.appendData(ae),n;{const s=Ny(n);return n.nextSibling?(o=n.parentNode)===null||o===void 0||o.insertBefore(s,n.nextSibling):(r=n.parentNode)===null||r===void 0||r.appendChild(s),s}})(e),kN=tt(Qi,!0),SN=tt(Qi,!1),Ry=(t,e)=>j(t.container())?Qi(e,t.container()):Qi(e,t.getNode()),Ay=(t,e)=>{const n=e.get();return n&&t.container()===n&&oo(n)},ju=(t,e)=>e.fold(n=>{qo(t.get());const o=kN(n);return t.set(o),C.some(L(o,o.length-1))},n=>be(n).map(o=>{if(Ay(o,t)){const r=t.get();return L(r,1)}{qo(t.get());const r=Ry(o,!0);return t.set(r),L(r,1)}}),n=>Sn(n).map(o=>{if(Ay(o,t)){const r=t.get();return L(r,r.length-1)}{qo(t.get());const r=Ry(o,!1);return t.set(r),L(r,r.length-1)}}),n=>{qo(t.get());const o=SN(n);return t.set(o),C.some(L(o,1))}),Oy=(t,e)=>{for(let n=0;n<t.length;n++){const o=t[n].apply(null,e);if(o.isSome())return o}return C.none()},ce=Cn([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),Ty=(t,e)=>co(e,t)||t,EN=(t,e,n)=>{const o=a0(n),r=Ty(e,o.container());return ho(t,r,o).fold(()=>ke(r,o).bind(tt(ho,t,r)).map(s=>ce.before(s)),C.none)},_N=(t,e)=>Ko(t,e)===null,By=(t,e,n)=>ho(t,e,n).filter(tt(_N,e)),NN=(t,e,n)=>{const o=i0(n);return By(t,e,o).bind(r=>Ue(r,o).isNone()?C.some(ce.start(r)):C.none())},RN=(t,e,n)=>{const o=a0(n);return By(t,e,o).bind(r=>ke(r,o).isNone()?C.some(ce.end(r)):C.none())},AN=(t,e,n)=>{const o=i0(n),r=Ty(e,o.container());return ho(t,r,o).fold(()=>Ue(r,o).bind(tt(ho,t,r)).map(s=>ce.after(s)),C.none)},Dy=t=>{return e=Hu(t),!(Et.DOM.getStyle(e,"direction",!0)==="rtl"||(o=>qE.test(o))((n=e.textContent)!==null&&n!==void 0?n:""));var e,n},An=(t,e,n)=>Oy([EN,NN,RN,AN],[t,e,n]).filter(Dy),Hu=t=>t.fold(ge,ge,ge,ge),Py=t=>t.fold(Y("before"),Y("start"),Y("end"),Y("after")),Ji=t=>t.fold(ce.before,ce.before,ce.after,ce.after),$u=t=>t.fold(ce.start,ce.start,ce.end,ce.end),ON=(t,e,n,o,r,s)=>pe(ho(e,n,o),ho(e,n,r),(a,i)=>a!==i&&((l,d,c)=>{const u=co(d,l),g=co(c,l);return Q(u)&&u===g})(n,a,i)?ce.after(t?a:i):s).getOr(s),TN=(t,e)=>t.fold(Ht,n=>{return r=e,!(Py(o=n)===Py(r)&&Hu(o)===Hu(r));var o,r}),BN=(t,e)=>t?e.fold(ko(C.some,ce.start),C.none,ko(C.some,ce.after),C.none):e.fold(C.none,ko(C.some,ce.before),C.none,ko(C.some,ce.end)),Ly=(t,e,n)=>{const o=t?1:-1;return e.setRng(L(n.container(),n.offset()+o).toRange()),e.getSel().modify("move",t?"forward":"backward","word"),!0};var On;(function(t){t[t.Br=0]="Br",t[t.Block=1]="Block",t[t.Wrap=2]="Wrap",t[t.Eol=3]="Eol"})(On||(On={}));const Zi=(t,e)=>t===Yt.Backwards?os(e):e,DN=(t,e,n)=>t===Yt.Forwards?e.next(n):e.prev(n),PN=(t,e,n,o)=>Ft(o.getNode(e===Yt.Forwards))?On.Br:wn(n,o)===!1?On.Block:On.Wrap,My=(t,e,n,o)=>{const r=kn(n);let s=o;const a=[];for(;s;){const i=DN(e,r,s);if(!i)break;if(Ft(i.getNode(!1)))return e===Yt.Forwards?{positions:Zi(e,a).concat([i]),breakType:On.Br,breakAt:C.some(i)}:{positions:Zi(e,a),breakType:On.Br,breakAt:C.some(i)};if(i.isVisible()){if(t(s,i)){const l=PN(0,e,s,i);return{positions:Zi(e,a),breakType:l,breakAt:C.some(i)}}a.push(i),s=i}else s=i}return{positions:Zi(e,a),breakType:On.Eol,breakAt:C.none()}},Iy=(t,e,n,o)=>e(n,o).breakAt.map(r=>{const s=e(n,r).positions;return t===Yt.Backwards?s.concat(r):[r].concat(s)}).getOr([]),Vu=(t,e)=>Re(t,(n,o)=>n.fold(()=>C.some(o),r=>pe(xe(r.getClientRects()),xe(o.getClientRects()),(s,a)=>{const i=Math.abs(e-s.left);return Math.abs(e-a.left)<=i?o:r}).or(n)),C.none()),tl=(t,e)=>xe(e.getClientRects()).bind(n=>Vu(t,n.left)),ia=tt(My,L.isAbove,-1),la=tt(My,L.isBelow,1),Fy=tt(Iy,-1,ia),Uy=tt(Iy,1,la),LN=(t,e)=>tl(Fy(t,e),e),MN=(t,e)=>tl(Uy(t,e),e),IN=Rt,zy=(t,e)=>Math.abs(t.left-e),jy=(t,e)=>Math.abs(t.right-e),Hy=(t,e)=>Oa(t,(n,o)=>{const r=Math.min(zy(n,e),jy(n,e)),s=Math.min(zy(o,e),jy(o,e));return s===r&&fr(o,"node")&&IN(o.node)||s<r?o:n}),FN=t=>{const e=n=>yt(n,o=>{const r=$o(o);return r.node=t,r});if(J(t))return e(t.getClientRects());if(j(t)){const n=t.ownerDocument.createRange();return n.setStart(t,0),n.setEnd(t,t.data.length),e(n.getClientRects())}return[]},$y=t=>Ln(t,FN);var da;(function(t){t[t.Up=-1]="Up",t[t.Down=1]="Down"})(da||(da={}));const Vy=(t,e,n,o,r,s)=>{let a=0;const i=[],l=u=>{let g=$y([u]);t===-1&&(g=g.reverse());for(let p=0;p<g.length;p++){const m=g[p];if(!n(m,d)){if(i.length>0&&e(m,_o(i))&&a++,m.line=a,r(m))return!0;i.push(m)}}return!1},d=_o(s.getClientRects());if(!d)return i;const c=s.getNode();return c&&(l(c),((u,g,p,m)=>{let h=m;for(;h=Us(h,u,wg,g);)if(p(h))return})(t,o,l,c)),i},UN=tt(Vy,da.Up,Ts,Bs),zN=tt(Vy,da.Down,Bs,Ts),qy=t=>_o(t.getClientRects()),Wy=t=>e=>((n,o)=>o.line>n)(t,e),qu=t=>e=>((n,o)=>o.line===n)(t,e),Wn=(t,e)=>{t.selection.setRng(e),Gs(t,t.selection.getRng())},Wu=(t,e,n)=>C.some(Lu(t,e,n)),Ky=(t,e,n,o,r,s)=>{const a=e===Yt.Forwards,i=kn(t.getBody()),l=tt(qd,a?i.next:i.prev),d=a?o:r;if(!n.collapsed){const m=ni(n);if(s(m))return qn(e,t,m,e===Yt.Backwards,!1);if(Fu(t)){const h=n.cloneRange();return h.collapse(e===Yt.Backwards),C.from(h)}}const c=Hs(e,t.getBody(),n);if(d(c))return aa(t,c.getNode(!a));let u=l(c);const g=vg(n);if(!u)return g?C.some(n):C.none();if(u=$e(a,u),d(u))return qn(e,t,u.getNode(!a),a,!1);const p=l(u);return p&&d(p)&&ci(u,p)?qn(e,t,p.getNode(!a),a,!1):g?Wu(t,u.toRange(),!1):C.none()},Gy=(t,e,n,o,r,s)=>{const a=Hs(e,t.getBody(),n),i=_o(a.getClientRects()),l=e===da.Down,d=t.getBody();if(!i)return C.none();if(Fu(t)){const h=l?L.fromRangeEnd(n):L.fromRangeStart(n);return(l?MN:LN)(d,h).orThunk(()=>C.from(h)).map(f=>f.toRange())}const c=(l?zN:UN)(d,Wy(1),a),u=mt(c,qu(1)),g=i.left,p=Hy(u,g);if(p&&s(p.node)){const h=Math.abs(g-p.left),f=Math.abs(g-p.right);return qn(e,t,p.node,h<f,!1)}let m;if(m=o(a)?a.getNode():r(a)?a.getNode(!0):ni(n),m){const h=((b,v,y,w)=>{const k=kn(v);let x,E,S,_;const O=[];let T=0;b===1?(x=k.next,E=Bs,S=Ts,_=L.after(w)):(x=k.prev,E=Ts,S=Bs,_=L.before(w));const P=qy(_);do{if(!_.isVisible())continue;const D=qy(_);if(S(D,P))continue;O.length>0&&E(D,_o(O))&&T++;const I=$o(D);if(I.position=_,I.line=T,y(I))return O;O.push(I)}while(_=x(_));return O})(e,d,Wy(1),m);let f=Hy(mt(h,qu(1)),g);if(f||(f=_o(mt(h,qu(0))),f))return Wu(t,f.position.toRange(),!1)}return u.length===0?Ku(t,l).filter(l?r:o).map(h=>Lu(t,h.toRange(),!1)):C.none()},Ku=(t,e)=>{const n=t.selection.getRng(),o=e?L.fromRangeEnd(n):L.fromRangeStart(n),r=(s=o.container(),a=t.getBody(),to(N(s),i=>jS(i.dom),i=>i.dom===a).map(i=>i.dom).getOr(a));var s,a;if(e){const i=la(r,o);return Eo(i.positions)}{const i=ia(r,o);return xe(i.positions)}},Yy=(t,e,n)=>Ku(t,e).filter(n).exists(o=>(t.selection.setRng(o.toRange()),!0)),el=(t,e)=>{const n=t.dom.createRng();n.setStart(e.container(),e.offset()),n.setEnd(e.container(),e.offset()),t.selection.setRng(n)},Xy=(t,e)=>{t?e.setAttribute("data-mce-selected","inline-boundary"):e.removeAttribute("data-mce-selected")},Qy=(t,e,n)=>ju(e,n).map(o=>(el(t,o),n)),jN=(t,e,n)=>{const o=t.getBody(),r=((s,a,i)=>{const l=L.fromRangeStart(s);if(s.collapsed)return l;{const d=L.fromRangeEnd(s);return i?Ue(a,d).getOr(d):ke(a,l).getOr(l)}})(t.selection.getRng(),o,n);return((s,a,i,l)=>{const d=$e(s,l),c=An(a,i,d);return An(a,i,d).bind(tt(BN,s)).orThunk(()=>((u,g,p,m,h)=>{const f=$e(u,h);return Fe(u,p,f).map(tt($e,u)).fold(()=>m.map(Ji),b=>An(g,p,b).map(tt(ON,u,g,p,f,b)).filter(tt(TN,m))).filter(Dy)})(s,a,i,c,l))})(n,tt(Zo,t),o,r).bind(s=>Qy(t,e,s))},Jy=(t,e,n)=>!!Ms(t)&&jN(t,e,n).isSome(),Zy=(t,e,n)=>!!Ms(e)&&((o,r)=>{const s=r.selection.getRng(),a=o?L.fromRangeEnd(s):L.fromRangeStart(s);return!!(i=>wt(i.selection.getSel().modify))(r)&&(o&&ud(a)?Ly(!0,r.selection,a):!(o||!md(a))&&Ly(!1,r.selection,a))})(t,e),HN=t=>{const e=Gt(null),n=tt(Zo,t);return t.on("NodeChange",o=>{Ms(t)&&(((r,s,a)=>{const i=yt(le(N(s.getRoot()),'*[data-mce-selected="inline-boundary"]'),c=>c.dom),l=mt(i,r),d=mt(a,r);H(Ul(l,d),tt(Xy,!1)),H(Ul(d,l),tt(Xy,!0))})(n,t.dom,o.parents),((r,s)=>{const a=s.get();if(r.selection.isCollapsed()&&!r.composing&&a){const i=L.fromRangeStart(r.selection.getRng());L.isTextPosition(i)&&!(l=>ud(l)||md(l))(i)&&(el(r,MS(a,i)),s.set(null))}})(t,e),((r,s,a,i)=>{if(s.selection.isCollapsed()){const l=mt(i,r);H(l,d=>{const c=L.fromRangeStart(s.selection.getRng());An(r,s.getBody(),c).bind(u=>Qy(s,a,u))})}})(n,t,e,o.parents))}),e},$N=tt(Zy,!0),VN=tt(Zy,!1),nl=(t,e,n)=>{if(Ms(t)){const o=Ku(t,e).getOrThunk(()=>{const r=t.selection.getRng();return e?L.fromRangeEnd(r):L.fromRangeStart(r)});return An(tt(Zo,t),t.getBody(),o).exists(r=>{const s=Ji(r);return ju(n,s).exists(a=>(el(t,a),!0))})}return!1},tC=(t,e)=>n=>ju(e,n).map(o=>()=>el(t,o)),eC=(t,e,n,o)=>{const r=t.getBody(),s=tt(Zo,t);t.undoManager.ignore(()=>{t.selection.setRng(((a,i)=>{const l=document.createRange();return l.setStart(a.container(),a.offset()),l.setEnd(i.container(),i.offset()),l})(n,o)),d0(t),An(s,r,L.fromRangeStart(t.selection.getRng())).map($u).bind(tC(t,e)).each(ts)}),t.nodeChanged()},Gu=(t,e,n)=>{if(t.selection.isCollapsed()&&Ms(t)){const o=L.fromRangeStart(t.selection.getRng());return((r,s,a,i)=>{const l=((u,g)=>co(g,u)||u)(r.getBody(),i.container()),d=tt(Zo,r),c=An(d,l,i);return c.bind(u=>a?u.fold(Y(C.some($u(u))),C.none,Y(C.some(Ji(u))),C.none):u.fold(C.none,Y(C.some(Ji(u))),C.none,Y(C.some($u(u))))).map(tC(r,s)).getOrThunk(()=>{const u=mi(a,l,i),g=u.bind(p=>An(d,l,p));return pe(c,g,()=>ho(d,l,i).bind(p=>(m=>pe(be(m),Sn(m),(h,f)=>{const b=$e(!0,h),v=$e(!1,f);return ke(m,b).forall(y=>y.isEqual(v))}).getOr(!0))(p)?C.some(()=>{Jo(r,a,N(p))}):C.none())).getOrThunk(()=>g.bind(()=>u.map(p=>()=>{a?eC(r,s,i,p):eC(r,s,p,i)})))})})(t,e,n,o)}return C.none()},qN=t=>Vf(t)===1,WN=(t,e)=>{const n=N(t.getBody()),o=N(t.selection.getStart()),r=mt(((s,a)=>{const i=Vn(a,s);return ns(i,on).fold(Y(i),l=>i.slice(0,l))})(n,o),qN);return Eo(r).bind(s=>{const a=L.fromRangeStart(t.selection.getRng());return!((l,d,c)=>pe(be(c),Sn(c),(u,g)=>{const p=$e(!0,u),m=$e(!1,g),h=$e(!1,d);return l?ke(c,h).exists(f=>f.isEqual(m)&&d.isEqual(p)):Ue(c,h).exists(f=>f.isEqual(p)&&d.isEqual(m))}).getOr(!0))(e,a,s.dom)||an((i=s).dom)&&T0(i.dom)?C.none():C.some(()=>((l,d,c,u)=>{const g=tt(a_,d),p=yt(mt(u,g),m=>m.dom);if(p.length===0)Jo(d,l,c);else{const m=((h,f)=>{const b=ou(!1),v=P0(f,b.dom);return Me(N(h),b),Tt(N(h)),L(v,0)})(c.dom,p);d.selection.setRng(m.toRange())}})(e,t,s,r));var i})},Yu=(t,e)=>t.selection.isCollapsed()?WN(t,e):C.none(),Xu=(t,e,n)=>Q(n)?C.some(()=>{t._selectionOverrides.hideFakeCaret(),Jo(t,e,N(n))}):C.none(),Qu=(t,e)=>t.selection.isCollapsed()?((n,o)=>{const r=o?Ys:Xs,s=o?Yt.Forwards:Yt.Backwards,a=Hs(s,n.getBody(),n.selection.getRng());return r(a)?Xu(n,o,a.getNode(!o)):C.from($e(o,a)).filter(i=>r(i)&&ci(a,i)).bind(i=>Xu(n,o,i.getNode(!o)))})(t,e):((n,o)=>{const r=n.selection.getNode();return yn(r)?Xu(n,o,r):C.none()})(t,e),Ju=t=>Ta(t!=null?t:"").getOr(0),nC=(t,e)=>(t||Ot(e)==="table"?"margin":"padding")+(vn(e,"direction")==="rtl"?"-right":"-left"),oC=t=>{const e=sC(t);return!t.mode.isReadOnly()&&(e.length>1||((n,o)=>So(o,r=>{const s=nC(Up(n),r),a=Fa(r,s).map(Ju).getOr(0);return n.dom.getContentEditable(r.dom)!=="false"&&a>0}))(t,e))},rC=t=>dd(t)||Cs(t),sC=t=>mt(Zf(t.selection.getSelectedBlocks()),e=>!rC(e)&&!(n=>tn(n).exists(rC))(e)&&Bo(e,n=>nn(n.dom)||Rt(n.dom)).exists(n=>nn(n.dom))),aC=(t,e)=>{var n,o;const{dom:r}=t,s=jk(t),a=(o=(n=/[a-z%]+$/i.exec(s))===null||n===void 0?void 0:n[0])!==null&&o!==void 0?o:"px",i=Ju(s),l=Up(t);H(sC(t),d=>{((c,u,g,p,m,h)=>{const f=nC(g,N(h)),b=Ju(c.getStyle(h,f));if(u==="outdent"){const v=Math.max(0,b-p);c.setStyle(h,f,v?v+m:"")}else{const v=b+p+m;c.setStyle(h,f,v)}})(r,e,l,i,a,d.dom)})},iC=t=>aC(t,"outdent"),lC=t=>{if(t.selection.isCollapsed()&&oC(t)){const e=t.dom,n=t.selection.getRng(),o=L.fromRangeStart(n),r=e.getParent(n.startContainer,e.isBlock);if(r!==null&&Ac(N(r),o))return C.some(()=>iC(t))}return C.none()},dC=(t,e,n)=>mr([lC,Uu,Mu,(o,r)=>Gu(o,e,r),Du,Vc,zu,Qu,Pu,Yu],o=>o(t,n)),KN=(t,e)=>{t.addCommand("delete",()=>{((n,o)=>{dC(n,o,!1).fold(()=>{d0(n),Mc(n)},ts)})(t,e)}),t.addCommand("forwardDelete",()=>{((n,o)=>{dC(n,o,!0).fold(()=>(r=>l0(r,"ForwardDelete"))(n),ts)})(t,e)})},cC=t=>t.touches===void 0||t.touches.length!==1?C.none():C.some(t.touches[0]),Zu=(t,e)=>pt(t,e.nodeName),GN=(t,e)=>!!j(e)||!!J(e)&&!Zu(t.getBlockElements(),e)&&!ze(e)&&!ks(t,e),YN=(t,e)=>!!(j(e)&&(e.data.length===0||/^\s+$/.test(e.data)&&(!e.nextSibling||Zu(t,e.nextSibling)))),uC=t=>t.dom.create(Be(t),Ls(t)),XN=t=>{const e=t.dom,n=t.selection,o=t.schema,r=o.getBlockElements(),s=n.getStart(),a=t.getBody();let i,l,d=!1;const c=Be(t);if(!s||!J(s))return;const u=a.nodeName.toLowerCase();if(!o.isValidChild(u,c.toLowerCase())||((y,w,k)=>It(Hb(N(k),N(w)),x=>Zu(y,x.dom)))(r,a,s))return;const g=n.getRng(),{startContainer:p,startOffset:m,endContainer:h,endOffset:f}=g,b=Qo(t);let v=a.firstChild;for(;v;)if(J(v)&&Jx(o,v),GN(o,v)){if(YN(r,v)){l=v,v=v.nextSibling,e.remove(l);continue}i||(i=uC(t),a.insertBefore(i,v),d=!0),l=v,v=v.nextSibling,i.appendChild(l)}else i=null,v=v.nextSibling;d&&b&&(g.setStart(p,m),g.setEnd(h,f),n.setRng(g),t.nodeChanged())},mC=(t,e,n)=>{const o=N(uC(t)),r=cd();Kt(o,r),n(e,o);const s=document.createRange();return s.setStartBefore(r.dom),s.setEndBefore(r.dom),s},fC=t=>e=>(" "+e.attr("class")+" ").indexOf(t)!==-1,QN=(t,e,n)=>function(o){const r=arguments,s=r[r.length-2],a=s>0?e.charAt(s-1):"";if(a==='"')return o;if(a===">"){const i=e.lastIndexOf("<",s);if(i!==-1&&e.substring(i,s).indexOf('contenteditable="false"')!==-1)return o}return'<span class="'+n+'" data-mce-content="'+t.dom.encode(r[0])+'">'+t.dom.encode(typeof r[1]=="string"?r[1]:r[0])+"</span>"},gC=(t,e)=>{e.hasAttribute("data-mce-caret")&&(fd(e),t.selection.setRng(t.selection.getRng()),t.selection.scrollIntoView(e))},JN=(t,e)=>{const n=(o=>bs(N(o.getBody()),"*[data-mce-caret]").map(r=>r.dom).getOrNull())(t);if(n)return e.type==="compositionstart"?(e.preventDefault(),e.stopPropagation(),void gC(t,n)):void(bg(n)&&(gC(t,n),t.undoManager.add()))},pC=Rt,hC=(t,e,n)=>{const o=kn(t.getBody()),r=tt(qd,e===1?o.next:o.prev);if(n.collapsed){const s=t.dom.getParent(n.startContainer,"PRE");if(!s)return;if(!r(L.fromRangeStart(n))){const a=N((i=>{const l=i.dom.create(Be(i));return l.innerHTML='<br data-mce-bogus="1">',l})(t));e===1?Jn(N(s),a):Me(N(s),a),t.selection.select(a.dom,!0),t.selection.collapse()}}},bC=(t,e)=>((n,o)=>{const r=o?Yt.Forwards:Yt.Backwards,s=n.selection.getRng();return((a,i,l)=>Ky(i,a,l,go,po,pC))(r,n,s).orThunk(()=>(hC(n,r,s),C.none()))})(t,e).exists(n=>(Wn(t,n),!0)),vC=(t,e)=>((n,o)=>{const r=o?1:-1,s=n.selection.getRng();return((a,i,l)=>Gy(i,a,l,d=>go(d)||zb(d),d=>po(d)||jb(d),pC))(r,n,s).orThunk(()=>(hC(n,r,s),C.none()))})(t,e).exists(n=>(Wn(t,n),!0)),yC=(t,e)=>Yy(t,e,e?po:go),ol=(t,e)=>Iu(t,!e).map(n=>{const o=n.toRange(),r=t.selection.getRng();return e?o.setStart(r.startContainer,r.startOffset):o.setEnd(r.endContainer,r.endOffset),o}).exists(n=>(Wn(t,n),!0)),ZN=t=>_t(["figcaption"],Ot(t)),tR=(t,e)=>{const n=N(t.getBody()),o=L.fromRangeStart(t.selection.getRng());return((r,s)=>{const a=tt(xt,s);return Bo(N(r.container()),on,a).filter(ZN)})(o,n).exists(()=>{if(((r,s,a)=>s?((i,l)=>la(i,l).breakAt.isNone())(r.dom,a):((i,l)=>ia(i,l).breakAt.isNone())(r.dom,a))(n,e,o)){const r=mC(t,n,e?Kt:Jf);return t.selection.setRng(r),!0}return!1})},CC=(t,e)=>!!t.selection.isCollapsed()&&tR(t,e),wC={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},xC=(t,e)=>e.keyCode===t.keyCode&&e.shiftKey===t.shiftKey&&e.altKey===t.altKey&&e.ctrlKey===t.ctrlKey&&e.metaKey===t.metaKey,ht=(t,...e)=>()=>t.apply(null,e),ca=(t,e)=>Wt(((n,o)=>Ln((r=>yt(r,s=>K(K({},wC),s)))(n),r=>xC(r,o)?[r]:[]))(t,e),n=>n.action()),kC=(t,e)=>mr(((n,o)=>Ln((r=>yt(r,s=>K(K({},wC),s)))(n),r=>xC(r,o)?[r]:[]))(t,e),n=>n.action()),SC=(t,e)=>{const n=e?Yt.Forwards:Yt.Backwards,o=t.selection.getRng();return Ky(t,n,o,Ys,Xs,yn).exists(r=>(Wn(t,r),!0))},EC=(t,e)=>{const n=e?1:-1,o=t.selection.getRng();return Gy(t,n,o,Ys,Xs,yn).exists(r=>(Wn(t,r),!0))},_C=(t,e)=>Yy(t,e,e?Xs:Ys),NC=Cn([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),ua=K(K({},NC),{none:t=>NC.none(t)}),RC=(t,e,n)=>Ln(oe(t),o=>Ze(o,e)?n(o)?[o]:[]:RC(o,e,n)),AC=(t,e)=>Do(t,"table",e),tm=(t,e,n,o,r=Ht)=>{const s=o===1;if(!s&&n<=0)return ua.first(t[0]);if(s&&n>=t.length-1)return ua.last(t[t.length-1]);{const a=n+o,i=t[a];return r(i)?ua.middle(e,i):tm(t,e,a,o,r)}},OC=(t,e)=>AC(t,e).bind(n=>{const o=RC(n,"th,td",Ht);return ns(o,r=>xt(t,r)).map(r=>({index:r,all:o}))}),TC=(t,e=!1)=>{return br(t)?t.dom.isContentEditable:(n=t,Do(n,"[contenteditable]")).fold(Y(e),o=>eR(o)==="true");var n},eR=t=>t.dom.contentEditable,BC=(t,e,n,o,r)=>{const s=le(N(n),"td,th,caption").map(i=>i.dom),a=mt(((i,l)=>Ln(l,d=>{const c=((u,g)=>({left:u.left-g,top:u.top-g,right:u.right+-2,bottom:u.bottom+-2,width:u.width+g,height:u.height+g}))($o(d.getBoundingClientRect()),-1);return[{x:c.left,y:i(c),cell:d},{x:c.right,y:i(c),cell:d}]}))(t,s),i=>e(i,r));return((i,l,d)=>Re(i,(c,u)=>c.fold(()=>C.some(u),g=>{const p=Math.sqrt(Math.abs(g.x-l)+Math.abs(g.y-d)),m=Math.sqrt(Math.abs(u.x-l)+Math.abs(u.y-d));return C.some(m<p?u:g)}),C.none()))(a,o,r).map(i=>i.cell)},nR=tt(BC,t=>t.bottom,(t,e)=>t.y<e),oR=tt(BC,t=>t.top,(t,e)=>t.y>e),DC=(t,e,n)=>{const o=t(e,n);return(r=>r.breakType===On.Wrap&&r.positions.length===0)(o)||!Ft(n.getNode())&&(r=>r.breakType===On.Br&&r.positions.length===1)(o)?!((r,s,a)=>a.breakAt.exists(i=>r(s,i).breakAt.isSome()))(t,e,o):o.breakAt.isNone()},rR=tt(DC,ia),sR=tt(DC,la),aR=(t,e,n,o)=>{const r=t.selection.getRng(),s=e?1:-1;return!(!th()||!((a,i,l)=>{const d=L.fromRangeStart(i);return Ar(!a,l).exists(c=>c.isEqual(d))})(e,r,n)||(qn(s,t,n,!e,!1).each(a=>{Wn(t,a)}),0))},PC=(t,e,n)=>{const o=((s,a)=>{const i=a.getNode(s);return zn(i)?C.some(i):C.none()})(!!e,n),r=e===!1;o.fold(()=>Wn(t,n.toRange()),s=>Ar(r,t.getBody()).filter(a=>a.isEqual(n)).fold(()=>Wn(t,n.toRange()),a=>((i,l,d)=>{l.undoManager.transact(()=>{const c=i?Jn:Me,u=mC(l,N(d),c);Wn(l,u)})})(e,t,s)))},iR=(t,e,n,o)=>{const r=t.selection.getRng(),s=L.fromRangeStart(r),a=t.getBody();if(!e&&rR(o,s)){const i=((l,d,c)=>((u,g)=>xe(g.getClientRects()).bind(p=>nR(u,p.left,p.top)).bind(p=>{return tl(Sn(m=p).map(h=>ia(m,h).positions.concat(h)).getOr([]),g);var m}))(d,c).orThunk(()=>xe(c.getClientRects()).bind(u=>Vu(Fy(l,L.before(d)),u.left))).getOr(L.before(d)))(a,n,s);return PC(t,e,i),!0}if(e&&sR(o,s)){const i=((l,d,c)=>((u,g)=>Eo(g.getClientRects()).bind(p=>oR(u,p.left,p.top)).bind(p=>{return tl(be(m=p).map(h=>[h].concat(la(m,h).positions)).getOr([]),g);var m}))(d,c).orThunk(()=>xe(c.getClientRects()).bind(u=>Vu(Uy(l,L.after(d)),u.left))).getOr(L.after(d)))(a,n,s);return PC(t,e,i),!0}return!1},LC=(t,e,n)=>C.from(t.dom.getParent(t.selection.getNode(),"td,th")).bind(o=>C.from(t.dom.getParent(o,"table")).map(r=>n(t,e,r,o))).getOr(!1),MC=(t,e)=>LC(t,e,aR),IC=(t,e)=>LC(t,e,iR),FC=(t,e,n)=>n.fold(C.none,C.none,(o,r)=>{return(s=r,((a,i)=>{const l=d=>{for(let c=0;c<d.childNodes.length;c++){const u=N(d.childNodes[c]);if(i(u))return C.some(u);const g=l(d.childNodes[c]);if(g.isSome())return g}return C.none()};return l(a.dom)})(s,Eb)).map(a=>(i=>{const l=Pr.exact(i,0,i,0);return lE(l)})(a));var s},o=>(t.execCommand("mceTableInsertRowAfter"),UC(t,e,o))),UC=(t,e,n)=>{return FC(t,e,(r=TC,OC(o=n,void 0).fold(()=>ua.none(o),s=>tm(s.all,o,s.index,1,r))));var o,r},lR=(t,e,n)=>{return FC(t,e,(r=TC,OC(o=n,void 0).fold(()=>ua.none(),s=>tm(s.all,o,s.index,-1,r))));var o,r},zC=(t,e)=>{const n=["table","li","dl"],o=N(t.getBody()),r=a=>{const i=Ot(a);return xt(a,o)||_t(n,i)},s=t.selection.getRng();return((a,i)=>((l,d,c=Dt)=>c(d)?C.none():_t(l,Ot(d))?C.some(d):hs(d,l.join(","),u=>Ze(u,"table")||c(u)))(["td","th"],a,i))(N(e?s.endContainer:s.startContainer),r).map(a=>(AC(a,r).each(i=>{t.model.table.clearSelectedCells(i.dom)}),t.selection.collapse(!e),(e?UC:lR)(t,r,a).each(i=>{t.selection.setRng(i)}),!0)).getOr(!1)},un=(t,e)=>({container:t,offset:e}),rl=Et.DOM,sl=t=>e=>t===e?-1:0,em=(t,e,n)=>{if(j(t)&&e>=0)return C.some(un(t,e));{const o=Ho(rl);return C.from(o.backwards(t,e,sl(t),n)).map(r=>un(r.container,r.container.data.length))}},nm=(t,e,n)=>{if(!j(t))return C.none();const o=t.data;if(e>=0&&e<=o.length)return C.some(un(t,e));{const r=Ho(rl);return C.from(r.backwards(t,e,sl(t),n)).bind(s=>{const a=s.container.data;return nm(s.container,e+a.length,n)})}},jC=(t,e,n)=>{if(!j(t))return C.none();const o=t.data;if(e<=o.length)return C.some(un(t,e));{const r=Ho(rl);return C.from(r.forwards(t,e,sl(t),n)).bind(s=>jC(s.container,e-o.length,n))}},om=(t,e,n,o,r)=>{const s=Ho(t,(a=>i=>a.isBlock(i)||_t(["BR","IMG","HR","INPUT"],i.nodeName)||a.getContentEditable(i)==="false")(t));return C.from(s.backwards(e,n,o,r))},HC=t=>jn(t.toString().replace(/\u00A0/g," ")),$C=t=>t!==""&&` \xA0\f
\r	\v`.indexOf(t)!==-1,rm=(t,e)=>t.substring(e.length),VC=(t,e,n,o=0)=>{return(r=N(e.startContainer),Do(r,_b)).fold(()=>((s,a,i,l=0)=>{if(!(d=a).collapsed||!j(d.startContainer))return C.none();var d;const c={text:"",offset:0},u=s.getParent(a.startContainer,s.isBlock)||s.getRoot();return om(s,a.startContainer,a.startOffset,(g,p,m)=>(c.text=m+c.text,c.offset+=p,((h,f,b)=>{let v;const y=b.charAt(0);for(v=f-1;v>=0;v--){const w=h.charAt(v);if($C(w))return C.none();if(y===w&&se(h,b,v,f))break}return C.some(v)})(c.text,c.offset,i).getOr(p)),u).bind(g=>{const p=a.cloneRange();if(p.setStart(g.container,g.offset),p.setEnd(a.endContainer,a.endOffset),p.collapsed)return C.none();const m=HC(p);return m.lastIndexOf(i)!==0||rm(m,i).length<l?C.none():C.some({text:rm(m,i),range:p,trigger:i})})})(t,e,n,o),s=>{const a=t.createRng();a.selectNode(s.dom);const i=HC(a);return C.some({range:a,text:rm(i,n),trigger:n})});var r},qC=t=>{if((e=>e.nodeType===3)(t))return un(t,t.data.length);{const e=t.childNodes;return e.length>0?qC(e[e.length-1]):un(t,e.length)}},WC=(t,e)=>{const n=t.childNodes;return n.length>0&&e<n.length?WC(n[e],0):n.length>0&&(o=>o.nodeType===1)(t)&&n.length===e?qC(n[n.length-1]):un(t,e)},KC=(t,e,n,o={})=>{var r;const s=e(),a=(r=t.selection.getRng().startContainer.nodeValue)!==null&&r!==void 0?r:"",i=mt(s.lookupByTrigger(n.trigger),d=>n.text.length>=d.minChars&&d.matches.getOrThunk(()=>(c=>u=>{const g=WC(u.startContainer,u.startOffset);return!((p,m)=>{var h;const f=(h=p.getParent(m.container,p.isBlock))!==null&&h!==void 0?h:p.getRoot();return om(p,m.container,m.offset,(b,v)=>v===0?-1:v,f).filter(b=>{const v=b.container.data.charAt(b.offset-1);return!$C(v)}).isSome()})(c,g)})(t.dom))(n.range,a,n.text));if(i.length===0)return C.none();const l=Promise.all(yt(i,d=>d.fetch(n.text,d.maxResults,o).then(c=>({matchText:n.text,items:c,columns:d.columns,onAction:d.onAction,highlightOn:d.highlightOn}))));return C.some({lookupData:l,context:n})};var Tn;(function(t){t[t.Error=0]="Error",t[t.Value=1]="Value"})(Tn||(Tn={}));const sm=(t,e,n)=>t.stype===Tn.Error?e(t.serror):n(t.svalue),Hr=t=>({stype:Tn.Value,svalue:t}),ma=t=>({stype:Tn.Error,serror:t}),dR=sm,am=t=>me(t)&&Oe(t).length>100?" removed due to size":JSON.stringify(t,null,2),al=(t,e)=>ma([{path:t,getErrorInfo:e}]),cR=(t,e)=>({extract:(n,o)=>At(o,t).fold(()=>((r,s)=>al(r,()=>'Choice schema did not contain choice key: "'+s+'"'))(n,t),r=>((s,a,i,l)=>At(i,l).fold(()=>((d,c,u)=>al(d,()=>'The chosen schema: "'+u+'" did not exist in branches: '+am(c)))(s,i,l),d=>d.extract(s.concat(["branch: "+l]),a)))(n,o,e,r)),toString:()=>"chooseOn("+t+"). Possible values: "+Oe(e)}),GC=t=>(...e)=>{if(e.length===0)throw new Error("Can't merge zero objects");const n={};for(let o=0;o<e.length;o++){const r=e[o];for(const s in r)pt(r,s)&&(n[s]=t(n[s],r[s]))}return n},im=GC((t,e)=>Xm(t)&&Xm(e)?im(t,e):e),YC=(GC((t,e)=>e),t=>({tag:"defaultedThunk",process:Y(t)})),uR=t=>{const e=(o=>{const r=[],s=[];return H(o,a=>{sm(a,i=>s.push(i),i=>r.push(i))}),{values:r,errors:s}})(t);return e.errors.length>0?(n=e.errors,ko(ma,ef)(n)):Hr(e.values);var n},XC=(t,e,n)=>{switch(t.tag){case"field":return e(t.key,t.newKey,t.presence,t.prop);case"custom":return n(t.newKey,t.instantiator)}},lm=t=>({extract:(e,n)=>{return o=t(n),r=s=>((a,i)=>al(a,Y(i)))(e,s),o.stype===Tn.Error?r(o.serror):o;var o,r},toString:Y("val")}),mR=lm(Hr),QC=(t,e,n,o)=>o(At(t,e).getOrThunk(()=>n(t))),fR=(t,e,n,o,r)=>{const s=i=>r.extract(e.concat([o]),i),a=i=>i.fold(()=>Hr(C.none()),l=>{return c=r.extract(e.concat([o]),l),u=C.some,c.stype===Tn.Value?{stype:Tn.Value,svalue:u(c.svalue)}:c;var c,u});switch(t.tag){case"required":return((i,l,d,c)=>At(l,d).fold(()=>((u,g,p)=>al(u,()=>'Could not find valid *required* value for "'+g+'" in '+am(p)))(i,d,l),c))(e,n,o,s);case"defaultedThunk":return QC(n,o,t.process,s);case"option":return((i,l,d)=>d(At(i,l)))(n,o,a);case"defaultedOptionThunk":return((i,l,d,c)=>c(At(i,l).map(u=>u===!0?d(i):u)))(n,o,t.process,a);case"mergeWithThunk":return QC(n,o,Y({}),i=>{const l=im(t.process(n),i);return s(l)})}},dm=t=>({extract:(e,n)=>((o,r,s)=>{const a={},i=[];for(const l of s)XC(l,(d,c,u,g)=>{const p=fR(u,o,r,d,g);dR(p,m=>{i.push(...m)},m=>{a[c]=m})},(d,c)=>{a[d]=c(r)});return i.length>0?ma(i):Hr(a)})(e,n,t),toString:()=>{const e=yt(t,n=>XC(n,(o,r,s,a)=>o+" -> "+a.toString(),(o,r)=>"state("+o+")"));return`obj{
`+e.join(`
`)+"}"}}),JC=t=>({extract:(e,n)=>{const o=yt(n,(r,s)=>t.extract(e.concat(["["+s+"]"]),r));return uR(o)},toString:()=>"array("+t.toString()+")"}),gR=(t,e,n)=>{return o=((r,s,a)=>((i,l)=>i.stype===Tn.Error?{stype:Tn.Error,serror:l(i.serror)}:i)(s.extract([r],a),i=>({input:a,errors:i})))(t,e,n),sm(o,he.error,he.value);var o},ZC=(t,e)=>cR(t,Ra(e,dm)),pR=Y(mR),il=(t,e)=>lm(n=>{const o=typeof n;return t(n)?Hr(n):ma(`Expected type: ${e} but got: ${o}`)}),hR=il(Je,"number"),ll=il(it,"string"),bR=il(xo,"boolean"),cm=il(wt,"function"),fa=(t,e,n,o)=>({tag:"field",key:t,newKey:e,presence:n,prop:o}),t1=(t,e)=>({tag:"custom",newKey:t,instantiator:e}),e1=(t,e)=>fa(t,t,{tag:"required",process:{}},e),n1=t=>e1(t,ll),o1=t=>e1(t,cm),um=(t,e)=>fa(t,t,{tag:"option",process:{}},e),dl=t=>um(t,ll),$r=(t,e,n)=>fa(t,t,YC(e),n),r1=(t,e)=>$r(t,e,hR),s1=(t,e,n)=>$r(t,e,(o=>{return r=s=>_t(o,s)?he.value(s):he.error(`Unsupported value: "${s}", choose one of "${o.join(", ")}".`),lm(s=>r(s).fold(ma,Hr));var r})(n)),mm=(t,e)=>$r(t,e,bR),fm=(t,e)=>$r(t,e,cm),vR=n1("type"),yR=o1("fetch"),gm=o1("onAction"),CR=fm("onSetup",()=>bt),wR=dl("text"),xR=dl("icon"),kR=dl("tooltip"),SR=dl("label"),ER=mm("active",!1),_R=mm("enabled",!0),a1=mm("primary",!1),ga=t=>((e,n)=>$r("type",n,ll))(0,t),NR=dm([vR,n1("trigger"),r1("minChars",1),((t,e)=>fa(t,t,YC(1),pR()))("columns"),r1("maxResults",10),um("matches",cm),yR,gm,(i1=ll,$r("highlightOn",[],JC(i1)))]);var i1;const pm=[_R,kR,xR,wR,CR],l1=[ER].concat(pm),RR=[fm("predicate",Dt),s1("scope","node",["node","editor"]),s1("position","selection",["node","selection","line"])],AR=pm.concat([ga("contextformbutton"),a1,gm,t1("original",ge)]),OR=l1.concat([ga("contextformbutton"),a1,gm,t1("original",ge)]),TR=pm.concat([ga("contextformbutton")]),BR=l1.concat([ga("contextformtogglebutton")]),DR=ZC("type",{contextformbutton:AR,contextformtogglebutton:OR});dm([ga("contextform"),fm("initValue",Y("")),SR,((t,e)=>fa(t,t,{tag:"required",process:{}},JC(e)))("commands",DR),um("launch",ZC("type",{contextformbutton:TR,contextformtogglebutton:BR}))].concat(RR));const PR=t=>{const e=t.ui.registry.getAll().popups,n=Ra(e,s=>{return(a=s,gR("Autocompleter",NR,K({trigger:a.ch},a))).fold(i=>{throw new Error(`Errors: 
`+(d=>{const c=d.length>10?d.slice(0,10).concat([{path:[],getErrorInfo:Y("... (only showing first ten failures)")}]):d;return yt(c,u=>"Failed path: ("+u.path.join(" > ")+`)
`+u.getErrorInfo())})((l=i).errors).join(`
`)+`

Input object: `+am(l.input));var l},ge);var a}),o=of(Hl(n,s=>s.trigger)),r=$l(n);return{dataset:n,triggers:o,lookupByTrigger:s=>mt(r,a=>a.trigger===s)}},LR=t=>{const e=ao(),n=Gt(!1),o=e.isSet,r=()=>{o()&&((i=>{Mt(i).autocompleter.removeDecoration()})(t),(i=>{i.dispatch("AutocompleterEnd")})(t),n.set(!1),e.clear())},s=No(()=>PR(t)),a=i=>{(l=>e.get().map(d=>VC(t.dom,t.selection.getRng(),d.trigger).bind(c=>KC(t,s,c,l))).getOrThunk(()=>((d,c)=>{const u=c(),g=d.selection.getRng();return((p,m,h)=>mr(h.triggers,f=>VC(p,m,f)))(d.dom,g,u).bind(p=>KC(d,c,p))})(t,s)))(i).fold(r,l=>{(d=>{o()||(((c,u)=>{Mt(c).autocompleter.addDecoration(u)})(t,d.range),e.set({trigger:d.trigger,matchLength:d.text.length}))})(l.context),l.lookupData.then(d=>{e.get().map(c=>{const u=l.context;c.trigger===u.trigger&&(u.text.length-c.matchLength>=10?r():(e.set(K(K({},c),{matchLength:u.text.length})),n.get()?((g,p)=>{g.dispatch("AutocompleterUpdate",p)})(t,{lookupData:d}):(n.set(!0),((g,p)=>{g.dispatch("AutocompleterStart",p)})(t,{lookupData:d}))))})})})};t.addCommand("mceAutocompleterReload",(i,l)=>{const d=me(l)?l.fetchOptions:{};a(d)}),t.addCommand("mceAutocompleterClose",r),((i,l)=>{const d=Rd(l.load,50);i.on("keypress compositionend",c=>{c.which!==27&&d.throttle()}),i.on("keydown",c=>{const u=c.which;u===8?d.throttle():u===27&&l.cancelIfNecessary()}),i.on("remove",d.cancel)})(t,{cancelIfNecessary:r,load:a})},d1=t=>(e,n,o={})=>{const r=e.getBody(),s={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:r,currentTarget:r,eventPhase:Event.AT_TARGET,originalTarget:r,explicitOriginalTarget:r,isTrusted:!1,srcElement:r,cancelable:!1,preventDefault:bt,inputType:n},a=Hg(new InputEvent(t));return e.dispatch(t,K(K(K({},a),s),o))},hm=d1("input"),bm=d1("beforeinput"),pa=(t,e)=>{const n=t.dom,o=t.schema.getMoveCaretBeforeOnEnterElements();if(!e)return;if(/^(LI|DT|DD)$/.test(e.nodeName)){const s=(a=>{for(;a;){if(J(a)||j(a)&&a.data&&/[\r\n\s]/.test(a.data))return a;a=a.nextSibling}return null})(e.firstChild);s&&/^(UL|OL|DL)$/.test(s.nodeName)&&e.insertBefore(n.doc.createTextNode(Zt),e.firstChild)}const r=n.createRng();if(e.normalize(),e.hasChildNodes()){const s=new Vt(e,e);let a,i=e;for(;a=s.current();){if(j(a)){r.setStart(a,0),r.setEnd(a,0);break}if(o[a.nodeName.toLowerCase()]){r.setStartBefore(a),r.setEndBefore(a);break}i=a,a=s.next()}a||(r.setStart(i,0),r.setEnd(i,0))}else Ft(e)?e.nextSibling&&n.isBlock(e.nextSibling)?(r.setStartBefore(e),r.setEndBefore(e)):(r.setStartAfter(e),r.setEndAfter(e)):(r.setStart(e,0),r.setEnd(e,0));t.selection.setRng(r),Gs(t,r)},cl=(t,e)=>{const n=t.getRoot();let o,r=e;for(;r!==n&&r&&t.getContentEditable(r)!=="false";)t.getContentEditable(r)==="true"&&(o=r),r=r.parentNode;return r!==n?o:n},vm=t=>C.from(t.dom.getParent(t.selection.getStart(!0),t.dom.isBlock)),c1=(t,e)=>{const n=t==null?void 0:t.parentNode;return Q(n)&&n.nodeName===e},u1=t=>Q(t)&&/^(OL|UL|LI)$/.test(t.nodeName),ul=t=>{const e=t.parentNode;return Q(n=e)&&/^(LI|DT|DD)$/.test(n.nodeName)?e:t;var n},ml=(t,e,n)=>{let o=t[n?"firstChild":"lastChild"];for(;o&&!J(o);)o=o[n?"nextSibling":"previousSibling"];return o===e},MR=(t,e)=>e&&e.nodeName==="A"&&t.isEmpty(e),ym=t=>{t.innerHTML='<br data-mce-bogus="1">'},Cm=(t,e)=>t.nodeName===e||t.previousSibling&&t.previousSibling.nodeName===e,m1=(t,e)=>Q(e)&&t.isBlock(e)&&!/^(TD|TH|CAPTION|FORM)$/.test(e.nodeName)&&!/^(fixed|absolute)/i.test(e.style.position)&&t.getContentEditable(e)!=="true",wm=(t,e,n)=>j(e)?t?n===1&&e.data.charAt(n-1)===ae?0:n:n===e.data.length-1&&e.data.charAt(n)===ae?e.data.length:n:n,ha=(t,e)=>{Be(t).toLowerCase()===e.tagName.toLowerCase()&&((n,o,r)=>{const s=n.dom;C.from(r.style).map(s.parseStyle).each(c=>{const u=K(K({},Xf(N(o))),c);s.setStyles(o,u)});const a=C.from(r.class).map(c=>c.split(/\s+/)),i=C.from(o.className).map(c=>mt(c.split(/\s+/),u=>u!==""));pe(a,i,(c,u)=>{const g=mt(u,m=>!_t(c,m)),p=[...c,...g];s.setAttrib(o,"class",p.join(" "))});const l=["style","class"],d=rs(r,(c,u)=>!_t(l,u));s.setAttribs(o,d)})(t,e,Ls(t))},f1={insert:(t,e)=>{let n,o,r,s,a=!1;const i=t.dom,l=t.schema,d=l.getNonEmptyElements(),c=t.selection.getRng(),u=Be(t),g=x=>{let E=n;const S=l.getTextInlineElements();let _;_=x||r==="TABLE"||r==="HR"?i.create(x||u):v.cloneNode(!1);let O=_;if(Tk(t)===!1)i.setAttrib(_,"style",null),i.setAttrib(_,"class",null);else do if(S[E.nodeName]){if(an(E)||ze(E))continue;const T=E.cloneNode(!1);i.setAttrib(T,"id",""),_.hasChildNodes()?(T.appendChild(_.firstChild),_.appendChild(T)):(O=T,_.appendChild(T))}while((E=E.parentNode)&&E!==b);return ha(t,_),ym(O),_},p=x=>{const E=wm(x,n,o);if(j(n)&&(x?E>0:E<n.data.length))return!1;if(n.parentNode===v&&a&&!x||x&&J(n)&&n===v.firstChild)return!0;if(Cm(n,"TABLE")||Cm(n,"HR"))return a&&!x||!a&&x;const S=new Vt(n,v);let _;for(j(n)&&(x&&E===0?S.prev():x||E!==n.data.length||S.next());_=S.current();){if(J(_)){if(!_.getAttribute("data-mce-bogus")){const O=_.nodeName.toLowerCase();if(d[O]&&O!=="br")return!1}}else if(j(_)&&!Fo(_.data))return!1;x?S.prev():S.next()}return!0},m=()=>{let x;return x=/^(H[1-6]|PRE|FIGURE)$/.test(r)&&y!=="HGROUP"?g(u):g(),((E,S)=>{const _=Bk(E);return!jt(S)&&(it(_)?_t($.explode(_),S.nodeName.toLowerCase()):_)})(t,s)&&m1(i,s)&&i.isEmpty(v)?x=i.split(s,v):i.insertAfter(x,v),pa(t,x),x};Si(i,c).each(x=>{c.setStart(x.startContainer,x.startOffset),c.setEnd(x.endContainer,x.endOffset)}),n=c.startContainer,o=c.startOffset;const h=!(!e||!e.shiftKey),f=!(!e||!e.ctrlKey);J(n)&&n.hasChildNodes()&&(a=o>n.childNodes.length-1,n=n.childNodes[Math.min(o,n.childNodes.length-1)]||n,o=a&&j(n)?n.data.length:0);const b=cl(i,n);if(!b||((x,E)=>{const S=x.dom.getParent(E,"ol,ul,dl");return S!==null&&x.dom.getContentEditableParent(S)==="false"})(t,n))return;h||(n=((x,E,S,_,O)=>{var T;const P=x.dom,D=(T=cl(P,_))!==null&&T!==void 0?T:P.getRoot();let I=P.getParent(_,P.isBlock);if(!I||!m1(P,I)){let q;if(I=I||D,q=I===x.getBody()||mg(I)?I.nodeName.toLowerCase():I.parentNode?I.parentNode.nodeName.toLowerCase():"",!I.hasChildNodes()){const at=P.create(E);return ha(x,at),I.appendChild(at),S.setStart(at,0),S.setEnd(at,0),at}let W,rt=_;for(;rt&&rt.parentNode!==I;)rt=rt.parentNode;for(;rt&&!P.isBlock(rt);)W=rt,rt=rt.previousSibling;if(W&&x.schema.isValidChild(q,E.toLowerCase())){const at=W.parentNode,vt=P.create(E);for(ha(x,vt),at.insertBefore(vt,W),rt=W;rt&&!P.isBlock(rt);){const St=rt.nextSibling;vt.appendChild(rt),rt=St}S.setStart(_,O),S.setEnd(_,O)}}return _})(t,u,c,n,o));let v=i.getParent(n,i.isBlock)||i.getRoot();s=Q(v==null?void 0:v.parentNode)?i.getParent(v.parentNode,i.isBlock):null,r=v?v.nodeName.toUpperCase():"";const y=s?s.nodeName.toUpperCase():"";if(y!=="LI"||f||(v=s,s=s.parentNode,r=y),/^(LI|DT|DD)$/.test(r)&&J(s)&&i.isEmpty(v))return void((x,E,S,_,O)=>{const T=x.dom,P=x.selection.getRng(),D=S.parentNode;if(S===x.getBody()||!D)return;var I;u1(I=S)&&u1(I.parentNode)&&(O="LI");let q=E(O);if(ml(S,_,!0)&&ml(S,_,!1))if(c1(S,"LI")){const W=ul(S);T.insertAfter(q,W),(rt=>{var at;return((at=rt.parentNode)===null||at===void 0?void 0:at.firstChild)===rt})(S)?T.remove(W):T.remove(S)}else T.replace(q,S);else if(ml(S,_,!0))c1(S,"LI")?(T.insertAfter(q,ul(S)),q.appendChild(T.doc.createTextNode(" ")),q.appendChild(S)):D.insertBefore(q,S),T.remove(_);else if(ml(S,_,!1))T.insertAfter(q,ul(S)),T.remove(_);else{S=ul(S);const W=P.cloneRange();W.setStartAfter(_),W.setEndAfter(S);const rt=W.extractContents();O==="LI"&&((at,vt)=>at.firstChild&&at.firstChild.nodeName==="LI")(rt)?(q=rt.firstChild,T.insertAfter(rt,S)):(T.insertAfter(rt,S),T.insertAfter(q,S)),T.remove(_)}pa(x,q)})(t,g,s,v,u);if(v===t.getBody())return;const w=v.parentNode;let k;if(Cr(v))k=fd(v),i.isEmpty(v)&&ym(v),ha(t,k),pa(t,k);else if(p(!1))k=m();else if(p(!0)&&w)k=w.insertBefore(g(),v),pa(t,Cm(v,"HR")?k:v);else{const x=(S=>{const _=S.cloneRange();return _.setStart(S.startContainer,wm(!0,S.startContainer,S.startOffset)),_.setEnd(S.endContainer,wm(!1,S.endContainer,S.endOffset)),_})(c).cloneRange();x.setEndAfter(v);const E=x.extractContents();(S=>{H(ag(N(S),Le),_=>{const O=_.dom;O.nodeValue=jn(O.data)})})(E),(S=>{let _=S;do j(_)&&(_.data=_.data.replace(/^[\r\n]+/,"")),_=_.firstChild;while(_)})(E),k=E.firstChild,i.insertAfter(E,v),((S,_,O)=>{var T;const P=[];if(!O)return;let D=O;for(;D=D.firstChild;){if(S.isBlock(D))return;J(D)&&!_[D.nodeName.toLowerCase()]&&P.push(D)}let I=P.length;for(;I--;)D=P[I],(!D.hasChildNodes()||D.firstChild===D.lastChild&&((T=D.firstChild)===null||T===void 0?void 0:T.nodeValue)===""||MR(S,D))&&S.remove(D)})(i,d,k),((S,_)=>{_.normalize();const O=_.lastChild;(!O||J(O)&&/^(left|right)$/gi.test(S.getStyle(O,"float",!0)))&&S.add(_,"br")})(i,v),i.isEmpty(v)&&ym(v),k.normalize(),i.isEmpty(k)?(i.remove(k),m()):(ha(t,k),pa(t,k))}i.setAttrib(k,"id",""),t.dispatch("NewBlock",{newBlock:k})},fakeEventName:"insertParagraph"},g1=(t,e,n)=>{const o=t.dom.createRng();n?(o.setStartBefore(e),o.setEndBefore(e)):(o.setStartAfter(e),o.setEndAfter(e)),t.selection.setRng(o),Gs(t,o)},IR=(t,e)=>{const n=Jt("br");Me(N(e),n),t.undoManager.add()},FR=(t,e)=>{UR(t.getBody(),e)||Jn(N(e),Jt("br"));const n=Jt("br");Jn(N(e),n),g1(t,n.dom,!1),t.undoManager.add()},UR=(t,e)=>{return n=L.after(e),!!Ft(n.getNode())||ke(t,L.after(e)).map(o=>Ft(o.getNode())).getOr(!1);var n},p1=t=>t&&t.nodeName==="A"&&"href"in t,zR=t=>t.fold(Dt,p1,p1,Dt),jR=(t,e)=>{e.fold(bt,tt(IR,t),tt(FR,t),bt)},h1={insert:(t,e)=>{const n=(o=>{const r=tt(Zo,o),s=L.fromRangeStart(o.selection.getRng());return An(r,o.getBody(),s).filter(zR)})(t);n.isSome()?n.each(tt(jR,t)):((o,r)=>{const s=o.selection,a=o.dom,i=s.getRng();let l,d=!1;Si(a,i).each(f=>{i.setStart(f.startContainer,f.startOffset),i.setEnd(f.endContainer,f.endOffset)});let c=i.startOffset,u=i.startContainer;if(J(u)&&u.hasChildNodes()){const f=c>u.childNodes.length-1;u=u.childNodes[Math.min(c,u.childNodes.length-1)]||u,c=f&&j(u)?u.data.length:0}let g=a.getParent(u,a.isBlock);const p=g&&g.parentNode?a.getParent(g.parentNode,a.isBlock):null,m=p?p.nodeName.toUpperCase():"",h=!(!r||!r.ctrlKey);m!=="LI"||h||(g=p),j(u)&&c>=u.data.length&&(((f,b,v)=>{const y=new Vt(b,v);let w;const k=f.getNonEmptyElements();for(;w=y.next();)if(k[w.nodeName.toLowerCase()]||j(w)&&w.length>0)return!0;return!1})(o.schema,u,g||a.getRoot())||(l=a.create("br"),i.insertNode(l),i.setStartAfter(l),i.setEndAfter(l),d=!0)),l=a.create("br"),Dd(a,i,l),g1(o,l,d),o.undoManager.add()})(t,e)},fakeEventName:"insertLineBreak"},b1=(t,e)=>vm(t).filter(n=>e.length>0&&Ze(N(n),e)).isSome(),We=Cn([{br:[]},{block:[]},{none:[]}]),HR=(t,e)=>(n=>b1(n,Ok(n)))(t),v1=t=>(e,n)=>(o=>vm(o).filter(r=>Cs(N(r))).isSome())(e)===t,y1=(t,e)=>(n,o)=>(s=>vm(s).fold(Y(""),a=>a.nodeName.toUpperCase()))(n)===t.toUpperCase()===e,$R=t=>{const e=cl(t.dom,t.selection.getStart());return jt(e)},ba=t=>y1("pre",t),fl=t=>(e,n)=>Nk(e)===t,VR=(t,e)=>(n=>b1(n,Ak(n)))(t),gl=(t,e)=>e,qR=t=>{const e=Be(t),n=cl(t.dom,t.selection.getStart());return Q(n)&&t.schema.isValidChild(n.nodeName,e)},Xe=(t,e)=>(n,o)=>Re(t,(r,s)=>r&&s(n,o),!0)?C.some(e):C.none(),pl=(t,e,n)=>{e.selection.isCollapsed()||(o=>{o.execCommand("delete")})(e),Q(n)&&bm(e,t.fakeEventName).isDefaultPrevented()||(t.insert(e,n),Q(n)&&hm(e,t.fakeEventName))},C1=(t,e)=>{const n=()=>pl(h1,t,e),o=()=>pl(f1,t,e),r=((s,a)=>Oy([Xe([HR],We.none()),Xe([ba(!0),$R],We.none()),Xe([y1("summary",!0)],We.br()),Xe([ba(!0),fl(!1),gl],We.br()),Xe([ba(!0),fl(!1)],We.block()),Xe([ba(!0),fl(!0),gl],We.block()),Xe([ba(!0),fl(!0)],We.br()),Xe([v1(!0),gl],We.br()),Xe([v1(!0)],We.block()),Xe([VR],We.br()),Xe([gl],We.br()),Xe([qR],We.block())],[s,!(!a||!a.shiftKey)]).getOr(We.none()))(t,e);switch(Rk(t)){case"linebreak":r.fold(n,n,bt);break;case"block":r.fold(o,o,bt);break;case"invert":r.fold(o,n,bt);break;default:r.fold(n,o,bt)}},WR=Ro(),w1=t=>t.stopImmediatePropagation(),x1=t=>t.keyCode===ot.PAGE_UP||t.keyCode===ot.PAGE_DOWN,k1=(t,e,n)=>{n&&!t.get()?e.on("NodeChange",w1,!0):!n&&t.get()&&e.off("NodeChange",w1),t.set(n)},S1=(t,e)=>{const n=e.container(),o=e.offset();return j(n)?(n.insertData(o,t),C.some(L(n,o+t.length))):di(e).map(r=>{const s=hr(t);return e.isAtEnd()?Jn(r,s):Me(r,s),L(s.dom,t.length)})},KR=tt(S1,Zt),GR=tt(S1," "),YR=(t,e)=>n=>((o,r)=>!Bc(r)&&(((s,a)=>((i,l)=>Ue(i.dom,l).isNone())(s,a)||((i,l)=>ke(i.dom,l).isNone())(s,a)||Ac(s,a)||Wb(s,a)||Tc(s,a)||Oc(s,a))(o,r)||Yb(o,r)||Xb(o,r)))(t,n)?KR(e):GR(e),XR=t=>{const e=L.fromRangeStart(t.selection.getRng()),n=N(t.getBody());if(t.selection.isCollapsed()){const o=tt(Zo,t),r=L.fromRangeStart(t.selection.getRng());return An(o,t.getBody(),r).bind((s=>a=>a.fold(i=>Ue(s.dom,L.before(i)),i=>be(i),i=>Sn(i),i=>ke(s.dom,L.after(i))))(n)).map(s=>()=>YR(n,e)(s).each((a=>i=>(a.selection.setRng(i.toRange()),a.nodeChanged(),!0))(t)))}return C.none()},QR=t=>PS(t)?[{keyCode:ot.TAB,action:ht(zC,t,!0)},{keyCode:ot.TAB,shiftKey:!0,action:ht(zC,t,!1)}]:[],JR=t=>{if(t.addShortcut("Meta+P","","mcePrint"),LR(t),Rn(t))return Gt(null);{const e=HN(t);return(n=>{n.on("keyup compositionstart",tt(JN,n))})(t),((n,o)=>{n.on("keydown",r=>{r.isDefaultPrevented()||((s,a,i)=>{const l=Ct.os.isMacOS()||Ct.os.isiOS();ca([{keyCode:ot.RIGHT,action:ht(bC,s,!0)},{keyCode:ot.LEFT,action:ht(bC,s,!1)},{keyCode:ot.UP,action:ht(vC,s,!1)},{keyCode:ot.DOWN,action:ht(vC,s,!0)},...l?[{keyCode:ot.UP,action:ht(ol,s,!1),metaKey:!0,shiftKey:!0},{keyCode:ot.DOWN,action:ht(ol,s,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:ot.RIGHT,action:ht(MC,s,!0)},{keyCode:ot.LEFT,action:ht(MC,s,!1)},{keyCode:ot.UP,action:ht(IC,s,!1)},{keyCode:ot.DOWN,action:ht(IC,s,!0)},{keyCode:ot.RIGHT,action:ht(SC,s,!0)},{keyCode:ot.LEFT,action:ht(SC,s,!1)},{keyCode:ot.UP,action:ht(EC,s,!1)},{keyCode:ot.DOWN,action:ht(EC,s,!0)},{keyCode:ot.RIGHT,action:ht(Jy,s,a,!0)},{keyCode:ot.LEFT,action:ht(Jy,s,a,!1)},{keyCode:ot.RIGHT,ctrlKey:!l,altKey:l,action:ht($N,s,a)},{keyCode:ot.LEFT,ctrlKey:!l,altKey:l,action:ht(VN,s,a)},{keyCode:ot.UP,action:ht(CC,s,!1)},{keyCode:ot.DOWN,action:ht(CC,s,!0)}],i).each(d=>{i.preventDefault()})})(n,o,r)})})(t,e),((n,o)=>{n.on("keydown",r=>{r.isDefaultPrevented()||((s,a,i)=>{const l=i.keyCode===ot.BACKSPACE?"deleteContentBackward":"deleteContentForward";kC([{keyCode:ot.BACKSPACE,action:ht(lC,s)},{keyCode:ot.BACKSPACE,action:ht(Uu,s,!1)},{keyCode:ot.DELETE,action:ht(Uu,s,!0)},{keyCode:ot.BACKSPACE,action:ht(Mu,s,!1)},{keyCode:ot.DELETE,action:ht(Mu,s,!0)},{keyCode:ot.BACKSPACE,action:ht(Gu,s,a,!1)},{keyCode:ot.DELETE,action:ht(Gu,s,a,!0)},{keyCode:ot.BACKSPACE,action:ht(Vc,s,!1)},{keyCode:ot.DELETE,action:ht(Vc,s,!0)},{keyCode:ot.BACKSPACE,action:ht(zu,s,!1)},{keyCode:ot.DELETE,action:ht(zu,s,!0)},{keyCode:ot.BACKSPACE,action:ht(Qu,s,!1)},{keyCode:ot.DELETE,action:ht(Qu,s,!0)},{keyCode:ot.BACKSPACE,action:ht(Pu,s,!1)},{keyCode:ot.DELETE,action:ht(Pu,s,!0)},{keyCode:ot.BACKSPACE,action:ht(Du,s,!1)},{keyCode:ot.DELETE,action:ht(Du,s,!0)},{keyCode:ot.BACKSPACE,action:ht(Yu,s,!1)},{keyCode:ot.DELETE,action:ht(Yu,s,!0)}],i).each(d=>{i.preventDefault(),bm(s,l).isDefaultPrevented()||(d(),hm(s,l))})})(n,o,r)}),n.on("keyup",r=>{r.isDefaultPrevented()||((s,a)=>{ca([{keyCode:ot.BACKSPACE,action:ht(Sy,s)},{keyCode:ot.DELETE,action:ht(Sy,s)}],a)})(n,r)})})(t,e),(n=>{n.on("keydown",o=>{o.keyCode===ot.ENTER&&((r,s)=>{var a;s.isDefaultPrevented()||(s.preventDefault(),(a=r.undoManager).typing&&(a.typing=!1,a.add()),r.undoManager.transact(()=>{C1(r,s)}))})(n,o)})})(t),(n=>{n.on("keydown",o=>{o.isDefaultPrevented()||((r,s)=>{kC([{keyCode:ot.SPACEBAR,action:ht(XR,r)}],s).each(a=>{s.preventDefault(),bm(r,"insertText",{data:" "}).isDefaultPrevented()||(a(),hm(r,"insertText",{data:" "}))})})(n,o)})})(t),(n=>{n.on("input",o=>{o.isComposing||(r=>{const s=N(r.getBody());r.selection.isCollapsed()&&zE(s,L.fromRangeStart(r.selection.getRng())).each(a=>{r.selection.setRng(a.toRange())})})(n)})})(t),(n=>{n.on("keydown",o=>{o.isDefaultPrevented()||((r,s)=>{ca([...QR(r)],s).each(a=>{s.preventDefault()})})(n,o)})})(t),((n,o)=>{n.on("keydown",r=>{r.isDefaultPrevented()||((s,a,i)=>{const l=Ct.os.isMacOS()||Ct.os.isiOS();ca([{keyCode:ot.END,action:ht(yC,s,!0)},{keyCode:ot.HOME,action:ht(yC,s,!1)},...l?[]:[{keyCode:ot.HOME,action:ht(ol,s,!1),ctrlKey:!0,shiftKey:!0},{keyCode:ot.END,action:ht(ol,s,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:ot.END,action:ht(_C,s,!0)},{keyCode:ot.HOME,action:ht(_C,s,!1)},{keyCode:ot.END,action:ht(nl,s,!0,a)},{keyCode:ot.HOME,action:ht(nl,s,!1,a)}],i).each(d=>{i.preventDefault()})})(n,o,r)})})(t,e),((n,o)=>{if(WR.os.isMacOS())return;const r=Gt(!1);n.on("keydown",s=>{x1(s)&&k1(r,n,!0)}),n.on("keyup",s=>{s.isDefaultPrevented()||((a,i,l)=>{ca([{keyCode:ot.PAGE_UP,action:ht(nl,a,!1,i)},{keyCode:ot.PAGE_DOWN,action:ht(nl,a,!0,i)}],l)})(n,o,s),x1(s)&&r.get()&&(k1(r,n,!1),n.nodeChanged())})})(t,e),e}};class ZR{constructor(e){let n;this.lastPath=[],this.editor=e;const o=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",r=>{const s=e.selection.getRng(),a={startContainer:s.startContainer,startOffset:s.startOffset,endContainer:s.endContainer,endOffset:s.endOffset};r.type!=="nodechange"&&gc(a,n)||e.dispatch("SelectionChange"),n=a}),e.on("contextmenu",()=>{e.dispatch("SelectionChange")}),e.on("SelectionChange",()=>{const r=e.selection.getStart(!0);r&&hi(e)&&!o.isSameElementPath(r)&&e.dom.isChildOf(r,e.getBody())&&e.nodeChanged({selectionChange:!0})}),e.on("mouseup",r=>{!r.isDefaultPrevented()&&hi(e)&&(e.selection.getNode().nodeName==="IMG"?He.setEditorTimeout(e,()=>{e.nodeChanged()}):e.nodeChanged())})}nodeChanged(e={}){const n=this.editor.selection;let o;if(this.editor.initialized&&n&&!iS(this.editor)&&!this.editor.mode.isReadOnly()){const r=this.editor.getBody();o=n.getStart(!0)||r,o.ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(o,r)||(o=r);const s=[];this.editor.dom.getParent(o,a=>a===r||(s.push(a),!1)),this.editor.dispatch("NodeChange",K(K({},e),{element:o,parents:s}))}}isSameElementPath(e){let n;const o=this.editor,r=os(o.dom.getParents(e,Ht,o.getBody()));if(r.length===this.lastPath.length){for(n=r.length;n>=0&&r[n]===this.lastPath[n];n--);if(n===-1)return this.lastPath=r,!0}return this.lastPath=r,!1}}const hl=Y("x-tinymce/html"),xm="<!-- x-tinymce/html -->",tA=t=>xm+t,E1=t=>t.indexOf(xm)!==-1,_1="%MCEPASTEBIN%",km=t=>t.dom.get("mcepastebin"),eA=t=>Q(t)&&t.id==="mcepastebin",N1=t=>t===_1,R1=(t,e)=>($.each(e,n=>{t=Sa(n,RegExp)?t.replace(n,""):t.replace(n[0],n[1])}),t),A1=t=>R1(t,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(e,n,o)=>n||o?Zt:" "],/<br class="Apple-interchange-newline">/g,/<br>$/i]),O1=(t,e)=>({content:t,cancelled:e}),Sm=(t,e)=>(t.insertContent(e,{merge:SS(t),paste:!0}),!0),Em=t=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(t),nA=(t,e,n)=>!(t.selection.isCollapsed()||!Em(e))&&((o,r,s)=>(o.undoManager.extra(()=>{s(o,r)},()=>{o.execCommand("mceInsertLink",!1,r)}),!0))(t,e,n),oA=(t,e,n)=>!!((o,r)=>Em(r)&&It(Kp(o),s=>cf(r.toLowerCase(),`.${s.toLowerCase()}`)))(t,e)&&((o,r,s)=>(o.undoManager.extra(()=>{s(o,r)},()=>{o.insertContent('<img src="'+r+'">')}),!0))(t,e,n),rA=(t=>{let e=0;return()=>"mceclip"+e++})(),T1=(t,e,n,o)=>{const r=((s,a,i)=>((l,d,c)=>{const u=((p,m,h)=>p.dispatch("PastePreProcess",{content:m,internal:h}))(l,d,c),g=((p,m)=>{const h=Ir({},p.schema);h.addNodeFilter("meta",b=>{$.each(b,v=>{v.remove()})});const f=h.parse(m,{forced_root_block:!1,isRootContent:!0});return mo({validate:!0},p.schema).serialize(f)})(l,u.content);return l.hasEventListeners("PastePostProcess")&&!u.isDefaultPrevented()?((p,m,h)=>{const f=p.dom.create("div",{style:"display:none"},m),b=((v,y,w)=>v.dispatch("PastePostProcess",{node:y,internal:w}))(p,f,h);return O1(b.node.innerHTML,b.isDefaultPrevented())})(l,g,c):O1(g,u.isDefaultPrevented())})(s,a,i))(t,e,n);r.cancelled||((s,a,i)=>{i||!ES(s)?Sm(s,a):((l,d)=>{$.each([nA,oA,Sm],c=>!c(l,d,Sm))})(s,a)})(t,r.content,o)},bl=(t,e,n)=>{const o=n||E1(e);T1(t,(r=>r.replace(xm,""))(e),o,!1)},_m=(t,e)=>{const n=t.dom.encode(e).replace(/\r\n/g,`
`),o=((r,s,a)=>{const i=r.split(/\n\n/),l=((u,g)=>{let p="<"+u;const m=Hl(g,(h,f)=>f+'="'+ro.encodeAllRaw(h)+'"');return m.length&&(p+=" "+m.join(" ")),p+">"})(s,a),d="</"+s+">",c=yt(i,u=>u.split(/\n/).join("<br />"));return c.length===1?c[0]:yt(c,u=>l+u+d).join("")})(kg(n,NS(t)),Be(t),Ls(t));T1(t,o,!1,!0)},B1=t=>{const e={};if(t&&t.types)for(let n=0;n<t.types.length;n++){const o=t.types[n];try{e[o]=t.getData(o)}catch(r){e[o]=""}}return e},Vr=(t,e)=>e in t&&t[e].length>0,D1=t=>Vr(t,"text/html")||Vr(t,"text/plain"),P1=(t,e,n)=>{const o=e.type==="paste"?e.clipboardData:e.dataTransfer;var r;if(ii(t)&&o){const s=((a,i)=>{const l=i.items?Ln(Ae(i.items),c=>c.kind==="file"?[c.getAsFile()]:[]):[],d=i.files?Ae(i.files):[];return mt(l.length>0?l:d,(c=>{const u=Kp(c);return g=>ee(g.type,"image/")&&It(u,p=>(m=>{const h=m.toLowerCase(),f={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return $.hasOwn(f,h)?"image/"+f[h]:"image/"+h})(p)===g.type)})(a))})(t,o);if(s.length>0)return e.preventDefault(),(r=s,Promise.all(yt(r,a=>wv(a).then(i=>({file:a,uri:i}))))).then(a=>{n&&t.selection.setRng(n),H(a,i=>{((l,d)=>{Cu(d.uri).each(({data:c,type:u,base64Encoded:g})=>{const p=g?c:btoa(c),m=d.file,h=l.editorUpload.blobCache,f=h.getByData(p,u),b=f!=null?f:((v,y,w,k)=>{const x=rA(),E=Mp(v)&&Q(w.name),S=E?((T,P)=>{const D=P.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return Q(D)?T.dom.encode(D[1]):void 0})(v,w.name):x,_=E?w.name:void 0,O=y.create(x,w,k,S,_);return y.add(O),O})(l,h,m,p);bl(l,`<img src="${b.blobUri()}">`,!1)})})(t,i)})}),!0}return!1},L1=(t,e,n,o)=>{let r=A1(n);const s=Vr(e,hl())||E1(n),a=!s&&(l=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(l))(r),i=Em(r);(N1(r)||!r.length||a&&!i)&&(o=!0),(o||i)&&(r=Vr(e,"text/plain")&&a?e["text/plain"]:(l=>{const d=so(),c=Ir({},d);let u="";const g=d.getVoidElements(),p=$.makeMap("script noscript style textarea video audio iframe object"," "),m=d.getBlockElements(),h=f=>{const b=f.name,v=f;if(b!=="br"){if(b!=="wbr")if(g[b]&&(u+=" "),p[b])u+=" ";else{if(f.type===3&&(u+=f.value),!(f.name in d.getVoidElements())){let y=f.firstChild;if(y)do h(y);while(y=y.next)}m[b]&&v.next&&(u+=`
`,b==="p"&&(u+=`
`))}}else u+=`
`};return l=R1(l,[/<!\[[^\]]+\]>/g]),h(c.parse(l)),u})(r)),N1(r)||(o?_m(t,r):bl(t,r,s))},sA=(t,e,n)=>{((o,r,s)=>{let a;o.on("keydown",i=>{(l=>ot.metaKeyPressed(l)&&l.keyCode===86||l.shiftKey&&l.keyCode===45)(i)&&!i.isDefaultPrevented()&&(a=i.shiftKey&&i.keyCode===86)}),o.on("paste",i=>{if(i.isDefaultPrevented()||(c=>{var u,g;return Ct.os.isAndroid()&&((g=(u=c.clipboardData)===null||u===void 0?void 0:u.items)===null||g===void 0?void 0:g.length)===0})(i))return;const l=s.get()==="text"||a;a=!1;const d=B1(i.clipboardData);!D1(d)&&P1(o,i,r.getLastRng()||o.selection.getRng())||(Vr(d,"text/html")?(i.preventDefault(),L1(o,d,d["text/html"],l)):(r.create(),He.setEditorTimeout(o,()=>{const c=r.getHtml();r.remove(),L1(o,d,c,l)},0)))})})(t,e,n),(o=>{const r=a=>ee(a,"webkit-fake-url"),s=a=>ee(a,"data:");o.parser.addNodeFilter("img",(a,i,l)=>{if(!ii(o)&&(d=>{var c;return((c=d.data)===null||c===void 0?void 0:c.paste)===!0})(l))for(const d of a){const c=d.attr("src");it(c)&&!d.attr("data-mce-object")&&c!==Ct.transparentSrc&&(r(c)||!RS(o)&&s(c))&&d.remove()}})})(t)},M1=(t,e,n,o)=>{((r,s,a)=>{if(!r)return!1;try{return r.clearData(),r.setData("text/html",s),r.setData("text/plain",a),r.setData(hl(),s),!0}catch(i){return!1}})(t.clipboardData,e.html,e.text)?(t.preventDefault(),o()):n(e.html,o)},I1=t=>(e,n)=>{const{dom:o,selection:r}=t,s=o.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=o.create("div",{contenteditable:"true"},e);o.setStyles(s,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),s.appendChild(a),o.add(t.getBody(),s);const i=r.getRng();a.focus();const l=o.createRng();l.selectNodeContents(a),r.setRng(l),He.setEditorTimeout(t,()=>{r.setRng(i),o.remove(s),n()},0)},F1=t=>({html:tA(t.selection.getContent({contextual:!0})),text:t.selection.getContent({format:"text"})}),U1=t=>!t.selection.isCollapsed()||(e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()))(t),z1=(t,e)=>{var n,o;return Xo.getCaretRangeFromPoint((n=e.clientX)!==null&&n!==void 0?n:0,(o=e.clientY)!==null&&o!==void 0?o:0,t.getDoc())},j1=(t,e)=>{t.focus(),e&&t.selection.setRng(e)},aA=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,H1=t=>$.trim(t).replace(aA,pi).toLowerCase(),iA=(t,e,n)=>{const o=xS(t);if(n||o==="all"||!kS(t))return e;const r=o?o.split(/[, ]/):[];if(r&&o!=="none"){const s=t.dom,a=t.selection.getNode();e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(i,l,d,c)=>{const u=s.parseStyle(s.decode(d)),g={};for(let m=0;m<r.length;m++){const h=u[r[m]];let f=h,b=s.getStyle(a,r[m],!0);/color/.test(r[m])&&(f=H1(f),b=H1(b)),b!==f&&(g[r[m]]=h)}const p=s.serializeStyle(g,"span");return p?l+' style="'+p+'"'+c:l+c})}else e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return e=e.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(s,a,i,l)=>a+' style="'+i+'"'+l),e},lA=t=>{const e=Gt(!1),n=Gt(_S(t)?"text":"html"),o=(r=>{const s=Gt(null);return{create:()=>((a,i)=>{const{dom:l,selection:d}=a,c=a.getBody();i.set(d.getRng());const u=l.add(a.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},_1);Ct.browser.isFirefox()&&l.setStyle(u,"left",l.getStyle(c,"direction",!0)==="rtl"?65535:-65535),l.bind(u,"beforedeactivate focusin focusout",g=>{g.stopPropagation()}),u.focus(),d.select(u,!0)})(r,s),remove:()=>((a,i)=>{const l=a.dom;if(km(a)){let d;const c=i.get();for(;d=km(a);)l.remove(d),l.unbind(d);c&&a.selection.setRng(c)}i.set(null)})(r,s),getEl:()=>km(r),getHtml:()=>(a=>{const i=a.dom,l=(g,p)=>{g.appendChild(p),i.remove(p,!0)},[d,...c]=mt(a.getBody().childNodes,eA);H(c,g=>{l(d,g)});const u=i.select("div[id=mcepastebin]",d);for(let g=u.length-1;g>=0;g--){const p=i.create("div");d.insertBefore(p,u[g]),l(p,u[g])}return d?d.innerHTML:""})(r),getLastRng:s.get}})(t);(r=>{(Ct.browser.isChromium()||Ct.browser.isSafari())&&((s,a)=>{s.on("PastePreProcess",i=>{i.content=a(s,i.content,i.internal)})})(r,iA)})(t),((r,s)=>{r.addCommand("mceTogglePlainTextPaste",()=>{((a,i)=>{i.get()==="text"?(i.set("html"),Gh(a,!1)):(i.set("text"),Gh(a,!0)),a.focus()})(r,s)}),r.addCommand("mceInsertClipboardContent",(a,i)=>{i.html&&bl(r,i.html,i.internal),i.text&&_m(r,i.text)})})(t,n),(r=>{const s=l=>d=>{l(r,d)},a=CS(r);wt(a)&&r.on("PastePreProcess",s(a));const i=wS(r);wt(i)&&r.on("PastePostProcess",s(i))})(t),t.on("PreInit",()=>{(r=>{r.on("cut",(s=>a=>{!a.isDefaultPrevented()&&U1(s)&&M1(a,F1(s),I1(s),()=>{if(Ct.browser.isChromium()||Ct.browser.isFirefox()){const i=s.selection.getRng();He.setEditorTimeout(s,()=>{s.selection.setRng(i),s.execCommand("Delete")},0)}else s.execCommand("Delete")})})(r)),r.on("copy",(s=>a=>{!a.isDefaultPrevented()&&U1(s)&&M1(a,F1(s),I1(s),bt)})(r))})(t),((r,s)=>{yS(r)&&r.on("dragend dragover draggesture dragdrop drop drag",a=>{a.preventDefault(),a.stopPropagation()}),ii(r)||r.on("drop",a=>{const i=a.dataTransfer;i&&(l=>It(l.files,d=>/^image\//.test(d.type)))(i)&&a.preventDefault()}),r.on("drop",a=>{if(a.isDefaultPrevented()||s.get())return;const i=z1(r,a);if(jt(i))return;const l=B1(a.dataTransfer),d=Vr(l,hl());if((!D1(l)||(g=>{const p=g["text/plain"];return!!p&&p.indexOf("file://")===0})(l))&&P1(r,a,i))return;const c=l[hl()],u=c||l["text/html"]||l["text/plain"];u&&(a.preventDefault(),He.setEditorTimeout(r,()=>{r.undoManager.transact(()=>{c&&r.execCommand("Delete"),j1(r,i);const g=A1(u);l["text/html"]?bl(r,g,d):_m(r,g)})}))}),r.on("dragstart",a=>{s.set(!0)}),r.on("dragover dragend",a=>{ii(r)&&!s.get()&&(a.preventDefault(),j1(r,z1(r,a))),a.type==="dragend"&&s.set(!1)})})(t,e),sA(t,o,n)})},dA=Ft,$1=j,cA=t=>Rt(t.dom),V1=t=>e=>xt(N(t),e),q1=(t,e)=>Bo(N(t),cA,V1(e)),W1=(t,e,n)=>{const o=new Vt(t,e),r=n?o.next.bind(o):o.prev.bind(o);let s=t;for(let a=n?t:r();a&&!dA(a);a=r())Ye(a)&&(s=a);return s},uA=t=>{const e=((n,o)=>{const r=L.fromRangeStart(n).getNode(),s=((d,c)=>Bo(N(d),u=>(g=>nn(g.dom))(u)||on(u),V1(c)).getOr(N(c)).dom)(r,o),a=W1(r,s,!1),i=W1(r,s,!0),l=document.createRange();return q1(a,s).fold(()=>{$1(a)?l.setStart(a,0):l.setStartBefore(a)},d=>l.setStartBefore(d.dom)),q1(i,s).fold(()=>{$1(i)?l.setEnd(i,i.data.length):l.setEndAfter(i)},d=>l.setEndAfter(d.dom)),l})(t.selection.getRng(),t.getBody());t.selection.setRng(Yc(e))};var qr;(function(t){t.Before="before",t.After="after"})(qr||(qr={}));const mA=(t,e)=>Math.abs(t.left-e),fA=(t,e)=>Math.abs(t.right-e),gA=(t,e)=>(n=>Re(n,(o,r)=>o.fold(()=>C.some(r),s=>{const a=Math.min(r.left,s.left),i=Math.min(r.top,s.top),l=Math.max(r.right,s.right),d=Math.max(r.bottom,s.bottom);return C.some({top:i,right:l,bottom:d,left:a,width:l-a,height:d-i})}),C.none()))(mt(t,n=>{return(o=e)>=(r=n).top&&o<=r.bottom;var o,r})).fold(()=>[[],t],n=>{const{pass:o,fail:r}=es(t,s=>((a,i)=>{const l=((d,c)=>Math.max(0,Math.min(d.bottom,c.bottom)-Math.max(d.top,c.top)))(a,i)/Math.min(a.height,i.height);return((d,c)=>d.top<c.bottom&&d.bottom>c.top)(a,i)&&l>.5})(s,n));return[o,r]}),pA=(t,e,n)=>e>t.left&&e<t.right?0:Math.min(Math.abs(t.left-e),Math.abs(t.right-e)),Nm=(t,e,n)=>{const o=d=>Ye(d.node)?C.some(d):J(d.node)?Nm(Ae(d.node.childNodes),e,n):C.none(),r=(d,c)=>{const u=ur(d,(g,p)=>c(g,e,n)-c(p,e,n));return((g,p)=>{if(g.length>=2){const m=o(g[0]).getOr(g[0]),h=o(g[1]).getOr(g[1]);if(Math.abs(p(m,e,n)-p(h,e,n))<2){if(j(m.node))return C.some(m);if(j(h.node))return C.some(h)}}return C.none()})(u,c).orThunk(()=>mr(u,o))},[s,a]=gA($y(t),n),{pass:i,fail:l}=es(a,d=>d.top<n);return r(s,pA).orThunk(()=>r(l,sp)).orThunk(()=>r(i,sp))},K1=(t,e,n)=>((o,r,s)=>{const a=N(o),i=Un(a),l=_x(i,r,s).filter(d=>Fn(a,d)).getOr(a);return((d,c,u,g)=>{const p=(m,h)=>{const f=mt(m.dom.childNodes,Ea(b=>J(b)&&b.classList.contains("mce-drag-container")));return h.fold(()=>Nm(f,u,g),b=>{const v=mt(f,y=>y!==b.dom);return Nm(v,u,g)}).orThunk(()=>(xt(m,d)?C.none():Uf(m)).bind(b=>p(b,C.some(m))))};return p(c,C.none())})(a,l,r,s)})(t,e,n).filter(o=>Fs(o.node)).map(o=>((r,s)=>({node:r.node,position:mA(r,s)<fA(r,s)?qr.Before:qr.After}))(o,e)),G1=t=>{var e,n;const o=t.getBoundingClientRect(),r=t.ownerDocument,s=r.documentElement,a=r.defaultView;return{top:o.top+((e=a==null?void 0:a.scrollY)!==null&&e!==void 0?e:0)-s.clientTop,left:o.left+((n=a==null?void 0:a.scrollX)!==null&&n!==void 0?n:0)-s.clientLeft}},Rm=Rt,hA=((...t)=>e=>{for(let n=0;n<t.length;n++)if(t[n](e))return!0;return!1})(Rm,nn),bA=(t,e,n,o)=>{const r=t.dom,s=e.cloneNode(!0);r.setStyles(s,{width:n,height:o}),r.setAttrib(s,"data-mce-selected",null);const a=r.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return r.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:o}),r.setStyles(s,{margin:0,boxSizing:"border-box"}),a.appendChild(s),a},vl=(t,e)=>n=>()=>{const o=t==="left"?n.scrollX:n.scrollY;n.scroll({[t]:o+e,behavior:"smooth"})},Y1=vl("left",-32),X1=vl("left",32),Q1=vl("top",-32),J1=vl("top",32),Z1=t=>{t&&t.parentNode&&t.parentNode.removeChild(t)},vA=(t,e)=>{const n=ei((r,s)=>{e._selectionOverrides.hideFakeCaret(),K1(e.getBody(),r,s).fold(()=>e.selection.placeCaretAt(r,s),a=>{const i=e._selectionOverrides.showCaret(1,a.node,a.position===qr.Before,!1);i?e.selection.setRng(i):e.selection.placeCaretAt(r,s)})},0);e.on("remove",n.cancel);const o=t;return r=>t.on(s=>{const a=Math.max(Math.abs(r.screenX-s.screenX),Math.abs(r.screenY-s.screenY));if(!s.dragging&&a>10){if(e.dispatch("dragstart",{target:s.element}).isDefaultPrevented())return;s.dragging=!0,e.focus()}if(s.dragging){const d=r.currentTarget===e.getDoc().documentElement,c=((u,g)=>({pageX:g.pageX-u.relX,pageY:g.pageY+5}))(s,((u,g)=>{return p=(f=>f.inline?G1(f.getBody()):{left:0,top:0})(u),m=(f=>{const b=f.getBody();return f.inline?{left:b.scrollLeft,top:b.scrollTop}:{left:0,top:0}})(u),h=((f,b)=>{if(b.target.ownerDocument!==f.getDoc()){const v=G1(f.getContentAreaContainer()),y=(w=>{const k=w.getBody(),x=w.getDoc().documentElement,E={left:k.scrollLeft,top:k.scrollTop},S={left:k.scrollLeft||x.scrollLeft,top:k.scrollTop||x.scrollTop};return w.inline?E:S})(f);return{left:b.pageX-v.left+y.left,top:b.pageY-v.top+y.top}}return{left:b.pageX,top:b.pageY}})(u,g),{pageX:h.left-p.left+m.left,pageY:h.top-p.top+m.top};var p,m,h})(e,r));i=s.ghost,l=e.getBody(),i.parentNode!==l&&l.appendChild(i),((u,g,p,m,h,f,b,v,y,w,k,x)=>{let E=0,S=0;u.style.left=g.pageX+"px",u.style.top=g.pageY+"px",g.pageX+p>h&&(E=g.pageX+p-h),g.pageY+m>f&&(S=g.pageY+m-f),u.style.width=p-E+"px",u.style.height=m-S+"px";const _=y.clientHeight,O=y.clientWidth,T=b+y.getBoundingClientRect().top,P=v+y.getBoundingClientRect().left;k.on(D=>{D.intervalId.clear(),D.dragging&&x&&(b+8>=_?D.intervalId.set(J1(w)):b-8<=0?D.intervalId.set(Q1(w)):v+8>=O?D.intervalId.set(X1(w)):v-8<=0?D.intervalId.set(Y1(w)):T+16>=window.innerHeight?D.intervalId.set(J1(window)):T-16<=0?D.intervalId.set(Q1(window)):P+16>=window.innerWidth?D.intervalId.set(X1(window)):P-16<=0&&D.intervalId.set(Y1(window)))})})(s.ghost,c,s.width,s.height,s.maxX,s.maxY,r.clientY,r.clientX,e.getContentAreaContainer(),e.getWin(),o,d),n.throttle(r.clientX,r.clientY)}var i,l})},tw=t=>{t.on(e=>{e.intervalId.clear(),Z1(e.ghost)}),t.clear()},yA=t=>{const e=ao(),n=Et.DOM,o=document,r=((l,d)=>c=>{if((p=>p.button===0)(c)){const p=Wt(d.dom.getParents(c.target),hA).getOr(null);if(Q(p)&&(u=d.getBody(),Rm(g=p)&&g!==u)){const m=d.dom.getPos(p),h=d.getBody(),f=d.getDoc().documentElement;l.set({element:p,dragging:!1,screenX:c.screenX,screenY:c.screenY,maxX:(d.inline?h.scrollWidth:f.offsetWidth)-2,maxY:(d.inline?h.scrollHeight:f.offsetHeight)-2,relX:c.pageX-m.x,relY:c.pageY-m.y,width:p.offsetWidth,height:p.offsetHeight,ghost:bA(d,p,p.offsetWidth,p.offsetHeight),intervalId:fk(100)})}}var u,g})(e,t),s=vA(e,t),a=((l,d)=>c=>{l.on(u=>{if(u.intervalId.clear(),u.dragging){if(((g,p,m)=>!jt(p)&&p!==m&&!g.dom.isChildOf(p,m)&&!Rm(p))(d,(g=>{const p=g.getSel();if(Q(p)){const m=p.getRangeAt(0).startContainer;return j(m)?m.parentNode:m}return null})(d.selection),u.element)){const g=(p=>{const m=p.cloneNode(!0);return m.removeAttribute("data-mce-selected"),m})(u.element);d.dispatch("drop",{clientX:c.clientX,clientY:c.clientY}).isDefaultPrevented()||d.undoManager.transact(()=>{Z1(u.element),d.insertContent(d.dom.getOuterHTML(g)),d._selectionOverrides.hideFakeCaret()})}d.dispatch("dragend")}}),tw(l)})(e,t),i=((l,d)=>()=>{l.on(c=>{c.intervalId.clear(),c.dragging&&d.dispatch("dragend")}),tw(l)})(e,t);t.on("mousedown",r),t.on("mousemove",s),t.on("mouseup",a),n.bind(o,"mousemove",s),n.bind(o,"mouseup",i),t.on("remove",()=>{n.unbind(o,"mousemove",s),n.unbind(o,"mouseup",i)}),t.on("keydown",l=>{l.keyCode===ot.ESC&&i()})},Wr=Rt,Am=(t,e)=>tr(t.getBody(),e),CA=t=>{const e=t.selection,n=t.dom,o=t.getBody(),r=zS(t,o,n.isBlock,()=>Qo(t)),s="sel-"+n.uniqueId(),a="data-mce-selected";let i;const l=f=>f!==o&&(Wr(f)||yn(f))&&n.isChildOf(f,o),d=(f,b,v,y=!0)=>t.dispatch("ShowCaret",{target:b,direction:f,before:v}).isDefaultPrevented()?null:(y&&e.scrollIntoView(b,f===-1),r.show(v,b)),c=f=>Ie(f)||Wa(f)||Ka(f),u=f=>c(f.startContainer)||c(f.endContainer),g=f=>{const b=t.schema.getVoidElements(),v=n.createRng(),y=f.startContainer,w=f.startOffset,k=f.endContainer,x=f.endOffset;return pt(b,y.nodeName.toLowerCase())?w===0?v.setStartBefore(y):v.setStartAfter(y):v.setStart(y,w),pt(b,k.nodeName.toLowerCase())?x===0?v.setEndBefore(k):v.setEndAfter(k):v.setEnd(k,x),v},p=(f,b)=>{if(!f)return null;if(f.collapsed){if(!u(f)){const k=b?1:-1,x=Hs(k,o,f),E=x.getNode(!b);if(Q(E)){if(Fs(E))return d(k,E,!!b&&!x.isAtEnd(),!1);if(oo(E)&&Rt(E.nextSibling)){const _=n.createRng();return _.setStart(E,0),_.setEnd(E,0),_}}const S=x.getNode(b);if(Q(S)){if(Fs(S))return d(k,S,!b&&!x.isAtEnd(),!1);if(oo(S)&&Rt(S.previousSibling)){const _=n.createRng();return _.setStart(S,1),_.setEnd(S,1),_}}}return null}let v=f.startContainer,y=f.startOffset;const w=f.endOffset;if(j(v)&&y===0&&Wr(v.parentNode)&&(v=v.parentNode,y=n.nodeIndex(v),v=v.parentNode),!J(v))return null;if(w===y+1&&v===f.endContainer){const k=v.childNodes[y];if(l(k))return(x=>{const E=x.cloneNode(!0),S=t.dispatch("ObjectSelected",{target:x,targetClone:E});if(S.isDefaultPrevented())return null;const _=((T,P)=>{const D=N(t.getBody()),I=t.getDoc(),q=bs(D,"#"+s).getOrThunk(()=>{const at=La('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',I);return Qt(at,"id",s),Kt(D,at),at}),W=n.createRng();ps(q),To(q,[hr(Zt,I),N(P),hr(Zt,I)]),W.setStart(q.dom.firstChild,1),W.setEnd(q.dom.lastChild,0),Ia(q,{top:n.getPos(T,t.getBody()).y+"px"}),gb(q);const rt=e.getSel();return rt&&(rt.removeAllRanges(),rt.addRange(W)),W})(x,S.targetClone),O=N(x);return H(le(N(t.getBody()),"*[data-mce-selected]"),T=>{xt(O,T)||ne(T,a)}),n.getAttrib(x,a)||x.setAttribute(a,"1"),i=x,h(),_})(k)}return null},m=()=>{i&&i.removeAttribute(a),bs(N(t.getBody()),"#"+s).each(Tt),i=null},h=()=>{r.hide()};return Rn(t)||(t.on("click",f=>{const b=Am(t,f.target);b&&Wr(b)&&(f.preventDefault(),t.focus())}),t.on("blur NewBlock",m),t.on("ResizeWindow FullscreenStateChanged",r.reposition),t.on("tap",f=>{const b=f.target,v=Am(t,b);Wr(v)?(f.preventDefault(),aa(t,v).each(p)):l(b)&&aa(t,b).each(p)},!0),t.on("mousedown",f=>{const b=f.target;if(b!==o&&b.nodeName!=="HTML"&&!n.isChildOf(b,o)||!((y,w,k)=>{const x=N(y.getBody()),E=y.inline?x:N(Un(x).dom.documentElement),S=((_,O,T,P)=>{const D=(I=>I.dom.getBoundingClientRect())(O);return{x:T-(_?D.left+O.dom.clientLeft+sN(O):0),y:P-(_?D.top+O.dom.clientTop+rN(O):0)}})(y.inline,E,w,k);return((_,O,T)=>{const P=nN(_),D=oN(_);return O>=0&&T>=0&&O<=P&&T<=D})(E,S.x,S.y)})(t,f.clientX,f.clientY))return;m(),h();const v=Am(t,b);Wr(v)?(f.preventDefault(),aa(t,v).each(p)):K1(o,f.clientX,f.clientY).each(y=>{var w;f.preventDefault(),(w=d(1,y.node,y.position===qr.Before,!1))&&e.setRng(w),J(v)?v.focus():t.getBody().focus()})}),t.on("keypress",f=>{ot.modifierPressed(f)||Wr(e.getNode())&&f.preventDefault()}),t.on("GetSelectionRange",f=>{let b=f.range;if(i){if(!i.parentNode)return void(i=null);b=b.cloneRange(),b.selectNode(i),f.range=b}}),t.on("SetSelectionRange",f=>{f.range=g(f.range);const b=p(f.range,f.forward);b&&(f.range=b)}),t.on("AfterSetSelectionRange",f=>{const b=f.range,v=b.startContainer.parentElement;var y;u(b)||J(y=v)&&y.id==="mcepastebin"||h(),(w=>Q(w)&&n.hasClass(w,"mce-offscreen-selection"))(v)||m()}),(f=>{yA(f),dS(f)&&(b=>{const v=k=>{if(!k.isDefaultPrevented()){const x=k.dataTransfer;x&&(_t(x.types,"Files")||x.files.length>0)&&(k.preventDefault(),k.type==="drop"&&Gi(b,"Dropped file type is not supported"))}},y=k=>{Ni(b,k.target)&&v(k)},w=()=>{const k=Et.DOM,x=b.dom,E=document,S=b.inline?b.getBody():b.getDoc(),_=["drop","dragover"];H(_,O=>{k.bind(E,O,y),x.bind(S,O,v)}),b.on("remove",()=>{H(_,O=>{k.unbind(E,O,y),x.unbind(S,O,v)})})};b.on("init",()=>{He.setEditorTimeout(b,w,0)})})(f)})(t),(f=>{const b=ei(()=>{if(!f.removed&&f.getBody().contains(document.activeElement)){const v=f.selection.getRng();if(v.collapsed){const y=Lu(f,v,!1);f.selection.setRng(y)}}},0);f.on("focus",()=>{b.throttle()}),f.on("blur",()=>{b.cancel()})})(t),(f=>{f.on("init",()=>{f.on("focusin",b=>{const v=b.target;if(yn(v)){const y=tr(f.getBody(),v),w=Rt(y)?y:v;f.selection.getNode()!==w&&aa(f,w).each(k=>f.selection.setRng(k))}})})})(t)),{showCaret:d,showBlockCaretContainer:f=>{f.hasAttribute("data-mce-caret")&&(fd(f),e.scrollIntoView(f))},hideFakeCaret:h,destroy:()=>{r.destroy(),i=null}}},wA=(t,e)=>{let n=e;for(let o=t.previousSibling;j(o);o=o.previousSibling)n+=o.data.length;return n},ew=(t,e,n,o,r)=>{if(j(n)&&(o<0||o>n.data.length))return[];const s=r&&j(n)?[wA(n,o)]:[o];let a=n;for(;a!==e&&a.parentNode;)s.push(t.nodeIndex(a,r)),a=a.parentNode;return a===e?s.reverse():[]},Om=(t,e,n,o,r,s,a=!1)=>({start:ew(t,e,n,o,a),end:ew(t,e,r,s,a)}),nw=(t,e)=>{const n=e.slice(),o=n.pop();return Je(o)?Re(n,(r,s)=>r.bind(a=>C.from(a.childNodes[s])),C.some(t)).bind(r=>j(r)&&(o<0||o>r.data.length)?C.none():C.some({node:r,offset:o})):C.none()},ow=(t,e)=>nw(t,e.start).bind(({node:n,offset:o})=>nw(t,e.end).map(({node:r,offset:s})=>{const a=document.createRange();return a.setStart(n,o),a.setEnd(r,s),a})),Kr=(t,e,n)=>{if(e&&t.isEmpty(e)&&!n(e)){const o=e.parentNode;t.remove(e),Kr(t,o,n)}},yl=(t,e,n,o=!0)=>{const r=e.startContainer.parentNode,s=e.endContainer.parentNode;e.deleteContents(),o&&!n(e.startContainer)&&(j(e.startContainer)&&e.startContainer.data.length===0&&t.remove(e.startContainer),j(e.endContainer)&&e.endContainer.data.length===0&&t.remove(e.endContainer),Kr(t,r,n),r!==s&&Kr(t,s,n))},Tm=(t,e)=>C.from(t.dom.getParent(e.startContainer,t.dom.isBlock)),rw=(t,e,n)=>{const o=t.dynamicPatternsLookup({text:n,block:e});return K(K({},t),{blockPatterns:Rp(o).concat(t.blockPatterns),inlinePatterns:Ap(o).concat(t.inlinePatterns)})},sw=(t,e,n,o)=>{const r=t.createRng();return r.setStart(e,0),r.setEnd(n,o),r.toString()},aw=(t,e,n)=>{((o,r,s)=>{if(j(o)&&0>=o.length)return C.some(un(o,0));{const a=Ho(rl);return C.from(a.forwards(o,0,sl(o),s)).map(i=>un(i.container,0))}})(e,0,e).each(o=>{const r=o.container;jC(r,n.start.length,e).each(s=>{const a=t.createRng();a.setStart(r,0),a.setEnd(s.container,s.offset),yl(t,a,i=>i===e)})})},iw=(t,e)=>t.create("span",{"data-mce-type":"bookmark",id:e}),Cl=(t,e)=>{const n=t.createRng();return n.setStartAfter(e.start),n.setEndBefore(e.end),n},lw=(t,e,n)=>{const o=ow(t.getRoot(),n).getOrDie("Unable to resolve path range"),r=o.startContainer,s=o.endContainer,a=o.endOffset===0?s:s.splitText(o.endOffset),i=o.startOffset===0?r:r.splitText(o.startOffset),l=i.parentNode;return{prefix:e,end:a.parentNode.insertBefore(iw(t,e+"-end"),a),start:l.insertBefore(iw(t,e+"-start"),i)}},dw=(t,e,n)=>{Kr(t,t.get(e.prefix+"-end"),n),Kr(t,t.get(e.prefix+"-start"),n)},Bm=t=>t.start.length===0,cw=(t,e,n,o)=>{const r=e.start;var s;return om(t,o.container,o.offset,(s=r,(a,i)=>{const l=a.data.substring(0,i),d=l.lastIndexOf(s.charAt(s.length-1)),c=l.lastIndexOf(s);return c!==-1?c+s.length:d!==-1?d+1:-1}),n).bind(a=>{var i,l;const d=(l=(i=n.textContent)===null||i===void 0?void 0:i.indexOf(r))!==null&&l!==void 0?l:-1;if(d!==-1&&a.offset>=d+r.length){const c=t.createRng();return c.setStart(a.container,a.offset-r.length),c.setEnd(a.container,a.offset),C.some(c)}{const c=a.offset-r.length;return nm(a.container,c,n).map(u=>{const g=t.createRng();return g.setStart(u.container,u.offset),g.setEnd(a.container,a.offset),g}).filter(u=>u.toString()===r).orThunk(()=>cw(t,e,n,un(a.container,0)))}})},xA=(t,e,n,o)=>{const r=t.dom,s=r.getRoot(),a=n.pattern,i=n.position.container,l=n.position.offset;return nm(i,l-n.pattern.end.length,e).bind(d=>{const c=Om(r,s,d.container,d.offset,i,l,o);if(Bm(a))return C.some({matches:[{pattern:a,startRng:c,endRng:c}],position:d});{const u=wl(t,n.remainingPatterns,d.container,d.offset,e,o),g=u.getOr({matches:[],position:d}),p=g.position;return((h,f,b,v,y,w=!1)=>{if(f.start.length===0&&!w){const k=h.createRng();return k.setStart(b,v),k.setEnd(b,v),C.some(k)}return em(b,v,y).bind(k=>cw(h,f,y,k).bind(x=>{var E;return w&&(x.endContainer===k.container&&x.endOffset===k.offset||k.offset===0&&((E=x.endContainer.textContent)===null||E===void 0?void 0:E.length)===x.endOffset)?C.none():C.some(x)}))})(r,a,p.container,p.offset,e,u.isNone()).map(h=>{const f=((b,v,y,w=!1)=>Om(b,v,y.startContainer,y.startOffset,y.endContainer,y.endOffset,w))(r,s,h,o);return{matches:g.matches.concat([{pattern:a,startRng:f,endRng:c}]),position:un(h.startContainer,h.startOffset)}})}})},wl=(t,e,n,o,r,s)=>{const a=t.dom;return em(n,o,a.getRoot()).bind(i=>{const l=sw(a,r,n,o);for(let d=0;d<e.length;d++){const c=e[d];if(!cf(l,c.end))continue;const u=e.slice();u.splice(d,1);const g=xA(t,r,{pattern:c,remainingPatterns:u,position:i},s);if(g.isNone()&&o>0)return wl(t,e,n,o-1,r,s);if(g.isSome())return g}return C.none()})},uw=(t,e,n)=>{t.selection.setRng(n),e.type==="inline-format"?H(e.format,o=>{t.formatter.apply(o)}):t.execCommand(e.cmd,!1,e.value)},mw=(t,e,n,o,r,s)=>{var a;return((i,l)=>{const d=So(i,c=>It(l,u=>c.pattern.start===u.pattern.start&&c.pattern.end===u.pattern.end));return i.length===l.length?d?i:l:i.length>l.length?i:l})(wl(t,r.inlinePatterns,n,o,e,s).fold(()=>[],i=>i.matches),wl(t,(a=r.inlinePatterns,ur(a,(i,l)=>l.end.length-i.end.length)),n,o,e,s).fold(()=>[],i=>i.matches))},fw=(t,e)=>{if(e.length===0)return;const n=t.dom,o=t.selection.getBookmark(),r=((s,a)=>{const i=Zg("mce_textpattern"),l=_a(a,(d,c)=>{const u=lw(s,i+`_end${d.length}`,c.endRng);return d.concat([K(K({},c),{endMarker:u})])},[]);return _a(l,(d,c)=>{const u=l.length-d.length-1,g=Bm(c.pattern)?c.endMarker:lw(s,i+`_start${u}`,c.startRng);return d.concat([K(K({},c),{startMarker:g})])},[])})(n,e);H(r,s=>{const a=n.getParent(s.startMarker.start,n.isBlock),i=l=>l===a;Bm(s.pattern)?((l,d,c,u)=>{const g=Cl(l.dom,c);yl(l.dom,g,u),uw(l,d,g)})(t,s.pattern,s.endMarker,i):((l,d,c,u,g)=>{const p=l.dom,m=Cl(p,u),h=Cl(p,c);yl(p,h,g),yl(p,m,g);const f={prefix:c.prefix,start:c.end,end:u.start},b=Cl(p,f);uw(l,d,b)})(t,s.pattern,s.startMarker,s.endMarker,i),dw(n,s.endMarker,i),dw(n,s.startMarker,i)}),t.selection.moveToBookmark(o)},kA=(t,e)=>{const n=t.selection.getRng();return Tm(t,n).map(o=>{var r;const s=Math.max(0,n.startOffset),a=rw(e,o,(r=o.textContent)!==null&&r!==void 0?r:""),i=mw(t,o,n.startContainer,s,a,!0),l=((d,c,u,g)=>{var p;const m=d.dom,h=Be(d);if(!m.is(c,h))return[];const f=(p=c.textContent)!==null&&p!==void 0?p:"";return((b,v)=>{const y=(k=>ur(k,(x,E)=>E.start.length-x.start.length))(b),w=v.replace(Zt," ");return Wt(y,k=>v.indexOf(k.start)===0||w.indexOf(k.start)===0)})(u.blockPatterns,f).map(b=>$.trim(f).length===b.start.length?[]:[{pattern:b,range:Om(m,m.getRoot(),c,0,c,0,!0)}]).getOr([])})(t,o,a);return(l.length>0||i.length>0)&&(t.undoManager.add(),t.undoManager.extra(()=>{t.execCommand("mceInsertNewLine")},()=>{t.insertContent(ys),fw(t,i),((u,g)=>{if(g.length===0)return;const p=u.selection.getBookmark();H(g,m=>((h,f)=>{const b=h.dom,v=f.pattern,y=ow(b.getRoot(),f.range).getOrDie("Unable to resolve path range");return Tm(h,y).each(w=>{v.type==="block-format"?((k,x)=>{const E=x.get(k);return $t(E)&&xe(E).exists(S=>pt(S,"block"))})(v.format,h.formatter)&&h.undoManager.transact(()=>{aw(h.dom,w,v),h.formatter.apply(v.format)}):v.type==="block-command"&&h.undoManager.transact(()=>{aw(h.dom,w,v),h.execCommand(v.cmd,!1,v.value)})}),!0})(u,m)),u.selection.moveToBookmark(p)})(t,l);const d=t.selection.getRng(),c=em(d.startContainer,d.startOffset,t.dom.getRoot());t.execCommand("mceInsertNewLine"),c.each(u=>{const g=u.container;g.data.charAt(u.offset-1)===ys&&(g.deleteData(u.offset-1,1),Kr(t.dom,g.parentNode,p=>p===t.dom.getRoot()))})}),!0)}).getOr(!1)},gw=(t,e,n)=>{for(let o=0;o<t.length;o++)if(n(t[o],e))return!0;return!1},SA=t=>{const e=$.each,n=ot.BACKSPACE,o=ot.DELETE,r=t.dom,s=t.selection,a=t.parser,i=Ct.browser,l=i.isFirefox(),d=i.isChromium()||i.isSafari(),c=Ct.deviceType.isiPhone()||Ct.deviceType.isiPad(),u=Ct.os.isMacOS()||Ct.os.isiOS(),g=(T,P)=>{try{t.getDoc().execCommand(T,!1,String(P))}catch(D){}},p=T=>T.isDefaultPrevented(),m=()=>{t.shortcuts.add("meta+a",null,"SelectAll")},h=()=>{t.inline||r.bind(t.getDoc(),"mousedown mouseup",T=>{let P;if(T.target===t.getDoc().documentElement)if(P=s.getRng(),t.getBody().focus(),T.type==="mousedown"){if(Ie(P.startContainer))return;s.placeCaretAt(T.clientX,T.clientY)}else s.setRng(P)})},f=()=>{Range.prototype.getClientRects||t.on("mousedown",T=>{if(!p(T)&&T.target.nodeName==="HTML"){const P=t.getBody();P.blur(),He.setEditorTimeout(t,()=>{P.focus()})}})},b=()=>{const T=qp(t);t.on("click",P=>{const D=P.target;/^(IMG|HR)$/.test(D.nodeName)&&r.getContentEditableParent(D)!=="false"&&(P.preventDefault(),t.selection.select(D),t.nodeChanged()),D.nodeName==="A"&&r.hasClass(D,T)&&D.childNodes.length===0&&(P.preventDefault(),s.select(D))})},v=()=>{t.on("keydown",T=>{if(!p(T)&&T.keyCode===n&&s.isCollapsed()&&s.getRng().startOffset===0){const P=s.getNode().previousSibling;if(P&&P.nodeName&&P.nodeName.toLowerCase()==="table")return T.preventDefault(),!1}return!0})},y=()=>{$p(t)||t.on("BeforeExecCommand mousedown",()=>{g("StyleWithCSS",!1),g("enableInlineTableEditing",!1),jp(t)||g("enableObjectResizing",!1)})},w=()=>{t.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},k=()=>{t.inline||t.on("keydown",()=>{document.activeElement===document.body&&t.getWin().focus()})},x=()=>{t.inline||(t.contentStyles.push("body {min-height: 150px}"),t.on("click",T=>{let P;T.target.nodeName==="HTML"&&(P=t.selection.getRng(),t.getBody().focus(),t.selection.setRng(P),t.selection.normalize(),t.nodeChanged())}))},E=()=>{u&&t.on("keydown",T=>{!ot.metaKeyPressed(T)||T.shiftKey||T.keyCode!==37&&T.keyCode!==39||(T.preventDefault(),t.selection.getSel().modify("move",T.keyCode===37?"backward":"forward","lineboundary"))})},S=()=>{t.on("click",T=>{let P=T.target;do if(P.tagName==="A")return void T.preventDefault();while(P=P.parentNode)}),t.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},_=()=>{t.on("init",()=>{t.dom.bind(t.getBody(),"submit",T=>{T.preventDefault()})})},O=bt;return Rn(t)?(d&&(h(),b(),_(),m(),c&&(k(),x(),S())),l&&(f(),y(),w(),E())):(t.on("keydown",T=>{if(p(T)||T.keyCode!==ot.BACKSPACE)return;let P=s.getRng();const D=P.startContainer,I=P.startOffset,q=r.getRoot();let W=D;if(P.collapsed&&I===0){for(;W.parentNode&&W.parentNode.firstChild===W&&W.parentNode!==q;)W=W.parentNode;W.nodeName==="BLOCKQUOTE"&&(t.formatter.toggle("blockquote",void 0,W),P=r.createRng(),P.setStart(D,0),P.setEnd(D,0),s.setRng(P))}}),(()=>{const T=P=>{const D=r.create("body"),I=P.cloneContents();return D.appendChild(I),s.serializer.serialize(D,{format:"html"})};t.on("keydown",P=>{const D=P.keyCode;if(!p(P)&&(D===o||D===n)){const I=t.selection.isCollapsed(),q=t.getBody();if(I&&!r.isEmpty(q)||!I&&!(W=>{const rt=T(W),at=r.createRng();return at.selectNode(t.getBody()),rt===T(at)})(t.selection.getRng()))return;P.preventDefault(),t.setContent(""),q.firstChild&&r.isBlock(q.firstChild)?t.selection.setCursorLocation(q.firstChild,0):t.selection.setCursorLocation(q,0),t.nodeChanged()}})})(),Ct.windowsPhone||t.on("keyup focusin mouseup",T=>{ot.modifierPressed(T)||(P=>{const D=P.getBody(),I=P.selection.getRng();return I.startContainer===I.endContainer&&I.startContainer===D&&I.startOffset===0&&I.endOffset===D.childNodes.length})(t)||s.normalize()},!0),d&&(h(),b(),t.on("init",()=>{g("DefaultParagraphSeparator",Be(t))}),_(),v(),a.addNodeFilter("br",T=>{let P=T.length;for(;P--;)T[P].attr("class")==="Apple-interchange-newline"&&T[P].remove()}),c?(k(),x(),S()):m()),l&&(t.on("keydown",T=>{if(!p(T)&&T.keyCode===n){if(!t.getBody().getElementsByTagName("hr").length)return;if(s.isCollapsed()&&s.getRng().startOffset===0){const P=s.getNode(),D=P.previousSibling;if(P.nodeName==="HR")return r.remove(P),void T.preventDefault();D&&D.nodeName&&D.nodeName.toLowerCase()==="hr"&&(r.remove(D),T.preventDefault())}}}),f(),(()=>{const T=()=>{const D=r.getAttribs(s.getStart().cloneNode(!1));return()=>{const I=s.getStart();I!==t.getBody()&&(r.setAttrib(I,"style",null),e(D,q=>{I.setAttributeNode(q.cloneNode(!0))}))}},P=()=>!s.isCollapsed()&&r.getParent(s.getStart(),r.isBlock)!==r.getParent(s.getEnd(),r.isBlock);t.on("keypress",D=>{let I;return!(!(p(D)||D.keyCode!==8&&D.keyCode!==46)&&P()&&(I=T(),t.getDoc().execCommand("delete",!1),I(),D.preventDefault(),1))}),r.bind(t.getDoc(),"cut",D=>{if(!p(D)&&P()){const I=T();He.setEditorTimeout(t,()=>{I()})}})})(),y(),t.on("SetContent ExecCommand",T=>{T.type!=="setcontent"&&T.command!=="mceInsertLink"||e(r.select("a:not([data-mce-block])"),P=>{var D;let I=P.parentNode;const q=r.getRoot();if((I==null?void 0:I.lastChild)===P){for(;I&&!r.isBlock(I);){if(((D=I.parentNode)===null||D===void 0?void 0:D.lastChild)!==I||I===q)return;I=I.parentNode}r.add(I,"br",{"data-mce-bogus":1})}})}),w(),E(),v())),{refreshContentEditable:O,isHidden:()=>{if(!l||t.removed)return!1;const T=t.selection.getSel();return!T||!T.rangeCount||T.rangeCount===0}}},Dm=Et.DOM,EA=t=>t.inline?t.getElement().nodeName.toLowerCase():void 0,Pm=t=>rs(t,e=>fe(e)===!1),pw=t=>{const e=t.options.get,n=t.editorUpload.blobCache;return Pm({allow_conditional_comments:e("allow_conditional_comments"),allow_html_data_urls:e("allow_html_data_urls"),allow_svg_data_urls:e("allow_svg_data_urls"),allow_html_in_named_anchor:e("allow_html_in_named_anchor"),allow_script_urls:e("allow_script_urls"),allow_unsafe_link_target:e("allow_unsafe_link_target"),convert_fonts_to_spans:e("convert_fonts_to_spans"),fix_list_elements:e("fix_list_elements"),font_size_legacy_values:e("font_size_legacy_values"),forced_root_block:e("forced_root_block"),forced_root_block_attrs:e("forced_root_block_attrs"),preserve_cdata:e("preserve_cdata"),remove_trailing_brs:e("remove_trailing_brs"),inline_styles:e("inline_styles"),root_name:EA(t),validate:!0,blob_cache:n,document:t.getDoc()})},hw=t=>{const e=t.options.get;return Pm({custom_elements:e("custom_elements"),extended_valid_elements:e("extended_valid_elements"),invalid_elements:e("invalid_elements"),invalid_styles:e("invalid_styles"),schema:e("schema"),valid_children:e("valid_children"),valid_classes:e("valid_classes"),valid_elements:e("valid_elements"),valid_styles:e("valid_styles"),verify_html:e("verify_html"),padd_empty_block_inline_children:e("format_empty_lines")})},bw=t=>t.inline?t.ui.styleSheetLoader:t.dom.styleSheetLoader,vw=t=>{const e=bw(t),n=zp(t),o=t.contentCSS,r=()=>{e.unloadAll(o),t.inline||t.ui.styleSheetLoader.unloadAll(n)},s=()=>{t.removed?r():t.on("remove",r)};if(t.contentStyles.length>0){let l="";$.each(t.contentStyles,d=>{l+=d+`\r
`}),t.dom.addStyle(l)}const a=Promise.all(((l,d,c)=>{const u=[bw(l).loadAll(d)];return l.inline?u:u.concat([l.ui.styleSheetLoader.loadAll(c)])})(t,o,n)).then(s).catch(s),i=$k(t);return i&&((l,d)=>{const c=N(l.getBody()),u=ed(Qn(c)),g=Jt("style");Qt(g,"type","text/css"),Kt(g,hr(d)),Kt(u,g),l.on("remove",()=>{Tt(g)})})(t,i),a},Lm=t=>{t.removed!==!0&&((e=>{Rn(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})})(t),(e=>{e.bindPendingEventDelegates(),e.initialized=!0,(o=>{o.dispatch("Init")})(e),e.focus(!0),(o=>{const r=o.dom.getRoot();o.inline||hi(o)&&o.selection.getStart(!0)!==r||be(r).each(s=>{const a=s.getNode(),i=zn(a)?be(a).getOr(s):s;o.selection.setRng(i.toRange())})})(e),e.nodeChanged({initial:!0});const n=gS(e);wt(n)&&n.call(e,e),(o=>{const r=hS(o);r&&He.setEditorTimeout(o,()=>{let s;s=r===!0?o:o.editorManager.get(r),s&&!s.destroyed&&(s.focus(),s.selection.scrollIntoView())},100)})(e)})(t))},yw=t=>{const e=t.getElement();let n=t.getDoc();t.inline&&(Dm.addClass(e,"mce-content-body"),t.contentDocument=n=document,t.contentWindow=window,t.bodyElement=e,t.contentAreaContainer=e);const o=t.getBody();o.disabled=!0,t.readonly=$p(t),t.readonly||(t.inline&&Dm.getStyle(o,"position",!0)==="static"&&(o.style.position="relative"),o.contentEditable="true"),o.disabled=!1,t.editorUpload=cN(t),t.schema=so(hw(t)),t.dom=Et(n,{keep_values:!0,url_converter:t.convertURL,url_converter_scope:t,update_styles:!0,root_element:t.inline?t.getBody():null,collect:t.inline,schema:t.schema,contentCssCors:Uk(t),referrerPolicy:Ud(t),onSetAttrib:a=>{t.dispatch("SetAttrib",a)}}),t.parser=(a=>{const i=Ir(pw(a),a.schema);return i.addAttributeFilter("src,href,style,tabindex",(l,d)=>{const c=a.dom,u="data-mce-"+d;let g=l.length;for(;g--;){const p=l[g];let m=p.attr(d);if(m&&!p.attr(u)){if(m.indexOf("data:")===0||m.indexOf("blob:")===0)continue;d==="style"?(m=c.serializeStyle(c.parseStyle(m),p.name),m.length||(m=null),p.attr(u,m),p.attr(d,m)):d==="tabindex"?(p.attr(u,m),p.attr(d,null)):p.attr(u,a.convertURL(m,d,p.name))}}}),i.addNodeFilter("script",l=>{let d=l.length;for(;d--;){const c=l[d],u=c.attr("type")||"no/type";u.indexOf("mce-")!==0&&c.attr("type","mce-"+u)}}),DS(a)&&i.addNodeFilter("#cdata",l=>{var d;let c=l.length;for(;c--;){const u=l[c];u.type=8,u.name="#comment",u.value="[CDATA["+a.dom.encode((d=u.value)!==null&&d!==void 0?d:"")+"]]"}}),i.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",l=>{let d=l.length;const c=a.schema.getNonEmptyElements();for(;d--;){const u=l[d];u.isEmpty(c)&&u.getAll("br").length===0&&u.append(new ve("br",1))}}),i})(t),t.serializer=Xv((a=>{const i=a.options.get;return K(K(K({},pw(a)),hw(a)),Pm({url_converter:i("url_converter"),url_converter_scope:i("url_converter_scope"),element_format:i("element_format"),entities:i("entities"),entity_encoding:i("entity_encoding"),indent:i("indent"),indent_after:i("indent_after"),indent_before:i("indent_before")}))})(t),t),t.selection=Yv(t.dom,t.getWin(),t.serializer,t),t.annotator=jh(t),t.formatter=ly(t),t.undoManager=cy(t),t._nodeChangeDispatcher=new ZR(t),t._selectionOverrides=CA(t),(a=>{const i=ao(),l=Gt(!1),d=Rd(c=>{a.dispatch("longpress",K(K({},c),{type:"longpress"})),l.set(!0)},400);a.on("touchstart",c=>{cC(c).each(u=>{d.cancel();const g={x:u.clientX,y:u.clientY,target:c.target};d.throttle(c),l.set(!1),i.set(g)})},!0),a.on("touchmove",c=>{d.cancel(),cC(c).each(u=>{i.on(g=>{((p,m)=>{const h=Math.abs(p.clientX-m.x),f=Math.abs(p.clientY-m.y);return h>5||f>5})(u,g)&&(i.clear(),l.set(!1),a.dispatch("longpresscancel"))})})},!0),a.on("touchend touchcancel",c=>{d.cancel(),c.type!=="touchcancel"&&i.get().filter(u=>u.target.isEqualNode(c.target)).each(()=>{l.get()?c.preventDefault():a.dispatch("tap",K(K({},c),{type:"tap"}))})},!0)})(t),(a=>{(i=>{i.on("click",l=>{i.dom.getParent(l.target,"details")&&l.preventDefault()})})(a),(i=>{i.parser.addNodeFilter("details",l=>{H(l,d=>{d.attr("data-mce-open",d.attr("open")),d.attr("open","open")})}),i.serializer.addNodeFilter("details",l=>{H(l,d=>{const c=d.attr("data-mce-open");d.attr("open",it(c)?c:null),d.attr("data-mce-open",null)})})})(a)})(t),(a=>{const i="contenteditable",l=" "+$.trim(TS(a))+" ",d=" "+$.trim(Wp(a))+" ",c=fC(l),u=fC(d),g=BS(a);g.length>0&&a.on("BeforeSetContent",p=>{((m,h,f)=>{let b=h.length,v=f.content;if(f.format!=="raw"){for(;b--;)v=v.replace(h[b],QN(m,v,Wp(m)));f.content=v}})(a,g,p)}),a.parser.addAttributeFilter("class",p=>{let m=p.length;for(;m--;){const h=p[m];c(h)?h.attr(i,"true"):u(h)&&h.attr(i,"false")}}),a.serializer.addAttributeFilter(i,p=>{let m=p.length;for(;m--;){const h=p[m];(c(h)||u(h))&&(g.length>0&&h.attr("data-mce-content")?(h.name="#text",h.type=3,h.raw=!0,h.value=h.attr("data-mce-content")):h.attr(i,null))}})})(t),Rn(t)||((a=>{a.on("mousedown",i=>{i.detail>=3&&(i.preventDefault(),uA(a))})})(t),(a=>{(i=>{const l=[",",".",";",":","!","?"],d=[32],c=()=>{return p=AS(i),m=OS(i),{inlinePatterns:Ap(p),blockPatterns:Rp(p),dynamicPatternsLookup:m};var p,m},u=()=>(p=>p.options.isSet("text_patterns_lookup"))(i);i.on("keydown",p=>{if(p.keyCode===13&&!ot.modifierPressed(p)&&i.selection.isCollapsed()){const m=c();(m.inlinePatterns.length>0||m.blockPatterns.length>0||u())&&kA(i,m)&&p.preventDefault()}},!0);const g=()=>{if(i.selection.isCollapsed()){const p=c();(p.inlinePatterns.length>0||u())&&((m,h)=>{const f=m.selection.getRng();Tm(m,f).map(b=>{const v=Math.max(0,f.startOffset-1),y=sw(m.dom,b,f.startContainer,v),w=rw(h,b,y),k=mw(m,b,f.startContainer,v,w,!1);k.length>0&&m.undoManager.transact(()=>{fw(m,k)})})})(i,p)}};i.on("keyup",p=>{gw(d,p,(m,h)=>m===h.keyCode&&!ot.modifierPressed(h))&&g()}),i.on("keypress",p=>{gw(l,p,(m,h)=>m.charCodeAt(0)===h.charCode)&&He.setEditorTimeout(i,g)})})(a)})(t));const r=JR(t);KN(t,r),(a=>{a.on("NodeChange",tt(XN,a))})(t),(a=>{var i;const l=a.dom,d=Be(a),c=(i=Kk(a))!==null&&i!==void 0?i:"",u=(g,p)=>{if((f=>{if(my(f)){const b=f.keyCode;return!fy(f)&&(ot.metaKeyPressed(f)||f.altKey||b>=112&&b<=123||_t(pN,b))}return!1})(g))return;const m=a.getBody(),h=!(f=>my(f)&&!(fy(f)||f.type==="keyup"&&f.keyCode===229))(g)&&((f,b,v)=>{if(Ut(N(b),!1)){const y=b.firstElementChild;return!y||!f.getStyle(b.firstElementChild,"padding-left")&&!f.getStyle(b.firstElementChild,"padding-right")&&v===y.nodeName.toLowerCase()}return!1})(l,m,d);(l.getAttrib(m,uy)!==""!==h||p)&&(l.setAttrib(m,uy,h?c:null),l.setAttrib(m,"aria-placeholder",h?c:null),((f,b)=>{f.dispatch("PlaceholderToggle",{state:b})})(a,h),a.on(h?"keydown":"keyup",u),a.off(h?"keyup":"keydown",u))};pn(c)&&a.on("init",g=>{u(g,!0),a.on("change SetContent ExecCommand",u),a.on("paste",p=>He.setEditorTimeout(a,()=>u(p)))})})(t),lA(t);const s=(a=>{const i=a;return(l=>At(l.plugins,"rtc").bind(d=>C.from(d.setup)))(a).fold(()=>(i.rtcInstance=$v(a),C.none()),l=>(i.rtcInstance=(()=>{const d=Y(null),c=Y("");return{init:{bindEvents:bt},undoManager:{beforeChange:bt,add:d,undo:d,redo:d,clear:bt,reset:bt,hasUndo:Dt,hasRedo:Dt,transact:d,ignore:bt,extra:bt},formatter:{match:Dt,matchAll:Y([]),matchNode:Y(void 0),canApply:Dt,closest:c,apply:bt,remove:bt,toggle:bt,formatChanged:Y({unbind:bt})},editor:{getContent:c,setContent:Y({content:"",html:""}),insertContent:Y(""),addVisual:bt},selection:{getContent:c},autocompleter:{addDecoration:bt,removeDecoration:bt},raw:{getModel:Y(C.none())}}})(),C.some(()=>l().then(d=>(i.rtcInstance=(c=>{const u=y=>me(y)?y:{},{init:g,undoManager:p,formatter:m,editor:h,selection:f,autocompleter:b,raw:v}=c;return{init:{bindEvents:g.bindEvents},undoManager:{beforeChange:p.beforeChange,add:p.add,undo:p.undo,redo:p.redo,clear:p.clear,reset:p.reset,hasUndo:p.hasUndo,hasRedo:p.hasRedo,transact:(y,w,k)=>p.transact(k),ignore:(y,w)=>p.ignore(w),extra:(y,w,k,x)=>p.extra(k,x)},formatter:{match:(y,w,k,x)=>m.match(y,u(w),x),matchAll:m.matchAll,matchNode:m.matchNode,canApply:y=>m.canApply(y),closest:y=>m.closest(y),apply:(y,w,k)=>m.apply(y,u(w)),remove:(y,w,k,x)=>m.remove(y,u(w)),toggle:(y,w,k)=>m.toggle(y,u(w)),formatChanged:(y,w,k,x,E)=>m.formatChanged(w,k,x,E)},editor:{getContent:y=>h.getContent(y),setContent:(y,w)=>({content:h.setContent(y,w),html:""}),insertContent:(y,w)=>(h.insertContent(y),""),addVisual:h.addVisual},selection:{getContent:(y,w)=>f.getContent(w)},autocompleter:{addDecoration:b.addDecoration,removeDecoration:b.removeDecoration},raw:{getModel:()=>C.some(v.getRawModel())}}})(d),d.rtc.isRemote)))))})(t);(a=>{const i=a.getDoc(),l=a.getBody();(u=>{u.dispatch("PreInit")})(a),bS(a)||(i.body.spellcheck=!1,Dm.setAttrib(l,"spellcheck","false")),a.quirks=SA(a),(u=>{u.dispatch("PostRender")})(a);const d=Vk(a);d!==void 0&&(l.dir=d);const c=vS(a);c&&a.on("BeforeSetContent",u=>{$.each(c,g=>{u.content=u.content.replace(g,p=>"<!--mce:protected "+escape(p)+"-->")})}),a.on("SetContent",()=>{a.addVisual(a.getBody())}),a.on("compositionstart compositionend",u=>{a.composing=u.type==="compositionstart"})})(t),s.fold(()=>{vw(t).then(()=>Lm(t))},a=>{t.setProgressState(!0),vw(t).then(()=>{a().then(i=>{t.setProgressState(!1),Lm(t),Vv(t)},i=>{t.notificationManager.open({type:"error",text:String(i)}),Lm(t),Vv(t)})})})},Cw=(t,e)=>{if(t.inline||(t.getElement().style.visibility=t.orgVisibility),e||t.inline)yw(t);else{const o=t.iframeElement,r=(n=N(o),Ox(n,"load",aN,()=>{r.unbind(),t.contentDocument=o.contentDocument,yw(t)}));if(Ct.browser.isFirefox()){const s=t.getDoc();s.open(),s.write(t.iframeHTML),s.close()}else o.srcdoc=t.iframeHTML}var n},Mm=Et.DOM,ww=Et.DOM,xw=(t,e)=>({editorContainer:t,iframeContainer:e,api:{}}),kw=t=>{const e=t.getElement();return t.inline?xw(null):(n=>{const o=ww.create("div");return ww.insertAfter(o,n),xw(o,o)})(e)},_A=t=>{t.dispatch("ScriptsLoaded"),(n=>{const o=$.trim(Ip(n)),r=n.ui.registry.getAll().icons,s=K(K({},Ki.get("default").icons),Ki.get(o).icons);Nt(s,(a,i)=>{pt(r,i)||n.ui.registry.addIcon(i,a)})})(t),(n=>{const o=_r(n);if(it(o)){const r=rr.get(o);n.theme=r(n,rr.urls[o])||{},wt(n.theme.init)&&n.theme.init(n,rr.urls[o]||n.documentBaseUrl.replace(/\/$/,""))}else n.theme={}})(t),(n=>{const o=zd(n),r=Fr.get(o);n.model=r(n,Fr.urls[o])})(t),(n=>{const o=[];H(ai(n),r=>{((s,a,i)=>{const l=Ur.get(i),d=Ur.urls[i]||s.documentBaseUrl.replace(/\/$/,"");if(i=$.trim(i),l&&$.inArray(a,i)===-1){if(s.plugins[i])return;try{const c=l(s,d)||{};s.plugins[i]=c,wt(c.init)&&(c.init(s,d),a.push(i))}catch(c){((u,g,p)=>{const m=rn.translate(["Failed to initialize plugin: {0}",g]);$h(u,"PluginLoadError",{message:m}),Yi(m,p),Gi(u,m)})(s,i,c)}}})(n,o,(s=>s.replace(/^\-/,""))(r))})})(t);const e=(n=>{const o=n.getElement();return n.orgDisplay=o.style.display,it(_r(n))?(r=>{const s=r.theme.renderUI;return s?s():kw(r)})(n):wt(_r(n))?(r=>{const s=r.getElement(),a=_r(r)(r,s);return a.editorContainer.nodeType&&(a.editorContainer.id=a.editorContainer.id||r.id+"_parent"),a.iframeContainer&&a.iframeContainer.nodeType&&(a.iframeContainer.id=a.iframeContainer.id||r.id+"_iframecontainer"),a.height=a.iframeHeight?a.iframeHeight:s.offsetHeight,a})(n):kw(n)})(t);((n,o)=>{const r={show:C.from(o.show).getOr(bt),hide:C.from(o.hide).getOr(bt),isEnabled:C.from(o.isEnabled).getOr(Ht),setEnabled:s=>{n.mode.isReadOnly()||C.from(o.setEnabled).each(a=>a(s))}};n.ui=K(K({},n.ui),r)})(t,C.from(e.api).getOr({})),t.editorContainer=e.editorContainer,(n=>{n.contentCSS=n.contentCSS.concat((o=>ny(o,Hk(o)))(n),(o=>ny(o,zp(o)))(n))})(t),t.inline?Cw(t):((n,o)=>{((r,s)=>{const a=r.translate("Rich Text Area"),i=In(N(r.getElement()),"tabindex").bind(Ta),l=((d,c,u,g)=>{const p=Jt("iframe");return g.each(m=>Qt(p,"tabindex",m)),Xn(p,u),Xn(p,{id:d+"_ifr",frameBorder:"0",allowTransparency:"true",title:c}),cs(p,"tox-edit-area__iframe"),p})(r.id,a,kk(r),i).dom;l.onload=()=>{l.onload=null,r.dispatch("load")},r.contentAreaContainer=s.iframeContainer,r.iframeElement=l,r.iframeHTML=(d=>{let c=Sk(d)+"<html><head>";Dp(d)!==d.documentBaseUrl&&(c+='<base href="'+d.documentBaseURI.getURI()+'" />'),c+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';const u=Ek(d),g=_k(d),p=d.translate(mS(d));return Pp(d)&&(c+='<meta http-equiv="Content-Security-Policy" content="'+Pp(d)+'" />'),c+=`</head><body id="${u}" class="mce-content-body ${g}" data-id="${d.id}" aria-label="${p}"><br></body></html>`,c})(r),Mm.add(s.iframeContainer,l)})(n,o),o.editorContainer&&(o.editorContainer.style.display=n.orgDisplay,n.hidden=Mm.isHidden(o.editorContainer)),n.getElement().style.display="none",Mm.setAttrib(n.id,"aria-hidden","true"),Cw(n)})(t,{editorContainer:e.editorContainer,iframeContainer:e.iframeContainer})},sr=Et.DOM,Sw=t=>t.charAt(0)==="-",Ew=(t,e,n)=>C.from(e).filter(o=>pn(o)&&!Ki.has(o)).map(o=>({url:`${t.editorManager.baseURL}/icons/${o}/icons${n}.js`,name:C.some(o)})),NA=(t,e)=>{const n=Hn.ScriptLoader,o=()=>{!t.removed&&(r=>{const s=_r(r);return!it(s)||Q(rr.get(s))})(t)&&(r=>{const s=zd(r);return Q(Fr.get(s))})(t)&&_A(t)};((r,s)=>{const a=_r(r);if(it(a)&&!Sw(a)&&!pt(rr.urls,a)){const i=Yk(r),l=i?r.documentBaseURI.toAbsolute(i):`themes/${a}/theme${s}.js`;rr.load(a,l).catch(()=>{((d,c,u)=>{ra(d,"ThemeLoadError",sa("theme",c,u))})(r,l,a)})}})(t,e),((r,s)=>{const a=zd(r);if(a!=="plugin"&&!pt(Fr.urls,a)){const i=Xk(r),l=it(i)?r.documentBaseURI.toAbsolute(i):`models/${a}/model${s}.js`;Fr.load(a,l).catch(()=>{((d,c,u)=>{ra(d,"ModelLoadError",sa("model",c,u))})(r,l,a)})}})(t,e),((r,s)=>{const a=Fp(s),i=zk(s);if(!rn.hasCode(a)&&a!=="en"){const l=pn(i)?i:`${s.editorManager.baseURL}/langs/${a}.js`;r.add(l).catch(()=>{((d,c,u)=>{ra(d,"LanguageLoadError",sa("language",c,u))})(s,l,a)})}})(n,t),((r,s,a)=>{const i=Ew(s,"default",a),l=(d=>C.from(Pk(d)).filter(pn).map(c=>({url:c,name:C.none()})))(s).orThunk(()=>Ew(s,Ip(s),""));H((d=>{const c=[],u=g=>{c.push(g)};for(let g=0;g<d.length;g++)d[g].each(u);return c})([i,l]),d=>{r.add(d.url).catch(()=>{((c,u,g)=>{ra(c,"IconsLoadError",sa("icons",u,g))})(s,d.url,d.name.getOrUndefined())})})})(n,t,e),((r,s)=>{const a=(i,l)=>{Ur.load(i,l).catch(()=>{((d,c,u)=>{ra(d,"PluginLoadError",sa("plugin",c,u))})(r,l,i)})};Nt(lS(r),(i,l)=>{a(l,i),r.options.set("plugins",ai(r).concat(l))}),H(ai(r),i=>{!(i=$.trim(i))||Ur.urls[i]||Sw(i)||a(i,`plugins/${i}/plugin${s}.js`)})})(t,e),n.loadQueue().then(o,o)},_w=Ro().deviceType,Nw=_w.isPhone(),RA=_w.isTablet(),va=t=>{if(jt(t))return[];{const e=$t(t)?t:t.split(/[ ,]/),n=yt(e,gr);return mt(n,pn)}},AA=(t,e)=>{const n=((s,a)=>{const i={},l={};return nf(s,(d,c)=>_t(t,c),jl(i),jl(l)),{t:i,f:l}})(e);return o=n.t,r=n.f,{sections:Y(o),options:Y(r)};var o,r},Im=(t,e)=>pt(t.sections(),e),OA=(t,e)=>K({table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:At(t,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1},e?{menubar:!1}:{}),TA=(t,e)=>{var n;const o=(n=e.external_plugins)!==null&&n!==void 0?n:{};return t&&t.external_plugins?$.extend({},t.external_plugins,o):o},BA=(t,e,n,o,r)=>{var s;const a=t?{mobile:OA((s=r.mobile)!==null&&s!==void 0?s:{},e)}:{},i=AA(["mobile"],im(a,r)),l=$.extend(n,o,i.options(),((d,c)=>d&&Im(c,"mobile"))(t,i)?((d,c,u={})=>{const g=d.sections(),p=At(g,c).getOr({});return $.extend({},u,p)})(i,"mobile"):{},{external_plugins:TA(o,i.options())});return((d,c,u,g)=>{const p=va(u.forced_plugins),m=va(g.plugins),h=((v,y)=>Im(v,y)?v.sections()[y]:{})(c,"mobile"),f=((v,y,w,k)=>v&&Im(y,"mobile")?k:w)(d,c,m,h.plugins?va(h.plugins):m),b=((v,y)=>[...va(v),...va(y)])(p,f);return $.extend(g,{forced_plugins:p,plugins:b})})(t,i,o,l)},DA=t=>{(e=>{const n=o=>()=>{H("left,center,right,justify".split(","),r=>{o!==r&&e.formatter.remove("align"+r)}),o!=="none"&&((r,s)=>{e.formatter.toggle(r,void 0),e.nodeChanged()})("align"+o)};e.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})})(t),(e=>{const n=o=>()=>{const r=e.selection,s=r.isCollapsed()?[e.dom.getParent(r.getNode(),e.dom.isBlock)]:r.getSelectedBlocks();return It(s,a=>Q(e.formatter.matchNode(a,o)))};e.editorCommands.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify")},"state")})(t)},PA=(t,e)=>{const n=t.selection,o=t.dom;return/^ | $/.test(e)?((r,s,a)=>{const i=N(r.getRoot());return a=Qs(i,L.fromRangeStart(s))?a.replace(/^ /,"&nbsp;"):a.replace(/^&nbsp;/," "),Js(i,L.fromRangeEnd(s))?a.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):a.replace(/&nbsp;(<br( \/)?>)?$/," ")})(o,n.getRng(),e):e},xl=(t,e)=>{const{content:n,details:o}=(r=>{if(typeof r!="string"){const s=$.extend({paste:r.paste,data:{paste:r.paste}},r);return{content:r.content,details:s}}return{content:r,details:{}}})(e);xu(t,K(K({},o),{content:PA(t,n),format:"html",set:!1,selection:!0})).each(r=>{const s=((a,i,l)=>Au(a).editor.insertContent(i,l))(t,r.content,o);ku(t,s,r),t.addVisual()})},LA={"font-size":"size","font-family":"face"},MA=Xl("font"),Rw=t=>(e,n)=>C.from(n).map(N).filter(Te).bind(o=>((r,s,a)=>Zc(N(a),i=>(l=>Fa(l,r).orThunk(()=>MA(l)?At(LA,r).bind(d=>In(l,d)):C.none()))(i),i=>xt(N(s),i)))(t,e,o.dom).or(((r,s)=>C.from(Et.DOM.getStyle(s,r,!0)))(t,o.dom))).getOr(""),IA=Rw("font-size"),FA=ko(t=>t.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),Rw("font-family")),UA=t=>be(t.getBody()).bind(e=>{const n=e.container();return C.from(j(n)?n.parentNode:n)}),Fm=(t,e)=>((n,o)=>(r=>C.from(r.selection.getRng()).bind(s=>{const a=r.getBody();return s.startContainer===a&&s.startOffset===0?C.none():C.from(r.selection.getStart(!0))}))(n).orThunk(tt(UA,n)).map(N).filter(Te).bind(o))(t,Qm(C.some,e)),Aw=(t,e)=>{if(/^[0-9.]+$/.test(e)){const n=parseInt(e,10);if(n>=1&&n<=7){const o=(s=>$.explode(s.options.get("font_size_style_values")))(t),r=(s=>$.explode(s.options.get("font_size_classes")))(t);return r.length>0?r[n-1]||e:o[n-1]||e}return e}return e},zA=t=>{const e=t.split(/\s*,\s*/);return yt(e,n=>n.indexOf(" ")===-1||ee(n,'"')||ee(n,"'")?n:`'${n}'`).join(",")},jA=t=>{DA(t),(e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":n=>{const o=e.getDoc();let r;try{o.execCommand(n)}catch(s){r=!0}if(n!=="paste"||o.queryCommandEnabled(n)||(r=!0),r||!o.queryCommandSupported(n)){let s=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(Ct.os.isMacOS()||Ct.os.isiOS())&&(s=s.replace(/Ctrl\+/g,"\u2318+")),e.notificationManager.open({text:s,type:"error"})}}})})(t),(e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})})(t),(e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(n,o,r)=>{let s=0;e.dom.getParent(e.selection.getNode(),a=>!J(a)||s++!==r||(e.selection.select(a),!1),e.getBody())},mceSelectNode:(n,o,r)=>{e.selection.select(r)},selectAll:()=>{const n=e.dom.getParent(e.selection.getStart(),nn);if(n){const o=e.dom.createRng();o.selectNodeContents(n),e.selection.setRng(o)}}})})(t),(e=>{e.editorCommands.addCommands({mceCleanup:()=>{const n=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(n)},insertImage:(n,o,r)=>{xl(e,e.dom.createHTML("img",{src:r}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(n,o,r)=>{xl(e,e.dom.encode(r))},insertHTML:(n,o,r)=>{xl(e,r)},mceInsertContent:(n,o,r)=>{xl(e,r)},mceSetContent:(n,o,r)=>{e.setContent(r)},mceReplaceContent:(n,o,r)=>{e.execCommand("mceInsertContent",!1,r.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent("")}})})(t),(e=>{const n=(o,r,s)=>{const a=it(s)?{href:s}:s,i=e.dom.getParent(e.selection.getNode(),"a");me(a)&&it(a.href)&&(a.href=a.href.replace(/ /g,"%20"),i&&a.href||e.formatter.remove("link"),a.href&&e.formatter.apply("link",a,i))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isCollapsed()){const o=e.dom.getParent(e.selection.getStart(),"a");o&&e.dom.remove(o,!0)}else e.formatter.remove("link")},mceInsertLink:n,createLink:n})})(t),(e=>{e.editorCommands.addCommands({Indent:()=>{(n=>{aC(n,"indent")})(e)},Outdent:()=>{iC(e)}}),e.editorCommands.addCommands({Outdent:()=>oC(e)},"state")})(t),(e=>{e.editorCommands.addCommands({insertParagraph:()=>{pl(f1,e)},mceInsertNewLine:(n,o,r)=>{C1(e,r)},InsertLineBreak:(n,o,r)=>{pl(h1,e)}})})(t),(e=>{(n=>{n.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":o=>{n.getDoc().execCommand(o);const r=n.dom.getParent(n.selection.getNode(),"ol,ul");if(r){const s=r.parentNode;if(s&&/^(H[1-6]|P|ADDRESS|PRE)$/.test(s.nodeName)){const a=n.selection.getBookmark();n.dom.split(s,r),n.selection.moveToBookmark(a)}}}})})(e),(n=>{n.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":o=>{const r=n.dom.getParent(n.selection.getNode(),"ul,ol");return r&&(o==="insertunorderedlist"&&r.tagName==="UL"||o==="insertorderedlist"&&r.tagName==="OL")}},"state")})(e)})(t),(e=>{(n=>{const o=(r,s)=>{n.formatter.toggle(r,s),n.nodeChanged()};n.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":r=>{o(r)},"ForeColor,HiliteColor":(r,s,a)=>{o(r,{value:a})},BackColor:(r,s,a)=>{o("hilitecolor",{value:a})},FontName:(r,s,a)=>{((i,l)=>{const d=Aw(i,l);i.formatter.toggle("fontname",{value:zA(d)}),i.nodeChanged()})(n,a)},FontSize:(r,s,a)=>{((i,l)=>{i.formatter.toggle("fontsize",{value:Aw(i,l)}),i.nodeChanged()})(n,a)},LineHeight:(r,s,a)=>{((i,l)=>{i.formatter.toggle("lineheight",{value:String(l)}),i.nodeChanged()})(n,a)},Lang:(r,s,a)=>{var i;o(r,{value:a.code,customValue:(i=a.customCode)!==null&&i!==void 0?i:null})},RemoveFormat:r=>{n.formatter.remove(r)},mceBlockQuote:()=>{o("blockquote")},FormatBlock:(r,s,a)=>{o(it(a)?a:"p")},mceToggleFormat:(r,s,a)=>{o(a)}})})(e),(n=>{const o=r=>n.formatter.match(r);n.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":r=>o(r),mceBlockQuote:()=>o("blockquote")},"state"),n.editorCommands.addQueryValueHandler("FontName",()=>(r=>Fm(r,s=>FA(r.getBody(),s.dom)).getOr(""))(n)),n.editorCommands.addQueryValueHandler("FontSize",()=>(r=>Fm(r,s=>IA(r.getBody(),s.dom)).getOr(""))(n)),n.editorCommands.addQueryValueHandler("LineHeight",()=>(r=>Fm(r,s=>{const a=N(r.getBody());return Zc(s,l=>Fa(l,"line-height"),tt(xt,a)).getOrThunk(()=>{const l=parseFloat(vn(s,"line-height")),d=parseFloat(vn(s,"font-size"));return String(l/d)})}).getOr(""))(n))})(e)})(t),(e=>{e.editorCommands.addCommands({mceRemoveNode:(n,o,r)=>{const s=r!=null?r:e.selection.getNode();if(s!==e.getBody()){const a=e.selection.getBookmark();e.dom.remove(s,!0),e.selection.moveToBookmark(a)}},mcePrint:()=>{e.getWin().print()},mceFocus:(n,o,r)=>{((s,a)=>{s.removed||(a?kc(s):(i=>{const l=i.selection,d=i.getBody();let c=l.getRng();i.quirks.refreshContentEditable(),Q(i.bookmark)&&!Qo(i)&&Cc(i).each(g=>{i.selection.setRng(g),c=g});const u=((g,p)=>g.dom.getParent(p,m=>g.dom.getContentEditable(m)==="true"))(i,l.getNode());if(u&&i.dom.isChildOf(u,d))return xc(u),Cb(i,c),void kc(i);i.inline||(Ct.browser.isOpera()||xc(d),i.getWin().focus()),(Ct.browser.isFirefox()||i.inline)&&(xc(d),Cb(i,c)),kc(i)})(s))})(e,r===!0)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})})(t)},HA=["toggleview"],Ow=t=>_t(HA,t.toLowerCase());class Tw{constructor(e){this.commands={state:{},exec:{},value:{}},this.editor=e}execCommand(e,n=!1,o,r){const s=this.editor,a=e.toLowerCase(),i=r==null?void 0:r.skip_focus;if(s.removed||(a!=="mcefocus"&&(/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)||i?(d=>{Cc(d).each(c=>d.selection.setRng(c))})(s):s.focus()),s.dispatch("BeforeExecCommand",{command:e,ui:n,value:o}).isDefaultPrevented()))return!1;const l=this.commands.exec[a];return!!wt(l)&&(l(a,n,o),s.dispatch("ExecCommand",{command:e,ui:n,value:o}),!0)}queryCommandState(e){if(!Ow(e)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;const n=e.toLowerCase(),o=this.commands.state[n];return!!wt(o)&&o(n)}queryCommandValue(e){if(!Ow(e)&&this.editor.quirks.isHidden()||this.editor.removed)return"";const n=e.toLowerCase(),o=this.commands.value[n];return wt(o)?o(n):""}addCommands(e,n="exec"){const o=this.commands;Nt(e,(r,s)=>{H(s.toLowerCase().split(","),a=>{o[n][a]=r})})}addCommand(e,n,o){const r=e.toLowerCase();this.commands.exec[r]=(s,a,i)=>n.call(o!=null?o:this.editor,a,i)}queryCommandSupported(e){const n=e.toLowerCase();return!!this.commands.exec[n]}addQueryStateHandler(e,n,o){this.commands.state[e.toLowerCase()]=()=>n.call(o!=null?o:this.editor)}addQueryValueHandler(e,n,o){this.commands.value[e.toLowerCase()]=()=>n.call(o!=null?o:this.editor)}}const Gr="data-mce-contenteditable",Um=(t,e,n)=>{try{t.getDoc().execCommand(e,!1,String(n))}catch(o){}},kl=(t,e)=>{t.dom.contentEditable=e?"true":"false"},$A=(t,e)=>{const n=N(t.getBody());((o,r,s)=>{Jl(o,r)&&!s?Pa(o,r):s&&cs(o,r)})(n,"mce-content-readonly",e),e?(t.selection.controlSelection.hideResizeRect(),t._selectionOverrides.hideFakeCaret(),(o=>{C.from(o.selection.getNode()).each(r=>{r.removeAttribute("data-mce-selected")})})(t),t.readonly=!0,kl(n,!1),H(le(n,'*[contenteditable="true"]'),o=>{Qt(o,Gr,"true"),kl(o,!1)})):(t.readonly=!1,kl(n,!0),H(le(n,'*[data-mce-contenteditable="true"]'),o=>{ne(o,Gr),kl(o,!0)}),Um(t,"StyleWithCSS",!1),Um(t,"enableInlineTableEditing",!1),Um(t,"enableObjectResizing",!1),(o=>Qo(o)||(r=>{const s=Qn(N(r.getElement()));return vc(s).filter(a=>!(i=>{const l=i.classList;return l!==void 0&&(l.contains("tox-edit-area")||l.contains("tox-edit-area__iframe")||l.contains("mce-content-body"))})(a.dom)&&Ni(r,a.dom)).isSome()})(o))(t)&&t.focus(),(o=>{o.selection.setRng(o.selection.getRng())})(t),t.nodeChanged())},ar=t=>t.readonly,Bw=t=>{t.parser.addAttributeFilter("contenteditable",e=>{ar(t)&&H(e,n=>{n.attr(Gr,n.attr("contenteditable")),n.attr("contenteditable","false")})}),t.serializer.addAttributeFilter(Gr,e=>{ar(t)&&H(e,n=>{n.attr("contenteditable",n.attr(Gr))})}),t.serializer.addTempAttr(Gr)},VA=["copy"],qA=$.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class zm{constructor(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||Dt}static isNative(e){return!!qA[e.toLowerCase()]}fire(e,n){return this.dispatch(e,n)}dispatch(e,n){const o=e.toLowerCase(),r=kd(o,n!=null?n:{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(r);const s=this.bindings[o];if(s)for(let a=0,i=s.length;a<i;a++){const l=s[a];if(!l.removed){if(l.once&&this.off(o,l.func),r.isImmediatePropagationStopped())return r;if(l.func.call(this.scope,r)===!1)return r.preventDefault(),r}}return r}on(e,n,o,r){if(n===!1&&(n=Dt),n){const s={func:n,removed:!1};r&&$.extend(s,r);const a=e.toLowerCase().split(" ");let i=a.length;for(;i--;){const l=a[i];let d=this.bindings[l];d||(d=[],this.toggleEvent(l,!0)),d=o?[s,...d]:[...d,s],this.bindings[l]=d}}return this}off(e,n){if(e){const o=e.toLowerCase().split(" ");let r=o.length;for(;r--;){const s=o[r];let a=this.bindings[s];if(!s)return Nt(this.bindings,(i,l)=>{this.toggleEvent(l,!1),delete this.bindings[l]}),this;if(a){if(n){const i=es(a,l=>l.func===n);a=i.fail,this.bindings[s]=a,H(i.pass,l=>{l.removed=!0})}else a.length=0;a.length||(this.toggleEvent(e,!1),delete this.bindings[s])}}}else Nt(this.bindings,(o,r)=>{this.toggleEvent(r,!1)}),this.bindings={};return this}once(e,n,o){return this.on(e,n,o,{once:!0})}has(e){e=e.toLowerCase();const n=this.bindings[e];return!(!n||n.length===0)}}const ya=t=>(t._eventDispatcher||(t._eventDispatcher=new zm({scope:t,toggleEvent:(e,n)=>{zm.isNative(e)&&t.toggleNativeEvent&&t.toggleNativeEvent(e,n)}})),t._eventDispatcher),jm={fire(t,e,n){return this.dispatch(t,e,n)},dispatch(t,e,n){const o=this;if(o.removed&&t!=="remove"&&t!=="detach")return kd(t.toLowerCase(),e!=null?e:{},o);const r=ya(o).dispatch(t,e);if(n!==!1&&o.parent){let s=o.parent();for(;s&&!r.isPropagationStopped();)s.dispatch(t,r,!1),s=s.parent?s.parent():void 0}return r},on(t,e,n){return ya(this).on(t,e,n)},off(t,e){return ya(this).off(t,e)},once(t,e){return ya(this).once(t,e)},hasEventListeners(t){return ya(this).has(t)}},Sl=Et.DOM;let ir;const El=(t,e)=>{if(e==="selectionchange")return t.getDoc();if(!t.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(e))return t.getDoc().documentElement;const n=Hp(t);return n?(t.eventRoot||(t.eventRoot=Sl.select(n)[0]),t.eventRoot):t.getBody()},Dw=(t,e,n)=>{(o=>!o.hidden&&!ar(o))(t)?t.dispatch(e,n):ar(t)&&((o,r)=>{if((s=>s.type==="click")(r)&&!ot.metaKeyPressed(r)){const s=N(r.target);((a,i)=>Do(i,"a",l=>xt(l,N(a.getBody()))).bind(l=>In(l,"href")))(o,s).each(a=>{if(r.preventDefault(),/^#/.test(a)){const l=o.dom.select(`${a},[name="${i=a,ee(i,"#")?((d,c)=>d.substring(c))(i,"#".length):i}"]`);l.length&&o.selection.scrollIntoView(l[0],!0)}else window.open(a,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes");var i})}else(s=>_t(VA,s.type))(r)&&o.dispatch(r.type,r)})(t,n)},Pw=(t,e)=>{if(t.delegates||(t.delegates={}),t.delegates[e]||t.removed)return;const n=El(t,e);if(Hp(t)){if(ir||(ir={},t.editorManager.on("removeEditor",()=>{t.editorManager.activeEditor||ir&&(Nt(ir,(r,s)=>{t.dom.unbind(El(t,s))}),ir=null)})),ir[e])return;const o=r=>{const s=r.target,a=t.editorManager.get();let i=a.length;for(;i--;){const l=a[i].getBody();(l===s||Sl.isChildOf(s,l))&&Dw(a[i],e,r)}};ir[e]=o,Sl.bind(n,e,o)}else{const o=r=>{Dw(t,e,r)};Sl.bind(n,e,o),t.delegates[e]=o}},Lw=K(K({},jm),{bindPendingEventDelegates(){const t=this;$.each(t._pendingNativeEvents,e=>{Pw(t,e)})},toggleNativeEvent(t,e){const n=this;t!=="focus"&&t!=="blur"&&(n.removed||(e?n.initialized?Pw(n,t):n._pendingNativeEvents?n._pendingNativeEvents.push(t):n._pendingNativeEvents=[t]:n.initialized&&n.delegates&&(n.dom.unbind(El(n,t),t,n.delegates[t]),delete n.delegates[t])))},unbindAllNativeEvents(){const t=this,e=t.getBody(),n=t.dom;t.delegates&&(Nt(t.delegates,(o,r)=>{t.dom.unbind(El(t,r),r,o)}),delete t.delegates),!t.inline&&e&&n&&(e.onload=null,n.unbind(t.getWin()),n.unbind(t.getDoc())),n&&(n.unbind(e),n.unbind(t.getContainer()))}}),WA=t=>it(t)?{value:t.split(/[ ,]/),valid:!0}:cr(t,it)?{value:t,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},Mw=(t,e)=>t+(is(e.message)?"":`. ${e.message}`),Iw=t=>t.valid,Hm=(t,e,n="")=>{const o=e(t);return xo(o)?o?{value:t,valid:!0}:{valid:!1,message:n}:o},KA=["design","readonly"],Fw=(t,e,n,o)=>{const r=n[e.get()],s=n[o];try{s.activate()}catch(a){return void console.error(`problem while activating editor mode ${o}:`,a)}r.deactivate(),r.editorReadOnly!==s.editorReadOnly&&$A(t,s.editorReadOnly),e.set(o),((a,i)=>{a.dispatch("SwitchMode",{mode:i})})(t,o)},$m=$.each,Vm=$.explode,GA={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},Uw=$.makeMap("alt,ctrl,shift,meta,access"),YA=t=>{const e={},n=Ct.os.isMacOS()||Ct.os.isiOS();$m(Vm(t.toLowerCase(),"+"),s=>{(a=>a in Uw)(s)?e[s]=!0:/^[0-9]{2,}$/.test(s)?e.keyCode=parseInt(s,10):(e.charCode=s.charCodeAt(0),e.keyCode=GA[s]||s.toUpperCase().charCodeAt(0))});const o=[e.keyCode];let r;for(r in Uw)e[r]?o.push(r):e[r]=!1;return e.id=o.join(","),e.access&&(e.alt=!0,n?e.ctrl=!0:e.shift=!0),e.meta&&(n?e.meta=!0:(e.ctrl=!0,e.meta=!1)),e};class zw{constructor(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;const n=this;e.on("keyup keypress keydown",o=>{!n.hasModifier(o)&&!n.isFunctionKey(o)||o.isDefaultPrevented()||($m(n.shortcuts,r=>{n.matchShortcut(o,r)&&(n.pendingPatterns=r.subpatterns.slice(0),o.type==="keydown"&&n.executeShortcutAction(r))}),n.matchShortcut(o,n.pendingPatterns[0])&&(n.pendingPatterns.length===1&&o.type==="keydown"&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}add(e,n,o,r){const s=this,a=s.normalizeCommandFunc(o);return $m(Vm($.trim(e)),i=>{const l=s.createShortcut(i,n,a,r);s.shortcuts[l.id]=l}),!0}remove(e){const n=this.createShortcut(e);return!!this.shortcuts[n.id]&&(delete this.shortcuts[n.id],!0)}normalizeCommandFunc(e){const n=this,o=e;return typeof o=="string"?()=>{n.editor.execCommand(o,!1,null)}:$.isArray(o)?()=>{n.editor.execCommand(o[0],o[1],o[2])}:o}createShortcut(e,n,o,r){const s=$.map(Vm(e,">"),YA);return s[s.length-1]=$.extend(s[s.length-1],{func:o,scope:r||this.editor}),$.extend(s[0],{desc:this.editor.translate(n),subpatterns:s.slice(1)})}hasModifier(e){return e.altKey||e.ctrlKey||e.metaKey}isFunctionKey(e){return e.type==="keydown"&&e.keyCode>=112&&e.keyCode<=123}matchShortcut(e,n){return!!n&&n.ctrl===e.ctrlKey&&n.meta===e.metaKey&&n.alt===e.altKey&&n.shift===e.shiftKey&&!!(e.keyCode===n.keyCode||e.charCode&&e.charCode===n.charCode)&&(e.preventDefault(),!0)}executeShortcutAction(e){return e.func?e.func.call(e.scope):null}}const XA=()=>{const t=(()=>{const e={},n={},o={},r={},s={},a={},i={},l={},d=(c,u)=>(g,p)=>{c[g.toLowerCase()]=K(K({},p),{type:u})};return{addButton:d(e,"button"),addGroupToolbarButton:d(e,"grouptoolbarbutton"),addToggleButton:d(e,"togglebutton"),addMenuButton:d(e,"menubutton"),addSplitButton:d(e,"splitbutton"),addMenuItem:d(n,"menuitem"),addNestedMenuItem:d(n,"nestedmenuitem"),addToggleMenuItem:d(n,"togglemenuitem"),addAutocompleter:d(o,"autocompleter"),addContextMenu:d(s,"contextmenu"),addContextToolbar:d(a,"contexttoolbar"),addContextForm:d(a,"contextform"),addSidebar:d(i,"sidebar"),addView:d(l,"views"),addIcon:(c,u)=>r[c.toLowerCase()]=u,getAll:()=>({buttons:e,menuItems:n,icons:r,popups:o,contextMenus:s,contextToolbars:a,sidebars:i,views:l})}})();return{addAutocompleter:t.addAutocompleter,addButton:t.addButton,addContextForm:t.addContextForm,addContextMenu:t.addContextMenu,addContextToolbar:t.addContextToolbar,addIcon:t.addIcon,addMenuButton:t.addMenuButton,addMenuItem:t.addMenuItem,addNestedMenuItem:t.addNestedMenuItem,addSidebar:t.addSidebar,addSplitButton:t.addSplitButton,addToggleButton:t.addToggleButton,addGroupToolbarButton:t.addGroupToolbarButton,addToggleMenuItem:t.addToggleMenuItem,addView:t.addView,getAll:t.getAll}},lr=Et.DOM,jw=$.extend,QA=$.each;class _l{constructor(e,n,o){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this.editorManager=o,this.documentBaseUrl=o.documentBaseURL,jw(this,Lw);const r=this;this.id=e,this.hidden=!1;const s=((p,m)=>BA(Nw||RA,Nw,m,p,m))(o.defaultOptions,n);this.options=((p,m)=>{const h={},f={},b=(y,w,k)=>{const x=Hm(w,k);return Iw(x)?(f[y]=x.value,!0):(console.warn(Mw(`Invalid value passed for the ${y} option`,x)),!1)},v=y=>pt(h,y);return{register:(y,w)=>{const k=(E=>it(E.processor))(w)?(E=>{const S=(()=>{switch(E){case"array":return $t;case"boolean":return xo;case"function":return wt;case"number":return Je;case"object":return me;case"string":return it;case"string[]":return WA;case"object[]":return _=>cr(_,me);case"regexp":return _=>Sa(_,RegExp);default:return Ht}})();return _=>Hm(_,S,`The value must be a ${E}.`)})(w.processor):w.processor,x=((E,S,_)=>{if(!fe(S)){const O=Hm(S,_);if(Iw(O))return O.value;console.error(Mw(`Invalid default value passed for the "${E}" option`,O))}})(y,w.default,k);h[y]=K(K({},w),{default:x,processor:k}),At(f,y).orThunk(()=>At(m,y)).each(E=>b(y,E,k))},isRegistered:v,get:y=>At(f,y).orThunk(()=>At(h,y).map(w=>w.default)).getOrUndefined(),set:(y,w)=>{if(v(y)){const k=h[y];return k.immutable?(console.error(`"${y}" is an immutable option and cannot be updated`),!1):b(y,w,k.processor)}return console.warn(`"${y}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:y=>{const w=v(y);return w&&delete f[y],w},isSet:y=>pt(f,y)}})(0,s),(p=>{const m=p.options.register;m("id",{processor:"string",default:p.id}),m("selector",{processor:"string"}),m("target",{processor:"object"}),m("suffix",{processor:"string"}),m("cache_suffix",{processor:"string"}),m("base_url",{processor:"string"}),m("referrer_policy",{processor:"string",default:""}),m("language_load",{processor:"boolean",default:!0}),m("inline",{processor:"boolean",default:!1}),m("iframe_attrs",{processor:"object",default:{}}),m("doctype",{processor:"string",default:"<!DOCTYPE html>"}),m("document_base_url",{processor:"string",default:p.documentBaseUrl}),m("body_id",{processor:Bp(p,"tinymce"),default:"tinymce"}),m("body_class",{processor:Bp(p),default:""}),m("content_security_policy",{processor:"string",default:""}),m("br_in_pre",{processor:"boolean",default:!0}),m("forced_root_block",{processor:h=>{const f=it(h)&&pn(h);return f?{value:h,valid:f}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),m("forced_root_block_attrs",{processor:"object",default:{}}),m("newline_behavior",{processor:h=>{const f=_t(["block","linebreak","invert","default"],h);return f?{value:h,valid:f}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),m("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),m("no_newline_selector",{processor:"string",default:""}),m("keep_styles",{processor:"boolean",default:!0}),m("end_container_on_empty_block",{processor:h=>xo(h)||it(h)?{valid:!0,value:h}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),m("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),m("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),m("font_size_classes",{processor:"string",default:""}),m("automatic_uploads",{processor:"boolean",default:!0}),m("images_reuse_filename",{processor:"boolean",default:!1}),m("images_replace_blob_uris",{processor:"boolean",default:!0}),m("icons",{processor:"string",default:""}),m("icons_url",{processor:"string",default:""}),m("images_upload_url",{processor:"string",default:""}),m("images_upload_base_path",{processor:"string",default:""}),m("images_upload_credentials",{processor:"boolean",default:!1}),m("images_upload_handler",{processor:"function"}),m("language",{processor:"string",default:"en"}),m("language_url",{processor:"string",default:""}),m("entity_encoding",{processor:"string",default:"named"}),m("indent",{processor:"boolean",default:!0}),m("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),m("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),m("indent_use_margin",{processor:"boolean",default:!1}),m("indentation",{processor:"string",default:"40px"}),m("content_css",{processor:h=>{const f=h===!1||it(h)||cr(h,it);return f?it(h)?{value:yt(h.split(","),gr),valid:f}:$t(h)?{value:h,valid:f}:h===!1?{value:[],valid:f}:{value:h,valid:f}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:jd(p)?[]:["default"]}),m("content_style",{processor:"string"}),m("content_css_cors",{processor:"boolean",default:!1}),m("font_css",{processor:h=>{const f=it(h)||cr(h,it);return f?{value:$t(h)?h:yt(h.split(","),gr),valid:f}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),m("inline_boundaries",{processor:"boolean",default:!0}),m("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),m("object_resizing",{processor:h=>{const f=xo(h)||it(h);return f?h===!1||Id.isiPhone()||Id.isiPad()?{value:"",valid:f}:{value:h===!0?"table,img,figure.image,div,video,iframe":h,valid:f}:{valid:!1,message:"Must be boolean or a string"}},default:!wk}),m("resize_img_proportional",{processor:"boolean",default:!0}),m("event_root",{processor:"object"}),m("service_message",{processor:"string"}),m("theme",{processor:h=>h===!1||it(h)||wt(h),default:"silver"}),m("theme_url",{processor:"string"}),m("formats",{processor:"object"}),m("format_empty_lines",{processor:"boolean",default:!1}),m("format_noneditable_selector",{processor:"string",default:""}),m("preview_styles",{processor:h=>{const f=h===!1||it(h);return f?{value:h===!1?"":h,valid:f}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),m("custom_ui_selector",{processor:"string",default:""}),m("hidden_input",{processor:"boolean",default:!0}),m("submit_patch",{processor:"boolean",default:!0}),m("encoding",{processor:"string"}),m("add_form_submit_trigger",{processor:"boolean",default:!0}),m("add_unload_trigger",{processor:"boolean",default:!0}),m("custom_undo_redo_levels",{processor:"number",default:0}),m("disable_nodechange",{processor:"boolean",default:!1}),m("readonly",{processor:"boolean",default:!1}),m("plugins",{processor:"string[]",default:[]}),m("external_plugins",{processor:"object"}),m("forced_plugins",{processor:"string[]"}),m("model",{processor:"string",default:p.hasPlugin("rtc")?"plugin":"dom"}),m("model_url",{processor:"string"}),m("block_unsupported_drop",{processor:"boolean",default:!0}),m("visual",{processor:"boolean",default:!0}),m("visual_table_class",{processor:"string",default:"mce-item-table"}),m("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),m("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),m("setup",{processor:"function"}),m("init_instance_callback",{processor:"function"}),m("url_converter",{processor:"function",default:p.convertURL}),m("url_converter_scope",{processor:"object",default:p}),m("urlconverter_callback",{processor:"function"}),m("allow_conditional_comments",{processor:"boolean",default:!1}),m("allow_html_data_urls",{processor:"boolean",default:!1}),m("allow_svg_data_urls",{processor:"boolean"}),m("allow_html_in_named_anchor",{processor:"boolean",default:!1}),m("allow_script_urls",{processor:"boolean",default:!1}),m("allow_unsafe_link_target",{processor:"boolean",default:!1}),m("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),m("fix_list_elements",{processor:"boolean",default:!1}),m("preserve_cdata",{processor:"boolean",default:!1}),m("remove_trailing_brs",{processor:"boolean"}),m("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),m("element_format",{processor:"string",default:"html"}),m("entities",{processor:"string"}),m("schema",{processor:"string",default:"html5"}),m("convert_urls",{processor:"boolean",default:!0}),m("relative_urls",{processor:"boolean",default:!0}),m("remove_script_host",{processor:"boolean",default:!0}),m("custom_elements",{processor:"string"}),m("extended_valid_elements",{processor:"string"}),m("invalid_elements",{processor:"string"}),m("invalid_styles",{processor:Fd}),m("valid_children",{processor:"string"}),m("valid_classes",{processor:Fd}),m("valid_elements",{processor:"string"}),m("valid_styles",{processor:Fd}),m("verify_html",{processor:"boolean",default:!0}),m("auto_focus",{processor:h=>it(h)||h===!0}),m("browser_spellcheck",{processor:"boolean",default:!1}),m("protect",{processor:"array"}),m("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),m("deprecation_warnings",{processor:"boolean",default:!0}),m("a11y_advanced_options",{processor:"boolean",default:!1}),m("api_key",{processor:"string"}),m("paste_block_drop",{processor:"boolean",default:!1}),m("paste_data_images",{processor:"boolean",default:!0}),m("paste_preprocess",{processor:"function"}),m("paste_postprocess",{processor:"function"}),m("paste_webkit_styles",{processor:"string",default:"none"}),m("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),m("paste_merge_formats",{processor:"boolean",default:!0}),m("smart_paste",{processor:"boolean",default:!0}),m("paste_as_text",{processor:"boolean",default:!1}),m("paste_tab_spaces",{processor:"number",default:4}),m("text_patterns",{processor:h=>cr(h,me)||h===!1?{value:Op(h===!1?[]:h),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}]}),m("text_patterns_lookup",{processor:h=>{return wt(h)?{value:(f=h,b=>{const v=f(b);return Op(v)}),valid:!0}:{valid:!1,message:"Must be a single function"};var f},default:h=>[]}),m("noneditable_class",{processor:"string",default:"mceNonEditable"}),m("editable_class",{processor:"string",default:"mceEditable"}),m("noneditable_regexp",{processor:h=>cr(h,Tp)?{value:h,valid:!0}:Tp(h)?{value:[h],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),m("table_tab_navigation",{processor:"boolean",default:!0}),p.on("ScriptsLoaded",()=>{m("directionality",{processor:"string",default:rn.isRtl()?"rtl":void 0}),m("placeholder",{processor:"string",default:xk.getAttrib(p.getElement(),"placeholder")})})})(r);const a=this.options.get;a("deprecation_warnings")&&((p,m)=>{((h,f)=>{const b=tN(h),v=eN(f),y=v.length>0,w=b.length>0,k=f.theme==="mobile";if(y||w||k){const x=`
- `,E=k?`

Themes:${x}mobile`:"",S=y?`

Plugins:${x}${v.join(x)}`:"",_=w?`

Options:${x}${b.join(x)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 6.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/6/migration-from-5x/ for more information."+E+S+_)}})(p,m)})(n,s);const i=a("suffix");i&&(o.suffix=i),this.suffix=o.suffix;const l=a("base_url");l&&o._setBaseUrl(l),this.baseUri=o.baseURI;const d=Ud(r);d&&(Hn.ScriptLoader._setReferrerPolicy(d),Et.DOM.styleSheetLoader._setReferrerPolicy(d));const c=Vp(r);Q(c)&&Et.DOM.styleSheetLoader._setContentCssCors(c),de.languageLoad=a("language_load"),de.baseURL=o.baseURL,this.setDirty(!1),this.documentBaseURI=new cn(Dp(r),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=jd(r),this.hasVisual=cS(r),this.shortcuts=new zw(this),this.editorCommands=new Tw(this),jA(this);const u=a("cache_suffix");u&&(Ct.cacheSuffix=u.replace(/^[\?\&]+/,"")),this.ui={registry:XA(),styleSheetLoader:void 0,show:bt,hide:bt,setEnabled:bt,isEnabled:Ht},this.mode=(p=>{const m=Gt("design"),h=Gt({design:{activate:bt,deactivate:bt,editorReadOnly:!1},readonly:{activate:bt,deactivate:bt,editorReadOnly:!0}});return(f=>{f.serializer?Bw(f):f.on("PreInit",()=>{Bw(f)})})(p),(f=>{f.on("ShowCaret",b=>{ar(f)&&b.preventDefault()}),f.on("ObjectSelected",b=>{ar(f)&&b.preventDefault()})})(p),{isReadOnly:()=>ar(p),set:f=>((b,v,y,w)=>{if(w!==y.get()){if(!pt(v,w))throw new Error(`Editor mode '${w}' is invalid`);b.initialized?Fw(b,y,v,w):b.on("init",()=>Fw(b,y,v,w))}})(p,h.get(),m,f),get:()=>m.get(),register:(f,b)=>{h.set(((v,y,w)=>{if(_t(KA,y))throw new Error(`Cannot override default mode ${y}`);return K(K({},v),{[y]:K(K({},w),{deactivate:()=>{try{w.deactivate()}catch(k){console.error(`problem while deactivating editor mode ${y}:`,k)}}})})})(h.get(),f,b))}}})(r),o.dispatch("SetupEditor",{editor:this});const g=fS(r);wt(g)&&g.call(r,r)}render(){(e=>{const n=e.id;rn.setCode(Fp(e));const o=()=>{sr.unbind(window,"ready",o),e.render()};if(!zo.Event.domLoaded)return void sr.bind(window,"ready",o);if(!e.getElement())return;const r=N(e.getElement()),s=Tf(r);e.on("remove",()=>{Zm(r.dom.attributes,i=>ne(r,i.name)),Xn(r,s)}),e.ui.styleSheetLoader=((i,l)=>Dg.forElement(i,{contentCssCors:Vp(l),referrerPolicy:Ud(l)}))(r,e),jd(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");const a=e.getElement().form||sr.getParent(n,"form");a&&(e.formElement=a,nS(e)&&!sd(e.getElement())&&(sr.insertAfter(sr.create("input",{type:"hidden",name:n}),n),e.hasHiddenInput=!0),e.formEventDelegate=i=>{e.dispatch(i.type,i)},sr.bind(a,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),!oS(e)||a.submit.nodeType||a.submit.length||a._mceOldSubmit||(a._mceOldSubmit=a.submit,a.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),a._mceOldSubmit(a)))),e.windowManager=ty(e),e.notificationManager=Zv(e),(i=>i.options.get("encoding")==="xml")(e)&&e.on("GetContent",i=>{i.save&&(i.content=sr.encode(i.content))}),rS(e)&&e.on("submit",()=>{e.initialized&&e.save()}),sS(e)&&(e._beforeUnload=()=>{!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),NA(e,e.suffix)})(this)}focus(e){this.execCommand("mceFocus",!1,e)}hasFocus(){return Qo(this)}translate(e){return rn.translate(e)}getParam(e,n,o){const r=this.options;return r.isRegistered(e)||(Q(o)?r.register(e,{processor:o,default:n}):r.register(e,{processor:Ht,default:n})),r.isSet(e)||fe(n)?r.get(e):n}hasPlugin(e,n){return!(!_t(ai(this),e)||n&&Ur.get(e)===void 0)}nodeChanged(e){this._nodeChangeDispatcher.nodeChanged(e)}addCommand(e,n,o){this.editorCommands.addCommand(e,n,o)}addQueryStateHandler(e,n,o){this.editorCommands.addQueryStateHandler(e,n,o)}addQueryValueHandler(e,n,o){this.editorCommands.addQueryValueHandler(e,n,o)}addShortcut(e,n,o,r){this.shortcuts.add(e,n,o,r)}execCommand(e,n,o,r){return this.editorCommands.execCommand(e,n,o,r)}queryCommandState(e){return this.editorCommands.queryCommandState(e)}queryCommandValue(e){return this.editorCommands.queryCommandValue(e)}queryCommandSupported(e){return this.editorCommands.queryCommandSupported(e)}show(){const e=this;e.hidden&&(e.hidden=!1,e.inline?e.getBody().contentEditable="true":(lr.show(e.getContainer()),lr.hide(e.id)),e.load(),e.dispatch("show"))}hide(){const e=this;e.hidden||(e.save(),e.inline?(e.getBody().contentEditable="false",e===e.editorManager.focusedEditor&&(e.editorManager.focusedEditor=null)):(lr.hide(e.getContainer()),lr.setStyle(e.id,"display",e.orgDisplay)),e.hidden=!0,e.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(e,n){this.dispatch("ProgressState",{state:e,time:n})}load(e={}){const n=this,o=n.getElement();if(n.removed)return"";if(o){const r=K(K({},e),{load:!0}),s=sd(o)?o.value:o.innerHTML,a=n.setContent(s,r);return r.no_events||n.dispatch("LoadContent",K(K({},r),{element:o})),a}return""}save(e={}){const n=this;let o=n.getElement();if(!o||!n.initialized||n.removed)return"";const r=K(K({},e),{save:!0,element:o});let s=n.getContent(r);const a=K(K({},r),{content:s});if(a.no_events||n.dispatch("SaveContent",a),a.format==="raw"&&n.dispatch("RawSaveContent",a),s=a.content,sd(o))o.value=s;else{!e.is_removing&&n.inline||(o.innerHTML=s);const i=lr.getParent(n.id,"form");i&&QA(i.elements,l=>l.name!==n.id||(l.value=s,!1))}return a.element=r.element=o=null,a.set_dirty!==!1&&n.setDirty(!1),s}setContent(e,n){return Ou(this,e,n)}getContent(e){return((n,o={})=>{const r=((s,a)=>K(K({},s),{format:a,get:!0,getInner:!0}))(o,o.format?o.format:"html");return Tv(n,r).fold(ge,s=>{const a=((i,l)=>Au(i).editor.getContent(l))(n,s);return Bv(n,a,s)})})(this,e)}insertContent(e,n){n&&(e=jw({content:e},n)),this.execCommand("mceInsertContent",!1,e)}resetContent(e){e===void 0?Ou(this,this.startContent,{format:"raw"}):Ou(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(e){const n=!this.isNotDirty;this.isNotDirty=!e,e&&e!==n&&this.dispatch("dirty")}getContainer(){const e=this;return e.container||(e.container=e.editorContainer||lr.get(e.id+"_parent")),e.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=lr.get(this.id)),this.targetElm}getWin(){const e=this;if(!e.contentWindow){const n=e.iframeElement;n&&(e.contentWindow=n.contentWindow)}return e.contentWindow}getDoc(){const e=this;if(!e.contentDocument){const n=e.getWin();n&&(e.contentDocument=n.document)}return e.contentDocument}getBody(){var e,n;const o=this.getDoc();return(n=(e=this.bodyElement)!==null&&e!==void 0?e:o==null?void 0:o.body)!==null&&n!==void 0?n:null}convertURL(e,n,o){const r=this,s=r.options.get,a=pS(r);return wt(a)?a.call(r,e,o,!0,n):!s("convert_urls")||o==="link"||me(o)&&o.nodeName==="LINK"||e.indexOf("file:")===0||e.length===0?e:s("relative_urls")?r.documentBaseURI.toRelative(e):e=r.documentBaseURI.toAbsolute(e,s("remove_script_host"))}addVisual(e){((n,o)=>{((r,s)=>{Mt(r).editor.addVisual(s)})(n,o)})(this,e)}remove(){(e=>{if(!e.removed){const{_selectionOverrides:n,editorUpload:o}=e,r=e.getBody(),s=e.getElement();r&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&Q(s==null?void 0:s.nextSibling)&&qi.remove(s.nextSibling),(a=>{a.dispatch("remove")})(e),e.editorManager.remove(e),!e.inline&&r&&(a=>{qi.setStyle(a.id,"display",a.orgDisplay)})(e),(a=>{a.dispatch("detach")})(e),qi.remove(e.getContainer()),Wi(n),Wi(o),e.destroy()}})(this)}destroy(e){((n,o)=>{const{selection:r,dom:s}=n;n.destroyed||(o||n.removed?(o||(n.editorManager.off("beforeunload",n._beforeUnload),n.theme&&n.theme.destroy&&n.theme.destroy(),Wi(r),Wi(s)),(a=>{const i=a.formElement;i&&(i._mceOldSubmit&&(i.submit=i._mceOldSubmit,delete i._mceOldSubmit),qi.unbind(i,"submit reset",a.formEventDelegate))})(n),(a=>{const i=a;i.contentAreaContainer=i.formElement=i.container=i.editorContainer=null,i.bodyElement=i.contentDocument=i.contentWindow=null,i.iframeElement=i.targetElm=null;const l=a.selection;if(l){const d=l.dom;i.selection=l.win=l.dom=d.doc=null}})(n),n.destroyed=!0):n.remove())})(this,e)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}const Yr=Et.DOM,Nl=$.each;let Rl,Hw=!1,ye=[];const Al=t=>{const e=t.type;Nl(vo.get(),n=>{switch(e){case"scroll":n.dispatch("ScrollWindow",t);break;case"resize":n.dispatch("ResizeWindow",t)}})},$w=t=>{if(t!==Hw){const e=Et.DOM;t?(e.bind(window,"resize",Al),e.bind(window,"scroll",Al)):(e.unbind(window,"resize",Al),e.unbind(window,"scroll",Al)),Hw=t}},Vw=t=>{const e=ye;return ye=mt(ye,n=>t!==n),vo.activeEditor===t&&(vo.activeEditor=ye.length>0?ye[0]:null),vo.focusedEditor===t&&(vo.focusedEditor=null),e.length!==ye.length},JA=document.compatMode!=="CSS1Compat",vo=K(K({},jm),{baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"6",minorVersion:"3.2",releaseDate:"2023-02-22",i18n:rn,activeEditor:null,focusedEditor:null,setup(){const t=this;let e="",n="",o=cn.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(o)&&(o=o.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(o)||(o+="/"));const r=window.tinymce||window.tinyMCEPreInit;if(r)e=r.base||r.baseURL,n=r.suffix;else{const a=document.getElementsByTagName("script");for(let i=0;i<a.length;i++){const l=a[i].src||"";if(l==="")continue;const d=l.substring(l.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(l)){d.indexOf(".min")!==-1&&(n=".min"),e=l.substring(0,l.lastIndexOf("/"));break}}if(!e&&document.currentScript){const i=document.currentScript.src;i.indexOf(".min")!==-1&&(n=".min"),e=i.substring(0,i.lastIndexOf("/"))}}var s;t.baseURL=new cn(o).toAbsolute(e),t.documentBaseURL=o,t.baseURI=new cn(t.baseURL),t.suffix=n,(s=t).on("AddEditor",tt(xE,s)),s.on("RemoveEditor",tt(kE,s))},overrideDefaults(t){const e=t.base_url;e&&this._setBaseUrl(e);const n=t.suffix;n&&(this.suffix=n),this.defaultOptions=t;const o=t.plugin_base_urls;o!==void 0&&Nt(o,(r,s)=>{de.PluginManager.urls[s]=r})},init(t){const e=this;let n;const o=$.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," ");let r=a=>{n=a};const s=()=>{let a=0;const i=[];let l;Yr.unbind(window,"ready",s),(d=>{const c=t.onpageload;c&&c.apply(e,[])})(),l=((d,c)=>{const u=[],g=wt(c)?p=>It(u,m=>c(m,p)):p=>_t(u,p);for(let p=0,m=d.length;p<m;p++){const h=d[p];g(h)||u.push(h)}return u})((d=>Ct.browser.isIE()||Ct.browser.isEdge()?(Yi("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):JA?(Yi("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):it(d.selector)?Yr.select(d.selector):Q(d.target)?[d.target]:[])(t)),$.each(l,d=>{var c;(c=e.get(d.id))&&c.initialized&&!(c.getContainer()||c.getBody()).parentNode&&(Vw(c),c.unbindAllNativeEvents(),c.destroy(!0),c.removed=!0)}),l=$.grep(l,d=>!e.get(d.id)),l.length===0?r([]):Nl(l,d=>{((c,u)=>c.inline&&u.tagName.toLowerCase()in o)(t,d)?Yi("Could not initialize inline editor on invalid inline target element",d):((c,u,g)=>{const p=new _l(c,u,e);i.push(p),p.on("init",()=>{++a===l.length&&r(i)}),p.targetElm=p.targetElm||g,p.render()})((c=>{let u=c.id;return u||(u=At(c,"name").filter(g=>!Yr.get(g)).getOrThunk(Yr.uniqueId),c.setAttribute("id",u)),u})(d),t,d)})};return Yr.bind(window,"ready",s),new Promise(a=>{n?a(n):r=i=>{a(i)}})},get(t){return arguments.length===0?ye.slice(0):it(t)?Wt(ye,e=>e.id===t).getOr(null):Je(t)&&ye[t]?ye[t]:null},add(t){const e=this,n=e.get(t.id);return n===t||(n===null&&ye.push(t),$w(!0),e.activeEditor=t,e.dispatch("AddEditor",{editor:t}),Rl||(Rl=o=>{const r=e.dispatch("BeforeUnload");if(r.returnValue)return o.preventDefault(),o.returnValue=r.returnValue,r.returnValue},window.addEventListener("beforeunload",Rl))),t},createEditor(t,e){return this.add(new _l(t,e,this))},remove(t){const e=this;let n;if(t){if(!it(t))return n=t,wo(e.get(n.id))?null:(Vw(n)&&e.dispatch("RemoveEditor",{editor:n}),ye.length===0&&window.removeEventListener("beforeunload",Rl),n.remove(),$w(ye.length>0),n);Nl(Yr.select(t),o=>{n=e.get(o.id),n&&e.remove(n)})}else for(let o=ye.length-1;o>=0;o--)e.remove(ye[o])},execCommand(t,e,n){var o;const r=this,s=me(n)?(o=n.id)!==null&&o!==void 0?o:n.index:n;switch(t){case"mceAddEditor":if(!r.get(s)){const a=n.options;new _l(s,a,r).render()}return!0;case"mceRemoveEditor":{const a=r.get(s);return a&&a.remove(),!0}case"mceToggleEditor":{const a=r.get(s);return a?(a.isHidden()?a.show():a.hide(),!0):(r.execCommand("mceAddEditor",!1,n),!0)}}return!!r.activeEditor&&r.activeEditor.execCommand(t,e,n)},triggerSave:()=>{Nl(ye,t=>{t.save()})},addI18n:(t,e)=>{rn.add(t,e)},translate:t=>rn.translate(t),setActive(t){const e=this.activeEditor;this.activeEditor!==t&&(e&&e.dispatch("deactivate",{relatedTarget:t}),t.dispatch("activate",{relatedTarget:e})),this.activeEditor=t},_setBaseUrl(t){this.baseURL=new cn(this.documentBaseURL).toAbsolute(t.replace(/\/+$/,"")),this.baseURI=new cn(this.baseURL)}});vo.setup();const ZA=(()=>{const t=ao();return{FakeClipboardItem:e=>({items:e,types:Oe(e),getType:n=>At(e,n).getOrUndefined()}),write:e=>{t.set(e)},read:()=>t.get().getOrUndefined(),clear:t.clear}})(),qw=Math.min,Xr=Math.max,Ol=Math.round,Ww=(t,e,n)=>{let o=e.x,r=e.y;const s=t.w,a=t.h,i=e.w,l=e.h,d=(n||"").split("");return d[0]==="b"&&(r+=l),d[1]==="r"&&(o+=i),d[0]==="c"&&(r+=Ol(l/2)),d[1]==="c"&&(o+=Ol(i/2)),d[3]==="b"&&(r-=a),d[4]==="r"&&(o-=s),d[3]==="c"&&(r-=Ol(a/2)),d[4]==="c"&&(o-=Ol(s/2)),Qr(o,r,s,a)},Qr=(t,e,n,o)=>({x:t,y:e,w:n,h:o}),tO={inflate:(t,e,n)=>Qr(t.x-e,t.y-n,t.w+2*e,t.h+2*n),relativePosition:Ww,findBestRelativePosition:(t,e,n,o)=>{for(let r=0;r<o.length;r++){const s=Ww(t,e,o[r]);if(s.x>=n.x&&s.x+s.w<=n.w+n.x&&s.y>=n.y&&s.y+s.h<=n.h+n.y)return o[r]}return null},intersect:(t,e)=>{const n=Xr(t.x,e.x),o=Xr(t.y,e.y),r=qw(t.x+t.w,e.x+e.w),s=qw(t.y+t.h,e.y+e.h);return r-n<0||s-o<0?null:Qr(n,o,r-n,s-o)},clamp:(t,e,n)=>{let o=t.x,r=t.y,s=t.x+t.w,a=t.y+t.h;const i=e.x+e.w,l=e.y+e.h,d=Xr(0,e.x-o),c=Xr(0,e.y-r),u=Xr(0,s-i),g=Xr(0,a-l);return o+=d,r+=c,n&&(s+=d,a+=c,o-=u,r-=g),s-=u,a-=g,Qr(o,r,s-o,a-r)},create:Qr,fromClientRect:t=>Qr(t.left,t.top,t.width,t.height)},eO=(()=>{const t={},e={};return{load:(n,o)=>{const r=`Script at URL "${o}" failed to load`,s=`Script at URL "${o}" did not call \`tinymce.Resource.add('${n}', data)\` within 1 second`;if(t[n]!==void 0)return t[n];{const a=new Promise((i,l)=>{const d=((c,u,g=1e3)=>{let p=!1,m=null;const h=v=>(...y)=>{p||(p=!0,m!==null&&(clearTimeout(m),m=null),v.apply(null,y))},f=h(c),b=h(u);return{start:(...v)=>{p||m!==null||(m=setTimeout(()=>b.apply(null,v),g))},resolve:f,reject:b}})(i,l);e[n]=d.resolve,Hn.ScriptLoader.loadScript(o).then(()=>d.start(s),()=>d.reject(r))});return t[n]=a,a}},add:(n,o)=>{e[n]!==void 0&&(e[n](o),delete e[n]),t[n]=Promise.resolve(o)},unload:n=>{delete t[n]}}})();let Ca;try{const t="__storage_test__";Ca=window.localStorage,Ca.setItem(t,t),Ca.removeItem(t)}catch(t){Ca=(()=>{let e={},n=[];const o={getItem:r=>e[r]||null,setItem:(r,s)=>{n.push(r),e[r]=String(s)},key:r=>n[r],removeItem:r=>{n=n.filter(s=>s===r),delete e[r]},clear:()=>{n=[],e={}},length:0};return Object.defineProperty(o,"length",{get:()=>n.length,configurable:!1,enumerable:!1}),o})()}const nO={geom:{Rect:tO},util:{Delay:He,Tools:$,VK:ot,URI:cn,EventDispatcher:zm,Observable:jm,I18n:rn,LocalStorage:Ca,ImageUploader:t=>{const e=oy(),n=sy(t,e);return{upload:(o,r=!0)=>n.upload(o,r?ry(t):void 0)}}},dom:{EventUtils:zo,TreeWalker:Vt,TextSeeker:Ho,DOMUtils:Et,ScriptLoader:Hn,RangeUtils:Xo,Serializer:Xv,StyleSheetLoader:Bg,ControlSelection:Xh,BookmarkManager:qs,Selection:Yv,Event:zo.Event},html:{Styles:xd,Entities:ro,Node:ve,Schema:so,DomParser:Ir,Writer:Pb,Serializer:mo},Env:Ct,AddOnManager:de,Annotator:jh,Formatter:ly,UndoManager:cy,EditorCommands:Tw,WindowManager:ty,NotificationManager:Zv,EditorObservable:Lw,Shortcuts:zw,Editor:_l,FocusManager:yb,EditorManager:vo,DOM:Et.DOM,ScriptLoader:Hn.ScriptLoader,PluginManager:Ur,ThemeManager:rr,ModelManager:Fr,IconManager:Ki,Resource:eO,FakeClipboard:ZA,trim:$.trim,isArray:$.isArray,is:$.is,toArray:$.toArray,makeMap:$.makeMap,each:$.each,map:$.map,grep:$.grep,inArray:$.inArray,extend:$.extend,walk:$.walk,resolve:$.resolve,explode:$.explode,_addCacheSuffix:$._addCacheSuffix},Kw=$.extend(vo,nO);(t=>{window.tinymce=t,window.tinyMCE=t})(Kw),(t=>{if(typeof module=="object")try{module.exports=t}catch(e){}})(Kw)})();
